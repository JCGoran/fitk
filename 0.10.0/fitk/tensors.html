<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.0.0"/>
    <title>fitk.tensors API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */a[target="_blank"]::after{  content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAQElEQVR42qXKwQkAIAxDUUdxtO6/RBQkQZvSi8I/pL4BoGw/XPkh4XigPmsUgh0626AjRsgxHTkUThsG2T/sIlzdTsp52kSS1wAAAABJRU5ErkJggg==);  margin:0 3px 0 5px;}</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../fitk.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;fitk</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#FisherMatrix">FisherMatrix</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FisherMatrix.__init__">FisherMatrix</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.from_parameters">from_parameters</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.matrix">matrix</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.values">values</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.fiducials">fiducials</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.names">names</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.latex_names">latex_names</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.rename">rename</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.fiducial">fiducial</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.set_fiducial">set_fiducial</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.latex_name">latex_name</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.set_latex_name">set_latex_name</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.is_valid">is_valid</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.sort">sort</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.ndim">ndim</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.is_diagonal">is_diagonal</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.diagonal">diagonal</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.drop">drop</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.trace">trace</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.eigenvalues">eigenvalues</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.eigenvectors">eigenvectors</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.condition_number">condition_number</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.inverse">inverse</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.determinant">determinant</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.constraints">constraints</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.reparametrize_symbolic">reparametrize_symbolic</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.reparametrize">reparametrize</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.to_dict">to_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.to_file">to_file</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.marginalize_over">marginalize_over</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.from_file">from_file</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.from_dict">from_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.correlation_matrix">correlation_matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.correlation_coefficient">correlation_coefficient</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.figure_of_merit">figure_of_merit</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.figure_of_correlation">figure_of_correlation</a>
                        </li>
                </ul>

            </li>
    </ul>


    <footer>
      <label for="page-select">Version:</label>
      <select id="page-select" onchange="redirectToPage()">
        <option value="">Select an option</option>
            <option value="master">master</option>
            <option value="0.11.0">0.11.0</option>
            <option value="0.11.dev1">0.11.dev1</option>
            <option value="0.10.4">0.10.4</option>
            <option value="0.10.3">0.10.3</option>
            <option value="0.10.2">0.10.2</option>
            <option value="0.10.1">0.10.1</option>
            <option value="0.10.0">0.10.0</option>
            <option value="0.9.3">0.9.3</option>
            <option value="0.9.2">0.9.2</option>
            <option value="0.9.1">0.9.1</option>
            <option value="0.9.0">0.9.0</option>
            <option value="0.8.0">0.8.0</option>
            <option value="0.7.2">0.7.2</option>
            <option value="0.7.1">0.7.1</option>
            <option value="0.7.0">0.7.0</option>
            <option value="0.6.6">0.6.6</option>
            <option value="0.6.5">0.6.5</option>
            <option value="0.6.4">0.6.4</option>
            <option value="0.6.3">0.6.3</option>
            <option value="0.6.2">0.6.2</option>
            <option value="0.6.1">0.6.1</option>
            <option value="0.6.0">0.6.0</option>
            <option value="0.6.dev5">0.6.dev5</option>
            <option value="0.6.dev4">0.6.dev4</option>
            <option value="0.6.dev3">0.6.dev3</option>
            <option value="0.6.dev2">0.6.dev2</option>
            <option value="0.6.dev1">0.6.dev1</option>
        </select>

      <script>
        function redirectToPage() {
          var select = document.getElementById("page-select");
          var selectedOption = select.options[select.selectedIndex].value;

          if (selectedOption !== "") {
            var redirectURL = "/fitk/" + selectedOption + "/index.html";
            window.location.href = redirectURL;
          }
        }

        // Set the default value of the dropdown to the selected option
        window.onload = function() {
          var select = document.getElementById("page-select");
          var currentURL = window.location.pathname;
          var match = currentURL.match(/^\/fitk\/([^/]+)\/.+$/);

          if (match && match[1]) {
            select.value = match[1];
          }
        };
      </script>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../fitk.html">fitk</a><wbr>.tensors    </h1>

                        <div class="docstring"><p>Submodule for performing operations on Fisher objects.</p>

<p>See here for documentation of <code><a href="#FisherMatrix">FisherMatrix</a></code>.</p>
</div>

                        <input id="mod-tensors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-tensors-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">Submodule for performing operations on Fisher objects.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">See here for documentation of `FisherMatrix`.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="c1"># needed for compatibility with Python 3.7</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="c1"># standard library imports</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">import</span> <span class="nn">copy</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">import</span> <span class="nn">json</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Mapping</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">permutations</span><span class="p">,</span> <span class="n">product</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="n">Number</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="c1"># third party imports</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">import</span> <span class="nn">sympy</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">erfinv</span>  <span class="c1"># pylint: disable=no-name-in-module</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="c1"># first party imports</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="kn">from</span> <span class="nn">fitk.utilities</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a>    <span class="n">FisherEncoder</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>    <span class="n">MismatchingSizeError</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a>    <span class="n">MismatchingValuesError</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>    <span class="n">P</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>    <span class="n">ParameterNotFoundError</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>    <span class="n">get_index_of_other_array</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>    <span class="n">is_iterable</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>    <span class="n">is_positive_semidefinite</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>    <span class="n">is_square</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>    <span class="n">is_symmetric</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>    <span class="n">make_default_names</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>    <span class="n">reindex_array</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="p">)</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="k">def</span> <span class="nf">_solve_eqns</span><span class="p">(</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>    <span class="n">new_params</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">],</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>    <span class="n">transformation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>    <span class="n">solution_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>    <span class="n">initial_guess</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="p">):</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">    Solves the equations to obtain the new values of the fiducials.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd">    Parameters</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">    ----------</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">    params : dict</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="sd">        the names of the parameters as keys, and the fiducials as corresponding</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="sd">        values</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="sd">    new_params : array_like of symbols</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="sd">        the new parameters as sympy symbols</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="sd">    transformation : dict</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="sd">        the transformation from old parameters to new ones as a dictionary</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">    solution_index : int, optional</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">        in case we want to specify which (of the potentially multiple) new</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="sd">        fiducials we want</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">    initial_guess : dict, optional</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">        the mapping of the new names and the initial guess used to obtain it.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">        Only used if `sympy.solve` fails to find a solution</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    Returns</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">    -------</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">    solution : dict</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">        the solution for the new fiducials, with names of the parameters as</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">        keys, and corresponding fiducials as values</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>    <span class="c1"># we need to obtain the new fiducial from the old one; since the</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>    <span class="c1"># equations are not necessarily solvable analytically, we we first</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>    <span class="c1"># plug in the values of the old fiducials</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>    <span class="n">equations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>        <span class="n">sympy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>            <span class="n">sympy</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">())),</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>            <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>        <span class="p">)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">transformation</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>    <span class="p">]</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>    <span class="c1"># remove any trivial equations</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>    <span class="n">equations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>        <span class="nb">filter</span><span class="p">(</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">logic</span><span class="o">.</span><span class="n">boolalg</span><span class="o">.</span><span class="n">BooleanTrue</span><span class="p">),</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>            <span class="n">equations</span><span class="p">,</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>        <span class="p">)</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>    <span class="p">)</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>    <span class="c1"># TODO handle the case when we have less new parameters than old ones</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>    <span class="c1"># case 1: the solutions are obtainable analytically, and we use</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>    <span class="c1"># `solve`</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>        <span class="n">solutions</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">equations</span><span class="p">,</span> <span class="n">new_params</span><span class="p">,</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>    <span class="c1"># case 2: `solve` has failed, so we use numerical methods instead</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>    <span class="c1"># with `nsolve`</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>        <span class="c1"># TODO fix this</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>        <span class="n">equation_parameters</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>            <span class="n">_</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">new_params</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>            <span class="k">if</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">{</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="n">equations</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">__</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">}</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>        <span class="p">]</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>        <span class="k">if</span> <span class="n">initial_guess</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>            <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_guess</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">equation_parameters</span><span class="p">]</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>            <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">equation_parameters</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>        <span class="n">solutions</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">nsolve</span><span class="p">(</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>            <span class="n">equations</span><span class="p">,</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>            <span class="n">equation_parameters</span><span class="p">,</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>            <span class="n">x0</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>            <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>        <span class="p">)</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">solutions</span><span class="p">:</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to solve system of equations </span><span class="si">{</span><span class="n">equations</span><span class="si">}</span><span class="s2"> over the real numbers&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>        <span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">solutions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">solution_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>            <span class="sa">f</span><span class="s2">&quot;Multiple solutions for new fiducials found: </span><span class="si">{</span><span class="n">solutions</span><span class="si">}</span><span class="s2">; &quot;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>            <span class="s2">&quot;using the first one available, if you want to customize this behavior, pass &quot;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>            <span class="s2">&quot;`solution_index=[INDEX]` to select a particular solution&quot;</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>        <span class="p">)</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>    <span class="k">return</span> <span class="n">solutions</span><span class="p">[</span><span class="n">solution_index</span> <span class="k">if</span> <span class="n">solution_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="k">def</span> <span class="nf">_jacobian</span><span class="p">(</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>    <span class="n">transformation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="p">):</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="sd">    Return the 3-tuple `new_names`, `new_fiducials`, and the Jacobian of the transformation as a matrix.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">    Parameters</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="sd">    ----------</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">    params : dict</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">        the names of the parameters as keys, and the fiducials as corresponding</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">        values</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">    transformation : dict</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">        the transformation from old parameters to new ones as a dictionary</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="sd">    **kwargs</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">        any other kwargs passed to `_solve_eqns`</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">    Returns</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a><span class="sd">    -------</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a><span class="sd">    result : 3-tuple</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a><span class="sd">        the new names, new fiducials, and the Jacobian of the transformation</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>    <span class="c1"># remove any identity maps, since we insert those later anyway</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>    <span class="n">transformation</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>        <span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">transformation</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="n">value</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>    <span class="p">}</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>    <span class="c1"># all of the old names as SymPy symbols</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>    <span class="n">old_params</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="p">)))</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>    <span class="c1"># the old names, which we explicitly want to remove</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>    <span class="n">removed_params</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">transformation</span><span class="p">)))</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>    <span class="c1"># the new names, derived from the values of the map</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>    <span class="n">new_params</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>        <span class="n">symbol</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">transformation</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>        <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>    <span class="p">}</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">param</span> <span class="ow">in</span> <span class="n">removed_params</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">new_params</span><span class="p">):</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameter cannot be on both sides of the mapping&quot;</span><span class="p">)</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>    <span class="c1"># the new parameters can contain the old ones if the old ones are not</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>    <span class="c1"># present in the keys of the dictionary</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>    <span class="n">new_params</span> <span class="o">=</span> <span class="n">new_params</span> <span class="o">|</span> <span class="p">(</span><span class="n">old_params</span> <span class="o">-</span> <span class="n">removed_params</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>    <span class="n">old_params_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">old_params</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>    <span class="n">new_params_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_params</span><span class="p">)</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>    <span class="c1"># edge case: there is a different number of new parameters than there are</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>    <span class="c1"># old ones</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_params_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_params_list</span><span class="p">):</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>            <span class="sa">f</span><span class="s2">&quot;The number of new parameters (size=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">new_params_list</span><span class="p">)</span><span class="si">}</span><span class="s2">) &quot;</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>            <span class="sa">f</span><span class="s2">&quot;differs from the number of old ones (size=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">old_params_list</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>    <span class="c1"># we fill the transformation with identity maps for implicitly transformed</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>    <span class="c1"># parameters</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>    <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">new_params_list</span><span class="p">:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>        <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">removed_params</span> <span class="ow">and</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">old_params</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>            <span class="n">transformation</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>    <span class="c1"># this is necessary because otherwise the ordering of the old parameters is</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>    <span class="c1"># messed up</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>    <span class="n">transformation</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">transformation</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">params</span><span class="p">}</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>    <span class="n">solution</span> <span class="o">=</span> <span class="n">_solve_eqns</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">new_params_list</span><span class="p">,</span> <span class="n">transformation</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>    <span class="c1"># getting the symbolic Jacobian</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>    <span class="n">jacobian_symbolic</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>        <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">transformation</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>    <span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">new_params_list</span><span class="p">)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>    <span class="c1"># evaluating the symbolic Jacobian at the new fiducials</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>    <span class="n">jacobian_numeric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>        <span class="n">jacobian_symbolic</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>            <span class="n">subs</span><span class="o">=</span><span class="p">{</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>                <span class="o">**</span><span class="n">solution</span><span class="p">,</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>                <span class="o">**</span><span class="n">params</span><span class="p">,</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>            <span class="p">}</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>        <span class="p">),</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>        <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>    <span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>    <span class="c1"># get the new fiducials from the solution, or, in case some of the old</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>    <span class="c1"># parameters remain, get the values from those instead</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>    <span class="n">new_fiducials</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>        <span class="n">solution</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">solution</span> <span class="k">else</span> <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">new_params_list</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>    <span class="p">]</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>    <span class="n">new_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">new_params_list</span><span class="p">]</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">new_names</span><span class="p">,</span> <span class="n">new_fiducials</span><span class="p">,</span> <span class="n">jacobian_numeric</span><span class="p">)</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="k">def</span> <span class="nf">_parse_sigma</span><span class="p">(</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>    <span class="n">sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>    <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="p">):</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>    <span class="k">if</span> <span class="n">sigma</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>            <span class="s2">&quot;Cannot specify both `p` and `sigma` simultaneously; &quot;</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>            <span class="s2">&quot;please specify at most one of those&quot;</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="p">)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>    <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>                <span class="sa">f</span><span class="s2">&quot;The value of `p` </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2"> is outside of the allowed range (0, 1)&quot;</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>            <span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>        <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">erfinv</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>    <span class="k">elif</span> <span class="n">sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>        <span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>    <span class="k">if</span> <span class="n">sigma</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>            <span class="sa">f</span><span class="s2">&quot;The value of `sigma` </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2"> is outside of the allowed range (0, infinify)&quot;</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>        <span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>    <span class="k">return</span> <span class="n">sigma</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="k">def</span> <span class="nf">_process_fisher_mapping</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Process a mapping/dict and returns the sanitized output.&quot;&quot;&quot;</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>    <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The mapping/dict must contain at least the key `name`&quot;</span><span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>    <span class="n">latex_name</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;latex_name&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>    <span class="n">fiducial</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fiducial&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>        <span class="n">latex_name</span><span class="o">=</span><span class="n">latex_name</span><span class="p">,</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="n">fiducial</span><span class="o">=</span><span class="n">fiducial</span><span class="p">,</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>    <span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a><span class="k">class</span> <span class="nc">FisherMatrix</span><span class="p">:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a><span class="sd">    Class for handling Fisher objects.</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a><span class="sd">    Examples</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a><span class="sd">    --------</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a><span class="sd">    Specify a Fisher object with default names and fiducials:</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]), latex_names=[&#39;$p_1$&#39;, &#39;$p_2$&#39;])</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a><span class="sd">    The object has a friendly representation in the interactive session:</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a><span class="sd">    &gt;&gt;&gt; fm</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a><span class="sd">           [0., 4.]]),</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="sd">        names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a><span class="sd">        latex_names=array([&#39;$p_1$&#39;, &#39;$p_2$&#39;], dtype=object),</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">    In a Jupyter notebook, it looks similar to the below (you can hover over</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="sd">    the $\LaTeX$ label to show the corresponding name and fiducial of that</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">    parameter):</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a><span class="sd">    &lt;table&gt;</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a><span class="sd">    &lt;thead&gt;</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a><span class="sd">    &lt;tr&gt;</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a><span class="sd">    &lt;th&gt;&lt;/th&gt;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a><span class="sd">    &lt;th title=&quot;name = &#39;p1&#39;, fiducial = 0.0&quot;&gt;$p_1$&lt;/th&gt;</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a><span class="sd">    &lt;th title=&quot;name = &#39;p2&#39;, fiducial = 0.0&quot;&gt;$p_2$&lt;/th&gt;</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="sd">    &lt;/tr&gt;</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">    &lt;/thead&gt;</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">    &lt;tbody&gt;</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="sd">    &lt;tr&gt;</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="sd">    &lt;th title=&quot;name = &#39;p1&#39;, fiducial = 0.0&quot;&gt;$p_1$&lt;/th&gt;</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">    &lt;td&gt;5.000&lt;/td&gt;</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">    &lt;td&gt;0.000&lt;/td&gt;</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">    &lt;/tr&gt;</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">    &lt;tr&gt;</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">    &lt;th title=&quot;name = &#39;p2&#39;, fiducial = 0.0&quot;&gt;$p_2$&lt;/th&gt;</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a><span class="sd">    &lt;td&gt;0.000&lt;/td&gt;</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a><span class="sd">    &lt;td&gt;4.000&lt;/td&gt;</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="sd">    &lt;/tr&gt;</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a><span class="sd">    &lt;/tbody&gt;</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a><span class="sd">    &lt;/table&gt;</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a><span class="sd">    List the names:</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="sd">    &gt;&gt;&gt; fm.names</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">    array([&#39;p1&#39;, &#39;p2&#39;], dtype=object)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a><span class="sd">    List the values of the Fisher object:</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="sd">    &gt;&gt;&gt; fm.values</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="sd">    array([[5., 0.],</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">           [0., 4.]])</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">    List the values of the fiducials:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">    &gt;&gt;&gt; fm.fiducials</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">    array([0., 0.])</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">    Names can be changed in bulk (ditto for fiducials and values; dimension</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="sd">    must of course match the original):</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]))</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="sd">    &gt;&gt;&gt; fm.names = [&#39;x&#39;, &#39;y&#39;]</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">    &gt;&gt;&gt; fm.latex_names = [r&#39;$\mathbf{X}$&#39;, r&#39;$\mathbf{Y}$&#39;]</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">    &gt;&gt;&gt; fm</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a><span class="sd">           [0., 4.]]),</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="sd">    We can get and set individual elements of the matrix using dict-like notation:</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]), names=[&#39;x&#39;, &#39;y&#39;])</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">    &gt;&gt;&gt; fm[&#39;x&#39;, &#39;x&#39;]</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a><span class="sd">    5.0</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a><span class="sd">    The off-diagonal elements are automatically updated when using the setter:</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]), names=[&#39;x&#39;, &#39;y&#39;])</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">    &gt;&gt;&gt; fm[&#39;x&#39;, &#39;y&#39;] = -2</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a><span class="sd">    &gt;&gt;&gt; fm</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="sd">        array([[ 5., -2.],</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="sd">           [-2.,  4.]]),</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a><span class="sd">        latex_names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">    We can select submatrices by index:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 3]), names=[&#39;x&#39;, &#39;y&#39;, &#39;z&#39;])</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">    &gt;&gt;&gt; fm[1:]</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">        array([[2., 0.],</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">           [0., 3.]]),</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">        names=array([&#39;y&#39;, &#39;z&#39;], dtype=object),</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">        latex_names=array([&#39;y&#39;, &#39;z&#39;], dtype=object),</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a><span class="sd">    Fisher object with parameter names:</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]),</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a><span class="sd">    ... names=[&#39;x&#39;, &#39;y&#39;], latex_names=[&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;])</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a><span class="sd">    &gt;&gt;&gt; fm_with_names = FisherMatrix(np.diag([1, 2]), names=[&#39;x&#39;, &#39;y&#39;])</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="sd">    We can add Fisher objects (ordering of names is taken care of):</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a><span class="sd">    &gt;&gt;&gt; fm + fm_with_names # doctest: +SKIP</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a><span class="sd">        array([[6., 0.],</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="sd">           [0., 6.]]),</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a><span class="sd">    We can also do element-wise multiplication or division:</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="sd">    &gt;&gt;&gt; fm * fm_with_names</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">           [0., 8.]]),</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a><span class="sd">    Furthermore, we can do matrix multiplication:</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a><span class="sd">    &gt;&gt;&gt; fm @ fm_with_names</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a><span class="sd">           [0., 8.]]),</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a><span class="sd">    We can also perform standard matrix operations like the trace, eigenvalues, determinant:</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a><span class="sd">    &gt;&gt;&gt; fm.trace()</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a><span class="sd">    9.0</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a><span class="sd">    &gt;&gt;&gt; fm.eigenvalues()</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">    array([4., 5.])</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a><span class="sd">    &gt;&gt;&gt; fm.determinant()</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a><span class="sd">    19.999999999999996</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a><span class="sd">    We can also get the inverse (the covariance matrix):</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">    &gt;&gt;&gt; fm.inverse()</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">    array([[0.2 , 0.  ],</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="sd">           [0.  , 0.25]])</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">    We can drop parameters from the object:</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">    &gt;&gt;&gt; fm.drop(&#39;x&#39;)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">        array([[4.]]),</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">        names=array([&#39;y&#39;], dtype=object),</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">        fiducials=array([0.]))</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">    We can save it to a file (the returned value is the dictionary that was saved):</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="sd">    &gt;&gt;&gt; pprint(fm.to_file(&#39;example_matrix.json&#39;), sort_dicts=False) # doctest: +SKIP</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">    {&#39;values&#39;: [[5.0, 0.0], [0.0, 4.0]],</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">     &#39;names&#39;: [&#39;x&#39;, &#39;y&#39;],</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">     &#39;latex_names&#39;: [&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;],</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a><span class="sd">     &#39;fiducials&#39;: [0.0, 0.0]}</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a><span class="sd">    Loading is performed by a class method `from_file`:</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a><span class="sd">    &gt;&gt;&gt; fm_new = FisherMatrix.from_file(&#39;example_matrix.json&#39;) # doctest: +SKIP</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>        <span class="n">values</span><span class="p">,</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>    <span class="p">):</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a><span class="sd">        Create for Fisher object.</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a><span class="sd">        Parameters</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a><span class="sd">        ----------</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a><span class="sd">        values : array_like of float</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a><span class="sd">            The values of the Fisher object.</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a><span class="sd">        names : array_like of str, optional</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a><span class="sd">            The names of the parameters (default: None).</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a><span class="sd">            If not specified, defaults to `p1, ..., pn`.</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a><span class="sd">        latex_names : array_like of str, optional</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a><span class="sd">            The LaTeX names of the parameters (default: None).</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a><span class="sd">            If not specified, defaults to `names`.</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a><span class="sd">        fiducials : array_like of float, optional</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="sd">            The fiducial values of the parameters (default: None). If not</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a><span class="sd">            specified, default to 0 for all parameters.</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a><span class="sd">        Raises</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a><span class="sd">        ------</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a><span class="sd">        ValueError</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="sd">            if the input array has the wrong dimensionality (not 2)</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a><span class="sd">        ValueError</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="sd">            if the object is not square-like</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="sd">            if the sizes of the array of names, values, LaTeX names and</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a><span class="sd">            fiducials do not match</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a><span class="sd">        Examples</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a><span class="sd">        --------</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="sd">        Specify a Fisher object without names:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a><span class="sd">            fiducials=array([0., 0., 0.]))</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a><span class="sd">        Specify a Fisher object with names, LaTeX names, and fiducials:</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([1, 2]), names=[&#39;alpha&#39;, &#39;beta&#39;],</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a><span class="sd">        ... latex_names=[r&#39;$\alpha$&#39;, r&#39;$\beta$&#39;], fiducials=[-3, 2])</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a><span class="sd">            names=array([&#39;alpha&#39;, &#39;beta&#39;], dtype=object),</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a><span class="sd">            latex_names=array([&#39;$\\alpha$&#39;, &#39;$\\beta$&#39;], dtype=object),</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a><span class="sd">            fiducials=array([-3.,  2.]))</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2"> is not 2-dimensional&quot;</span><span class="p">)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2"> is not square-like&quot;</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>        <span class="c1"># try to treat it as an array-like object</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ndim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="c1"># setting the fiducials</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>        <span class="k">if</span> <span class="n">fiducials</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>        <span class="c1"># setting the names</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">make_default_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>            <span class="c1"># check they&#39;re unique</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">names</span><span class="p">)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>        <span class="c1"># setting the pretty names (LaTeX)</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>        <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">)</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latex_names</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>        <span class="c1"># check sizes of inputs</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span><span class="p">)</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>        <span class="p">):</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">,</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span><span class="p">,</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span><span class="p">,</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>            <span class="p">)</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>    <span class="k">def</span> <span class="nf">from_parameters</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="p">):</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a><span class="sd">        Alternative constructor.</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a><span class="sd">        Parameters</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a><span class="sd">        ----------</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a><span class="sd">        values : array_like of float</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a><span class="sd">            the values of the Fisher object</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="sd">        *args : P</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">            the Fisher parameters</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">        Examples</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">        --------</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix.from_parameters(</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">        ... np.diag([1, 2, 3]),</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        ... P(&#39;a&#39;, -1, &#39;$x$&#39;),</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">        ... P(&#39;b&#39;, 0, &#39;$y$&#39;),</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">        ... P(&#39;c&#39;, 1, &#39;$z$&#39;)</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">        ... )</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=object),</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a><span class="sd">            latex_names=array([&#39;$x$&#39;, &#39;$y$&#39;, &#39;$z$&#39;], dtype=object),</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="sd">            fiducials=array([-1.,  0.,  1.]))</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>            <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">fiducial</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">latex_name</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>        <span class="p">)</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>    <span class="nd">@property</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the (multivariate) Gaussian part of the Fisher object.&quot;&quot;&quot;</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>    <span class="nd">@property</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a><span class="sd">        Returns the values in the Fisher object as a numpy array.</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a><span class="sd">        Raises</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a><span class="sd">        ------</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a><span class="sd">            if the new values do not have the same size as the original ones</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a><span class="sd">        ValueError</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a><span class="sd">            if the shape of the new values is not square</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a><span class="sd">        TypeError</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a><span class="sd">            if the new values do not have the same type as the original ones</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a><span class="sd">        Notes</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a><span class="sd">        -----</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a><span class="sd">        Currently returns the same output as `matrix` (subject to change).</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>    <span class="nd">@values</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="n">value</span><span class="p">,</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>    <span class="p">):</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> is not a square object&quot;</span><span class="p">)</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>    <span class="nd">@property</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>    <span class="k">def</span> <span class="nf">fiducials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a><span class="sd">        Returns the fiducial values of the Fisher object as a numpy array.</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a><span class="sd">        Raises</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="sd">        ------</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="sd">            if the new values do not have the same size as the original ones</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="sd">        TypeError</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a><span class="sd">            if the new values do not have the same type as the original ones</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>    <span class="nd">@fiducials</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>    <span class="k">def</span> <span class="nf">fiducials</span><span class="p">(</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>    <span class="p">):</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">value</span><span class="p">])</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>    <span class="nd">@property</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a><span class="sd">        Returns the parameter names of the Fisher object.</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a><span class="sd">        Raises</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a><span class="sd">        ------</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a><span class="sd">            if the new values do not have the same size as the original ones</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>    <span class="nd">@names</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>    <span class="p">):</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>    <span class="nd">@property</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>    <span class="k">def</span> <span class="nf">latex_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a><span class="sd">        Returns the LaTeX names of the parameters of the Fisher object.</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a><span class="sd">        Raises</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a><span class="sd">        ------</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="sd">            if the new values do not have the same size as the original ones</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>    <span class="nd">@latex_names</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>    <span class="k">def</span> <span class="nf">latex_names</span><span class="p">(</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>    <span class="p">):</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">]],</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a><span class="sd">        Return a Fisher object with new names. This is primarily useful for renaming individual parameters.</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">        Parameters</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="sd">        ----------</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">        names : dict-like</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">            a mapping (dictionary-like object) between the old names and the</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">            new ones. The values it maps to can either be a string (the new</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="sd">            name), or a dict with keys `name`, `latex_name`, and `fiducial`</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">            (only `name` is mandatory).</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a><span class="sd">        ignore_errors : bool, optional</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a><span class="sd">            if set to True, will not raise an error if a parameter doesn&#39;t</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">            exist (default: False)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a><span class="sd">        Returns</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="sd">        -------</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">        FisherMatrix</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a><span class="sd">            the Fisher object with new names</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a><span class="sd">        Examples</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a><span class="sd">        --------</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a><span class="sd">        &gt;&gt;&gt; m.rename({&#39;p1&#39; : &#39;a&#39;, &#39;p2&#39; : dict(name=&#39;b&#39;, latex_name=&#39;$b$&#39;, fiducial=2)})</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;$b$&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="sd">            fiducials=array([0., 2., 0.]))</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_errors</span><span class="p">:</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>                    <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>        <span class="n">names_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>        <span class="n">latex_names_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>        <span class="n">fiducial_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">names_new</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>            <span class="c1"># it&#39;s a mapping</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">_process_fisher_mapping</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>                <span class="n">latex_names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;latex_name&quot;</span><span class="p">]</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>                <span class="n">fiducial_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;fiducial&quot;</span><span class="p">]</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>                <span class="n">names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>            <span class="c1"># otherwise, it&#39;s a string</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>                <span class="n">names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>                <span class="n">latex_names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names_new</span><span class="p">,</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names_new</span><span class="p">,</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducial_new</span><span class="p">,</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>        <span class="p">)</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Representation of the Fisher object suitable for viewing in Jupyter notebook environments.&quot;&quot;&quot;</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>        <span class="n">header_matrix</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>            <span class="s2">&quot;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&quot;</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>            <span class="o">+</span> <span class="p">(</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>                <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>                    <span class="p">[</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>                        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;th title=&quot;name = &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, fiducial = </span><span class="si">{</span><span class="n">fiducial</span><span class="si">}</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">latex_name</span><span class="si">}</span><span class="s2">&lt;/th&gt;&quot;&quot;&quot;</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>                        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">fiducial</span><span class="p">,</span> <span class="n">latex_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>                        <span class="p">)</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>                    <span class="p">]</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>                <span class="p">)</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>            <span class="p">)</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>            <span class="o">+</span> <span class="s2">&quot;&lt;/tr&gt;&lt;/thead&gt;&quot;</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>        <span class="p">)</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>        <span class="n">body_matrix</span> <span class="o">=</span> <span class="s2">&quot;&lt;tbody&gt;&quot;</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">fiducial</span><span class="p">,</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">latex_name</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">),</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>        <span class="p">):</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>            <span class="n">body_matrix</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;tr&gt;&lt;th title=&quot;name = &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, fiducial = </span><span class="si">{</span><span class="n">fiducial</span><span class="si">}</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">latex_name</span><span class="si">}</span><span class="s2">&lt;/th&gt;&quot;&quot;&quot;</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>                <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;&lt;td&gt;</span><span class="si">{:.3f}</span><span class="s2">&lt;/td&gt;&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]))</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>                <span class="o">+</span> <span class="s2">&quot;&lt;/tr&gt;&quot;</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>            <span class="p">)</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="n">body_matrix</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/tbody&gt;&quot;</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>        <span class="n">html_matrix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;table&gt;</span><span class="si">{</span><span class="n">header_matrix</span><span class="si">}{</span><span class="n">body_matrix</span><span class="si">}</span><span class="s2">&lt;/table&gt;&quot;</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>        <span class="k">return</span> <span class="n">html_matrix</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Representation of the Fisher object for non-Jupyter interfaces.&quot;&quot;&quot;</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>            <span class="s2">&quot;FisherMatrix(</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>            <span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>            <span class="sa">f</span><span class="s2">&quot;    names=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>            <span class="sa">f</span><span class="s2">&quot;    latex_names=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>            <span class="sa">f</span><span class="s2">&quot;    fiducials=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>        <span class="p">)</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Representation of the Fisher object as a string.&quot;&quot;&quot;</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>            <span class="s2">&quot;FisherMatrix(</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>            <span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>            <span class="sa">f</span><span class="s2">&quot;    names=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>            <span class="sa">f</span><span class="s2">&quot;    latex_names=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>            <span class="sa">f</span><span class="s2">&quot;    fiducials=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>        <span class="p">)</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="sd">        Iterate over the Fisher object.</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a><span class="sd">        Raises</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">        ------</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">        NotImplementedError</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">            always raised as iteration should be performed using `__getitem__`</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">            instead</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>            <span class="sa">f</span><span class="s2">&quot;Object of type `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">` is not iterable; &quot;</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>            <span class="s2">&quot;use `&lt;object&gt;[&lt;key&gt;]` to get or set elements of the object instead&quot;</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>        <span class="p">)</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>        <span class="n">keys</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">slice</span><span class="p">],</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>    <span class="p">):</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a><span class="sd">        Implement access to elements in the Fisher object.</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a><span class="sd">        Notes</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a><span class="sd">        -----</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="sd">        Has support for slicing.</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>        <span class="c1"># the object can be sliced</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>            <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">),)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>            <span class="n">sl</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>                <span class="n">values</span><span class="p">,</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>                <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>            <span class="p">)</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>        <span class="c1"># the keys can be a tuple</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> arguments, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>            <span class="c1"># error checking</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>                    <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>        <span class="c1"># otherwise, it&#39;s some generic object</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>            <span class="k">if</span> <span class="n">keys</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>                <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">keys</span><span class="p">),)</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">indices</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>        <span class="n">keys</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>        <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>    <span class="p">):</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">        Implement setting of elements in the Fisher object.</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">        Raises</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">        ------</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a><span class="sd">        TypeError</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a><span class="sd">            if keys are not a tuple, or if `value` is not a number</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a><span class="sd">            if the size of keys are not equal to the dimensionality of the</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="sd">            Fisher object</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="sd">            if any of the keys is not in the parameter names</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a><span class="sd">        Notes</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a><span class="sd">        -----</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="sd">        Does not support slicing.</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>        <span class="c1"># the above fails for strings (since they are iterable), so we do an</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>        <span class="c1"># explicit check here</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> is not a number&quot;</span><span class="p">)</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>                <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>        <span class="c1"># automatically raises a value error</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>        <span class="n">temp_data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">):</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>            <span class="k">for</span> <span class="n">permutation</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">permutations</span><span class="p">(</span><span class="n">indices</span><span class="p">)):</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>                <span class="c1"># update all symmetric parts</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>                <span class="n">temp_data</span><span class="p">[</span><span class="n">permutation</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>            <span class="n">temp_data</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>    <span class="k">def</span> <span class="nf">fiducial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a><span class="sd">        Return the value of the fiducial associated to the parameter `name`.</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a><span class="sd">        Parameters</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="sd">        ----------</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="sd">        name : str</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="sd">            the name of the parameter</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">        Raises</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">        ------</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a><span class="sd">        Examples</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">        --------</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], fiducials=[2, 3])</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="sd">        Get the value of the fiducial associated to parameter `b`:</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a><span class="sd">        &gt;&gt;&gt; fm.fiducial(&#39;b&#39;)</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a><span class="sd">        3.0</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>    <span class="k">def</span> <span class="nf">set_fiducial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">        Set the fiducial of parameter `name`.</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="sd">        Parameters</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="sd">        ----------</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">        name : str</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a><span class="sd">            the name of the parameter</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a><span class="sd">        value : float</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a><span class="sd">            the new fiducial value of the parameter</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">        Raises</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a><span class="sd">        ------</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">        Examples</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a><span class="sd">        --------</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], fiducials=[2, 3])</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="sd">        Set the value of the fiducial associated to parameter `b`:</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">        &gt;&gt;&gt; fm.set_fiducial(&#39;b&#39;, 4)</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="sd">        &gt;&gt;&gt; fm</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">            fiducials=array([2., 4.]))</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>    <span class="k">def</span> <span class="nf">latex_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a><span class="sd">        Return the LaTeX name associated to the parameter `name`.</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a><span class="sd">        Parameters</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="sd">        ----------</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="sd">        name : str</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="sd">            the name of the parameter</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="sd">        Raises</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a><span class="sd">        ------</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a><span class="sd">        Examples</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">        --------</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], latex_names=[r&#39;$\mathbf{A}$&#39;, r&#39;$\mathbf{B}$&#39;])</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a><span class="sd">        Get the LaTeX name associated to parameter `b`:</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">        &gt;&gt;&gt; fm.latex_name(&#39;b&#39;)</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a><span class="sd">        &#39;$\\mathbf{B}$&#39;</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>    <span class="k">def</span> <span class="nf">set_latex_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">        Set the LaTeX name of parameter `name`.</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a><span class="sd">        Parameters</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a><span class="sd">        ----------</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="sd">        name : str</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a><span class="sd">            the name of the parameter</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="sd">        value : str</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">            the new LaTeX name of the parameter</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="sd">        Raises</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="sd">        ------</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">        Examples</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a><span class="sd">        --------</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], fiducials=[2, 3])</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">        Set the value of the fiducial associated to parameter `b`:</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">        &gt;&gt;&gt; fm.set_latex_name(&#39;b&#39;, r&#39;$\mathcal{B}$&#39;)</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">        &gt;&gt;&gt; fm</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;$\\mathcal{B}$&#39;], dtype=object),</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">            fiducials=array([2., 3.]))</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a><span class="sd">        Check whether the values make a valid Fisher object.</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a><span class="sd">        A (square) matrix is a Fisher matrix if it satisifies the following two</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a><span class="sd">        criteria:</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="sd">        * it is symmetric</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a><span class="sd">        * it is positive semi-definite</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">        Returns</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a><span class="sd">        -------</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">        bool</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">            Whether or nor the Fisher object is valid.</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a><span class="sd">        Examples</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">        --------</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a><span class="sd">        &gt;&gt;&gt; m.is_valid()</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">        True</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([-1, 3])).is_valid()</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a><span class="sd">        False</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>        <span class="k">return</span> <span class="n">is_symmetric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_positive_semidefinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a><span class="sd">        Sort the Fisher object by name according to some criterion.</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a><span class="sd">        Parameters</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a><span class="sd">        ----------</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a><span class="sd">        **kwargs</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a><span class="sd">            all of the other keyword arguments for the Python builtin &lt;a</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a><span class="sd">            href=&quot;https://docs.python.org/3/library/functions.html#sorted&quot;</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a><span class="sd">            target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;`sorted`&lt;/a&gt;.</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a><span class="sd">            If none are specified, will sort according to the names of the parameters.</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a><span class="sd">            In the special case that the value of the keyword `key` is set to</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a><span class="sd">            either `&#39;fiducials&#39;` or `&#39;latex_names&#39;`, it will sort according to those.</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a><span class="sd">            In the second special case that the value of the keyword `key` is</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a><span class="sd">            set to an array of integers of equal size as the Fisher object, sorts them</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a><span class="sd">            according to those instead.</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a><span class="sd">            In the third (and final) special case that the value of the keyword</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a><span class="sd">            `key` is set to an array strings matching those of parameter names</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a><span class="sd">            of the FisherMatrix, the items are sorted according to those</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="sd">            values.</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">        Returns</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a><span class="sd">        -------</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="sd">        FisherMatrix</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a><span class="sd">            the Fisher object with sorted names</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">        Raises</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="sd">        ------</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="sd">        ValueError</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="sd">            if `key` does not match the names of the Fisher object</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a><span class="sd">        TypeError</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a><span class="sd">            if `key` is not a callable</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a><span class="sd">        Examples</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a><span class="sd">        --------</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a><span class="sd">        Define a Fisher matrix:</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([3, 1, 2]), names=list(&#39;sdf&#39;),</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a><span class="sd">        ... latex_names=[&#39;hjkl&#39;, &#39;qwe&#39;, &#39;ll&#39;], fiducials=[8, 7, 3])</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="sd">        Sort according to values of the fiducials:</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a><span class="sd">        &gt;&gt;&gt; m.sort(key=&#39;fiducials&#39;)</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">            array([[2., 0., 0.],</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="sd">               [0., 1., 0.],</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">            names=array([&#39;f&#39;, &#39;d&#39;, &#39;s&#39;], dtype=object),</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">            latex_names=array([&#39;ll&#39;, &#39;qwe&#39;, &#39;hjkl&#39;], dtype=object),</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a><span class="sd">            fiducials=array([3., 7., 8.]))</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a><span class="sd">        Sort according to the LaTeX names (alphabetically):</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="sd">        &gt;&gt;&gt; m.sort(key=&#39;latex_names&#39;)</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a><span class="sd">            array([[3., 0., 0.],</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a><span class="sd">               [0., 0., 1.]]),</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a><span class="sd">            names=array([&#39;s&#39;, &#39;f&#39;, &#39;d&#39;], dtype=object),</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a><span class="sd">            latex_names=array([&#39;hjkl&#39;, &#39;ll&#39;, &#39;qwe&#39;], dtype=object),</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a><span class="sd">            fiducials=array([8., 3., 7.]))</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="n">allowed_keys</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;fiducials&quot;</span><span class="p">,</span> <span class="s2">&quot;latex_names&quot;</span><span class="p">)</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>        <span class="c1"># something that can be passed to `sorted`</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;key&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])):</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>        <span class="c1"># an integer index</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>            <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>            <span class="ow">and</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>            <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="s2">&quot;__index__&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>        <span class="p">):</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>        <span class="c1"># either &#39;fiducials&#39; or &#39;latex_names&#39;</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>        <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>            <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>            <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">allowed_keys</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>        <span class="p">):</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]))</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>            <span class="k">if</span> <span class="s2">&quot;reversed&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>                <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>        <span class="c1"># the names themselves, in any order</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>        <span class="k">elif</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]):</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>                    <span class="sa">f</span><span class="s2">&quot;The object &#39;</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; appears to be an iterable, &quot;</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>                    <span class="sa">f</span><span class="s2">&quot;but does not contain all of the names in the Fisher object (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">); &quot;</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>                    <span class="s2">&quot;if you meant to sort by the names, make sure they are all in the passed array!&quot;</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>                <span class="p">)</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>        <span class="c1"># something else should throw an error</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>        <span class="k">elif</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>                <span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> is not a callable, a list of names, &quot;</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>                <span class="sa">f</span><span class="s2">&quot;or one of </span><span class="si">{</span><span class="n">allowed_keys</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>            <span class="p">)</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>        <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">reindex_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>        <span class="p">)</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">        Compare Fisher object with another object.</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a><span class="sd">        Returns `True` if the operands have the following properties:</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a><span class="sd">        * are instances of FisherMatrix</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a><span class="sd">        * have same names (potentially shuffled)</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a><span class="sd">        * have same dimensionality</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a><span class="sd">        * have same fiducials (potentially shuffled)</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a><span class="sd">        * have same values (potentially shuffled)</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>        <span class="c1"># index for re-shuffling parameters</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">ndim</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>            <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>            <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>                <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>            <span class="p">)</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>            <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>                <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">),</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>            <span class="p">)</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>        <span class="p">)</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>    <span class="nd">@property</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of dimensions of the Fisher object (for now always 2).&quot;&quot;&quot;</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of parameters in the Fisher object.&quot;&quot;&quot;</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>    <span class="k">def</span> <span class="nf">is_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a><span class="sd">        Check whether the Fisher matrix is diagonal.</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a><span class="sd">        Returns</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a><span class="sd">        -------</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a><span class="sd">        bool</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>    <span class="k">def</span> <span class="nf">diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">        Return the diagonal elements of the Fisher object as a numpy array.</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="sd">        Returns</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">        -------</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">        array_like : float</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">            The diagonal elements as a numpy array.</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a><span class="sd">        Remove parameters from the Fisher object.</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">        Parameters</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a><span class="sd">        ----------</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a><span class="sd">        names : str</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a><span class="sd">            the names of the parameters to drop.</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a><span class="sd">            If passing a list or a tuple, make sure to unpack it using the</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a><span class="sd">            asterisk (*).</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a><span class="sd">        invert : bool, optional</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a><span class="sd">            whether to drop all the parameters NOT in names (the complement)</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a><span class="sd">            (default: False)</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a><span class="sd">        ignore_errors : bool, optional</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a><span class="sd">            should non-existing parameters be ignored (default: False)</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a><span class="sd">        Returns</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a><span class="sd">        -------</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a><span class="sd">        FisherMatrix</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a><span class="sd">            the Fisher object with removed names</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a><span class="sd">        Examples</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a><span class="sd">        --------</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a><span class="sd">        Drop `p1` and `p3`:</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a><span class="sd">        &gt;&gt;&gt; m.drop(&#39;p1&#39;, &#39;p3&#39;)</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a><span class="sd">            array([[2.]]),</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a><span class="sd">            names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a><span class="sd">            latex_names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a><span class="sd">            fiducials=array([0.]))</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a><span class="sd">        Same result, but note the asterisk (`*`):</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a><span class="sd">        &gt;&gt;&gt; m.drop(*[&#39;p1&#39;, &#39;p3&#39;])</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a><span class="sd">            array([[2.]]),</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a><span class="sd">            names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="sd">            latex_names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a><span class="sd">            fiducials=array([0.]))</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a><span class="sd">        Drop everything *except* `p1` and `p3`:</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="sd">        &gt;&gt;&gt; m.drop(&#39;p1&#39;, &#39;p3&#39;, invert=True)</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">               [0., 3.]]),</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)):</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>                <span class="sa">f</span><span class="s2">&quot;The names (</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">) are not a strict subset &quot;</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>                <span class="sa">f</span><span class="s2">&quot;of the parameter names in the Fisher object (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">); &quot;</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>                <span class="s2">&quot;you can pass `ignore_errors=True` to ignore this error&quot;</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>            <span class="p">)</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>        <span class="k">if</span> <span class="n">ignore_errors</span><span class="p">:</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">]))</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>        <span class="k">if</span> <span class="n">invert</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">^</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to remove all parameters&quot;</span><span class="p">)</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>                <span class="n">values</span><span class="p">,</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>                <span class="n">index</span><span class="p">,</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>                <span class="n">axis</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>            <span class="p">)</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>        <span class="n">latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>        <span class="p">)</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>    <span class="p">):</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the trace of the Fisher object as a numpy array.&quot;&quot;&quot;</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>    <span class="k">def</span> <span class="nf">eigenvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the eigenvalues of the Fisher object as a numpy array.&quot;&quot;&quot;</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>    <span class="k">def</span> <span class="nf">eigenvectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the right eigenvectors of the Fisher object as a numpy array.&quot;&quot;&quot;</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>    <span class="k">def</span> <span class="nf">condition_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a><span class="sd">        Return the condition number of the matrix with respect to the $L^2$ norm.</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a><span class="sd">        Examples</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a><span class="sd">        --------</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a><span class="sd">        &gt;&gt;&gt; fm.condition_number()</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a><span class="sd">        3.0</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">())</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_pinv</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a><span class="sd">        Return the inverse of the Fisher matrix.</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a><span class="sd">        Parameters</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a><span class="sd">        ----------</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a><span class="sd">        use_pinv : bool, optional</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a><span class="sd">            use the Moore-Penrose pseudoinverse (default: False). Can be useful</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a><span class="sd">            if the Fisher matrix is weakly singular. Use with caution!</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a><span class="sd">        Raises</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a><span class="sd">        ------</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a><span class="sd">        LinAlgError</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a><span class="sd">            if the Fisher matrix is singular</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a><span class="sd">        Returns</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a><span class="sd">        -------</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a><span class="sd">        array_like : float</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a><span class="sd">            the covariance matrix as a numpy array</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a><span class="sd">        Examples</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a><span class="sd">        --------</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 5]))</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a><span class="sd">        &gt;&gt;&gt; fm.inverse()</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a><span class="sd">        array([[1. , 0. , 0. ],</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a><span class="sd">               [0. , 0.5, 0. ],</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a><span class="sd">               [0. , 0. , 0.2]])</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>        <span class="k">if</span> <span class="n">use_pinv</span><span class="p">:</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">hermitian</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>    <span class="k">def</span> <span class="nf">determinant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a><span class="sd">        Return the determinant of the matrix.</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a><span class="sd">        Returns</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a><span class="sd">        -------</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">        float</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>    <span class="k">def</span> <span class="nf">constraints</span><span class="p">(</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>        <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>        <span class="n">marginalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>        <span class="n">sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a>        <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a>    <span class="p">):</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">        Compute the constraints on parameters.</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">        Parameters</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">        ----------</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a><span class="sd">        name : str, optional</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a><span class="sd">            the name of the parameter for which we we want the constraints</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a><span class="sd">            (default: None)</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a><span class="sd">        marginalized : bool, optional</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a><span class="sd">            whether we want the marginalized or the unmarginalized</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a><span class="sd">            constraints (default: True).</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a><span class="sd">        sigma : float, optional</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a><span class="sd">            how many sigmas away (default: 1).</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a><span class="sd">        p : float, optional</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="sd">            the confidence interval (p-value) (default: None).</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="sd">        **kwargs</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a><span class="sd">            any kwargs passed to `inverse`</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a><span class="sd">        Returns</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a><span class="sd">        -------</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a><span class="sd">        float or array_like of float</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a><span class="sd">        Notes</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a><span class="sd">        -----</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a><span class="sd">        The user should specify either `sigma` or `p`, but not both</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a><span class="sd">        simultaneously.</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a><span class="sd">        If neither are specified, defaults to `sigma=1`.</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a><span class="sd">        The relationship between `p` and `sigma` is defined via:</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a><span class="sd">        $$</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a><span class="sd">            p(\sigma) = \int\limits_{\mu - \sigma}^{\mu + \sigma}</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a><span class="sd">                        f(x, \mu, 1)\, \mathrm{d}x</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a><span class="sd">                      = \mathrm{Erf}(\sigma / \sqrt{2})</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a><span class="sd">        $$</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a><span class="sd">        and therefore the inverse is simply:</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a><span class="sd">        $$</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a><span class="sd">            \sigma(p) = \sqrt{2}\, \mathrm{Erf}^{-1}(p)</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a><span class="sd">        $$</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a><span class="sd">        The values of `p` corresponding to 1, 2, 3 `sigma` are roughly</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a><span class="sd">        0.683, 0.954, and 0.997, respectively.</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a><span class="sd">        Examples</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a><span class="sd">        --------</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a><span class="sd">        Get (marginalized by default) constraints for all parameters:</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix([[3, -2], [-2, 5]])</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a><span class="sd">        &gt;&gt;&gt; m.constraints()</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a><span class="sd">        array([0.67419986, 0.52223297])</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a><span class="sd">        Get the unmarginalized constraints instead:</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(marginalized=False)</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a><span class="sd">        array([0.57735027, 0.4472136 ])</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a><span class="sd">        Get the unmarginalized constraints for a single parameter:</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(&#39;p1&#39;, marginalized=False)</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a><span class="sd">        array([0.57735027])</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a><span class="sd">        Get the marginalized constraints for a single parameter:</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(&#39;p1&#39;, p=0.682689) # p-value roughly equal to 1 sigma</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a><span class="sd">        array([0.67419918])</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>        <span class="n">sigma</span> <span class="o">=</span> <span class="n">_parse_sigma</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>        <span class="k">if</span> <span class="n">marginalized</span><span class="p">:</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>            <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>                <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>            <span class="p">)</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">inv</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">*</span> <span class="n">sigma</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">*</span> <span class="n">sigma</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>                <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)]</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a><span class="sd">        Return the result of adding two Fisher objects.</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a><span class="sd">        Notes</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a><span class="sd">        -----</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a><span class="sd">        We can add or subtract Fisher objects which have different parameter</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a><span class="sd">        names.</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a><span class="sd">        Due to the peculiarities of Python&#39;s `set` built-in, the ordering of</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a><span class="sd">        names in the result is not guaranteed to be preserved, even for</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a><span class="sd">        identical inputs. This is not a problem though, since `__eq__` can</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a><span class="sd">        handle parameter shuffling, so if `m1` and `m2` are instances of</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a><span class="sd">        `FisherMatrix`, `m1 + m2 == m1 + m2` will always yield `True`.</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a>                <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">))]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>                <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a>            <span class="p">)</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>                <span class="n">fiducial1</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a>                    <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a>                <span class="p">)</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>                <span class="n">fiducial2</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a>                    <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>                    <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>                <span class="p">)</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>                <span class="n">latex_name1</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>                    <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>                <span class="p">)</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>                <span class="n">latex_name2</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>                    <span class="n">other</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>                    <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>                <span class="p">)</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>                    <span class="n">fiducial1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>                    <span class="ow">and</span> <span class="n">fiducial2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a>                    <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducial1</span><span class="p">,</span> <span class="n">fiducial2</span><span class="p">)</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>                <span class="p">):</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>                    <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a>                        <span class="s2">&quot;fiducial values&quot;</span><span class="p">,</span> <span class="n">fiducial1</span><span class="p">,</span> <span class="n">fiducial2</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>                    <span class="p">)</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>                <span class="n">fiducials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fiducial1</span> <span class="k">if</span> <span class="n">fiducial1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fiducial2</span><span class="p">)</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>                <span class="n">latex_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>                    <span class="n">latex_name1</span> <span class="k">if</span> <span class="n">latex_name1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">latex_name2</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>                <span class="p">)</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>            <span class="c1"># TODO make this work for arbitrary number of dimensions</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">index1</span><span class="p">,</span> <span class="n">name1</span><span class="p">),</span> <span class="p">(</span><span class="n">index2</span><span class="p">,</span> <span class="n">name2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>                <span class="c1"># case 1: the names are in both</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>                    <span class="n">name1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>                    <span class="ow">and</span> <span class="n">name2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>                    <span class="ow">and</span> <span class="n">name1</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>                    <span class="ow">and</span> <span class="n">name2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>                <span class="p">):</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a>                    <span class="n">values</span><span class="p">[</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span> <span class="o">+</span> <span class="n">other</span><span class="p">[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>                <span class="c1"># case 2a: the names are in the left one only</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a>                <span class="k">elif</span> <span class="n">name1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="ow">and</span> <span class="n">name2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>                    <span class="n">values</span><span class="p">[</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a>                <span class="c1"># case 2b: the names are in the right one only</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>                <span class="k">elif</span> <span class="n">name1</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span> <span class="ow">and</span> <span class="n">name2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>                    <span class="n">values</span><span class="p">[</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>                <span class="c1"># case 3: one name is in one, but not the other</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>                    <span class="n">values</span><span class="p">[</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">other</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a>        <span class="p">)</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a>    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Addition when the Fisher object is the right operand.&quot;&quot;&quot;</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the negation of the Fisher object.&quot;&quot;&quot;</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>            <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a>        <span class="p">)</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the result of subtracting two Fisher objects.&quot;&quot;&quot;</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Subtraction when the Fisher object is the right operand.&quot;&quot;&quot;</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>        <span class="c1"># this will never be called if we subtract two FisherMatrix instances,</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>        <span class="c1"># so we just need to handle floats</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>    <span class="k">def</span> <span class="nf">__array_ufunc__</span><span class="p">(</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>        <span class="n">ufunc</span><span class="p">,</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a>        <span class="n">method</span><span class="p">,</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>        <span class="o">*</span><span class="n">inputs</span><span class="p">,</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a>    <span class="p">):</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a><span class="sd">        Handle numpy&#39;s universal functions.</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a><span class="sd">        Notes</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a><span class="sd">        -----</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a><span class="sd">        For a complete list and explanation, see:</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a><span class="sd">        https://numpy.org/doc/stable/reference/ufuncs.html</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;__call__&quot;</span><span class="p">:</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>            <span class="n">scalars</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>                    <span class="n">scalars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>                    <span class="n">scalars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>                    <span class="k">return</span> <span class="bp">NotImplemented</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">names</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">inputs</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)]</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]):</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mismatching names&quot;</span><span class="p">)</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>            <span class="c1"># make sure the names have the same _ordering_</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>                    <span class="n">scalars</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">_</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a>                        <span class="n">key</span><span class="o">=</span><span class="n">get_index_of_other_array</span><span class="p">(</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a>                            <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a>                            <span class="n">_</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a>                        <span class="p">)</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>                <span class="n">ufunc</span><span class="p">(</span><span class="o">*</span><span class="n">scalars</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a>                <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>            <span class="p">)</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>        <span class="k">return</span> <span class="bp">NotImplemented</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Raise the Fisher object to some power.&quot;&quot;&quot;</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>        <span class="p">)</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a>    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a>    <span class="p">):</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Matrix-multiply two Fisher objects.&quot;&quot;&quot;</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a>        <span class="c1"># make sure they have the right parameters</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a>            <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a>        <span class="c1"># make sure the fiducials match</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">):</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a>            <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;fiducial value&quot;</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">@</span> <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a>        <span class="p">)</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a>    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FisherMatrix</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the result of dividing a Fisher object by a number, or another Fisher object (element-wise).&quot;&quot;&quot;</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a>        <span class="c1"># we can only divide two objects if they have the same dimensions and sizes</span>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a>            <span class="c1"># maybe it&#39;s a FisherMatrix</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a>            <span class="c1"># make sure they have the right parameters</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a>            <span class="c1"># make sure the fiducials match</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">):</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a>                    <span class="s2">&quot;fiducial value&quot;</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a>                <span class="p">)</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a>            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a>                <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">other</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a>        <span class="p">)</span>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a>    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FisherMatrix</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the result of multiplying a Fisher object by a number, or another Fisher object (element-wise).&quot;&quot;&quot;</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a>        <span class="c1"># we can only multiply two objects if they have the same dimensions and sizes</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a>            <span class="c1"># maybe it&#39;s a FisherMatrix</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a>            <span class="c1"># make sure they have the right parameters</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a>            <span class="c1"># make sure the fiducials match</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">):</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a>                    <span class="s2">&quot;fiducial value&quot;</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a>                <span class="p">)</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a>            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a>                <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">other</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a>        <span class="p">)</span>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a>    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FisherMatrix</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the result of multiplying a number by a Fisher object, or another Fisher object (element-wise).&quot;&quot;&quot;</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a>    <span class="k">def</span> <span class="nf">reparametrize_symbolic</span><span class="p">(</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>        <span class="n">transformation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a><span class="sd">        Perform a symbolic transformation of the Fisher object.</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a><span class="sd">        Parameters</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a><span class="sd">        ----------</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a><span class="sd">        transformation : mapping</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a><span class="sd">            a mapping between the old and new parameters (or new and old ones)</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a><span class="sd">        latex_names : mapping, optional</span>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a><span class="sd">            a dictionary with the names of new parameters as keys, and LaTeX</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a><span class="sd">            names of new parameters as values (default: None). If not</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a><span class="sd">            specified, uses the names extracted from `transformation`.</span>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a><span class="sd">        **kwargs</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a><span class="sd">            any optional keyword arguments passed to the solver for obtaining</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a><span class="sd">            the new fiducials. Available arguments:</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a><span class="sd">            - `solution_index`, int: in case of multiple solutions, one can select</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a><span class="sd">              the index of the solution (default: None, meaning the first</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a><span class="sd">              element is selected)</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a><span class="sd">            - `initial_guess`, dict: in case of using the numerical solver,</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a><span class="sd">              this should be a dictionary of the initial guesses for the new</span>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a><span class="sd">              fiducials (default: None, and the initial guess is set to all</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a><span class="sd">              ones)</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a><span class="sd">        Returns</span>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a><span class="sd">        -------</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a><span class="sd">        FisherMatrix</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a><span class="sd">            The new Fisher object with the specified names, LaTeX names, and</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a><span class="sd">            fiducials.</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a><span class="sd">        Raises</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a><span class="sd">        ------</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a><span class="sd">            if any of the keys in the mapping is not in the names of the Fisher</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a><span class="sd">            matrix</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a><span class="sd">        SympifyError</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a><span class="sd">            if any of the expressions in the values cannot be transformed using</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a><span class="sd">            &lt;a</span>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a><span class="sd">            href=&quot;https://docs.sympy.org/latest/modules/core.html#module-sympy.core.sympify&quot;</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a><span class="sd">            target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;`sympy.sympify`&lt;/a&gt;</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a><span class="sd">        ValueError</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a><span class="sd">            if SymPy is is unable to find a solution for the new fiducials</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a><span class="sd">        TypeError</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a><span class="sd">            if SymPy is unable to find a real solution for the new fiducials</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a><span class="sd">        ValueError</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a><span class="sd">            if any of the old parameters is on both sides of the mapping</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a><span class="sd">        ValueError</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a><span class="sd">            if the number of new parameters is different from the number of old</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a><span class="sd">            parameters</span>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a><span class="sd">        Warns</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a><span class="sd">        -----</span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a><span class="sd">        UserWarning</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a><span class="sd">            if the SymPy solver returns multiple solutions for the values of</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a><span class="sd">            the new fiducials</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a><span class="sd">        See Also</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a><span class="sd">        --------</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a><span class="sd">        `reparametrize` : the numerical version of this method</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a><span class="sd">        Examples</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a><span class="sd">        --------</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a><span class="sd">        ... np.diag([1, 2, 3]),</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a><span class="sd">        ... names=[&quot;omega_m&quot;, &quot;omega_b&quot;, &quot;h&quot;],</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a><span class="sd">        ... fiducials=[0.147, 0.025, 0.7],</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a><span class="sd">        ... )</span>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a><span class="sd">        Reparametrize it:</span>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a><span class="sd">        &gt;&gt;&gt; fm.reparametrize_symbolic(</span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a><span class="sd">        ... {&#39;omega_m&#39; : &#39;Omega_m * h**2&#39;, &#39;omega_b&#39; : &#39;Omega_b * h**2&#39;}</span>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a><span class="sd">        ... ).sort(key=[&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;])</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a><span class="sd">            array([[0.2401    , 0.        , 0.2058    ],</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a><span class="sd">               [0.        , 0.4802    , 0.07      ],</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a><span class="sd">               [0.2058    , 0.07      , 3.18660408]]),</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a><span class="sd">            names=array([&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;], dtype=object),</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a><span class="sd">            latex_names=array([&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;], dtype=object),</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a><span class="sd">            fiducials=array([0.3       , 0.05102041, 0.7       ]))</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a>        <span class="c1"># check that the keys of the dictionary are present in the names</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">transformation</span><span class="p">:</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a>                <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a>        <span class="c1"># check that we can &quot;sympify&quot; all of the expressions</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a>        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">transformation</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a>                <span class="n">sympy</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a>            <span class="k">except</span> <span class="n">sympy</span><span class="o">.</span><span class="n">SympifyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a>                <span class="k">raise</span> <span class="n">sympy</span><span class="o">.</span><span class="n">SympifyError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a>        <span class="c1"># get the new names, fiducials, and the Jacobian</span>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a>        <span class="n">names_new</span><span class="p">,</span> <span class="n">fiducials_new</span><span class="p">,</span> <span class="n">jacobian</span> <span class="o">=</span> <span class="n">_jacobian</span><span class="p">(</span>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)),</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>            <span class="n">transformation</span><span class="p">,</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a>        <span class="p">)</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a>        <span class="c1"># set the new LaTeX names from the old ones (if they&#39;re still present),</span>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a>        <span class="c1"># otherwise use the new names</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a>        <span class="n">latex_names_new</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latex_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="k">else</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">names_new</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a>        <span class="p">]</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a>        <span class="c1"># in case any of the new names are specified, set them</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a>        <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a>            <span class="n">latex_names_new</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a>                <span class="n">latex_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">latex_names</span> <span class="k">else</span> <span class="n">key</span>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">latex_names_new</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a>            <span class="p">]</span>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reparametrize</span><span class="p">(</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a>            <span class="n">jacobian</span><span class="p">,</span>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names_new</span><span class="p">,</span>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials_new</span><span class="p">,</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names_new</span><span class="p">,</span>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a>        <span class="p">)</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>    <span class="k">def</span> <span class="nf">reparametrize</span><span class="p">(</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a>        <span class="n">jacobian</span><span class="p">,</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a>        <span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a><span class="sd">        Perform a numerical transformation of the Fisher object using a Jacobian.</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a><span class="sd">        Parameters</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a><span class="sd">        ----------</span>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a><span class="sd">        transformation : array_like of float</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a><span class="sd">            the Jacobian of the transformation</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a><span class="sd">        names : array_like of str, optional</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a><span class="sd">            list of new names for the Fisher object (default: None). If None,</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a><span class="sd">            uses the old names.</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a><span class="sd">        latex_names: array_like of str, optional</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a><span class="sd">            list of new LaTeX names for the Fisher object (default: None). If</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a><span class="sd">            None, and `names` is set, uses those instead, otherwise uses the</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a><span class="sd">            old LaTeX names.</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a><span class="sd">        fiducials : array_like of float, optional</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a><span class="sd">            the new values of the fiducials (default: None). If None, defaults</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a><span class="sd">            to the old values of the fiducials.</span>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a><span class="sd">        Returns</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a><span class="sd">        -------</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a><span class="sd">        FisherMatrix</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a><span class="sd">            The new Fisher object with the specified names, LaTeX names, and</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a><span class="sd">            fiducials.</span>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a><span class="sd">        See Also</span>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a><span class="sd">        --------</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a><span class="sd">        `reparametrize_symbolic` : the symbolic version of this method</span>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a><span class="sd">        Notes</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a><span class="sd">        -----</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a><span class="sd">        See the &lt;a</span>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a><span class="sd">        href=&quot;https://en.wikipedia.org/w/index.php?title=Fisher_information&amp;oldid=1063384000#Reparametrization&quot;</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a><span class="sd">        target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Wikipedia article&lt;/a&gt; for</span>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a><span class="sd">        more information.</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a><span class="sd">        Examples</span>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a><span class="sd">        --------</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]))</span>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a><span class="sd">        &gt;&gt;&gt; fm</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a><span class="sd">        Define a Jacobian:</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a><span class="sd">        &gt;&gt;&gt; jac = [[1, 4], [3, 2]]</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a><span class="sd">        Reparametrize according to that Jacobian:</span>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a><span class="sd">        &gt;&gt;&gt; fm.reparametrize(jac, names=[&#39;a&#39;, &#39;b&#39;])</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a><span class="sd">            array([[19., 16.],</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a><span class="sd">               [16., 24.]]),</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">@</span> <span class="n">jacobian</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a>        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a>            <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">latex_names</span><span class="p">))</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a>                    <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a>                <span class="n">latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a>            <span class="c1"># we don&#39;t transform the names</span>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a>        <span class="k">if</span> <span class="n">fiducials</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fiducials</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a>        <span class="p">)</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the Fisher object as a dictionary.&quot;&quot;&quot;</span>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a>        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a>            <span class="n">values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a>        <span class="p">)</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a>        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a>        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a><span class="sd">        Save the Fisher object to a file (UTF-8 encoded).</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a><span class="sd">        Parameters</span>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a><span class="sd">        ----------</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a><span class="sd">        path : str or Path</span>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a><span class="sd">            the path to save the data to.</span>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a><span class="sd">        metadata : dict, optional</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a><span class="sd">            any metadata that should be associated to the object saved, in the</span>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a><span class="sd">            form of a dictionary-like object</span>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a><span class="sd">        Returns</span>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a><span class="sd">        -------</span>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a><span class="sd">        dict</span>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a><span class="sd">            the dictionary that was saved</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a><span class="sd">        Notes</span>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a><span class="sd">        -----</span>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a><span class="sd">        The format used is a simple JSON file, containing at least the values of the</span>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a><span class="sd">        Fisher object, the names of the parameters, the LaTeX names, and the</span>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a><span class="sd">        fiducial values.</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a><span class="sd">        Examples</span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a><span class="sd">        --------</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a><span class="sd">        &gt;&gt;&gt; from pprint import pprint</span>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], latex_names=[r&#39;$\mathbf{A}$&#39;, r&#39;$\mathbf{B}$&#39;])</span>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a><span class="sd">        &gt;&gt;&gt; pprint(fm.to_file(&#39;example_matrix.json&#39;), sort_dicts=False) # doctest: +SKIP</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a><span class="sd">        {&#39;values&#39;: array([[1., 0.],</span>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a><span class="sd">         &#39;names&#39;: array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a><span class="sd">         &#39;latex_names&#39;: array([&#39;$\\mathbf{A}$&#39;, &#39;$\\mathbf{B}$&#39;], dtype=object),</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a><span class="sd">         &#39;fiducials&#39;: array([0., 0.])}</span>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a><span class="sd">        There is also a convenience function for reading it:</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a><span class="sd">        &gt;&gt;&gt; fm_read = FisherMatrix.from_file(&#39;example_matrix.json&#39;) # doctest: +SKIP</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a><span class="sd">        Verify it&#39;s the same object:</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a><span class="sd">        &gt;&gt;&gt; fm == fm_read # doctest: +SKIP</span>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a><span class="sd">        True</span>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a>        <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a>                <span class="o">**</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a>                <span class="o">**</span><span class="p">{</span><span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">},</span>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a>            <span class="p">}</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a>            <span class="n">file_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">FisherEncoder</span><span class="p">))</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a>        <span class="k">return</span> <span class="n">data</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a>    <span class="k">def</span> <span class="nf">marginalize_over</span><span class="p">(</span>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a>        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a><span class="sd">        Perform marginalization over some parameters.</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a><span class="sd">        Parameters</span>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a><span class="sd">        ----------</span>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a><span class="sd">        names : str</span>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a><span class="sd">            the names of the parameters to marginalize over</span>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a><span class="sd">        invert : bool, optional</span>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a><span class="sd">            whether to marginalize over all the parameters NOT in names (the complement) (default: False)</span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a><span class="sd">        ignore_errors : bool, optional</span>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a><span class="sd">            should non-existing parameters be ignored (default: False)</span>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a><span class="sd">        **kwargs</span>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a><span class="sd">            any kwargs passed to `inverse`</span>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a><span class="sd">        Returns</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a><span class="sd">        -------</span>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a><span class="sd">        FisherMatrix</span>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a><span class="sd">            The Fisher object with the specified parameters marginalized over.</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a><span class="sd">        Examples</span>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos">2156</span></a><span class="sd">        --------</span>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos">2157</span></a><span class="sd">        Generate a Fisher object using a random orthogonal matrix:</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos">2158</span></a><span class="sd">        &gt;&gt;&gt; rm = np.array([[-0.0942819 ,  0.56164959,  0.7638867 ,  0.18138749, -0.24338518],</span>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos">2159</span></a><span class="sd">        ... [ 0.22058622,  0.74746891, -0.33297073, -0.47219083,  0.24248352],</span>
</span><span id="L-2160"><a href="#L-2160"><span class="linenos">2160</span></a><span class="sd">        ... [-0.23923712,  0.18017836, -0.44325216,  0.05300493, -0.84321964],</span>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos">2161</span></a><span class="sd">        ... [-0.25595188,  0.30540004, -0.32672895,  0.77839888,  0.35855659],</span>
</span><span id="L-2162"><a href="#L-2162"><span class="linenos">2162</span></a><span class="sd">        ... [ 0.90537665,  0.0103218 , -0.04881925,  0.36799464, -0.20587183]])</span>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos">2163</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(rm.T @ np.diag([1, 2, 3, 7, 6]) @ rm)</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos">2164</span></a>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos">2165</span></a><span class="sd">        Marginalize over some parameters:</span>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos">2166</span></a><span class="sd">        &gt;&gt;&gt; fm.marginalize_over(&#39;p1&#39;, &#39;p2&#39;)</span>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos">2167</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos">2168</span></a><span class="sd">            array([[ 1.67715593, -1.01556087,  0.30020774],</span>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos">2169</span></a><span class="sd">               [-1.01556087,  4.92788973,  0.91219829],</span>
</span><span id="L-2170"><a href="#L-2170"><span class="linenos">2170</span></a><span class="sd">               [ 0.30020774,  0.91219829,  3.1796454 ]]),</span>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos">2171</span></a><span class="sd">            names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos">2172</span></a><span class="sd">            latex_names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos">2173</span></a><span class="sd">            fiducials=array([0., 0., 0.]))</span>
</span><span id="L-2174"><a href="#L-2174"><span class="linenos">2174</span></a>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos">2175</span></a><span class="sd">        Marginalize over all parameters which are NOT `p1` or `p2`:</span>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos">2176</span></a><span class="sd">        &gt;&gt;&gt; fm.marginalize_over(&#39;p1&#39;, &#39;p2&#39;, invert=True)</span>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos">2177</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos">2178</span></a><span class="sd">            array([[ 5.04480061, -0.04490451],</span>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos">2179</span></a><span class="sd">               [-0.04490451,  1.61599083]]),</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos">2180</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos">2181</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos">2182</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos">2183</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos">2184</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos">2185</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos">2186</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-2187"><a href="#L-2187"><span class="linenos">2187</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos">2188</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-2189"><a href="#L-2189"><span class="linenos">2189</span></a>        <span class="p">)</span>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos">2190</span></a>        <span class="k">if</span> <span class="n">invert</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos">2191</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">^</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos">2192</span></a>        <span class="n">fisher</span> <span class="o">=</span> <span class="n">inv</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="n">ignore_errors</span><span class="p">)</span>
</span><span id="L-2193"><a href="#L-2193"><span class="linenos">2193</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-2194"><a href="#L-2194"><span class="linenos">2194</span></a>            <span class="n">fisher</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="L-2195"><a href="#L-2195"><span class="linenos">2195</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-2196"><a href="#L-2196"><span class="linenos">2196</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="L-2197"><a href="#L-2197"><span class="linenos">2197</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="L-2198"><a href="#L-2198"><span class="linenos">2198</span></a>        <span class="p">)</span>
</span><span id="L-2199"><a href="#L-2199"><span class="linenos">2199</span></a>
</span><span id="L-2200"><a href="#L-2200"><span class="linenos">2200</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-2201"><a href="#L-2201"><span class="linenos">2201</span></a>    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
</span><span id="L-2202"><a href="#L-2202"><span class="linenos">2202</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-2203"><a href="#L-2203"><span class="linenos">2203</span></a>        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
</span><span id="L-2204"><a href="#L-2204"><span class="linenos">2204</span></a>    <span class="p">):</span>
</span><span id="L-2205"><a href="#L-2205"><span class="linenos">2205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2206"><a href="#L-2206"><span class="linenos">2206</span></a><span class="sd">        Read a Fisher object from a file.</span>
</span><span id="L-2207"><a href="#L-2207"><span class="linenos">2207</span></a>
</span><span id="L-2208"><a href="#L-2208"><span class="linenos">2208</span></a><span class="sd">        Parameters</span>
</span><span id="L-2209"><a href="#L-2209"><span class="linenos">2209</span></a><span class="sd">        ----------</span>
</span><span id="L-2210"><a href="#L-2210"><span class="linenos">2210</span></a><span class="sd">        path : str or Path</span>
</span><span id="L-2211"><a href="#L-2211"><span class="linenos">2211</span></a><span class="sd">            the path to the file</span>
</span><span id="L-2212"><a href="#L-2212"><span class="linenos">2212</span></a>
</span><span id="L-2213"><a href="#L-2213"><span class="linenos">2213</span></a><span class="sd">        Returns</span>
</span><span id="L-2214"><a href="#L-2214"><span class="linenos">2214</span></a><span class="sd">        -------</span>
</span><span id="L-2215"><a href="#L-2215"><span class="linenos">2215</span></a><span class="sd">        FisherMatrix</span>
</span><span id="L-2216"><a href="#L-2216"><span class="linenos">2216</span></a>
</span><span id="L-2217"><a href="#L-2217"><span class="linenos">2217</span></a><span class="sd">        Notes</span>
</span><span id="L-2218"><a href="#L-2218"><span class="linenos">2218</span></a><span class="sd">        -----</span>
</span><span id="L-2219"><a href="#L-2219"><span class="linenos">2219</span></a><span class="sd">        Any metadata is ignored when reading the file.</span>
</span><span id="L-2220"><a href="#L-2220"><span class="linenos">2220</span></a><span class="sd">        If you want to read the metadata as well, use something like the following:</span>
</span><span id="L-2221"><a href="#L-2221"><span class="linenos">2221</span></a>
</span><span id="L-2222"><a href="#L-2222"><span class="linenos">2222</span></a><span class="sd">        &gt;&gt;&gt; import json</span>
</span><span id="L-2223"><a href="#L-2223"><span class="linenos">2223</span></a><span class="sd">        &gt;&gt;&gt; with open(&lt;filename&gt;, &#39;r&#39;) as f: # doctest: +SKIP</span>
</span><span id="L-2224"><a href="#L-2224"><span class="linenos">2224</span></a><span class="sd">        ...     data = json.loads(f.read()) # doctest: +SKIP</span>
</span><span id="L-2225"><a href="#L-2225"><span class="linenos">2225</span></a>
</span><span id="L-2226"><a href="#L-2226"><span class="linenos">2226</span></a><span class="sd">        Then `data` will contain a dictionary with all of the data from the</span>
</span><span id="L-2227"><a href="#L-2227"><span class="linenos">2227</span></a><span class="sd">        file, which can be easily parsed.</span>
</span><span id="L-2228"><a href="#L-2228"><span class="linenos">2228</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2229"><a href="#L-2229"><span class="linenos">2229</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
</span><span id="L-2230"><a href="#L-2230"><span class="linenos">2230</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file_handle</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="L-2231"><a href="#L-2231"><span class="linenos">2231</span></a>
</span><span id="L-2232"><a href="#L-2232"><span class="linenos">2232</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-2233"><a href="#L-2233"><span class="linenos">2233</span></a>
</span><span id="L-2234"><a href="#L-2234"><span class="linenos">2234</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-2235"><a href="#L-2235"><span class="linenos">2235</span></a>    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span>
</span><span id="L-2236"><a href="#L-2236"><span class="linenos">2236</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-2237"><a href="#L-2237"><span class="linenos">2237</span></a>        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="L-2238"><a href="#L-2238"><span class="linenos">2238</span></a>    <span class="p">):</span>
</span><span id="L-2239"><a href="#L-2239"><span class="linenos">2239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2240"><a href="#L-2240"><span class="linenos">2240</span></a><span class="sd">        Read a Fisher object from a dictionary.</span>
</span><span id="L-2241"><a href="#L-2241"><span class="linenos">2241</span></a>
</span><span id="L-2242"><a href="#L-2242"><span class="linenos">2242</span></a><span class="sd">        Parameters</span>
</span><span id="L-2243"><a href="#L-2243"><span class="linenos">2243</span></a><span class="sd">        ----------</span>
</span><span id="L-2244"><a href="#L-2244"><span class="linenos">2244</span></a><span class="sd">        data</span>
</span><span id="L-2245"><a href="#L-2245"><span class="linenos">2245</span></a><span class="sd">            the dictionary</span>
</span><span id="L-2246"><a href="#L-2246"><span class="linenos">2246</span></a>
</span><span id="L-2247"><a href="#L-2247"><span class="linenos">2247</span></a><span class="sd">        Raises</span>
</span><span id="L-2248"><a href="#L-2248"><span class="linenos">2248</span></a><span class="sd">        ------</span>
</span><span id="L-2249"><a href="#L-2249"><span class="linenos">2249</span></a><span class="sd">        KeyError</span>
</span><span id="L-2250"><a href="#L-2250"><span class="linenos">2250</span></a><span class="sd">            if the dictionary contains malformed data</span>
</span><span id="L-2251"><a href="#L-2251"><span class="linenos">2251</span></a>
</span><span id="L-2252"><a href="#L-2252"><span class="linenos">2252</span></a><span class="sd">        Returns</span>
</span><span id="L-2253"><a href="#L-2253"><span class="linenos">2253</span></a><span class="sd">        -------</span>
</span><span id="L-2254"><a href="#L-2254"><span class="linenos">2254</span></a><span class="sd">        FisherMatrix</span>
</span><span id="L-2255"><a href="#L-2255"><span class="linenos">2255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2256"><a href="#L-2256"><span class="linenos">2256</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="L-2257"><a href="#L-2257"><span class="linenos">2257</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">],</span>
</span><span id="L-2258"><a href="#L-2258"><span class="linenos">2258</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">],</span>
</span><span id="L-2259"><a href="#L-2259"><span class="linenos">2259</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;latex_names&quot;</span><span class="p">],</span>
</span><span id="L-2260"><a href="#L-2260"><span class="linenos">2260</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fiducials&quot;</span><span class="p">],</span>
</span><span id="L-2261"><a href="#L-2261"><span class="linenos">2261</span></a>        <span class="p">)</span>
</span><span id="L-2262"><a href="#L-2262"><span class="linenos">2262</span></a>
</span><span id="L-2263"><a href="#L-2263"><span class="linenos">2263</span></a>    <span class="k">def</span> <span class="nf">correlation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-2264"><a href="#L-2264"><span class="linenos">2264</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2265"><a href="#L-2265"><span class="linenos">2265</span></a><span class="sd">        Compute the correlation matrix from the Fisher matrix.</span>
</span><span id="L-2266"><a href="#L-2266"><span class="linenos">2266</span></a>
</span><span id="L-2267"><a href="#L-2267"><span class="linenos">2267</span></a><span class="sd">        Parameters</span>
</span><span id="L-2268"><a href="#L-2268"><span class="linenos">2268</span></a><span class="sd">        ----------</span>
</span><span id="L-2269"><a href="#L-2269"><span class="linenos">2269</span></a><span class="sd">        **kwargs</span>
</span><span id="L-2270"><a href="#L-2270"><span class="linenos">2270</span></a><span class="sd">            any kwargs passed to `inverse`</span>
</span><span id="L-2271"><a href="#L-2271"><span class="linenos">2271</span></a>
</span><span id="L-2272"><a href="#L-2272"><span class="linenos">2272</span></a><span class="sd">        Returns</span>
</span><span id="L-2273"><a href="#L-2273"><span class="linenos">2273</span></a><span class="sd">        -------</span>
</span><span id="L-2274"><a href="#L-2274"><span class="linenos">2274</span></a><span class="sd">        array_like : float</span>
</span><span id="L-2275"><a href="#L-2275"><span class="linenos">2275</span></a><span class="sd">            the correlation matrix as a numpy array</span>
</span><span id="L-2276"><a href="#L-2276"><span class="linenos">2276</span></a>
</span><span id="L-2277"><a href="#L-2277"><span class="linenos">2277</span></a><span class="sd">        Notes</span>
</span><span id="L-2278"><a href="#L-2278"><span class="linenos">2278</span></a><span class="sd">        -----</span>
</span><span id="L-2279"><a href="#L-2279"><span class="linenos">2279</span></a><span class="sd">        The entries of the output matrix are given by:</span>
</span><span id="L-2280"><a href="#L-2280"><span class="linenos">2280</span></a><span class="sd">        $$</span>
</span><span id="L-2281"><a href="#L-2281"><span class="linenos">2281</span></a><span class="sd">            \mathsf{P}_{ij} \equiv \frac{\mathsf{C}_{ij}}{\sqrt{\mathsf{C}_{ii} \mathsf{C}_{jj}}}</span>
</span><span id="L-2282"><a href="#L-2282"><span class="linenos">2282</span></a><span class="sd">        $$</span>
</span><span id="L-2283"><a href="#L-2283"><span class="linenos">2283</span></a><span class="sd">        where $\mathsf{C}_{ij}$ is the $(i, j)$ element of the covariance</span>
</span><span id="L-2284"><a href="#L-2284"><span class="linenos">2284</span></a><span class="sd">        matrix (the inverse of the Fisher matrix).</span>
</span><span id="L-2285"><a href="#L-2285"><span class="linenos">2285</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2286"><a href="#L-2286"><span class="linenos">2286</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-2287"><a href="#L-2287"><span class="linenos">2287</span></a>        <span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>
</span><span id="L-2288"><a href="#L-2288"><span class="linenos">2288</span></a>
</span><span id="L-2289"><a href="#L-2289"><span class="linenos">2289</span></a>        <span class="k">return</span> <span class="n">inv</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="n">diag</span><span class="p">))</span>
</span><span id="L-2290"><a href="#L-2290"><span class="linenos">2290</span></a>
</span><span id="L-2291"><a href="#L-2291"><span class="linenos">2291</span></a>    <span class="k">def</span> <span class="nf">correlation_coefficient</span><span class="p">(</span>
</span><span id="L-2292"><a href="#L-2292"><span class="linenos">2292</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2293"><a href="#L-2293"><span class="linenos">2293</span></a>        <span class="n">name1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-2294"><a href="#L-2294"><span class="linenos">2294</span></a>        <span class="n">name2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-2295"><a href="#L-2295"><span class="linenos">2295</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-2296"><a href="#L-2296"><span class="linenos">2296</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2297"><a href="#L-2297"><span class="linenos">2297</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2298"><a href="#L-2298"><span class="linenos">2298</span></a><span class="sd">        Return the correlation coefficient between two parameters.</span>
</span><span id="L-2299"><a href="#L-2299"><span class="linenos">2299</span></a>
</span><span id="L-2300"><a href="#L-2300"><span class="linenos">2300</span></a><span class="sd">        Parameters</span>
</span><span id="L-2301"><a href="#L-2301"><span class="linenos">2301</span></a><span class="sd">        ----------</span>
</span><span id="L-2302"><a href="#L-2302"><span class="linenos">2302</span></a><span class="sd">        name1 : str</span>
</span><span id="L-2303"><a href="#L-2303"><span class="linenos">2303</span></a><span class="sd">            the name of the first parameter</span>
</span><span id="L-2304"><a href="#L-2304"><span class="linenos">2304</span></a>
</span><span id="L-2305"><a href="#L-2305"><span class="linenos">2305</span></a><span class="sd">        name2 : str</span>
</span><span id="L-2306"><a href="#L-2306"><span class="linenos">2306</span></a><span class="sd">            the name of the second parameter</span>
</span><span id="L-2307"><a href="#L-2307"><span class="linenos">2307</span></a>
</span><span id="L-2308"><a href="#L-2308"><span class="linenos">2308</span></a><span class="sd">        **kwargs</span>
</span><span id="L-2309"><a href="#L-2309"><span class="linenos">2309</span></a><span class="sd">            any kwargs passed to `correlation_matrix`</span>
</span><span id="L-2310"><a href="#L-2310"><span class="linenos">2310</span></a>
</span><span id="L-2311"><a href="#L-2311"><span class="linenos">2311</span></a><span class="sd">        Returns</span>
</span><span id="L-2312"><a href="#L-2312"><span class="linenos">2312</span></a><span class="sd">        -------</span>
</span><span id="L-2313"><a href="#L-2313"><span class="linenos">2313</span></a><span class="sd">        float</span>
</span><span id="L-2314"><a href="#L-2314"><span class="linenos">2314</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2315"><a href="#L-2315"><span class="linenos">2315</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="L-2316"><a href="#L-2316"><span class="linenos">2316</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">correlation_matrix</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="L-2317"><a href="#L-2317"><span class="linenos">2317</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="L-2318"><a href="#L-2318"><span class="linenos">2318</span></a>        <span class="p">)[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span>
</span><span id="L-2319"><a href="#L-2319"><span class="linenos">2319</span></a>
</span><span id="L-2320"><a href="#L-2320"><span class="linenos">2320</span></a>    <span class="k">def</span> <span class="nf">figure_of_merit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2321"><a href="#L-2321"><span class="linenos">2321</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2322"><a href="#L-2322"><span class="linenos">2322</span></a><span class="sd">        Compute the figure of merit (FoM).</span>
</span><span id="L-2323"><a href="#L-2323"><span class="linenos">2323</span></a>
</span><span id="L-2324"><a href="#L-2324"><span class="linenos">2324</span></a><span class="sd">        Returns</span>
</span><span id="L-2325"><a href="#L-2325"><span class="linenos">2325</span></a><span class="sd">        -------</span>
</span><span id="L-2326"><a href="#L-2326"><span class="linenos">2326</span></a><span class="sd">        float</span>
</span><span id="L-2327"><a href="#L-2327"><span class="linenos">2327</span></a>
</span><span id="L-2328"><a href="#L-2328"><span class="linenos">2328</span></a><span class="sd">        Notes</span>
</span><span id="L-2329"><a href="#L-2329"><span class="linenos">2329</span></a><span class="sd">        -----</span>
</span><span id="L-2330"><a href="#L-2330"><span class="linenos">2330</span></a><span class="sd">        The figure of merit is computed as:</span>
</span><span id="L-2331"><a href="#L-2331"><span class="linenos">2331</span></a><span class="sd">        $$</span>
</span><span id="L-2332"><a href="#L-2332"><span class="linenos">2332</span></a><span class="sd">            \mathrm{FoM} \equiv \frac{1}{2} \log \left[ \det \mathsf{F} \right]</span>
</span><span id="L-2333"><a href="#L-2333"><span class="linenos">2333</span></a><span class="sd">        $$</span>
</span><span id="L-2334"><a href="#L-2334"><span class="linenos">2334</span></a><span class="sd">        where $\mathsf{F}$ denotes the Fisher matrix.</span>
</span><span id="L-2335"><a href="#L-2335"><span class="linenos">2335</span></a>
</span><span id="L-2336"><a href="#L-2336"><span class="linenos">2336</span></a><span class="sd">        Some authors define the FoM (also sometimes called the signal-to-noise,</span>
</span><span id="L-2337"><a href="#L-2337"><span class="linenos">2337</span></a><span class="sd">        $\mathrm{SNR}$) as:</span>
</span><span id="L-2338"><a href="#L-2338"><span class="linenos">2338</span></a><span class="sd">        $$</span>
</span><span id="L-2339"><a href="#L-2339"><span class="linenos">2339</span></a><span class="sd">            \mathrm{SNR} = \sqrt{\det \mathsf{F}}</span>
</span><span id="L-2340"><a href="#L-2340"><span class="linenos">2340</span></a><span class="sd">        $$</span>
</span><span id="L-2341"><a href="#L-2341"><span class="linenos">2341</span></a><span class="sd">        The two are related by a simple transformation:</span>
</span><span id="L-2342"><a href="#L-2342"><span class="linenos">2342</span></a><span class="sd">        $$</span>
</span><span id="L-2343"><a href="#L-2343"><span class="linenos">2343</span></a><span class="sd">            \mathrm{SNR} = \exp{\left( \mathrm{FoM} \right)}</span>
</span><span id="L-2344"><a href="#L-2344"><span class="linenos">2344</span></a><span class="sd">        $$</span>
</span><span id="L-2345"><a href="#L-2345"><span class="linenos">2345</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2346"><a href="#L-2346"><span class="linenos">2346</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="L-2347"><a href="#L-2347"><span class="linenos">2347</span></a>
</span><span id="L-2348"><a href="#L-2348"><span class="linenos">2348</span></a>    <span class="k">def</span> <span class="nf">figure_of_correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-2349"><a href="#L-2349"><span class="linenos">2349</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2350"><a href="#L-2350"><span class="linenos">2350</span></a><span class="sd">        Compute the figure of correlation (FoC).</span>
</span><span id="L-2351"><a href="#L-2351"><span class="linenos">2351</span></a>
</span><span id="L-2352"><a href="#L-2352"><span class="linenos">2352</span></a><span class="sd">        Parameters</span>
</span><span id="L-2353"><a href="#L-2353"><span class="linenos">2353</span></a><span class="sd">        ----------</span>
</span><span id="L-2354"><a href="#L-2354"><span class="linenos">2354</span></a><span class="sd">        **kwargs</span>
</span><span id="L-2355"><a href="#L-2355"><span class="linenos">2355</span></a><span class="sd">            any kwargs passed to `correlation_matrix`</span>
</span><span id="L-2356"><a href="#L-2356"><span class="linenos">2356</span></a>
</span><span id="L-2357"><a href="#L-2357"><span class="linenos">2357</span></a><span class="sd">        Returns</span>
</span><span id="L-2358"><a href="#L-2358"><span class="linenos">2358</span></a><span class="sd">        -------</span>
</span><span id="L-2359"><a href="#L-2359"><span class="linenos">2359</span></a><span class="sd">        float</span>
</span><span id="L-2360"><a href="#L-2360"><span class="linenos">2360</span></a>
</span><span id="L-2361"><a href="#L-2361"><span class="linenos">2361</span></a><span class="sd">        See Also</span>
</span><span id="L-2362"><a href="#L-2362"><span class="linenos">2362</span></a><span class="sd">        --------</span>
</span><span id="L-2363"><a href="#L-2363"><span class="linenos">2363</span></a><span class="sd">        `correlation_matrix` : compute the correlation matrix</span>
</span><span id="L-2364"><a href="#L-2364"><span class="linenos">2364</span></a>
</span><span id="L-2365"><a href="#L-2365"><span class="linenos">2365</span></a><span class="sd">        Notes</span>
</span><span id="L-2366"><a href="#L-2366"><span class="linenos">2366</span></a><span class="sd">        -----</span>
</span><span id="L-2367"><a href="#L-2367"><span class="linenos">2367</span></a><span class="sd">        The output is computed as:</span>
</span><span id="L-2368"><a href="#L-2368"><span class="linenos">2368</span></a><span class="sd">        $$</span>
</span><span id="L-2369"><a href="#L-2369"><span class="linenos">2369</span></a><span class="sd">            \mathrm{FoC} \equiv - \frac{1}{2} \log \left[ \det \mathsf{P} \right]</span>
</span><span id="L-2370"><a href="#L-2370"><span class="linenos">2370</span></a><span class="sd">        $$</span>
</span><span id="L-2371"><a href="#L-2371"><span class="linenos">2371</span></a><span class="sd">        where $\mathsf{P}$ denotes the correlation matrix.</span>
</span><span id="L-2372"><a href="#L-2372"><span class="linenos">2372</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2373"><a href="#L-2373"><span class="linenos">2373</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correlation_matrix</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
</span></pre></div>


            </section>
                <section id="FisherMatrix">
                            <input id="FisherMatrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FisherMatrix</span>:

                <label class="view-source-button" for="FisherMatrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix-285"><a href="#FisherMatrix-285"><span class="linenos"> 285</span></a><span class="k">class</span> <span class="nc">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-286"><a href="#FisherMatrix-286"><span class="linenos"> 286</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-287"><a href="#FisherMatrix-287"><span class="linenos"> 287</span></a><span class="sd">    Class for handling Fisher objects.</span>
</span><span id="FisherMatrix-288"><a href="#FisherMatrix-288"><span class="linenos"> 288</span></a>
</span><span id="FisherMatrix-289"><a href="#FisherMatrix-289"><span class="linenos"> 289</span></a><span class="sd">    Examples</span>
</span><span id="FisherMatrix-290"><a href="#FisherMatrix-290"><span class="linenos"> 290</span></a><span class="sd">    --------</span>
</span><span id="FisherMatrix-291"><a href="#FisherMatrix-291"><span class="linenos"> 291</span></a><span class="sd">    Specify a Fisher object with default names and fiducials:</span>
</span><span id="FisherMatrix-292"><a href="#FisherMatrix-292"><span class="linenos"> 292</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]), latex_names=[&#39;$p_1$&#39;, &#39;$p_2$&#39;])</span>
</span><span id="FisherMatrix-293"><a href="#FisherMatrix-293"><span class="linenos"> 293</span></a>
</span><span id="FisherMatrix-294"><a href="#FisherMatrix-294"><span class="linenos"> 294</span></a><span class="sd">    The object has a friendly representation in the interactive session:</span>
</span><span id="FisherMatrix-295"><a href="#FisherMatrix-295"><span class="linenos"> 295</span></a><span class="sd">    &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix-296"><a href="#FisherMatrix-296"><span class="linenos"> 296</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-297"><a href="#FisherMatrix-297"><span class="linenos"> 297</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="FisherMatrix-298"><a href="#FisherMatrix-298"><span class="linenos"> 298</span></a><span class="sd">           [0., 4.]]),</span>
</span><span id="FisherMatrix-299"><a href="#FisherMatrix-299"><span class="linenos"> 299</span></a><span class="sd">        names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-300"><a href="#FisherMatrix-300"><span class="linenos"> 300</span></a><span class="sd">        latex_names=array([&#39;$p_1$&#39;, &#39;$p_2$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-301"><a href="#FisherMatrix-301"><span class="linenos"> 301</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-302"><a href="#FisherMatrix-302"><span class="linenos"> 302</span></a>
</span><span id="FisherMatrix-303"><a href="#FisherMatrix-303"><span class="linenos"> 303</span></a><span class="sd">    In a Jupyter notebook, it looks similar to the below (you can hover over</span>
</span><span id="FisherMatrix-304"><a href="#FisherMatrix-304"><span class="linenos"> 304</span></a><span class="sd">    the $\LaTeX$ label to show the corresponding name and fiducial of that</span>
</span><span id="FisherMatrix-305"><a href="#FisherMatrix-305"><span class="linenos"> 305</span></a><span class="sd">    parameter):</span>
</span><span id="FisherMatrix-306"><a href="#FisherMatrix-306"><span class="linenos"> 306</span></a>
</span><span id="FisherMatrix-307"><a href="#FisherMatrix-307"><span class="linenos"> 307</span></a><span class="sd">    &lt;table&gt;</span>
</span><span id="FisherMatrix-308"><a href="#FisherMatrix-308"><span class="linenos"> 308</span></a><span class="sd">    &lt;thead&gt;</span>
</span><span id="FisherMatrix-309"><a href="#FisherMatrix-309"><span class="linenos"> 309</span></a><span class="sd">    &lt;tr&gt;</span>
</span><span id="FisherMatrix-310"><a href="#FisherMatrix-310"><span class="linenos"> 310</span></a><span class="sd">    &lt;th&gt;&lt;/th&gt;</span>
</span><span id="FisherMatrix-311"><a href="#FisherMatrix-311"><span class="linenos"> 311</span></a><span class="sd">    &lt;th title=&quot;name = &#39;p1&#39;, fiducial = 0.0&quot;&gt;$p_1$&lt;/th&gt;</span>
</span><span id="FisherMatrix-312"><a href="#FisherMatrix-312"><span class="linenos"> 312</span></a><span class="sd">    &lt;th title=&quot;name = &#39;p2&#39;, fiducial = 0.0&quot;&gt;$p_2$&lt;/th&gt;</span>
</span><span id="FisherMatrix-313"><a href="#FisherMatrix-313"><span class="linenos"> 313</span></a><span class="sd">    &lt;/tr&gt;</span>
</span><span id="FisherMatrix-314"><a href="#FisherMatrix-314"><span class="linenos"> 314</span></a><span class="sd">    &lt;/thead&gt;</span>
</span><span id="FisherMatrix-315"><a href="#FisherMatrix-315"><span class="linenos"> 315</span></a><span class="sd">    &lt;tbody&gt;</span>
</span><span id="FisherMatrix-316"><a href="#FisherMatrix-316"><span class="linenos"> 316</span></a><span class="sd">    &lt;tr&gt;</span>
</span><span id="FisherMatrix-317"><a href="#FisherMatrix-317"><span class="linenos"> 317</span></a><span class="sd">    &lt;th title=&quot;name = &#39;p1&#39;, fiducial = 0.0&quot;&gt;$p_1$&lt;/th&gt;</span>
</span><span id="FisherMatrix-318"><a href="#FisherMatrix-318"><span class="linenos"> 318</span></a><span class="sd">    &lt;td&gt;5.000&lt;/td&gt;</span>
</span><span id="FisherMatrix-319"><a href="#FisherMatrix-319"><span class="linenos"> 319</span></a><span class="sd">    &lt;td&gt;0.000&lt;/td&gt;</span>
</span><span id="FisherMatrix-320"><a href="#FisherMatrix-320"><span class="linenos"> 320</span></a><span class="sd">    &lt;/tr&gt;</span>
</span><span id="FisherMatrix-321"><a href="#FisherMatrix-321"><span class="linenos"> 321</span></a><span class="sd">    &lt;tr&gt;</span>
</span><span id="FisherMatrix-322"><a href="#FisherMatrix-322"><span class="linenos"> 322</span></a><span class="sd">    &lt;th title=&quot;name = &#39;p2&#39;, fiducial = 0.0&quot;&gt;$p_2$&lt;/th&gt;</span>
</span><span id="FisherMatrix-323"><a href="#FisherMatrix-323"><span class="linenos"> 323</span></a><span class="sd">    &lt;td&gt;0.000&lt;/td&gt;</span>
</span><span id="FisherMatrix-324"><a href="#FisherMatrix-324"><span class="linenos"> 324</span></a><span class="sd">    &lt;td&gt;4.000&lt;/td&gt;</span>
</span><span id="FisherMatrix-325"><a href="#FisherMatrix-325"><span class="linenos"> 325</span></a><span class="sd">    &lt;/tr&gt;</span>
</span><span id="FisherMatrix-326"><a href="#FisherMatrix-326"><span class="linenos"> 326</span></a><span class="sd">    &lt;/tbody&gt;</span>
</span><span id="FisherMatrix-327"><a href="#FisherMatrix-327"><span class="linenos"> 327</span></a><span class="sd">    &lt;/table&gt;</span>
</span><span id="FisherMatrix-328"><a href="#FisherMatrix-328"><span class="linenos"> 328</span></a>
</span><span id="FisherMatrix-329"><a href="#FisherMatrix-329"><span class="linenos"> 329</span></a><span class="sd">    List the names:</span>
</span><span id="FisherMatrix-330"><a href="#FisherMatrix-330"><span class="linenos"> 330</span></a><span class="sd">    &gt;&gt;&gt; fm.names</span>
</span><span id="FisherMatrix-331"><a href="#FisherMatrix-331"><span class="linenos"> 331</span></a><span class="sd">    array([&#39;p1&#39;, &#39;p2&#39;], dtype=object)</span>
</span><span id="FisherMatrix-332"><a href="#FisherMatrix-332"><span class="linenos"> 332</span></a>
</span><span id="FisherMatrix-333"><a href="#FisherMatrix-333"><span class="linenos"> 333</span></a><span class="sd">    List the values of the Fisher object:</span>
</span><span id="FisherMatrix-334"><a href="#FisherMatrix-334"><span class="linenos"> 334</span></a><span class="sd">    &gt;&gt;&gt; fm.values</span>
</span><span id="FisherMatrix-335"><a href="#FisherMatrix-335"><span class="linenos"> 335</span></a><span class="sd">    array([[5., 0.],</span>
</span><span id="FisherMatrix-336"><a href="#FisherMatrix-336"><span class="linenos"> 336</span></a><span class="sd">           [0., 4.]])</span>
</span><span id="FisherMatrix-337"><a href="#FisherMatrix-337"><span class="linenos"> 337</span></a>
</span><span id="FisherMatrix-338"><a href="#FisherMatrix-338"><span class="linenos"> 338</span></a><span class="sd">    List the values of the fiducials:</span>
</span><span id="FisherMatrix-339"><a href="#FisherMatrix-339"><span class="linenos"> 339</span></a><span class="sd">    &gt;&gt;&gt; fm.fiducials</span>
</span><span id="FisherMatrix-340"><a href="#FisherMatrix-340"><span class="linenos"> 340</span></a><span class="sd">    array([0., 0.])</span>
</span><span id="FisherMatrix-341"><a href="#FisherMatrix-341"><span class="linenos"> 341</span></a>
</span><span id="FisherMatrix-342"><a href="#FisherMatrix-342"><span class="linenos"> 342</span></a><span class="sd">    Names can be changed in bulk (ditto for fiducials and values; dimension</span>
</span><span id="FisherMatrix-343"><a href="#FisherMatrix-343"><span class="linenos"> 343</span></a><span class="sd">    must of course match the original):</span>
</span><span id="FisherMatrix-344"><a href="#FisherMatrix-344"><span class="linenos"> 344</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]))</span>
</span><span id="FisherMatrix-345"><a href="#FisherMatrix-345"><span class="linenos"> 345</span></a><span class="sd">    &gt;&gt;&gt; fm.names = [&#39;x&#39;, &#39;y&#39;]</span>
</span><span id="FisherMatrix-346"><a href="#FisherMatrix-346"><span class="linenos"> 346</span></a><span class="sd">    &gt;&gt;&gt; fm.latex_names = [r&#39;$\mathbf{X}$&#39;, r&#39;$\mathbf{Y}$&#39;]</span>
</span><span id="FisherMatrix-347"><a href="#FisherMatrix-347"><span class="linenos"> 347</span></a><span class="sd">    &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix-348"><a href="#FisherMatrix-348"><span class="linenos"> 348</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-349"><a href="#FisherMatrix-349"><span class="linenos"> 349</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="FisherMatrix-350"><a href="#FisherMatrix-350"><span class="linenos"> 350</span></a><span class="sd">           [0., 4.]]),</span>
</span><span id="FisherMatrix-351"><a href="#FisherMatrix-351"><span class="linenos"> 351</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-352"><a href="#FisherMatrix-352"><span class="linenos"> 352</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-353"><a href="#FisherMatrix-353"><span class="linenos"> 353</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-354"><a href="#FisherMatrix-354"><span class="linenos"> 354</span></a>
</span><span id="FisherMatrix-355"><a href="#FisherMatrix-355"><span class="linenos"> 355</span></a><span class="sd">    We can get and set individual elements of the matrix using dict-like notation:</span>
</span><span id="FisherMatrix-356"><a href="#FisherMatrix-356"><span class="linenos"> 356</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]), names=[&#39;x&#39;, &#39;y&#39;])</span>
</span><span id="FisherMatrix-357"><a href="#FisherMatrix-357"><span class="linenos"> 357</span></a><span class="sd">    &gt;&gt;&gt; fm[&#39;x&#39;, &#39;x&#39;]</span>
</span><span id="FisherMatrix-358"><a href="#FisherMatrix-358"><span class="linenos"> 358</span></a><span class="sd">    5.0</span>
</span><span id="FisherMatrix-359"><a href="#FisherMatrix-359"><span class="linenos"> 359</span></a>
</span><span id="FisherMatrix-360"><a href="#FisherMatrix-360"><span class="linenos"> 360</span></a><span class="sd">    The off-diagonal elements are automatically updated when using the setter:</span>
</span><span id="FisherMatrix-361"><a href="#FisherMatrix-361"><span class="linenos"> 361</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]), names=[&#39;x&#39;, &#39;y&#39;])</span>
</span><span id="FisherMatrix-362"><a href="#FisherMatrix-362"><span class="linenos"> 362</span></a><span class="sd">    &gt;&gt;&gt; fm[&#39;x&#39;, &#39;y&#39;] = -2</span>
</span><span id="FisherMatrix-363"><a href="#FisherMatrix-363"><span class="linenos"> 363</span></a><span class="sd">    &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix-364"><a href="#FisherMatrix-364"><span class="linenos"> 364</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-365"><a href="#FisherMatrix-365"><span class="linenos"> 365</span></a><span class="sd">        array([[ 5., -2.],</span>
</span><span id="FisherMatrix-366"><a href="#FisherMatrix-366"><span class="linenos"> 366</span></a><span class="sd">           [-2.,  4.]]),</span>
</span><span id="FisherMatrix-367"><a href="#FisherMatrix-367"><span class="linenos"> 367</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-368"><a href="#FisherMatrix-368"><span class="linenos"> 368</span></a><span class="sd">        latex_names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-369"><a href="#FisherMatrix-369"><span class="linenos"> 369</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-370"><a href="#FisherMatrix-370"><span class="linenos"> 370</span></a>
</span><span id="FisherMatrix-371"><a href="#FisherMatrix-371"><span class="linenos"> 371</span></a><span class="sd">    We can select submatrices by index:</span>
</span><span id="FisherMatrix-372"><a href="#FisherMatrix-372"><span class="linenos"> 372</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 3]), names=[&#39;x&#39;, &#39;y&#39;, &#39;z&#39;])</span>
</span><span id="FisherMatrix-373"><a href="#FisherMatrix-373"><span class="linenos"> 373</span></a><span class="sd">    &gt;&gt;&gt; fm[1:]</span>
</span><span id="FisherMatrix-374"><a href="#FisherMatrix-374"><span class="linenos"> 374</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-375"><a href="#FisherMatrix-375"><span class="linenos"> 375</span></a><span class="sd">        array([[2., 0.],</span>
</span><span id="FisherMatrix-376"><a href="#FisherMatrix-376"><span class="linenos"> 376</span></a><span class="sd">           [0., 3.]]),</span>
</span><span id="FisherMatrix-377"><a href="#FisherMatrix-377"><span class="linenos"> 377</span></a><span class="sd">        names=array([&#39;y&#39;, &#39;z&#39;], dtype=object),</span>
</span><span id="FisherMatrix-378"><a href="#FisherMatrix-378"><span class="linenos"> 378</span></a><span class="sd">        latex_names=array([&#39;y&#39;, &#39;z&#39;], dtype=object),</span>
</span><span id="FisherMatrix-379"><a href="#FisherMatrix-379"><span class="linenos"> 379</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-380"><a href="#FisherMatrix-380"><span class="linenos"> 380</span></a>
</span><span id="FisherMatrix-381"><a href="#FisherMatrix-381"><span class="linenos"> 381</span></a><span class="sd">    Fisher object with parameter names:</span>
</span><span id="FisherMatrix-382"><a href="#FisherMatrix-382"><span class="linenos"> 382</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]),</span>
</span><span id="FisherMatrix-383"><a href="#FisherMatrix-383"><span class="linenos"> 383</span></a><span class="sd">    ... names=[&#39;x&#39;, &#39;y&#39;], latex_names=[&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;])</span>
</span><span id="FisherMatrix-384"><a href="#FisherMatrix-384"><span class="linenos"> 384</span></a><span class="sd">    &gt;&gt;&gt; fm_with_names = FisherMatrix(np.diag([1, 2]), names=[&#39;x&#39;, &#39;y&#39;])</span>
</span><span id="FisherMatrix-385"><a href="#FisherMatrix-385"><span class="linenos"> 385</span></a>
</span><span id="FisherMatrix-386"><a href="#FisherMatrix-386"><span class="linenos"> 386</span></a><span class="sd">    We can add Fisher objects (ordering of names is taken care of):</span>
</span><span id="FisherMatrix-387"><a href="#FisherMatrix-387"><span class="linenos"> 387</span></a><span class="sd">    &gt;&gt;&gt; fm + fm_with_names # doctest: +SKIP</span>
</span><span id="FisherMatrix-388"><a href="#FisherMatrix-388"><span class="linenos"> 388</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-389"><a href="#FisherMatrix-389"><span class="linenos"> 389</span></a><span class="sd">        array([[6., 0.],</span>
</span><span id="FisherMatrix-390"><a href="#FisherMatrix-390"><span class="linenos"> 390</span></a><span class="sd">           [0., 6.]]),</span>
</span><span id="FisherMatrix-391"><a href="#FisherMatrix-391"><span class="linenos"> 391</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-392"><a href="#FisherMatrix-392"><span class="linenos"> 392</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-393"><a href="#FisherMatrix-393"><span class="linenos"> 393</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-394"><a href="#FisherMatrix-394"><span class="linenos"> 394</span></a>
</span><span id="FisherMatrix-395"><a href="#FisherMatrix-395"><span class="linenos"> 395</span></a><span class="sd">    We can also do element-wise multiplication or division:</span>
</span><span id="FisherMatrix-396"><a href="#FisherMatrix-396"><span class="linenos"> 396</span></a><span class="sd">    &gt;&gt;&gt; fm * fm_with_names</span>
</span><span id="FisherMatrix-397"><a href="#FisherMatrix-397"><span class="linenos"> 397</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-398"><a href="#FisherMatrix-398"><span class="linenos"> 398</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="FisherMatrix-399"><a href="#FisherMatrix-399"><span class="linenos"> 399</span></a><span class="sd">           [0., 8.]]),</span>
</span><span id="FisherMatrix-400"><a href="#FisherMatrix-400"><span class="linenos"> 400</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-401"><a href="#FisherMatrix-401"><span class="linenos"> 401</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-402"><a href="#FisherMatrix-402"><span class="linenos"> 402</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-403"><a href="#FisherMatrix-403"><span class="linenos"> 403</span></a>
</span><span id="FisherMatrix-404"><a href="#FisherMatrix-404"><span class="linenos"> 404</span></a><span class="sd">    Furthermore, we can do matrix multiplication:</span>
</span><span id="FisherMatrix-405"><a href="#FisherMatrix-405"><span class="linenos"> 405</span></a><span class="sd">    &gt;&gt;&gt; fm @ fm_with_names</span>
</span><span id="FisherMatrix-406"><a href="#FisherMatrix-406"><span class="linenos"> 406</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-407"><a href="#FisherMatrix-407"><span class="linenos"> 407</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="FisherMatrix-408"><a href="#FisherMatrix-408"><span class="linenos"> 408</span></a><span class="sd">           [0., 8.]]),</span>
</span><span id="FisherMatrix-409"><a href="#FisherMatrix-409"><span class="linenos"> 409</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-410"><a href="#FisherMatrix-410"><span class="linenos"> 410</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-411"><a href="#FisherMatrix-411"><span class="linenos"> 411</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-412"><a href="#FisherMatrix-412"><span class="linenos"> 412</span></a>
</span><span id="FisherMatrix-413"><a href="#FisherMatrix-413"><span class="linenos"> 413</span></a><span class="sd">    We can also perform standard matrix operations like the trace, eigenvalues, determinant:</span>
</span><span id="FisherMatrix-414"><a href="#FisherMatrix-414"><span class="linenos"> 414</span></a><span class="sd">    &gt;&gt;&gt; fm.trace()</span>
</span><span id="FisherMatrix-415"><a href="#FisherMatrix-415"><span class="linenos"> 415</span></a><span class="sd">    9.0</span>
</span><span id="FisherMatrix-416"><a href="#FisherMatrix-416"><span class="linenos"> 416</span></a><span class="sd">    &gt;&gt;&gt; fm.eigenvalues()</span>
</span><span id="FisherMatrix-417"><a href="#FisherMatrix-417"><span class="linenos"> 417</span></a><span class="sd">    array([4., 5.])</span>
</span><span id="FisherMatrix-418"><a href="#FisherMatrix-418"><span class="linenos"> 418</span></a><span class="sd">    &gt;&gt;&gt; fm.determinant()</span>
</span><span id="FisherMatrix-419"><a href="#FisherMatrix-419"><span class="linenos"> 419</span></a><span class="sd">    19.999999999999996</span>
</span><span id="FisherMatrix-420"><a href="#FisherMatrix-420"><span class="linenos"> 420</span></a>
</span><span id="FisherMatrix-421"><a href="#FisherMatrix-421"><span class="linenos"> 421</span></a><span class="sd">    We can also get the inverse (the covariance matrix):</span>
</span><span id="FisherMatrix-422"><a href="#FisherMatrix-422"><span class="linenos"> 422</span></a><span class="sd">    &gt;&gt;&gt; fm.inverse()</span>
</span><span id="FisherMatrix-423"><a href="#FisherMatrix-423"><span class="linenos"> 423</span></a><span class="sd">    array([[0.2 , 0.  ],</span>
</span><span id="FisherMatrix-424"><a href="#FisherMatrix-424"><span class="linenos"> 424</span></a><span class="sd">           [0.  , 0.25]])</span>
</span><span id="FisherMatrix-425"><a href="#FisherMatrix-425"><span class="linenos"> 425</span></a>
</span><span id="FisherMatrix-426"><a href="#FisherMatrix-426"><span class="linenos"> 426</span></a><span class="sd">    We can drop parameters from the object:</span>
</span><span id="FisherMatrix-427"><a href="#FisherMatrix-427"><span class="linenos"> 427</span></a><span class="sd">    &gt;&gt;&gt; fm.drop(&#39;x&#39;)</span>
</span><span id="FisherMatrix-428"><a href="#FisherMatrix-428"><span class="linenos"> 428</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-429"><a href="#FisherMatrix-429"><span class="linenos"> 429</span></a><span class="sd">        array([[4.]]),</span>
</span><span id="FisherMatrix-430"><a href="#FisherMatrix-430"><span class="linenos"> 430</span></a><span class="sd">        names=array([&#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-431"><a href="#FisherMatrix-431"><span class="linenos"> 431</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-432"><a href="#FisherMatrix-432"><span class="linenos"> 432</span></a><span class="sd">        fiducials=array([0.]))</span>
</span><span id="FisherMatrix-433"><a href="#FisherMatrix-433"><span class="linenos"> 433</span></a>
</span><span id="FisherMatrix-434"><a href="#FisherMatrix-434"><span class="linenos"> 434</span></a><span class="sd">    We can save it to a file (the returned value is the dictionary that was saved):</span>
</span><span id="FisherMatrix-435"><a href="#FisherMatrix-435"><span class="linenos"> 435</span></a><span class="sd">    &gt;&gt;&gt; pprint(fm.to_file(&#39;example_matrix.json&#39;), sort_dicts=False) # doctest: +SKIP</span>
</span><span id="FisherMatrix-436"><a href="#FisherMatrix-436"><span class="linenos"> 436</span></a><span class="sd">    {&#39;values&#39;: [[5.0, 0.0], [0.0, 4.0]],</span>
</span><span id="FisherMatrix-437"><a href="#FisherMatrix-437"><span class="linenos"> 437</span></a><span class="sd">     &#39;names&#39;: [&#39;x&#39;, &#39;y&#39;],</span>
</span><span id="FisherMatrix-438"><a href="#FisherMatrix-438"><span class="linenos"> 438</span></a><span class="sd">     &#39;latex_names&#39;: [&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;],</span>
</span><span id="FisherMatrix-439"><a href="#FisherMatrix-439"><span class="linenos"> 439</span></a><span class="sd">     &#39;fiducials&#39;: [0.0, 0.0]}</span>
</span><span id="FisherMatrix-440"><a href="#FisherMatrix-440"><span class="linenos"> 440</span></a>
</span><span id="FisherMatrix-441"><a href="#FisherMatrix-441"><span class="linenos"> 441</span></a><span class="sd">    Loading is performed by a class method `from_file`:</span>
</span><span id="FisherMatrix-442"><a href="#FisherMatrix-442"><span class="linenos"> 442</span></a><span class="sd">    &gt;&gt;&gt; fm_new = FisherMatrix.from_file(&#39;example_matrix.json&#39;) # doctest: +SKIP</span>
</span><span id="FisherMatrix-443"><a href="#FisherMatrix-443"><span class="linenos"> 443</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-444"><a href="#FisherMatrix-444"><span class="linenos"> 444</span></a>
</span><span id="FisherMatrix-445"><a href="#FisherMatrix-445"><span class="linenos"> 445</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FisherMatrix-446"><a href="#FisherMatrix-446"><span class="linenos"> 446</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-447"><a href="#FisherMatrix-447"><span class="linenos"> 447</span></a>        <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-448"><a href="#FisherMatrix-448"><span class="linenos"> 448</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-449"><a href="#FisherMatrix-449"><span class="linenos"> 449</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-450"><a href="#FisherMatrix-450"><span class="linenos"> 450</span></a>        <span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-451"><a href="#FisherMatrix-451"><span class="linenos"> 451</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-452"><a href="#FisherMatrix-452"><span class="linenos"> 452</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-453"><a href="#FisherMatrix-453"><span class="linenos"> 453</span></a><span class="sd">        Create for Fisher object.</span>
</span><span id="FisherMatrix-454"><a href="#FisherMatrix-454"><span class="linenos"> 454</span></a>
</span><span id="FisherMatrix-455"><a href="#FisherMatrix-455"><span class="linenos"> 455</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-456"><a href="#FisherMatrix-456"><span class="linenos"> 456</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-457"><a href="#FisherMatrix-457"><span class="linenos"> 457</span></a><span class="sd">        values : array_like of float</span>
</span><span id="FisherMatrix-458"><a href="#FisherMatrix-458"><span class="linenos"> 458</span></a><span class="sd">            The values of the Fisher object.</span>
</span><span id="FisherMatrix-459"><a href="#FisherMatrix-459"><span class="linenos"> 459</span></a>
</span><span id="FisherMatrix-460"><a href="#FisherMatrix-460"><span class="linenos"> 460</span></a><span class="sd">        names : array_like of str, optional</span>
</span><span id="FisherMatrix-461"><a href="#FisherMatrix-461"><span class="linenos"> 461</span></a><span class="sd">            The names of the parameters (default: None).</span>
</span><span id="FisherMatrix-462"><a href="#FisherMatrix-462"><span class="linenos"> 462</span></a><span class="sd">            If not specified, defaults to `p1, ..., pn`.</span>
</span><span id="FisherMatrix-463"><a href="#FisherMatrix-463"><span class="linenos"> 463</span></a>
</span><span id="FisherMatrix-464"><a href="#FisherMatrix-464"><span class="linenos"> 464</span></a><span class="sd">        latex_names : array_like of str, optional</span>
</span><span id="FisherMatrix-465"><a href="#FisherMatrix-465"><span class="linenos"> 465</span></a><span class="sd">            The LaTeX names of the parameters (default: None).</span>
</span><span id="FisherMatrix-466"><a href="#FisherMatrix-466"><span class="linenos"> 466</span></a><span class="sd">            If not specified, defaults to `names`.</span>
</span><span id="FisherMatrix-467"><a href="#FisherMatrix-467"><span class="linenos"> 467</span></a>
</span><span id="FisherMatrix-468"><a href="#FisherMatrix-468"><span class="linenos"> 468</span></a><span class="sd">        fiducials : array_like of float, optional</span>
</span><span id="FisherMatrix-469"><a href="#FisherMatrix-469"><span class="linenos"> 469</span></a><span class="sd">            The fiducial values of the parameters (default: None). If not</span>
</span><span id="FisherMatrix-470"><a href="#FisherMatrix-470"><span class="linenos"> 470</span></a><span class="sd">            specified, default to 0 for all parameters.</span>
</span><span id="FisherMatrix-471"><a href="#FisherMatrix-471"><span class="linenos"> 471</span></a>
</span><span id="FisherMatrix-472"><a href="#FisherMatrix-472"><span class="linenos"> 472</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-473"><a href="#FisherMatrix-473"><span class="linenos"> 473</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-474"><a href="#FisherMatrix-474"><span class="linenos"> 474</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix-475"><a href="#FisherMatrix-475"><span class="linenos"> 475</span></a><span class="sd">            if the input array has the wrong dimensionality (not 2)</span>
</span><span id="FisherMatrix-476"><a href="#FisherMatrix-476"><span class="linenos"> 476</span></a>
</span><span id="FisherMatrix-477"><a href="#FisherMatrix-477"><span class="linenos"> 477</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix-478"><a href="#FisherMatrix-478"><span class="linenos"> 478</span></a><span class="sd">            if the object is not square-like</span>
</span><span id="FisherMatrix-479"><a href="#FisherMatrix-479"><span class="linenos"> 479</span></a>
</span><span id="FisherMatrix-480"><a href="#FisherMatrix-480"><span class="linenos"> 480</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="FisherMatrix-481"><a href="#FisherMatrix-481"><span class="linenos"> 481</span></a><span class="sd">            if the sizes of the array of names, values, LaTeX names and</span>
</span><span id="FisherMatrix-482"><a href="#FisherMatrix-482"><span class="linenos"> 482</span></a><span class="sd">            fiducials do not match</span>
</span><span id="FisherMatrix-483"><a href="#FisherMatrix-483"><span class="linenos"> 483</span></a>
</span><span id="FisherMatrix-484"><a href="#FisherMatrix-484"><span class="linenos"> 484</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-485"><a href="#FisherMatrix-485"><span class="linenos"> 485</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-486"><a href="#FisherMatrix-486"><span class="linenos"> 486</span></a><span class="sd">        Specify a Fisher object without names:</span>
</span><span id="FisherMatrix-487"><a href="#FisherMatrix-487"><span class="linenos"> 487</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix-488"><a href="#FisherMatrix-488"><span class="linenos"> 488</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-489"><a href="#FisherMatrix-489"><span class="linenos"> 489</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="FisherMatrix-490"><a href="#FisherMatrix-490"><span class="linenos"> 490</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix-491"><a href="#FisherMatrix-491"><span class="linenos"> 491</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix-492"><a href="#FisherMatrix-492"><span class="linenos"> 492</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-493"><a href="#FisherMatrix-493"><span class="linenos"> 493</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-494"><a href="#FisherMatrix-494"><span class="linenos"> 494</span></a><span class="sd">            fiducials=array([0., 0., 0.]))</span>
</span><span id="FisherMatrix-495"><a href="#FisherMatrix-495"><span class="linenos"> 495</span></a>
</span><span id="FisherMatrix-496"><a href="#FisherMatrix-496"><span class="linenos"> 496</span></a><span class="sd">        Specify a Fisher object with names, LaTeX names, and fiducials:</span>
</span><span id="FisherMatrix-497"><a href="#FisherMatrix-497"><span class="linenos"> 497</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([1, 2]), names=[&#39;alpha&#39;, &#39;beta&#39;],</span>
</span><span id="FisherMatrix-498"><a href="#FisherMatrix-498"><span class="linenos"> 498</span></a><span class="sd">        ... latex_names=[r&#39;$\alpha$&#39;, r&#39;$\beta$&#39;], fiducials=[-3, 2])</span>
</span><span id="FisherMatrix-499"><a href="#FisherMatrix-499"><span class="linenos"> 499</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-500"><a href="#FisherMatrix-500"><span class="linenos"> 500</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix-501"><a href="#FisherMatrix-501"><span class="linenos"> 501</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix-502"><a href="#FisherMatrix-502"><span class="linenos"> 502</span></a><span class="sd">            names=array([&#39;alpha&#39;, &#39;beta&#39;], dtype=object),</span>
</span><span id="FisherMatrix-503"><a href="#FisherMatrix-503"><span class="linenos"> 503</span></a><span class="sd">            latex_names=array([&#39;$\\alpha$&#39;, &#39;$\\beta$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-504"><a href="#FisherMatrix-504"><span class="linenos"> 504</span></a><span class="sd">            fiducials=array([-3.,  2.]))</span>
</span><span id="FisherMatrix-505"><a href="#FisherMatrix-505"><span class="linenos"> 505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-506"><a href="#FisherMatrix-506"><span class="linenos"> 506</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="FisherMatrix-507"><a href="#FisherMatrix-507"><span class="linenos"> 507</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2"> is not 2-dimensional&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-508"><a href="#FisherMatrix-508"><span class="linenos"> 508</span></a>
</span><span id="FisherMatrix-509"><a href="#FisherMatrix-509"><span class="linenos"> 509</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
</span><span id="FisherMatrix-510"><a href="#FisherMatrix-510"><span class="linenos"> 510</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2"> is not square-like&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-511"><a href="#FisherMatrix-511"><span class="linenos"> 511</span></a>
</span><span id="FisherMatrix-512"><a href="#FisherMatrix-512"><span class="linenos"> 512</span></a>        <span class="c1"># try to treat it as an array-like object</span>
</span><span id="FisherMatrix-513"><a href="#FisherMatrix-513"><span class="linenos"> 513</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix-514"><a href="#FisherMatrix-514"><span class="linenos"> 514</span></a>
</span><span id="FisherMatrix-515"><a href="#FisherMatrix-515"><span class="linenos"> 515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix-516"><a href="#FisherMatrix-516"><span class="linenos"> 516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ndim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="FisherMatrix-517"><a href="#FisherMatrix-517"><span class="linenos"> 517</span></a>        <span class="c1"># setting the fiducials</span>
</span><span id="FisherMatrix-518"><a href="#FisherMatrix-518"><span class="linenos"> 518</span></a>        <span class="k">if</span> <span class="n">fiducials</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-519"><a href="#FisherMatrix-519"><span class="linenos"> 519</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix-520"><a href="#FisherMatrix-520"><span class="linenos"> 520</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-521"><a href="#FisherMatrix-521"><span class="linenos"> 521</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix-522"><a href="#FisherMatrix-522"><span class="linenos"> 522</span></a>
</span><span id="FisherMatrix-523"><a href="#FisherMatrix-523"><span class="linenos"> 523</span></a>        <span class="c1"># setting the names</span>
</span><span id="FisherMatrix-524"><a href="#FisherMatrix-524"><span class="linenos"> 524</span></a>        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-525"><a href="#FisherMatrix-525"><span class="linenos"> 525</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">make_default_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>
</span><span id="FisherMatrix-526"><a href="#FisherMatrix-526"><span class="linenos"> 526</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-527"><a href="#FisherMatrix-527"><span class="linenos"> 527</span></a>            <span class="c1"># check they&#39;re unique</span>
</span><span id="FisherMatrix-528"><a href="#FisherMatrix-528"><span class="linenos"> 528</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-529"><a href="#FisherMatrix-529"><span class="linenos"> 529</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-530"><a href="#FisherMatrix-530"><span class="linenos"> 530</span></a>
</span><span id="FisherMatrix-531"><a href="#FisherMatrix-531"><span class="linenos"> 531</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix-532"><a href="#FisherMatrix-532"><span class="linenos"> 532</span></a>
</span><span id="FisherMatrix-533"><a href="#FisherMatrix-533"><span class="linenos"> 533</span></a>        <span class="c1"># setting the pretty names (LaTeX)</span>
</span><span id="FisherMatrix-534"><a href="#FisherMatrix-534"><span class="linenos"> 534</span></a>        <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-535"><a href="#FisherMatrix-535"><span class="linenos"> 535</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">)</span>
</span><span id="FisherMatrix-536"><a href="#FisherMatrix-536"><span class="linenos"> 536</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-537"><a href="#FisherMatrix-537"><span class="linenos"> 537</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latex_names</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix-538"><a href="#FisherMatrix-538"><span class="linenos"> 538</span></a>
</span><span id="FisherMatrix-539"><a href="#FisherMatrix-539"><span class="linenos"> 539</span></a>        <span class="c1"># check sizes of inputs</span>
</span><span id="FisherMatrix-540"><a href="#FisherMatrix-540"><span class="linenos"> 540</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="FisherMatrix-541"><a href="#FisherMatrix-541"><span class="linenos"> 541</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span>
</span><span id="FisherMatrix-542"><a href="#FisherMatrix-542"><span class="linenos"> 542</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix-543"><a href="#FisherMatrix-543"><span class="linenos"> 543</span></a>        <span class="p">):</span>
</span><span id="FisherMatrix-544"><a href="#FisherMatrix-544"><span class="linenos"> 544</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span>
</span><span id="FisherMatrix-545"><a href="#FisherMatrix-545"><span class="linenos"> 545</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="FisherMatrix-546"><a href="#FisherMatrix-546"><span class="linenos"> 546</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">,</span>
</span><span id="FisherMatrix-547"><a href="#FisherMatrix-547"><span class="linenos"> 547</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-548"><a href="#FisherMatrix-548"><span class="linenos"> 548</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-549"><a href="#FisherMatrix-549"><span class="linenos"> 549</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-550"><a href="#FisherMatrix-550"><span class="linenos"> 550</span></a>
</span><span id="FisherMatrix-551"><a href="#FisherMatrix-551"><span class="linenos"> 551</span></a>    <span class="nd">@classmethod</span>
</span><span id="FisherMatrix-552"><a href="#FisherMatrix-552"><span class="linenos"> 552</span></a>    <span class="k">def</span> <span class="nf">from_parameters</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="p">):</span>
</span><span id="FisherMatrix-553"><a href="#FisherMatrix-553"><span class="linenos"> 553</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-554"><a href="#FisherMatrix-554"><span class="linenos"> 554</span></a><span class="sd">        Alternative constructor.</span>
</span><span id="FisherMatrix-555"><a href="#FisherMatrix-555"><span class="linenos"> 555</span></a>
</span><span id="FisherMatrix-556"><a href="#FisherMatrix-556"><span class="linenos"> 556</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-557"><a href="#FisherMatrix-557"><span class="linenos"> 557</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-558"><a href="#FisherMatrix-558"><span class="linenos"> 558</span></a><span class="sd">        values : array_like of float</span>
</span><span id="FisherMatrix-559"><a href="#FisherMatrix-559"><span class="linenos"> 559</span></a><span class="sd">            the values of the Fisher object</span>
</span><span id="FisherMatrix-560"><a href="#FisherMatrix-560"><span class="linenos"> 560</span></a>
</span><span id="FisherMatrix-561"><a href="#FisherMatrix-561"><span class="linenos"> 561</span></a><span class="sd">        *args : P</span>
</span><span id="FisherMatrix-562"><a href="#FisherMatrix-562"><span class="linenos"> 562</span></a><span class="sd">            the Fisher parameters</span>
</span><span id="FisherMatrix-563"><a href="#FisherMatrix-563"><span class="linenos"> 563</span></a>
</span><span id="FisherMatrix-564"><a href="#FisherMatrix-564"><span class="linenos"> 564</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-565"><a href="#FisherMatrix-565"><span class="linenos"> 565</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-566"><a href="#FisherMatrix-566"><span class="linenos"> 566</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix.from_parameters(</span>
</span><span id="FisherMatrix-567"><a href="#FisherMatrix-567"><span class="linenos"> 567</span></a><span class="sd">        ... np.diag([1, 2, 3]),</span>
</span><span id="FisherMatrix-568"><a href="#FisherMatrix-568"><span class="linenos"> 568</span></a><span class="sd">        ... P(&#39;a&#39;, -1, &#39;$x$&#39;),</span>
</span><span id="FisherMatrix-569"><a href="#FisherMatrix-569"><span class="linenos"> 569</span></a><span class="sd">        ... P(&#39;b&#39;, 0, &#39;$y$&#39;),</span>
</span><span id="FisherMatrix-570"><a href="#FisherMatrix-570"><span class="linenos"> 570</span></a><span class="sd">        ... P(&#39;c&#39;, 1, &#39;$z$&#39;)</span>
</span><span id="FisherMatrix-571"><a href="#FisherMatrix-571"><span class="linenos"> 571</span></a><span class="sd">        ... )</span>
</span><span id="FisherMatrix-572"><a href="#FisherMatrix-572"><span class="linenos"> 572</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-573"><a href="#FisherMatrix-573"><span class="linenos"> 573</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="FisherMatrix-574"><a href="#FisherMatrix-574"><span class="linenos"> 574</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix-575"><a href="#FisherMatrix-575"><span class="linenos"> 575</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix-576"><a href="#FisherMatrix-576"><span class="linenos"> 576</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=object),</span>
</span><span id="FisherMatrix-577"><a href="#FisherMatrix-577"><span class="linenos"> 577</span></a><span class="sd">            latex_names=array([&#39;$x$&#39;, &#39;$y$&#39;, &#39;$z$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-578"><a href="#FisherMatrix-578"><span class="linenos"> 578</span></a><span class="sd">            fiducials=array([-1.,  0.,  1.]))</span>
</span><span id="FisherMatrix-579"><a href="#FisherMatrix-579"><span class="linenos"> 579</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-580"><a href="#FisherMatrix-580"><span class="linenos"> 580</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="FisherMatrix-581"><a href="#FisherMatrix-581"><span class="linenos"> 581</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-582"><a href="#FisherMatrix-582"><span class="linenos"> 582</span></a>            <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>
</span><span id="FisherMatrix-583"><a href="#FisherMatrix-583"><span class="linenos"> 583</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">fiducial</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
</span><span id="FisherMatrix-584"><a href="#FisherMatrix-584"><span class="linenos"> 584</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">latex_name</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
</span><span id="FisherMatrix-585"><a href="#FisherMatrix-585"><span class="linenos"> 585</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-586"><a href="#FisherMatrix-586"><span class="linenos"> 586</span></a>
</span><span id="FisherMatrix-587"><a href="#FisherMatrix-587"><span class="linenos"> 587</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-588"><a href="#FisherMatrix-588"><span class="linenos"> 588</span></a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-589"><a href="#FisherMatrix-589"><span class="linenos"> 589</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the (multivariate) Gaussian part of the Fisher object.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-590"><a href="#FisherMatrix-590"><span class="linenos"> 590</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
</span><span id="FisherMatrix-591"><a href="#FisherMatrix-591"><span class="linenos"> 591</span></a>
</span><span id="FisherMatrix-592"><a href="#FisherMatrix-592"><span class="linenos"> 592</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-593"><a href="#FisherMatrix-593"><span class="linenos"> 593</span></a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-594"><a href="#FisherMatrix-594"><span class="linenos"> 594</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-595"><a href="#FisherMatrix-595"><span class="linenos"> 595</span></a><span class="sd">        Returns the values in the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix-596"><a href="#FisherMatrix-596"><span class="linenos"> 596</span></a>
</span><span id="FisherMatrix-597"><a href="#FisherMatrix-597"><span class="linenos"> 597</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-598"><a href="#FisherMatrix-598"><span class="linenos"> 598</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-599"><a href="#FisherMatrix-599"><span class="linenos"> 599</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="FisherMatrix-600"><a href="#FisherMatrix-600"><span class="linenos"> 600</span></a><span class="sd">            if the new values do not have the same size as the original ones</span>
</span><span id="FisherMatrix-601"><a href="#FisherMatrix-601"><span class="linenos"> 601</span></a>
</span><span id="FisherMatrix-602"><a href="#FisherMatrix-602"><span class="linenos"> 602</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix-603"><a href="#FisherMatrix-603"><span class="linenos"> 603</span></a><span class="sd">            if the shape of the new values is not square</span>
</span><span id="FisherMatrix-604"><a href="#FisherMatrix-604"><span class="linenos"> 604</span></a>
</span><span id="FisherMatrix-605"><a href="#FisherMatrix-605"><span class="linenos"> 605</span></a><span class="sd">        TypeError</span>
</span><span id="FisherMatrix-606"><a href="#FisherMatrix-606"><span class="linenos"> 606</span></a><span class="sd">            if the new values do not have the same type as the original ones</span>
</span><span id="FisherMatrix-607"><a href="#FisherMatrix-607"><span class="linenos"> 607</span></a>
</span><span id="FisherMatrix-608"><a href="#FisherMatrix-608"><span class="linenos"> 608</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-609"><a href="#FisherMatrix-609"><span class="linenos"> 609</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-610"><a href="#FisherMatrix-610"><span class="linenos"> 610</span></a><span class="sd">        Currently returns the same output as `matrix` (subject to change).</span>
</span><span id="FisherMatrix-611"><a href="#FisherMatrix-611"><span class="linenos"> 611</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-612"><a href="#FisherMatrix-612"><span class="linenos"> 612</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
</span><span id="FisherMatrix-613"><a href="#FisherMatrix-613"><span class="linenos"> 613</span></a>
</span><span id="FisherMatrix-614"><a href="#FisherMatrix-614"><span class="linenos"> 614</span></a>    <span class="nd">@values</span><span class="o">.</span><span class="n">setter</span>
</span><span id="FisherMatrix-615"><a href="#FisherMatrix-615"><span class="linenos"> 615</span></a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span>
</span><span id="FisherMatrix-616"><a href="#FisherMatrix-616"><span class="linenos"> 616</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-617"><a href="#FisherMatrix-617"><span class="linenos"> 617</span></a>        <span class="n">value</span><span class="p">,</span>
</span><span id="FisherMatrix-618"><a href="#FisherMatrix-618"><span class="linenos"> 618</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-619"><a href="#FisherMatrix-619"><span class="linenos"> 619</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span><span id="FisherMatrix-620"><a href="#FisherMatrix-620"><span class="linenos"> 620</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="FisherMatrix-621"><a href="#FisherMatrix-621"><span class="linenos"> 621</span></a>
</span><span id="FisherMatrix-622"><a href="#FisherMatrix-622"><span class="linenos"> 622</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span><span id="FisherMatrix-623"><a href="#FisherMatrix-623"><span class="linenos"> 623</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> is not a square object&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-624"><a href="#FisherMatrix-624"><span class="linenos"> 624</span></a>
</span><span id="FisherMatrix-625"><a href="#FisherMatrix-625"><span class="linenos"> 625</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix-626"><a href="#FisherMatrix-626"><span class="linenos"> 626</span></a>
</span><span id="FisherMatrix-627"><a href="#FisherMatrix-627"><span class="linenos"> 627</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-628"><a href="#FisherMatrix-628"><span class="linenos"> 628</span></a>    <span class="k">def</span> <span class="nf">fiducials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-629"><a href="#FisherMatrix-629"><span class="linenos"> 629</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-630"><a href="#FisherMatrix-630"><span class="linenos"> 630</span></a><span class="sd">        Returns the fiducial values of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix-631"><a href="#FisherMatrix-631"><span class="linenos"> 631</span></a>
</span><span id="FisherMatrix-632"><a href="#FisherMatrix-632"><span class="linenos"> 632</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-633"><a href="#FisherMatrix-633"><span class="linenos"> 633</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-634"><a href="#FisherMatrix-634"><span class="linenos"> 634</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="FisherMatrix-635"><a href="#FisherMatrix-635"><span class="linenos"> 635</span></a><span class="sd">            if the new values do not have the same size as the original ones</span>
</span><span id="FisherMatrix-636"><a href="#FisherMatrix-636"><span class="linenos"> 636</span></a>
</span><span id="FisherMatrix-637"><a href="#FisherMatrix-637"><span class="linenos"> 637</span></a><span class="sd">        TypeError</span>
</span><span id="FisherMatrix-638"><a href="#FisherMatrix-638"><span class="linenos"> 638</span></a><span class="sd">            if the new values do not have the same type as the original ones</span>
</span><span id="FisherMatrix-639"><a href="#FisherMatrix-639"><span class="linenos"> 639</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-640"><a href="#FisherMatrix-640"><span class="linenos"> 640</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span>
</span><span id="FisherMatrix-641"><a href="#FisherMatrix-641"><span class="linenos"> 641</span></a>
</span><span id="FisherMatrix-642"><a href="#FisherMatrix-642"><span class="linenos"> 642</span></a>    <span class="nd">@fiducials</span><span class="o">.</span><span class="n">setter</span>
</span><span id="FisherMatrix-643"><a href="#FisherMatrix-643"><span class="linenos"> 643</span></a>    <span class="k">def</span> <span class="nf">fiducials</span><span class="p">(</span>
</span><span id="FisherMatrix-644"><a href="#FisherMatrix-644"><span class="linenos"> 644</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-645"><a href="#FisherMatrix-645"><span class="linenos"> 645</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
</span><span id="FisherMatrix-646"><a href="#FisherMatrix-646"><span class="linenos"> 646</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-647"><a href="#FisherMatrix-647"><span class="linenos"> 647</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-648"><a href="#FisherMatrix-648"><span class="linenos"> 648</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="FisherMatrix-649"><a href="#FisherMatrix-649"><span class="linenos"> 649</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FisherMatrix-650"><a href="#FisherMatrix-650"><span class="linenos"> 650</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">value</span><span class="p">])</span>
</span><span id="FisherMatrix-651"><a href="#FisherMatrix-651"><span class="linenos"> 651</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="FisherMatrix-652"><a href="#FisherMatrix-652"><span class="linenos"> 652</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="FisherMatrix-653"><a href="#FisherMatrix-653"><span class="linenos"> 653</span></a>
</span><span id="FisherMatrix-654"><a href="#FisherMatrix-654"><span class="linenos"> 654</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-655"><a href="#FisherMatrix-655"><span class="linenos"> 655</span></a>    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-656"><a href="#FisherMatrix-656"><span class="linenos"> 656</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-657"><a href="#FisherMatrix-657"><span class="linenos"> 657</span></a><span class="sd">        Returns the parameter names of the Fisher object.</span>
</span><span id="FisherMatrix-658"><a href="#FisherMatrix-658"><span class="linenos"> 658</span></a>
</span><span id="FisherMatrix-659"><a href="#FisherMatrix-659"><span class="linenos"> 659</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-660"><a href="#FisherMatrix-660"><span class="linenos"> 660</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-661"><a href="#FisherMatrix-661"><span class="linenos"> 661</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="FisherMatrix-662"><a href="#FisherMatrix-662"><span class="linenos"> 662</span></a><span class="sd">            if the new values do not have the same size as the original ones</span>
</span><span id="FisherMatrix-663"><a href="#FisherMatrix-663"><span class="linenos"> 663</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-664"><a href="#FisherMatrix-664"><span class="linenos"> 664</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span>
</span><span id="FisherMatrix-665"><a href="#FisherMatrix-665"><span class="linenos"> 665</span></a>
</span><span id="FisherMatrix-666"><a href="#FisherMatrix-666"><span class="linenos"> 666</span></a>    <span class="nd">@names</span><span class="o">.</span><span class="n">setter</span>
</span><span id="FisherMatrix-667"><a href="#FisherMatrix-667"><span class="linenos"> 667</span></a>    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span>
</span><span id="FisherMatrix-668"><a href="#FisherMatrix-668"><span class="linenos"> 668</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-669"><a href="#FisherMatrix-669"><span class="linenos"> 669</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="FisherMatrix-670"><a href="#FisherMatrix-670"><span class="linenos"> 670</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-671"><a href="#FisherMatrix-671"><span class="linenos"> 671</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-672"><a href="#FisherMatrix-672"><span class="linenos"> 672</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="FisherMatrix-673"><a href="#FisherMatrix-673"><span class="linenos"> 673</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix-674"><a href="#FisherMatrix-674"><span class="linenos"> 674</span></a>
</span><span id="FisherMatrix-675"><a href="#FisherMatrix-675"><span class="linenos"> 675</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-676"><a href="#FisherMatrix-676"><span class="linenos"> 676</span></a>    <span class="k">def</span> <span class="nf">latex_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-677"><a href="#FisherMatrix-677"><span class="linenos"> 677</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-678"><a href="#FisherMatrix-678"><span class="linenos"> 678</span></a><span class="sd">        Returns the LaTeX names of the parameters of the Fisher object.</span>
</span><span id="FisherMatrix-679"><a href="#FisherMatrix-679"><span class="linenos"> 679</span></a>
</span><span id="FisherMatrix-680"><a href="#FisherMatrix-680"><span class="linenos"> 680</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-681"><a href="#FisherMatrix-681"><span class="linenos"> 681</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-682"><a href="#FisherMatrix-682"><span class="linenos"> 682</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="FisherMatrix-683"><a href="#FisherMatrix-683"><span class="linenos"> 683</span></a><span class="sd">            if the new values do not have the same size as the original ones</span>
</span><span id="FisherMatrix-684"><a href="#FisherMatrix-684"><span class="linenos"> 684</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-685"><a href="#FisherMatrix-685"><span class="linenos"> 685</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span>
</span><span id="FisherMatrix-686"><a href="#FisherMatrix-686"><span class="linenos"> 686</span></a>
</span><span id="FisherMatrix-687"><a href="#FisherMatrix-687"><span class="linenos"> 687</span></a>    <span class="nd">@latex_names</span><span class="o">.</span><span class="n">setter</span>
</span><span id="FisherMatrix-688"><a href="#FisherMatrix-688"><span class="linenos"> 688</span></a>    <span class="k">def</span> <span class="nf">latex_names</span><span class="p">(</span>
</span><span id="FisherMatrix-689"><a href="#FisherMatrix-689"><span class="linenos"> 689</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-690"><a href="#FisherMatrix-690"><span class="linenos"> 690</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="FisherMatrix-691"><a href="#FisherMatrix-691"><span class="linenos"> 691</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-692"><a href="#FisherMatrix-692"><span class="linenos"> 692</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-693"><a href="#FisherMatrix-693"><span class="linenos"> 693</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="FisherMatrix-694"><a href="#FisherMatrix-694"><span class="linenos"> 694</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix-695"><a href="#FisherMatrix-695"><span class="linenos"> 695</span></a>
</span><span id="FisherMatrix-696"><a href="#FisherMatrix-696"><span class="linenos"> 696</span></a>    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
</span><span id="FisherMatrix-697"><a href="#FisherMatrix-697"><span class="linenos"> 697</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-698"><a href="#FisherMatrix-698"><span class="linenos"> 698</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">]],</span>
</span><span id="FisherMatrix-699"><a href="#FisherMatrix-699"><span class="linenos"> 699</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix-700"><a href="#FisherMatrix-700"><span class="linenos"> 700</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-701"><a href="#FisherMatrix-701"><span class="linenos"> 701</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-702"><a href="#FisherMatrix-702"><span class="linenos"> 702</span></a><span class="sd">        Return a Fisher object with new names. This is primarily useful for renaming individual parameters.</span>
</span><span id="FisherMatrix-703"><a href="#FisherMatrix-703"><span class="linenos"> 703</span></a>
</span><span id="FisherMatrix-704"><a href="#FisherMatrix-704"><span class="linenos"> 704</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-705"><a href="#FisherMatrix-705"><span class="linenos"> 705</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-706"><a href="#FisherMatrix-706"><span class="linenos"> 706</span></a><span class="sd">        names : dict-like</span>
</span><span id="FisherMatrix-707"><a href="#FisherMatrix-707"><span class="linenos"> 707</span></a><span class="sd">            a mapping (dictionary-like object) between the old names and the</span>
</span><span id="FisherMatrix-708"><a href="#FisherMatrix-708"><span class="linenos"> 708</span></a><span class="sd">            new ones. The values it maps to can either be a string (the new</span>
</span><span id="FisherMatrix-709"><a href="#FisherMatrix-709"><span class="linenos"> 709</span></a><span class="sd">            name), or a dict with keys `name`, `latex_name`, and `fiducial`</span>
</span><span id="FisherMatrix-710"><a href="#FisherMatrix-710"><span class="linenos"> 710</span></a><span class="sd">            (only `name` is mandatory).</span>
</span><span id="FisherMatrix-711"><a href="#FisherMatrix-711"><span class="linenos"> 711</span></a>
</span><span id="FisherMatrix-712"><a href="#FisherMatrix-712"><span class="linenos"> 712</span></a><span class="sd">        ignore_errors : bool, optional</span>
</span><span id="FisherMatrix-713"><a href="#FisherMatrix-713"><span class="linenos"> 713</span></a><span class="sd">            if set to True, will not raise an error if a parameter doesn&#39;t</span>
</span><span id="FisherMatrix-714"><a href="#FisherMatrix-714"><span class="linenos"> 714</span></a><span class="sd">            exist (default: False)</span>
</span><span id="FisherMatrix-715"><a href="#FisherMatrix-715"><span class="linenos"> 715</span></a>
</span><span id="FisherMatrix-716"><a href="#FisherMatrix-716"><span class="linenos"> 716</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-717"><a href="#FisherMatrix-717"><span class="linenos"> 717</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-718"><a href="#FisherMatrix-718"><span class="linenos"> 718</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix-719"><a href="#FisherMatrix-719"><span class="linenos"> 719</span></a><span class="sd">            the Fisher object with new names</span>
</span><span id="FisherMatrix-720"><a href="#FisherMatrix-720"><span class="linenos"> 720</span></a>
</span><span id="FisherMatrix-721"><a href="#FisherMatrix-721"><span class="linenos"> 721</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-722"><a href="#FisherMatrix-722"><span class="linenos"> 722</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-723"><a href="#FisherMatrix-723"><span class="linenos"> 723</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix-724"><a href="#FisherMatrix-724"><span class="linenos"> 724</span></a><span class="sd">        &gt;&gt;&gt; m.rename({&#39;p1&#39; : &#39;a&#39;, &#39;p2&#39; : dict(name=&#39;b&#39;, latex_name=&#39;$b$&#39;, fiducial=2)})</span>
</span><span id="FisherMatrix-725"><a href="#FisherMatrix-725"><span class="linenos"> 725</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-726"><a href="#FisherMatrix-726"><span class="linenos"> 726</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="FisherMatrix-727"><a href="#FisherMatrix-727"><span class="linenos"> 727</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix-728"><a href="#FisherMatrix-728"><span class="linenos"> 728</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix-729"><a href="#FisherMatrix-729"><span class="linenos"> 729</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-730"><a href="#FisherMatrix-730"><span class="linenos"> 730</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;$b$&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-731"><a href="#FisherMatrix-731"><span class="linenos"> 731</span></a><span class="sd">            fiducials=array([0., 2., 0.]))</span>
</span><span id="FisherMatrix-732"><a href="#FisherMatrix-732"><span class="linenos"> 732</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-733"><a href="#FisherMatrix-733"><span class="linenos"> 733</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_errors</span><span class="p">:</span>
</span><span id="FisherMatrix-734"><a href="#FisherMatrix-734"><span class="linenos"> 734</span></a>            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-735"><a href="#FisherMatrix-735"><span class="linenos"> 735</span></a>                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-736"><a href="#FisherMatrix-736"><span class="linenos"> 736</span></a>                    <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-737"><a href="#FisherMatrix-737"><span class="linenos"> 737</span></a>
</span><span id="FisherMatrix-738"><a href="#FisherMatrix-738"><span class="linenos"> 738</span></a>        <span class="n">names_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-739"><a href="#FisherMatrix-739"><span class="linenos"> 739</span></a>        <span class="n">latex_names_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix-740"><a href="#FisherMatrix-740"><span class="linenos"> 740</span></a>        <span class="n">fiducial_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix-741"><a href="#FisherMatrix-741"><span class="linenos"> 741</span></a>
</span><span id="FisherMatrix-742"><a href="#FisherMatrix-742"><span class="linenos"> 742</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="FisherMatrix-743"><a href="#FisherMatrix-743"><span class="linenos"> 743</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">names_new</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span>
</span><span id="FisherMatrix-744"><a href="#FisherMatrix-744"><span class="linenos"> 744</span></a>            <span class="c1"># it&#39;s a mapping</span>
</span><span id="FisherMatrix-745"><a href="#FisherMatrix-745"><span class="linenos"> 745</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
</span><span id="FisherMatrix-746"><a href="#FisherMatrix-746"><span class="linenos"> 746</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">_process_fisher_mapping</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="FisherMatrix-747"><a href="#FisherMatrix-747"><span class="linenos"> 747</span></a>                <span class="n">latex_names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;latex_name&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix-748"><a href="#FisherMatrix-748"><span class="linenos"> 748</span></a>                <span class="n">fiducial_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;fiducial&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix-749"><a href="#FisherMatrix-749"><span class="linenos"> 749</span></a>                <span class="n">names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix-750"><a href="#FisherMatrix-750"><span class="linenos"> 750</span></a>            <span class="c1"># otherwise, it&#39;s a string</span>
</span><span id="FisherMatrix-751"><a href="#FisherMatrix-751"><span class="linenos"> 751</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-752"><a href="#FisherMatrix-752"><span class="linenos"> 752</span></a>                <span class="n">names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix-753"><a href="#FisherMatrix-753"><span class="linenos"> 753</span></a>                <span class="n">latex_names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix-754"><a href="#FisherMatrix-754"><span class="linenos"> 754</span></a>
</span><span id="FisherMatrix-755"><a href="#FisherMatrix-755"><span class="linenos"> 755</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-756"><a href="#FisherMatrix-756"><span class="linenos"> 756</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-757"><a href="#FisherMatrix-757"><span class="linenos"> 757</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names_new</span><span class="p">,</span>
</span><span id="FisherMatrix-758"><a href="#FisherMatrix-758"><span class="linenos"> 758</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names_new</span><span class="p">,</span>
</span><span id="FisherMatrix-759"><a href="#FisherMatrix-759"><span class="linenos"> 759</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducial_new</span><span class="p">,</span>
</span><span id="FisherMatrix-760"><a href="#FisherMatrix-760"><span class="linenos"> 760</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-761"><a href="#FisherMatrix-761"><span class="linenos"> 761</span></a>
</span><span id="FisherMatrix-762"><a href="#FisherMatrix-762"><span class="linenos"> 762</span></a>    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-763"><a href="#FisherMatrix-763"><span class="linenos"> 763</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Representation of the Fisher object suitable for viewing in Jupyter notebook environments.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-764"><a href="#FisherMatrix-764"><span class="linenos"> 764</span></a>        <span class="n">header_matrix</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FisherMatrix-765"><a href="#FisherMatrix-765"><span class="linenos"> 765</span></a>            <span class="s2">&quot;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&quot;</span>
</span><span id="FisherMatrix-766"><a href="#FisherMatrix-766"><span class="linenos"> 766</span></a>            <span class="o">+</span> <span class="p">(</span>
</span><span id="FisherMatrix-767"><a href="#FisherMatrix-767"><span class="linenos"> 767</span></a>                <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="FisherMatrix-768"><a href="#FisherMatrix-768"><span class="linenos"> 768</span></a>                    <span class="p">[</span>
</span><span id="FisherMatrix-769"><a href="#FisherMatrix-769"><span class="linenos"> 769</span></a>                        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;th title=&quot;name = &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, fiducial = </span><span class="si">{</span><span class="n">fiducial</span><span class="si">}</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">latex_name</span><span class="si">}</span><span class="s2">&lt;/th&gt;&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-770"><a href="#FisherMatrix-770"><span class="linenos"> 770</span></a>                        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">fiducial</span><span class="p">,</span> <span class="n">latex_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="FisherMatrix-771"><a href="#FisherMatrix-771"><span class="linenos"> 771</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-772"><a href="#FisherMatrix-772"><span class="linenos"> 772</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-773"><a href="#FisherMatrix-773"><span class="linenos"> 773</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-774"><a href="#FisherMatrix-774"><span class="linenos"> 774</span></a>                        <span class="p">)</span>
</span><span id="FisherMatrix-775"><a href="#FisherMatrix-775"><span class="linenos"> 775</span></a>                    <span class="p">]</span>
</span><span id="FisherMatrix-776"><a href="#FisherMatrix-776"><span class="linenos"> 776</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-777"><a href="#FisherMatrix-777"><span class="linenos"> 777</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-778"><a href="#FisherMatrix-778"><span class="linenos"> 778</span></a>            <span class="o">+</span> <span class="s2">&quot;&lt;/tr&gt;&lt;/thead&gt;&quot;</span>
</span><span id="FisherMatrix-779"><a href="#FisherMatrix-779"><span class="linenos"> 779</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-780"><a href="#FisherMatrix-780"><span class="linenos"> 780</span></a>
</span><span id="FisherMatrix-781"><a href="#FisherMatrix-781"><span class="linenos"> 781</span></a>        <span class="n">body_matrix</span> <span class="o">=</span> <span class="s2">&quot;&lt;tbody&gt;&quot;</span>
</span><span id="FisherMatrix-782"><a href="#FisherMatrix-782"><span class="linenos"> 782</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">fiducial</span><span class="p">,</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">latex_name</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="FisherMatrix-783"><a href="#FisherMatrix-783"><span class="linenos"> 783</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-784"><a href="#FisherMatrix-784"><span class="linenos"> 784</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-785"><a href="#FisherMatrix-785"><span class="linenos"> 785</span></a>            <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">),</span>
</span><span id="FisherMatrix-786"><a href="#FisherMatrix-786"><span class="linenos"> 786</span></a>        <span class="p">):</span>
</span><span id="FisherMatrix-787"><a href="#FisherMatrix-787"><span class="linenos"> 787</span></a>            <span class="n">body_matrix</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="FisherMatrix-788"><a href="#FisherMatrix-788"><span class="linenos"> 788</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;tr&gt;&lt;th title=&quot;name = &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, fiducial = </span><span class="si">{</span><span class="n">fiducial</span><span class="si">}</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">latex_name</span><span class="si">}</span><span class="s2">&lt;/th&gt;&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-789"><a href="#FisherMatrix-789"><span class="linenos"> 789</span></a>                <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;&lt;td&gt;</span><span class="si">{:.3f}</span><span class="s2">&lt;/td&gt;&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]))</span>
</span><span id="FisherMatrix-790"><a href="#FisherMatrix-790"><span class="linenos"> 790</span></a>                <span class="o">+</span> <span class="s2">&quot;&lt;/tr&gt;&quot;</span>
</span><span id="FisherMatrix-791"><a href="#FisherMatrix-791"><span class="linenos"> 791</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-792"><a href="#FisherMatrix-792"><span class="linenos"> 792</span></a>        <span class="n">body_matrix</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/tbody&gt;&quot;</span>
</span><span id="FisherMatrix-793"><a href="#FisherMatrix-793"><span class="linenos"> 793</span></a>
</span><span id="FisherMatrix-794"><a href="#FisherMatrix-794"><span class="linenos"> 794</span></a>        <span class="n">html_matrix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;table&gt;</span><span class="si">{</span><span class="n">header_matrix</span><span class="si">}{</span><span class="n">body_matrix</span><span class="si">}</span><span class="s2">&lt;/table&gt;&quot;</span>
</span><span id="FisherMatrix-795"><a href="#FisherMatrix-795"><span class="linenos"> 795</span></a>
</span><span id="FisherMatrix-796"><a href="#FisherMatrix-796"><span class="linenos"> 796</span></a>        <span class="k">return</span> <span class="n">html_matrix</span>
</span><span id="FisherMatrix-797"><a href="#FisherMatrix-797"><span class="linenos"> 797</span></a>
</span><span id="FisherMatrix-798"><a href="#FisherMatrix-798"><span class="linenos"> 798</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-799"><a href="#FisherMatrix-799"><span class="linenos"> 799</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Representation of the Fisher object for non-Jupyter interfaces.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-800"><a href="#FisherMatrix-800"><span class="linenos"> 800</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="FisherMatrix-801"><a href="#FisherMatrix-801"><span class="linenos"> 801</span></a>            <span class="s2">&quot;FisherMatrix(</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-802"><a href="#FisherMatrix-802"><span class="linenos"> 802</span></a>            <span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-803"><a href="#FisherMatrix-803"><span class="linenos"> 803</span></a>            <span class="sa">f</span><span class="s2">&quot;    names=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-804"><a href="#FisherMatrix-804"><span class="linenos"> 804</span></a>            <span class="sa">f</span><span class="s2">&quot;    latex_names=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-805"><a href="#FisherMatrix-805"><span class="linenos"> 805</span></a>            <span class="sa">f</span><span class="s2">&quot;    fiducials=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="FisherMatrix-806"><a href="#FisherMatrix-806"><span class="linenos"> 806</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-807"><a href="#FisherMatrix-807"><span class="linenos"> 807</span></a>
</span><span id="FisherMatrix-808"><a href="#FisherMatrix-808"><span class="linenos"> 808</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-809"><a href="#FisherMatrix-809"><span class="linenos"> 809</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Representation of the Fisher object as a string.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-810"><a href="#FisherMatrix-810"><span class="linenos"> 810</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="FisherMatrix-811"><a href="#FisherMatrix-811"><span class="linenos"> 811</span></a>            <span class="s2">&quot;FisherMatrix(</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-812"><a href="#FisherMatrix-812"><span class="linenos"> 812</span></a>            <span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-813"><a href="#FisherMatrix-813"><span class="linenos"> 813</span></a>            <span class="sa">f</span><span class="s2">&quot;    names=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-814"><a href="#FisherMatrix-814"><span class="linenos"> 814</span></a>            <span class="sa">f</span><span class="s2">&quot;    latex_names=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-815"><a href="#FisherMatrix-815"><span class="linenos"> 815</span></a>            <span class="sa">f</span><span class="s2">&quot;    fiducials=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="FisherMatrix-816"><a href="#FisherMatrix-816"><span class="linenos"> 816</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-817"><a href="#FisherMatrix-817"><span class="linenos"> 817</span></a>
</span><span id="FisherMatrix-818"><a href="#FisherMatrix-818"><span class="linenos"> 818</span></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-819"><a href="#FisherMatrix-819"><span class="linenos"> 819</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-820"><a href="#FisherMatrix-820"><span class="linenos"> 820</span></a><span class="sd">        Iterate over the Fisher object.</span>
</span><span id="FisherMatrix-821"><a href="#FisherMatrix-821"><span class="linenos"> 821</span></a>
</span><span id="FisherMatrix-822"><a href="#FisherMatrix-822"><span class="linenos"> 822</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-823"><a href="#FisherMatrix-823"><span class="linenos"> 823</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-824"><a href="#FisherMatrix-824"><span class="linenos"> 824</span></a><span class="sd">        NotImplementedError</span>
</span><span id="FisherMatrix-825"><a href="#FisherMatrix-825"><span class="linenos"> 825</span></a><span class="sd">            always raised as iteration should be performed using `__getitem__`</span>
</span><span id="FisherMatrix-826"><a href="#FisherMatrix-826"><span class="linenos"> 826</span></a><span class="sd">            instead</span>
</span><span id="FisherMatrix-827"><a href="#FisherMatrix-827"><span class="linenos"> 827</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-828"><a href="#FisherMatrix-828"><span class="linenos"> 828</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="FisherMatrix-829"><a href="#FisherMatrix-829"><span class="linenos"> 829</span></a>            <span class="sa">f</span><span class="s2">&quot;Object of type `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">` is not iterable; &quot;</span>
</span><span id="FisherMatrix-830"><a href="#FisherMatrix-830"><span class="linenos"> 830</span></a>            <span class="s2">&quot;use `&lt;object&gt;[&lt;key&gt;]` to get or set elements of the object instead&quot;</span>
</span><span id="FisherMatrix-831"><a href="#FisherMatrix-831"><span class="linenos"> 831</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-832"><a href="#FisherMatrix-832"><span class="linenos"> 832</span></a>
</span><span id="FisherMatrix-833"><a href="#FisherMatrix-833"><span class="linenos"> 833</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span>
</span><span id="FisherMatrix-834"><a href="#FisherMatrix-834"><span class="linenos"> 834</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-835"><a href="#FisherMatrix-835"><span class="linenos"> 835</span></a>        <span class="n">keys</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">slice</span><span class="p">],</span>
</span><span id="FisherMatrix-836"><a href="#FisherMatrix-836"><span class="linenos"> 836</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-837"><a href="#FisherMatrix-837"><span class="linenos"> 837</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-838"><a href="#FisherMatrix-838"><span class="linenos"> 838</span></a><span class="sd">        Implement access to elements in the Fisher object.</span>
</span><span id="FisherMatrix-839"><a href="#FisherMatrix-839"><span class="linenos"> 839</span></a>
</span><span id="FisherMatrix-840"><a href="#FisherMatrix-840"><span class="linenos"> 840</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-841"><a href="#FisherMatrix-841"><span class="linenos"> 841</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-842"><a href="#FisherMatrix-842"><span class="linenos"> 842</span></a><span class="sd">        Has support for slicing.</span>
</span><span id="FisherMatrix-843"><a href="#FisherMatrix-843"><span class="linenos"> 843</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-844"><a href="#FisherMatrix-844"><span class="linenos"> 844</span></a>        <span class="c1"># the object can be sliced</span>
</span><span id="FisherMatrix-845"><a href="#FisherMatrix-845"><span class="linenos"> 845</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="FisherMatrix-846"><a href="#FisherMatrix-846"><span class="linenos"> 846</span></a>            <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="FisherMatrix-847"><a href="#FisherMatrix-847"><span class="linenos"> 847</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">),)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span>
</span><span id="FisherMatrix-848"><a href="#FisherMatrix-848"><span class="linenos"> 848</span></a>            <span class="n">sl</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
</span><span id="FisherMatrix-849"><a href="#FisherMatrix-849"><span class="linenos"> 849</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="FisherMatrix-850"><a href="#FisherMatrix-850"><span class="linenos"> 850</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
</span><span id="FisherMatrix-851"><a href="#FisherMatrix-851"><span class="linenos"> 851</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
</span><span id="FisherMatrix-852"><a href="#FisherMatrix-852"><span class="linenos"> 852</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
</span><span id="FisherMatrix-853"><a href="#FisherMatrix-853"><span class="linenos"> 853</span></a>
</span><span id="FisherMatrix-854"><a href="#FisherMatrix-854"><span class="linenos"> 854</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-855"><a href="#FisherMatrix-855"><span class="linenos"> 855</span></a>                <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-856"><a href="#FisherMatrix-856"><span class="linenos"> 856</span></a>                <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-857"><a href="#FisherMatrix-857"><span class="linenos"> 857</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-858"><a href="#FisherMatrix-858"><span class="linenos"> 858</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-859"><a href="#FisherMatrix-859"><span class="linenos"> 859</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-860"><a href="#FisherMatrix-860"><span class="linenos"> 860</span></a>
</span><span id="FisherMatrix-861"><a href="#FisherMatrix-861"><span class="linenos"> 861</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FisherMatrix-862"><a href="#FisherMatrix-862"><span class="linenos"> 862</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</span><span id="FisherMatrix-863"><a href="#FisherMatrix-863"><span class="linenos"> 863</span></a>        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="FisherMatrix-864"><a href="#FisherMatrix-864"><span class="linenos"> 864</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="FisherMatrix-865"><a href="#FisherMatrix-865"><span class="linenos"> 865</span></a>
</span><span id="FisherMatrix-866"><a href="#FisherMatrix-866"><span class="linenos"> 866</span></a>        <span class="c1"># the keys can be a tuple</span>
</span><span id="FisherMatrix-867"><a href="#FisherMatrix-867"><span class="linenos"> 867</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="FisherMatrix-868"><a href="#FisherMatrix-868"><span class="linenos"> 868</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="FisherMatrix-869"><a href="#FisherMatrix-869"><span class="linenos"> 869</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> arguments, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-870"><a href="#FisherMatrix-870"><span class="linenos"> 870</span></a>
</span><span id="FisherMatrix-871"><a href="#FisherMatrix-871"><span class="linenos"> 871</span></a>            <span class="c1"># error checking</span>
</span><span id="FisherMatrix-872"><a href="#FisherMatrix-872"><span class="linenos"> 872</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="FisherMatrix-873"><a href="#FisherMatrix-873"><span class="linenos"> 873</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-874"><a href="#FisherMatrix-874"><span class="linenos"> 874</span></a>                    <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-875"><a href="#FisherMatrix-875"><span class="linenos"> 875</span></a>
</span><span id="FisherMatrix-876"><a href="#FisherMatrix-876"><span class="linenos"> 876</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
</span><span id="FisherMatrix-877"><a href="#FisherMatrix-877"><span class="linenos"> 877</span></a>
</span><span id="FisherMatrix-878"><a href="#FisherMatrix-878"><span class="linenos"> 878</span></a>        <span class="c1"># otherwise, it&#39;s some generic object</span>
</span><span id="FisherMatrix-879"><a href="#FisherMatrix-879"><span class="linenos"> 879</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-880"><a href="#FisherMatrix-880"><span class="linenos"> 880</span></a>            <span class="k">if</span> <span class="n">keys</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-881"><a href="#FisherMatrix-881"><span class="linenos"> 881</span></a>                <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-882"><a href="#FisherMatrix-882"><span class="linenos"> 882</span></a>
</span><span id="FisherMatrix-883"><a href="#FisherMatrix-883"><span class="linenos"> 883</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">keys</span><span class="p">),)</span>
</span><span id="FisherMatrix-884"><a href="#FisherMatrix-884"><span class="linenos"> 884</span></a>
</span><span id="FisherMatrix-885"><a href="#FisherMatrix-885"><span class="linenos"> 885</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">indices</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix-886"><a href="#FisherMatrix-886"><span class="linenos"> 886</span></a>
</span><span id="FisherMatrix-887"><a href="#FisherMatrix-887"><span class="linenos"> 887</span></a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span>
</span><span id="FisherMatrix-888"><a href="#FisherMatrix-888"><span class="linenos"> 888</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-889"><a href="#FisherMatrix-889"><span class="linenos"> 889</span></a>        <span class="n">keys</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="FisherMatrix-890"><a href="#FisherMatrix-890"><span class="linenos"> 890</span></a>        <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="FisherMatrix-891"><a href="#FisherMatrix-891"><span class="linenos"> 891</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-892"><a href="#FisherMatrix-892"><span class="linenos"> 892</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-893"><a href="#FisherMatrix-893"><span class="linenos"> 893</span></a><span class="sd">        Implement setting of elements in the Fisher object.</span>
</span><span id="FisherMatrix-894"><a href="#FisherMatrix-894"><span class="linenos"> 894</span></a>
</span><span id="FisherMatrix-895"><a href="#FisherMatrix-895"><span class="linenos"> 895</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-896"><a href="#FisherMatrix-896"><span class="linenos"> 896</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-897"><a href="#FisherMatrix-897"><span class="linenos"> 897</span></a><span class="sd">        TypeError</span>
</span><span id="FisherMatrix-898"><a href="#FisherMatrix-898"><span class="linenos"> 898</span></a><span class="sd">            if keys are not a tuple, or if `value` is not a number</span>
</span><span id="FisherMatrix-899"><a href="#FisherMatrix-899"><span class="linenos"> 899</span></a>
</span><span id="FisherMatrix-900"><a href="#FisherMatrix-900"><span class="linenos"> 900</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="FisherMatrix-901"><a href="#FisherMatrix-901"><span class="linenos"> 901</span></a><span class="sd">            if the size of keys are not equal to the dimensionality of the</span>
</span><span id="FisherMatrix-902"><a href="#FisherMatrix-902"><span class="linenos"> 902</span></a><span class="sd">            Fisher object</span>
</span><span id="FisherMatrix-903"><a href="#FisherMatrix-903"><span class="linenos"> 903</span></a>
</span><span id="FisherMatrix-904"><a href="#FisherMatrix-904"><span class="linenos"> 904</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix-905"><a href="#FisherMatrix-905"><span class="linenos"> 905</span></a><span class="sd">            if any of the keys is not in the parameter names</span>
</span><span id="FisherMatrix-906"><a href="#FisherMatrix-906"><span class="linenos"> 906</span></a>
</span><span id="FisherMatrix-907"><a href="#FisherMatrix-907"><span class="linenos"> 907</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-908"><a href="#FisherMatrix-908"><span class="linenos"> 908</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-909"><a href="#FisherMatrix-909"><span class="linenos"> 909</span></a><span class="sd">        Does not support slicing.</span>
</span><span id="FisherMatrix-910"><a href="#FisherMatrix-910"><span class="linenos"> 910</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-911"><a href="#FisherMatrix-911"><span class="linenos"> 911</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FisherMatrix-912"><a href="#FisherMatrix-912"><span class="linenos"> 912</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</span><span id="FisherMatrix-913"><a href="#FisherMatrix-913"><span class="linenos"> 913</span></a>        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="FisherMatrix-914"><a href="#FisherMatrix-914"><span class="linenos"> 914</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="FisherMatrix-915"><a href="#FisherMatrix-915"><span class="linenos"> 915</span></a>
</span><span id="FisherMatrix-916"><a href="#FisherMatrix-916"><span class="linenos"> 916</span></a>        <span class="c1"># the above fails for strings (since they are iterable), so we do an</span>
</span><span id="FisherMatrix-917"><a href="#FisherMatrix-917"><span class="linenos"> 917</span></a>        <span class="c1"># explicit check here</span>
</span><span id="FisherMatrix-918"><a href="#FisherMatrix-918"><span class="linenos"> 918</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FisherMatrix-919"><a href="#FisherMatrix-919"><span class="linenos"> 919</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</span><span id="FisherMatrix-920"><a href="#FisherMatrix-920"><span class="linenos"> 920</span></a>
</span><span id="FisherMatrix-921"><a href="#FisherMatrix-921"><span class="linenos"> 921</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="FisherMatrix-922"><a href="#FisherMatrix-922"><span class="linenos"> 922</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</span><span id="FisherMatrix-923"><a href="#FisherMatrix-923"><span class="linenos"> 923</span></a>
</span><span id="FisherMatrix-924"><a href="#FisherMatrix-924"><span class="linenos"> 924</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="FisherMatrix-925"><a href="#FisherMatrix-925"><span class="linenos"> 925</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> is not a number&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-926"><a href="#FisherMatrix-926"><span class="linenos"> 926</span></a>
</span><span id="FisherMatrix-927"><a href="#FisherMatrix-927"><span class="linenos"> 927</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="FisherMatrix-928"><a href="#FisherMatrix-928"><span class="linenos"> 928</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-929"><a href="#FisherMatrix-929"><span class="linenos"> 929</span></a>                <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-930"><a href="#FisherMatrix-930"><span class="linenos"> 930</span></a>
</span><span id="FisherMatrix-931"><a href="#FisherMatrix-931"><span class="linenos"> 931</span></a>        <span class="c1"># automatically raises a value error</span>
</span><span id="FisherMatrix-932"><a href="#FisherMatrix-932"><span class="linenos"> 932</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
</span><span id="FisherMatrix-933"><a href="#FisherMatrix-933"><span class="linenos"> 933</span></a>
</span><span id="FisherMatrix-934"><a href="#FisherMatrix-934"><span class="linenos"> 934</span></a>        <span class="n">temp_data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="FisherMatrix-935"><a href="#FisherMatrix-935"><span class="linenos"> 935</span></a>
</span><span id="FisherMatrix-936"><a href="#FisherMatrix-936"><span class="linenos"> 936</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">):</span>
</span><span id="FisherMatrix-937"><a href="#FisherMatrix-937"><span class="linenos"> 937</span></a>            <span class="k">for</span> <span class="n">permutation</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">permutations</span><span class="p">(</span><span class="n">indices</span><span class="p">)):</span>
</span><span id="FisherMatrix-938"><a href="#FisherMatrix-938"><span class="linenos"> 938</span></a>                <span class="c1"># update all symmetric parts</span>
</span><span id="FisherMatrix-939"><a href="#FisherMatrix-939"><span class="linenos"> 939</span></a>                <span class="n">temp_data</span><span class="p">[</span><span class="n">permutation</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix-940"><a href="#FisherMatrix-940"><span class="linenos"> 940</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-941"><a href="#FisherMatrix-941"><span class="linenos"> 941</span></a>            <span class="n">temp_data</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix-942"><a href="#FisherMatrix-942"><span class="linenos"> 942</span></a>
</span><span id="FisherMatrix-943"><a href="#FisherMatrix-943"><span class="linenos"> 943</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span>
</span><span id="FisherMatrix-944"><a href="#FisherMatrix-944"><span class="linenos"> 944</span></a>
</span><span id="FisherMatrix-945"><a href="#FisherMatrix-945"><span class="linenos"> 945</span></a>    <span class="k">def</span> <span class="nf">fiducial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="FisherMatrix-946"><a href="#FisherMatrix-946"><span class="linenos"> 946</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-947"><a href="#FisherMatrix-947"><span class="linenos"> 947</span></a><span class="sd">        Return the value of the fiducial associated to the parameter `name`.</span>
</span><span id="FisherMatrix-948"><a href="#FisherMatrix-948"><span class="linenos"> 948</span></a>
</span><span id="FisherMatrix-949"><a href="#FisherMatrix-949"><span class="linenos"> 949</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-950"><a href="#FisherMatrix-950"><span class="linenos"> 950</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-951"><a href="#FisherMatrix-951"><span class="linenos"> 951</span></a><span class="sd">        name : str</span>
</span><span id="FisherMatrix-952"><a href="#FisherMatrix-952"><span class="linenos"> 952</span></a><span class="sd">            the name of the parameter</span>
</span><span id="FisherMatrix-953"><a href="#FisherMatrix-953"><span class="linenos"> 953</span></a>
</span><span id="FisherMatrix-954"><a href="#FisherMatrix-954"><span class="linenos"> 954</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-955"><a href="#FisherMatrix-955"><span class="linenos"> 955</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-956"><a href="#FisherMatrix-956"><span class="linenos"> 956</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix-957"><a href="#FisherMatrix-957"><span class="linenos"> 957</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="FisherMatrix-958"><a href="#FisherMatrix-958"><span class="linenos"> 958</span></a>
</span><span id="FisherMatrix-959"><a href="#FisherMatrix-959"><span class="linenos"> 959</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-960"><a href="#FisherMatrix-960"><span class="linenos"> 960</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-961"><a href="#FisherMatrix-961"><span class="linenos"> 961</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="FisherMatrix-962"><a href="#FisherMatrix-962"><span class="linenos"> 962</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix-963"><a href="#FisherMatrix-963"><span class="linenos"> 963</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], fiducials=[2, 3])</span>
</span><span id="FisherMatrix-964"><a href="#FisherMatrix-964"><span class="linenos"> 964</span></a>
</span><span id="FisherMatrix-965"><a href="#FisherMatrix-965"><span class="linenos"> 965</span></a><span class="sd">        Get the value of the fiducial associated to parameter `b`:</span>
</span><span id="FisherMatrix-966"><a href="#FisherMatrix-966"><span class="linenos"> 966</span></a><span class="sd">        &gt;&gt;&gt; fm.fiducial(&#39;b&#39;)</span>
</span><span id="FisherMatrix-967"><a href="#FisherMatrix-967"><span class="linenos"> 967</span></a><span class="sd">        3.0</span>
</span><span id="FisherMatrix-968"><a href="#FisherMatrix-968"><span class="linenos"> 968</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-969"><a href="#FisherMatrix-969"><span class="linenos"> 969</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-970"><a href="#FisherMatrix-970"><span class="linenos"> 970</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-971"><a href="#FisherMatrix-971"><span class="linenos"> 971</span></a>
</span><span id="FisherMatrix-972"><a href="#FisherMatrix-972"><span class="linenos"> 972</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix-973"><a href="#FisherMatrix-973"><span class="linenos"> 973</span></a>
</span><span id="FisherMatrix-974"><a href="#FisherMatrix-974"><span class="linenos"> 974</span></a>    <span class="k">def</span> <span class="nf">set_fiducial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="FisherMatrix-975"><a href="#FisherMatrix-975"><span class="linenos"> 975</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-976"><a href="#FisherMatrix-976"><span class="linenos"> 976</span></a><span class="sd">        Set the fiducial of parameter `name`.</span>
</span><span id="FisherMatrix-977"><a href="#FisherMatrix-977"><span class="linenos"> 977</span></a>
</span><span id="FisherMatrix-978"><a href="#FisherMatrix-978"><span class="linenos"> 978</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-979"><a href="#FisherMatrix-979"><span class="linenos"> 979</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-980"><a href="#FisherMatrix-980"><span class="linenos"> 980</span></a><span class="sd">        name : str</span>
</span><span id="FisherMatrix-981"><a href="#FisherMatrix-981"><span class="linenos"> 981</span></a><span class="sd">            the name of the parameter</span>
</span><span id="FisherMatrix-982"><a href="#FisherMatrix-982"><span class="linenos"> 982</span></a>
</span><span id="FisherMatrix-983"><a href="#FisherMatrix-983"><span class="linenos"> 983</span></a><span class="sd">        value : float</span>
</span><span id="FisherMatrix-984"><a href="#FisherMatrix-984"><span class="linenos"> 984</span></a><span class="sd">            the new fiducial value of the parameter</span>
</span><span id="FisherMatrix-985"><a href="#FisherMatrix-985"><span class="linenos"> 985</span></a>
</span><span id="FisherMatrix-986"><a href="#FisherMatrix-986"><span class="linenos"> 986</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-987"><a href="#FisherMatrix-987"><span class="linenos"> 987</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-988"><a href="#FisherMatrix-988"><span class="linenos"> 988</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix-989"><a href="#FisherMatrix-989"><span class="linenos"> 989</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="FisherMatrix-990"><a href="#FisherMatrix-990"><span class="linenos"> 990</span></a>
</span><span id="FisherMatrix-991"><a href="#FisherMatrix-991"><span class="linenos"> 991</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-992"><a href="#FisherMatrix-992"><span class="linenos"> 992</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-993"><a href="#FisherMatrix-993"><span class="linenos"> 993</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="FisherMatrix-994"><a href="#FisherMatrix-994"><span class="linenos"> 994</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix-995"><a href="#FisherMatrix-995"><span class="linenos"> 995</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], fiducials=[2, 3])</span>
</span><span id="FisherMatrix-996"><a href="#FisherMatrix-996"><span class="linenos"> 996</span></a>
</span><span id="FisherMatrix-997"><a href="#FisherMatrix-997"><span class="linenos"> 997</span></a><span class="sd">        Set the value of the fiducial associated to parameter `b`:</span>
</span><span id="FisherMatrix-998"><a href="#FisherMatrix-998"><span class="linenos"> 998</span></a><span class="sd">        &gt;&gt;&gt; fm.set_fiducial(&#39;b&#39;, 4)</span>
</span><span id="FisherMatrix-999"><a href="#FisherMatrix-999"><span class="linenos"> 999</span></a><span class="sd">        &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix-1000"><a href="#FisherMatrix-1000"><span class="linenos">1000</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1001"><a href="#FisherMatrix-1001"><span class="linenos">1001</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix-1002"><a href="#FisherMatrix-1002"><span class="linenos">1002</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix-1003"><a href="#FisherMatrix-1003"><span class="linenos">1003</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1004"><a href="#FisherMatrix-1004"><span class="linenos">1004</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1005"><a href="#FisherMatrix-1005"><span class="linenos">1005</span></a><span class="sd">            fiducials=array([2., 4.]))</span>
</span><span id="FisherMatrix-1006"><a href="#FisherMatrix-1006"><span class="linenos">1006</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1007"><a href="#FisherMatrix-1007"><span class="linenos">1007</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-1008"><a href="#FisherMatrix-1008"><span class="linenos">1008</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1009"><a href="#FisherMatrix-1009"><span class="linenos">1009</span></a>
</span><span id="FisherMatrix-1010"><a href="#FisherMatrix-1010"><span class="linenos">1010</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix-1011"><a href="#FisherMatrix-1011"><span class="linenos">1011</span></a>
</span><span id="FisherMatrix-1012"><a href="#FisherMatrix-1012"><span class="linenos">1012</span></a>    <span class="k">def</span> <span class="nf">latex_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="FisherMatrix-1013"><a href="#FisherMatrix-1013"><span class="linenos">1013</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1014"><a href="#FisherMatrix-1014"><span class="linenos">1014</span></a><span class="sd">        Return the LaTeX name associated to the parameter `name`.</span>
</span><span id="FisherMatrix-1015"><a href="#FisherMatrix-1015"><span class="linenos">1015</span></a>
</span><span id="FisherMatrix-1016"><a href="#FisherMatrix-1016"><span class="linenos">1016</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1017"><a href="#FisherMatrix-1017"><span class="linenos">1017</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1018"><a href="#FisherMatrix-1018"><span class="linenos">1018</span></a><span class="sd">        name : str</span>
</span><span id="FisherMatrix-1019"><a href="#FisherMatrix-1019"><span class="linenos">1019</span></a><span class="sd">            the name of the parameter</span>
</span><span id="FisherMatrix-1020"><a href="#FisherMatrix-1020"><span class="linenos">1020</span></a>
</span><span id="FisherMatrix-1021"><a href="#FisherMatrix-1021"><span class="linenos">1021</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-1022"><a href="#FisherMatrix-1022"><span class="linenos">1022</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-1023"><a href="#FisherMatrix-1023"><span class="linenos">1023</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix-1024"><a href="#FisherMatrix-1024"><span class="linenos">1024</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="FisherMatrix-1025"><a href="#FisherMatrix-1025"><span class="linenos">1025</span></a>
</span><span id="FisherMatrix-1026"><a href="#FisherMatrix-1026"><span class="linenos">1026</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1027"><a href="#FisherMatrix-1027"><span class="linenos">1027</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1028"><a href="#FisherMatrix-1028"><span class="linenos">1028</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="FisherMatrix-1029"><a href="#FisherMatrix-1029"><span class="linenos">1029</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix-1030"><a href="#FisherMatrix-1030"><span class="linenos">1030</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], latex_names=[r&#39;$\mathbf{A}$&#39;, r&#39;$\mathbf{B}$&#39;])</span>
</span><span id="FisherMatrix-1031"><a href="#FisherMatrix-1031"><span class="linenos">1031</span></a>
</span><span id="FisherMatrix-1032"><a href="#FisherMatrix-1032"><span class="linenos">1032</span></a><span class="sd">        Get the LaTeX name associated to parameter `b`:</span>
</span><span id="FisherMatrix-1033"><a href="#FisherMatrix-1033"><span class="linenos">1033</span></a><span class="sd">        &gt;&gt;&gt; fm.latex_name(&#39;b&#39;)</span>
</span><span id="FisherMatrix-1034"><a href="#FisherMatrix-1034"><span class="linenos">1034</span></a><span class="sd">        &#39;$\\mathbf{B}$&#39;</span>
</span><span id="FisherMatrix-1035"><a href="#FisherMatrix-1035"><span class="linenos">1035</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1036"><a href="#FisherMatrix-1036"><span class="linenos">1036</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-1037"><a href="#FisherMatrix-1037"><span class="linenos">1037</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1038"><a href="#FisherMatrix-1038"><span class="linenos">1038</span></a>
</span><span id="FisherMatrix-1039"><a href="#FisherMatrix-1039"><span class="linenos">1039</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix-1040"><a href="#FisherMatrix-1040"><span class="linenos">1040</span></a>
</span><span id="FisherMatrix-1041"><a href="#FisherMatrix-1041"><span class="linenos">1041</span></a>    <span class="k">def</span> <span class="nf">set_latex_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FisherMatrix-1042"><a href="#FisherMatrix-1042"><span class="linenos">1042</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1043"><a href="#FisherMatrix-1043"><span class="linenos">1043</span></a><span class="sd">        Set the LaTeX name of parameter `name`.</span>
</span><span id="FisherMatrix-1044"><a href="#FisherMatrix-1044"><span class="linenos">1044</span></a>
</span><span id="FisherMatrix-1045"><a href="#FisherMatrix-1045"><span class="linenos">1045</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1046"><a href="#FisherMatrix-1046"><span class="linenos">1046</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1047"><a href="#FisherMatrix-1047"><span class="linenos">1047</span></a><span class="sd">        name : str</span>
</span><span id="FisherMatrix-1048"><a href="#FisherMatrix-1048"><span class="linenos">1048</span></a><span class="sd">            the name of the parameter</span>
</span><span id="FisherMatrix-1049"><a href="#FisherMatrix-1049"><span class="linenos">1049</span></a>
</span><span id="FisherMatrix-1050"><a href="#FisherMatrix-1050"><span class="linenos">1050</span></a><span class="sd">        value : str</span>
</span><span id="FisherMatrix-1051"><a href="#FisherMatrix-1051"><span class="linenos">1051</span></a><span class="sd">            the new LaTeX name of the parameter</span>
</span><span id="FisherMatrix-1052"><a href="#FisherMatrix-1052"><span class="linenos">1052</span></a>
</span><span id="FisherMatrix-1053"><a href="#FisherMatrix-1053"><span class="linenos">1053</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-1054"><a href="#FisherMatrix-1054"><span class="linenos">1054</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-1055"><a href="#FisherMatrix-1055"><span class="linenos">1055</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix-1056"><a href="#FisherMatrix-1056"><span class="linenos">1056</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="FisherMatrix-1057"><a href="#FisherMatrix-1057"><span class="linenos">1057</span></a>
</span><span id="FisherMatrix-1058"><a href="#FisherMatrix-1058"><span class="linenos">1058</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1059"><a href="#FisherMatrix-1059"><span class="linenos">1059</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1060"><a href="#FisherMatrix-1060"><span class="linenos">1060</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="FisherMatrix-1061"><a href="#FisherMatrix-1061"><span class="linenos">1061</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix-1062"><a href="#FisherMatrix-1062"><span class="linenos">1062</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], fiducials=[2, 3])</span>
</span><span id="FisherMatrix-1063"><a href="#FisherMatrix-1063"><span class="linenos">1063</span></a>
</span><span id="FisherMatrix-1064"><a href="#FisherMatrix-1064"><span class="linenos">1064</span></a><span class="sd">        Set the value of the fiducial associated to parameter `b`:</span>
</span><span id="FisherMatrix-1065"><a href="#FisherMatrix-1065"><span class="linenos">1065</span></a><span class="sd">        &gt;&gt;&gt; fm.set_latex_name(&#39;b&#39;, r&#39;$\mathcal{B}$&#39;)</span>
</span><span id="FisherMatrix-1066"><a href="#FisherMatrix-1066"><span class="linenos">1066</span></a><span class="sd">        &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix-1067"><a href="#FisherMatrix-1067"><span class="linenos">1067</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1068"><a href="#FisherMatrix-1068"><span class="linenos">1068</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix-1069"><a href="#FisherMatrix-1069"><span class="linenos">1069</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix-1070"><a href="#FisherMatrix-1070"><span class="linenos">1070</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1071"><a href="#FisherMatrix-1071"><span class="linenos">1071</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;$\\mathcal{B}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1072"><a href="#FisherMatrix-1072"><span class="linenos">1072</span></a><span class="sd">            fiducials=array([2., 3.]))</span>
</span><span id="FisherMatrix-1073"><a href="#FisherMatrix-1073"><span class="linenos">1073</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1074"><a href="#FisherMatrix-1074"><span class="linenos">1074</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-1075"><a href="#FisherMatrix-1075"><span class="linenos">1075</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1076"><a href="#FisherMatrix-1076"><span class="linenos">1076</span></a>
</span><span id="FisherMatrix-1077"><a href="#FisherMatrix-1077"><span class="linenos">1077</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix-1078"><a href="#FisherMatrix-1078"><span class="linenos">1078</span></a>
</span><span id="FisherMatrix-1079"><a href="#FisherMatrix-1079"><span class="linenos">1079</span></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-1080"><a href="#FisherMatrix-1080"><span class="linenos">1080</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1081"><a href="#FisherMatrix-1081"><span class="linenos">1081</span></a><span class="sd">        Check whether the values make a valid Fisher object.</span>
</span><span id="FisherMatrix-1082"><a href="#FisherMatrix-1082"><span class="linenos">1082</span></a>
</span><span id="FisherMatrix-1083"><a href="#FisherMatrix-1083"><span class="linenos">1083</span></a><span class="sd">        A (square) matrix is a Fisher matrix if it satisifies the following two</span>
</span><span id="FisherMatrix-1084"><a href="#FisherMatrix-1084"><span class="linenos">1084</span></a><span class="sd">        criteria:</span>
</span><span id="FisherMatrix-1085"><a href="#FisherMatrix-1085"><span class="linenos">1085</span></a>
</span><span id="FisherMatrix-1086"><a href="#FisherMatrix-1086"><span class="linenos">1086</span></a><span class="sd">        * it is symmetric</span>
</span><span id="FisherMatrix-1087"><a href="#FisherMatrix-1087"><span class="linenos">1087</span></a><span class="sd">        * it is positive semi-definite</span>
</span><span id="FisherMatrix-1088"><a href="#FisherMatrix-1088"><span class="linenos">1088</span></a>
</span><span id="FisherMatrix-1089"><a href="#FisherMatrix-1089"><span class="linenos">1089</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1090"><a href="#FisherMatrix-1090"><span class="linenos">1090</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1091"><a href="#FisherMatrix-1091"><span class="linenos">1091</span></a><span class="sd">        bool</span>
</span><span id="FisherMatrix-1092"><a href="#FisherMatrix-1092"><span class="linenos">1092</span></a><span class="sd">            Whether or nor the Fisher object is valid.</span>
</span><span id="FisherMatrix-1093"><a href="#FisherMatrix-1093"><span class="linenos">1093</span></a>
</span><span id="FisherMatrix-1094"><a href="#FisherMatrix-1094"><span class="linenos">1094</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1095"><a href="#FisherMatrix-1095"><span class="linenos">1095</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1096"><a href="#FisherMatrix-1096"><span class="linenos">1096</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix-1097"><a href="#FisherMatrix-1097"><span class="linenos">1097</span></a><span class="sd">        &gt;&gt;&gt; m.is_valid()</span>
</span><span id="FisherMatrix-1098"><a href="#FisherMatrix-1098"><span class="linenos">1098</span></a><span class="sd">        True</span>
</span><span id="FisherMatrix-1099"><a href="#FisherMatrix-1099"><span class="linenos">1099</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([-1, 3])).is_valid()</span>
</span><span id="FisherMatrix-1100"><a href="#FisherMatrix-1100"><span class="linenos">1100</span></a><span class="sd">        False</span>
</span><span id="FisherMatrix-1101"><a href="#FisherMatrix-1101"><span class="linenos">1101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1102"><a href="#FisherMatrix-1102"><span class="linenos">1102</span></a>        <span class="k">return</span> <span class="n">is_symmetric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_positive_semidefinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-1103"><a href="#FisherMatrix-1103"><span class="linenos">1103</span></a>
</span><span id="FisherMatrix-1104"><a href="#FisherMatrix-1104"><span class="linenos">1104</span></a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span>
</span><span id="FisherMatrix-1105"><a href="#FisherMatrix-1105"><span class="linenos">1105</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1106"><a href="#FisherMatrix-1106"><span class="linenos">1106</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-1107"><a href="#FisherMatrix-1107"><span class="linenos">1107</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1108"><a href="#FisherMatrix-1108"><span class="linenos">1108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1109"><a href="#FisherMatrix-1109"><span class="linenos">1109</span></a><span class="sd">        Sort the Fisher object by name according to some criterion.</span>
</span><span id="FisherMatrix-1110"><a href="#FisherMatrix-1110"><span class="linenos">1110</span></a>
</span><span id="FisherMatrix-1111"><a href="#FisherMatrix-1111"><span class="linenos">1111</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1112"><a href="#FisherMatrix-1112"><span class="linenos">1112</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1113"><a href="#FisherMatrix-1113"><span class="linenos">1113</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix-1114"><a href="#FisherMatrix-1114"><span class="linenos">1114</span></a><span class="sd">            all of the other keyword arguments for the Python builtin &lt;a</span>
</span><span id="FisherMatrix-1115"><a href="#FisherMatrix-1115"><span class="linenos">1115</span></a><span class="sd">            href=&quot;https://docs.python.org/3/library/functions.html#sorted&quot;</span>
</span><span id="FisherMatrix-1116"><a href="#FisherMatrix-1116"><span class="linenos">1116</span></a><span class="sd">            target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;`sorted`&lt;/a&gt;.</span>
</span><span id="FisherMatrix-1117"><a href="#FisherMatrix-1117"><span class="linenos">1117</span></a><span class="sd">            If none are specified, will sort according to the names of the parameters.</span>
</span><span id="FisherMatrix-1118"><a href="#FisherMatrix-1118"><span class="linenos">1118</span></a><span class="sd">            In the special case that the value of the keyword `key` is set to</span>
</span><span id="FisherMatrix-1119"><a href="#FisherMatrix-1119"><span class="linenos">1119</span></a><span class="sd">            either `&#39;fiducials&#39;` or `&#39;latex_names&#39;`, it will sort according to those.</span>
</span><span id="FisherMatrix-1120"><a href="#FisherMatrix-1120"><span class="linenos">1120</span></a><span class="sd">            In the second special case that the value of the keyword `key` is</span>
</span><span id="FisherMatrix-1121"><a href="#FisherMatrix-1121"><span class="linenos">1121</span></a><span class="sd">            set to an array of integers of equal size as the Fisher object, sorts them</span>
</span><span id="FisherMatrix-1122"><a href="#FisherMatrix-1122"><span class="linenos">1122</span></a><span class="sd">            according to those instead.</span>
</span><span id="FisherMatrix-1123"><a href="#FisherMatrix-1123"><span class="linenos">1123</span></a><span class="sd">            In the third (and final) special case that the value of the keyword</span>
</span><span id="FisherMatrix-1124"><a href="#FisherMatrix-1124"><span class="linenos">1124</span></a><span class="sd">            `key` is set to an array strings matching those of parameter names</span>
</span><span id="FisherMatrix-1125"><a href="#FisherMatrix-1125"><span class="linenos">1125</span></a><span class="sd">            of the FisherMatrix, the items are sorted according to those</span>
</span><span id="FisherMatrix-1126"><a href="#FisherMatrix-1126"><span class="linenos">1126</span></a><span class="sd">            values.</span>
</span><span id="FisherMatrix-1127"><a href="#FisherMatrix-1127"><span class="linenos">1127</span></a>
</span><span id="FisherMatrix-1128"><a href="#FisherMatrix-1128"><span class="linenos">1128</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1129"><a href="#FisherMatrix-1129"><span class="linenos">1129</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1130"><a href="#FisherMatrix-1130"><span class="linenos">1130</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix-1131"><a href="#FisherMatrix-1131"><span class="linenos">1131</span></a><span class="sd">            the Fisher object with sorted names</span>
</span><span id="FisherMatrix-1132"><a href="#FisherMatrix-1132"><span class="linenos">1132</span></a>
</span><span id="FisherMatrix-1133"><a href="#FisherMatrix-1133"><span class="linenos">1133</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-1134"><a href="#FisherMatrix-1134"><span class="linenos">1134</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-1135"><a href="#FisherMatrix-1135"><span class="linenos">1135</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix-1136"><a href="#FisherMatrix-1136"><span class="linenos">1136</span></a><span class="sd">            if `key` does not match the names of the Fisher object</span>
</span><span id="FisherMatrix-1137"><a href="#FisherMatrix-1137"><span class="linenos">1137</span></a>
</span><span id="FisherMatrix-1138"><a href="#FisherMatrix-1138"><span class="linenos">1138</span></a><span class="sd">        TypeError</span>
</span><span id="FisherMatrix-1139"><a href="#FisherMatrix-1139"><span class="linenos">1139</span></a><span class="sd">            if `key` is not a callable</span>
</span><span id="FisherMatrix-1140"><a href="#FisherMatrix-1140"><span class="linenos">1140</span></a>
</span><span id="FisherMatrix-1141"><a href="#FisherMatrix-1141"><span class="linenos">1141</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1142"><a href="#FisherMatrix-1142"><span class="linenos">1142</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1143"><a href="#FisherMatrix-1143"><span class="linenos">1143</span></a><span class="sd">        Define a Fisher matrix:</span>
</span><span id="FisherMatrix-1144"><a href="#FisherMatrix-1144"><span class="linenos">1144</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([3, 1, 2]), names=list(&#39;sdf&#39;),</span>
</span><span id="FisherMatrix-1145"><a href="#FisherMatrix-1145"><span class="linenos">1145</span></a><span class="sd">        ... latex_names=[&#39;hjkl&#39;, &#39;qwe&#39;, &#39;ll&#39;], fiducials=[8, 7, 3])</span>
</span><span id="FisherMatrix-1146"><a href="#FisherMatrix-1146"><span class="linenos">1146</span></a>
</span><span id="FisherMatrix-1147"><a href="#FisherMatrix-1147"><span class="linenos">1147</span></a><span class="sd">        Sort according to values of the fiducials:</span>
</span><span id="FisherMatrix-1148"><a href="#FisherMatrix-1148"><span class="linenos">1148</span></a><span class="sd">        &gt;&gt;&gt; m.sort(key=&#39;fiducials&#39;)</span>
</span><span id="FisherMatrix-1149"><a href="#FisherMatrix-1149"><span class="linenos">1149</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1150"><a href="#FisherMatrix-1150"><span class="linenos">1150</span></a><span class="sd">            array([[2., 0., 0.],</span>
</span><span id="FisherMatrix-1151"><a href="#FisherMatrix-1151"><span class="linenos">1151</span></a><span class="sd">               [0., 1., 0.],</span>
</span><span id="FisherMatrix-1152"><a href="#FisherMatrix-1152"><span class="linenos">1152</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix-1153"><a href="#FisherMatrix-1153"><span class="linenos">1153</span></a><span class="sd">            names=array([&#39;f&#39;, &#39;d&#39;, &#39;s&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1154"><a href="#FisherMatrix-1154"><span class="linenos">1154</span></a><span class="sd">            latex_names=array([&#39;ll&#39;, &#39;qwe&#39;, &#39;hjkl&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1155"><a href="#FisherMatrix-1155"><span class="linenos">1155</span></a><span class="sd">            fiducials=array([3., 7., 8.]))</span>
</span><span id="FisherMatrix-1156"><a href="#FisherMatrix-1156"><span class="linenos">1156</span></a>
</span><span id="FisherMatrix-1157"><a href="#FisherMatrix-1157"><span class="linenos">1157</span></a><span class="sd">        Sort according to the LaTeX names (alphabetically):</span>
</span><span id="FisherMatrix-1158"><a href="#FisherMatrix-1158"><span class="linenos">1158</span></a><span class="sd">        &gt;&gt;&gt; m.sort(key=&#39;latex_names&#39;)</span>
</span><span id="FisherMatrix-1159"><a href="#FisherMatrix-1159"><span class="linenos">1159</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1160"><a href="#FisherMatrix-1160"><span class="linenos">1160</span></a><span class="sd">            array([[3., 0., 0.],</span>
</span><span id="FisherMatrix-1161"><a href="#FisherMatrix-1161"><span class="linenos">1161</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix-1162"><a href="#FisherMatrix-1162"><span class="linenos">1162</span></a><span class="sd">               [0., 0., 1.]]),</span>
</span><span id="FisherMatrix-1163"><a href="#FisherMatrix-1163"><span class="linenos">1163</span></a><span class="sd">            names=array([&#39;s&#39;, &#39;f&#39;, &#39;d&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1164"><a href="#FisherMatrix-1164"><span class="linenos">1164</span></a><span class="sd">            latex_names=array([&#39;hjkl&#39;, &#39;ll&#39;, &#39;qwe&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1165"><a href="#FisherMatrix-1165"><span class="linenos">1165</span></a><span class="sd">            fiducials=array([8., 3., 7.]))</span>
</span><span id="FisherMatrix-1166"><a href="#FisherMatrix-1166"><span class="linenos">1166</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1167"><a href="#FisherMatrix-1167"><span class="linenos">1167</span></a>        <span class="n">allowed_keys</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;fiducials&quot;</span><span class="p">,</span> <span class="s2">&quot;latex_names&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-1168"><a href="#FisherMatrix-1168"><span class="linenos">1168</span></a>
</span><span id="FisherMatrix-1169"><a href="#FisherMatrix-1169"><span class="linenos">1169</span></a>        <span class="c1"># something that can be passed to `sorted`</span>
</span><span id="FisherMatrix-1170"><a href="#FisherMatrix-1170"><span class="linenos">1170</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;key&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])):</span>
</span><span id="FisherMatrix-1171"><a href="#FisherMatrix-1171"><span class="linenos">1171</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="FisherMatrix-1172"><a href="#FisherMatrix-1172"><span class="linenos">1172</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1173"><a href="#FisherMatrix-1173"><span class="linenos">1173</span></a>
</span><span id="FisherMatrix-1174"><a href="#FisherMatrix-1174"><span class="linenos">1174</span></a>        <span class="c1"># an integer index</span>
</span><span id="FisherMatrix-1175"><a href="#FisherMatrix-1175"><span class="linenos">1175</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="FisherMatrix-1176"><a href="#FisherMatrix-1176"><span class="linenos">1176</span></a>            <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
</span><span id="FisherMatrix-1177"><a href="#FisherMatrix-1177"><span class="linenos">1177</span></a>            <span class="ow">and</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
</span><span id="FisherMatrix-1178"><a href="#FisherMatrix-1178"><span class="linenos">1178</span></a>            <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="s2">&quot;__index__&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
</span><span id="FisherMatrix-1179"><a href="#FisherMatrix-1179"><span class="linenos">1179</span></a>        <span class="p">):</span>
</span><span id="FisherMatrix-1180"><a href="#FisherMatrix-1180"><span class="linenos">1180</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="FisherMatrix-1181"><a href="#FisherMatrix-1181"><span class="linenos">1181</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1182"><a href="#FisherMatrix-1182"><span class="linenos">1182</span></a>
</span><span id="FisherMatrix-1183"><a href="#FisherMatrix-1183"><span class="linenos">1183</span></a>        <span class="c1"># either &#39;fiducials&#39; or &#39;latex_names&#39;</span>
</span><span id="FisherMatrix-1184"><a href="#FisherMatrix-1184"><span class="linenos">1184</span></a>        <span class="k">elif</span> <span class="p">(</span>
</span><span id="FisherMatrix-1185"><a href="#FisherMatrix-1185"><span class="linenos">1185</span></a>            <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
</span><span id="FisherMatrix-1186"><a href="#FisherMatrix-1186"><span class="linenos">1186</span></a>            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="FisherMatrix-1187"><a href="#FisherMatrix-1187"><span class="linenos">1187</span></a>            <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">allowed_keys</span>
</span><span id="FisherMatrix-1188"><a href="#FisherMatrix-1188"><span class="linenos">1188</span></a>        <span class="p">):</span>
</span><span id="FisherMatrix-1189"><a href="#FisherMatrix-1189"><span class="linenos">1189</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]))</span>
</span><span id="FisherMatrix-1190"><a href="#FisherMatrix-1190"><span class="linenos">1190</span></a>            <span class="k">if</span> <span class="s2">&quot;reversed&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix-1191"><a href="#FisherMatrix-1191"><span class="linenos">1191</span></a>                <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1192"><a href="#FisherMatrix-1192"><span class="linenos">1192</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1193"><a href="#FisherMatrix-1193"><span class="linenos">1193</span></a>
</span><span id="FisherMatrix-1194"><a href="#FisherMatrix-1194"><span class="linenos">1194</span></a>        <span class="c1"># the names themselves, in any order</span>
</span><span id="FisherMatrix-1195"><a href="#FisherMatrix-1195"><span class="linenos">1195</span></a>        <span class="k">elif</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]):</span>
</span><span id="FisherMatrix-1196"><a href="#FisherMatrix-1196"><span class="linenos">1196</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-1197"><a href="#FisherMatrix-1197"><span class="linenos">1197</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix-1198"><a href="#FisherMatrix-1198"><span class="linenos">1198</span></a>                    <span class="sa">f</span><span class="s2">&quot;The object &#39;</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; appears to be an iterable, &quot;</span>
</span><span id="FisherMatrix-1199"><a href="#FisherMatrix-1199"><span class="linenos">1199</span></a>                    <span class="sa">f</span><span class="s2">&quot;but does not contain all of the names in the Fisher object (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">); &quot;</span>
</span><span id="FisherMatrix-1200"><a href="#FisherMatrix-1200"><span class="linenos">1200</span></a>                    <span class="s2">&quot;if you meant to sort by the names, make sure they are all in the passed array!&quot;</span>
</span><span id="FisherMatrix-1201"><a href="#FisherMatrix-1201"><span class="linenos">1201</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1202"><a href="#FisherMatrix-1202"><span class="linenos">1202</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1203"><a href="#FisherMatrix-1203"><span class="linenos">1203</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1204"><a href="#FisherMatrix-1204"><span class="linenos">1204</span></a>
</span><span id="FisherMatrix-1205"><a href="#FisherMatrix-1205"><span class="linenos">1205</span></a>        <span class="c1"># something else should throw an error</span>
</span><span id="FisherMatrix-1206"><a href="#FisherMatrix-1206"><span class="linenos">1206</span></a>        <span class="k">elif</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="FisherMatrix-1207"><a href="#FisherMatrix-1207"><span class="linenos">1207</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="FisherMatrix-1208"><a href="#FisherMatrix-1208"><span class="linenos">1208</span></a>                <span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> is not a callable, a list of names, &quot;</span>
</span><span id="FisherMatrix-1209"><a href="#FisherMatrix-1209"><span class="linenos">1209</span></a>                <span class="sa">f</span><span class="s2">&quot;or one of </span><span class="si">{</span><span class="n">allowed_keys</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-1210"><a href="#FisherMatrix-1210"><span class="linenos">1210</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-1211"><a href="#FisherMatrix-1211"><span class="linenos">1211</span></a>
</span><span id="FisherMatrix-1212"><a href="#FisherMatrix-1212"><span class="linenos">1212</span></a>        <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1213"><a href="#FisherMatrix-1213"><span class="linenos">1213</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1214"><a href="#FisherMatrix-1214"><span class="linenos">1214</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">reindex_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1215"><a href="#FisherMatrix-1215"><span class="linenos">1215</span></a>
</span><span id="FisherMatrix-1216"><a href="#FisherMatrix-1216"><span class="linenos">1216</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1217"><a href="#FisherMatrix-1217"><span class="linenos">1217</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1218"><a href="#FisherMatrix-1218"><span class="linenos">1218</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1219"><a href="#FisherMatrix-1219"><span class="linenos">1219</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1220"><a href="#FisherMatrix-1220"><span class="linenos">1220</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1221"><a href="#FisherMatrix-1221"><span class="linenos">1221</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1222"><a href="#FisherMatrix-1222"><span class="linenos">1222</span></a>
</span><span id="FisherMatrix-1223"><a href="#FisherMatrix-1223"><span class="linenos">1223</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="FisherMatrix-1224"><a href="#FisherMatrix-1224"><span class="linenos">1224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1225"><a href="#FisherMatrix-1225"><span class="linenos">1225</span></a><span class="sd">        Compare Fisher object with another object.</span>
</span><span id="FisherMatrix-1226"><a href="#FisherMatrix-1226"><span class="linenos">1226</span></a>
</span><span id="FisherMatrix-1227"><a href="#FisherMatrix-1227"><span class="linenos">1227</span></a><span class="sd">        Returns `True` if the operands have the following properties:</span>
</span><span id="FisherMatrix-1228"><a href="#FisherMatrix-1228"><span class="linenos">1228</span></a>
</span><span id="FisherMatrix-1229"><a href="#FisherMatrix-1229"><span class="linenos">1229</span></a><span class="sd">        * are instances of FisherMatrix</span>
</span><span id="FisherMatrix-1230"><a href="#FisherMatrix-1230"><span class="linenos">1230</span></a><span class="sd">        * have same names (potentially shuffled)</span>
</span><span id="FisherMatrix-1231"><a href="#FisherMatrix-1231"><span class="linenos">1231</span></a><span class="sd">        * have same dimensionality</span>
</span><span id="FisherMatrix-1232"><a href="#FisherMatrix-1232"><span class="linenos">1232</span></a><span class="sd">        * have same fiducials (potentially shuffled)</span>
</span><span id="FisherMatrix-1233"><a href="#FisherMatrix-1233"><span class="linenos">1233</span></a><span class="sd">        * have same values (potentially shuffled)</span>
</span><span id="FisherMatrix-1234"><a href="#FisherMatrix-1234"><span class="linenos">1234</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1235"><a href="#FisherMatrix-1235"><span class="linenos">1235</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-1236"><a href="#FisherMatrix-1236"><span class="linenos">1236</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="FisherMatrix-1237"><a href="#FisherMatrix-1237"><span class="linenos">1237</span></a>
</span><span id="FisherMatrix-1238"><a href="#FisherMatrix-1238"><span class="linenos">1238</span></a>        <span class="c1"># index for re-shuffling parameters</span>
</span><span id="FisherMatrix-1239"><a href="#FisherMatrix-1239"><span class="linenos">1239</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1240"><a href="#FisherMatrix-1240"><span class="linenos">1240</span></a>
</span><span id="FisherMatrix-1241"><a href="#FisherMatrix-1241"><span class="linenos">1241</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="FisherMatrix-1242"><a href="#FisherMatrix-1242"><span class="linenos">1242</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
</span><span id="FisherMatrix-1243"><a href="#FisherMatrix-1243"><span class="linenos">1243</span></a>            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">ndim</span>
</span><span id="FisherMatrix-1244"><a href="#FisherMatrix-1244"><span class="linenos">1244</span></a>            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="FisherMatrix-1245"><a href="#FisherMatrix-1245"><span class="linenos">1245</span></a>            <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1246"><a href="#FisherMatrix-1246"><span class="linenos">1246</span></a>            <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
</span><span id="FisherMatrix-1247"><a href="#FisherMatrix-1247"><span class="linenos">1247</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1248"><a href="#FisherMatrix-1248"><span class="linenos">1248</span></a>                <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
</span><span id="FisherMatrix-1249"><a href="#FisherMatrix-1249"><span class="linenos">1249</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-1250"><a href="#FisherMatrix-1250"><span class="linenos">1250</span></a>            <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
</span><span id="FisherMatrix-1251"><a href="#FisherMatrix-1251"><span class="linenos">1251</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1252"><a href="#FisherMatrix-1252"><span class="linenos">1252</span></a>                <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">),</span>
</span><span id="FisherMatrix-1253"><a href="#FisherMatrix-1253"><span class="linenos">1253</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-1254"><a href="#FisherMatrix-1254"><span class="linenos">1254</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1255"><a href="#FisherMatrix-1255"><span class="linenos">1255</span></a>
</span><span id="FisherMatrix-1256"><a href="#FisherMatrix-1256"><span class="linenos">1256</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-1257"><a href="#FisherMatrix-1257"><span class="linenos">1257</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-1258"><a href="#FisherMatrix-1258"><span class="linenos">1258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of dimensions of the Fisher object (for now always 2).&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1259"><a href="#FisherMatrix-1259"><span class="linenos">1259</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="FisherMatrix-1260"><a href="#FisherMatrix-1260"><span class="linenos">1260</span></a>
</span><span id="FisherMatrix-1261"><a href="#FisherMatrix-1261"><span class="linenos">1261</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-1262"><a href="#FisherMatrix-1262"><span class="linenos">1262</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of parameters in the Fisher object.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1263"><a href="#FisherMatrix-1263"><span class="linenos">1263</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span>
</span><span id="FisherMatrix-1264"><a href="#FisherMatrix-1264"><span class="linenos">1264</span></a>
</span><span id="FisherMatrix-1265"><a href="#FisherMatrix-1265"><span class="linenos">1265</span></a>    <span class="k">def</span> <span class="nf">is_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-1266"><a href="#FisherMatrix-1266"><span class="linenos">1266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1267"><a href="#FisherMatrix-1267"><span class="linenos">1267</span></a><span class="sd">        Check whether the Fisher matrix is diagonal.</span>
</span><span id="FisherMatrix-1268"><a href="#FisherMatrix-1268"><span class="linenos">1268</span></a>
</span><span id="FisherMatrix-1269"><a href="#FisherMatrix-1269"><span class="linenos">1269</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1270"><a href="#FisherMatrix-1270"><span class="linenos">1270</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1271"><a href="#FisherMatrix-1271"><span class="linenos">1271</span></a><span class="sd">        bool</span>
</span><span id="FisherMatrix-1272"><a href="#FisherMatrix-1272"><span class="linenos">1272</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1273"><a href="#FisherMatrix-1273"><span class="linenos">1273</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
</span><span id="FisherMatrix-1274"><a href="#FisherMatrix-1274"><span class="linenos">1274</span></a>
</span><span id="FisherMatrix-1275"><a href="#FisherMatrix-1275"><span class="linenos">1275</span></a>    <span class="k">def</span> <span class="nf">diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="FisherMatrix-1276"><a href="#FisherMatrix-1276"><span class="linenos">1276</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1277"><a href="#FisherMatrix-1277"><span class="linenos">1277</span></a><span class="sd">        Return the diagonal elements of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix-1278"><a href="#FisherMatrix-1278"><span class="linenos">1278</span></a>
</span><span id="FisherMatrix-1279"><a href="#FisherMatrix-1279"><span class="linenos">1279</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1280"><a href="#FisherMatrix-1280"><span class="linenos">1280</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1281"><a href="#FisherMatrix-1281"><span class="linenos">1281</span></a><span class="sd">        array_like : float</span>
</span><span id="FisherMatrix-1282"><a href="#FisherMatrix-1282"><span class="linenos">1282</span></a><span class="sd">            The diagonal elements as a numpy array.</span>
</span><span id="FisherMatrix-1283"><a href="#FisherMatrix-1283"><span class="linenos">1283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1284"><a href="#FisherMatrix-1284"><span class="linenos">1284</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="FisherMatrix-1285"><a href="#FisherMatrix-1285"><span class="linenos">1285</span></a>
</span><span id="FisherMatrix-1286"><a href="#FisherMatrix-1286"><span class="linenos">1286</span></a>    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span>
</span><span id="FisherMatrix-1287"><a href="#FisherMatrix-1287"><span class="linenos">1287</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1288"><a href="#FisherMatrix-1288"><span class="linenos">1288</span></a>        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix-1289"><a href="#FisherMatrix-1289"><span class="linenos">1289</span></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix-1290"><a href="#FisherMatrix-1290"><span class="linenos">1290</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix-1291"><a href="#FisherMatrix-1291"><span class="linenos">1291</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1292"><a href="#FisherMatrix-1292"><span class="linenos">1292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1293"><a href="#FisherMatrix-1293"><span class="linenos">1293</span></a><span class="sd">        Remove parameters from the Fisher object.</span>
</span><span id="FisherMatrix-1294"><a href="#FisherMatrix-1294"><span class="linenos">1294</span></a>
</span><span id="FisherMatrix-1295"><a href="#FisherMatrix-1295"><span class="linenos">1295</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1296"><a href="#FisherMatrix-1296"><span class="linenos">1296</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1297"><a href="#FisherMatrix-1297"><span class="linenos">1297</span></a><span class="sd">        names : str</span>
</span><span id="FisherMatrix-1298"><a href="#FisherMatrix-1298"><span class="linenos">1298</span></a><span class="sd">            the names of the parameters to drop.</span>
</span><span id="FisherMatrix-1299"><a href="#FisherMatrix-1299"><span class="linenos">1299</span></a><span class="sd">            If passing a list or a tuple, make sure to unpack it using the</span>
</span><span id="FisherMatrix-1300"><a href="#FisherMatrix-1300"><span class="linenos">1300</span></a><span class="sd">            asterisk (*).</span>
</span><span id="FisherMatrix-1301"><a href="#FisherMatrix-1301"><span class="linenos">1301</span></a>
</span><span id="FisherMatrix-1302"><a href="#FisherMatrix-1302"><span class="linenos">1302</span></a><span class="sd">        invert : bool, optional</span>
</span><span id="FisherMatrix-1303"><a href="#FisherMatrix-1303"><span class="linenos">1303</span></a><span class="sd">            whether to drop all the parameters NOT in names (the complement)</span>
</span><span id="FisherMatrix-1304"><a href="#FisherMatrix-1304"><span class="linenos">1304</span></a><span class="sd">            (default: False)</span>
</span><span id="FisherMatrix-1305"><a href="#FisherMatrix-1305"><span class="linenos">1305</span></a>
</span><span id="FisherMatrix-1306"><a href="#FisherMatrix-1306"><span class="linenos">1306</span></a><span class="sd">        ignore_errors : bool, optional</span>
</span><span id="FisherMatrix-1307"><a href="#FisherMatrix-1307"><span class="linenos">1307</span></a><span class="sd">            should non-existing parameters be ignored (default: False)</span>
</span><span id="FisherMatrix-1308"><a href="#FisherMatrix-1308"><span class="linenos">1308</span></a>
</span><span id="FisherMatrix-1309"><a href="#FisherMatrix-1309"><span class="linenos">1309</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1310"><a href="#FisherMatrix-1310"><span class="linenos">1310</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1311"><a href="#FisherMatrix-1311"><span class="linenos">1311</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix-1312"><a href="#FisherMatrix-1312"><span class="linenos">1312</span></a><span class="sd">            the Fisher object with removed names</span>
</span><span id="FisherMatrix-1313"><a href="#FisherMatrix-1313"><span class="linenos">1313</span></a>
</span><span id="FisherMatrix-1314"><a href="#FisherMatrix-1314"><span class="linenos">1314</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1315"><a href="#FisherMatrix-1315"><span class="linenos">1315</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1316"><a href="#FisherMatrix-1316"><span class="linenos">1316</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix-1317"><a href="#FisherMatrix-1317"><span class="linenos">1317</span></a>
</span><span id="FisherMatrix-1318"><a href="#FisherMatrix-1318"><span class="linenos">1318</span></a><span class="sd">        Drop `p1` and `p3`:</span>
</span><span id="FisherMatrix-1319"><a href="#FisherMatrix-1319"><span class="linenos">1319</span></a><span class="sd">        &gt;&gt;&gt; m.drop(&#39;p1&#39;, &#39;p3&#39;)</span>
</span><span id="FisherMatrix-1320"><a href="#FisherMatrix-1320"><span class="linenos">1320</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1321"><a href="#FisherMatrix-1321"><span class="linenos">1321</span></a><span class="sd">            array([[2.]]),</span>
</span><span id="FisherMatrix-1322"><a href="#FisherMatrix-1322"><span class="linenos">1322</span></a><span class="sd">            names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1323"><a href="#FisherMatrix-1323"><span class="linenos">1323</span></a><span class="sd">            latex_names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1324"><a href="#FisherMatrix-1324"><span class="linenos">1324</span></a><span class="sd">            fiducials=array([0.]))</span>
</span><span id="FisherMatrix-1325"><a href="#FisherMatrix-1325"><span class="linenos">1325</span></a>
</span><span id="FisherMatrix-1326"><a href="#FisherMatrix-1326"><span class="linenos">1326</span></a><span class="sd">        Same result, but note the asterisk (`*`):</span>
</span><span id="FisherMatrix-1327"><a href="#FisherMatrix-1327"><span class="linenos">1327</span></a><span class="sd">        &gt;&gt;&gt; m.drop(*[&#39;p1&#39;, &#39;p3&#39;])</span>
</span><span id="FisherMatrix-1328"><a href="#FisherMatrix-1328"><span class="linenos">1328</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1329"><a href="#FisherMatrix-1329"><span class="linenos">1329</span></a><span class="sd">            array([[2.]]),</span>
</span><span id="FisherMatrix-1330"><a href="#FisherMatrix-1330"><span class="linenos">1330</span></a><span class="sd">            names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1331"><a href="#FisherMatrix-1331"><span class="linenos">1331</span></a><span class="sd">            latex_names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1332"><a href="#FisherMatrix-1332"><span class="linenos">1332</span></a><span class="sd">            fiducials=array([0.]))</span>
</span><span id="FisherMatrix-1333"><a href="#FisherMatrix-1333"><span class="linenos">1333</span></a>
</span><span id="FisherMatrix-1334"><a href="#FisherMatrix-1334"><span class="linenos">1334</span></a><span class="sd">        Drop everything *except* `p1` and `p3`:</span>
</span><span id="FisherMatrix-1335"><a href="#FisherMatrix-1335"><span class="linenos">1335</span></a><span class="sd">        &gt;&gt;&gt; m.drop(&#39;p1&#39;, &#39;p3&#39;, invert=True)</span>
</span><span id="FisherMatrix-1336"><a href="#FisherMatrix-1336"><span class="linenos">1336</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1337"><a href="#FisherMatrix-1337"><span class="linenos">1337</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix-1338"><a href="#FisherMatrix-1338"><span class="linenos">1338</span></a><span class="sd">               [0., 3.]]),</span>
</span><span id="FisherMatrix-1339"><a href="#FisherMatrix-1339"><span class="linenos">1339</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1340"><a href="#FisherMatrix-1340"><span class="linenos">1340</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1341"><a href="#FisherMatrix-1341"><span class="linenos">1341</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-1342"><a href="#FisherMatrix-1342"><span class="linenos">1342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1343"><a href="#FisherMatrix-1343"><span class="linenos">1343</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)):</span>
</span><span id="FisherMatrix-1344"><a href="#FisherMatrix-1344"><span class="linenos">1344</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix-1345"><a href="#FisherMatrix-1345"><span class="linenos">1345</span></a>                <span class="sa">f</span><span class="s2">&quot;The names (</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">) are not a strict subset &quot;</span>
</span><span id="FisherMatrix-1346"><a href="#FisherMatrix-1346"><span class="linenos">1346</span></a>                <span class="sa">f</span><span class="s2">&quot;of the parameter names in the Fisher object (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">); &quot;</span>
</span><span id="FisherMatrix-1347"><a href="#FisherMatrix-1347"><span class="linenos">1347</span></a>                <span class="s2">&quot;you can pass `ignore_errors=True` to ignore this error&quot;</span>
</span><span id="FisherMatrix-1348"><a href="#FisherMatrix-1348"><span class="linenos">1348</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-1349"><a href="#FisherMatrix-1349"><span class="linenos">1349</span></a>
</span><span id="FisherMatrix-1350"><a href="#FisherMatrix-1350"><span class="linenos">1350</span></a>        <span class="k">if</span> <span class="n">ignore_errors</span><span class="p">:</span>
</span><span id="FisherMatrix-1351"><a href="#FisherMatrix-1351"><span class="linenos">1351</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">]))</span>
</span><span id="FisherMatrix-1352"><a href="#FisherMatrix-1352"><span class="linenos">1352</span></a>
</span><span id="FisherMatrix-1353"><a href="#FisherMatrix-1353"><span class="linenos">1353</span></a>        <span class="k">if</span> <span class="n">invert</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix-1354"><a href="#FisherMatrix-1354"><span class="linenos">1354</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">^</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
</span><span id="FisherMatrix-1355"><a href="#FisherMatrix-1355"><span class="linenos">1355</span></a>
</span><span id="FisherMatrix-1356"><a href="#FisherMatrix-1356"><span class="linenos">1356</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-1357"><a href="#FisherMatrix-1357"><span class="linenos">1357</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to remove all parameters&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-1358"><a href="#FisherMatrix-1358"><span class="linenos">1358</span></a>
</span><span id="FisherMatrix-1359"><a href="#FisherMatrix-1359"><span class="linenos">1359</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
</span><span id="FisherMatrix-1360"><a href="#FisherMatrix-1360"><span class="linenos">1360</span></a>
</span><span id="FisherMatrix-1361"><a href="#FisherMatrix-1361"><span class="linenos">1361</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
</span><span id="FisherMatrix-1362"><a href="#FisherMatrix-1362"><span class="linenos">1362</span></a>        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
</span><span id="FisherMatrix-1363"><a href="#FisherMatrix-1363"><span class="linenos">1363</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
</span><span id="FisherMatrix-1364"><a href="#FisherMatrix-1364"><span class="linenos">1364</span></a>                <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1365"><a href="#FisherMatrix-1365"><span class="linenos">1365</span></a>                <span class="n">index</span><span class="p">,</span>
</span><span id="FisherMatrix-1366"><a href="#FisherMatrix-1366"><span class="linenos">1366</span></a>                <span class="n">axis</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
</span><span id="FisherMatrix-1367"><a href="#FisherMatrix-1367"><span class="linenos">1367</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-1368"><a href="#FisherMatrix-1368"><span class="linenos">1368</span></a>
</span><span id="FisherMatrix-1369"><a href="#FisherMatrix-1369"><span class="linenos">1369</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1370"><a href="#FisherMatrix-1370"><span class="linenos">1370</span></a>        <span class="n">latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1371"><a href="#FisherMatrix-1371"><span class="linenos">1371</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
</span><span id="FisherMatrix-1372"><a href="#FisherMatrix-1372"><span class="linenos">1372</span></a>
</span><span id="FisherMatrix-1373"><a href="#FisherMatrix-1373"><span class="linenos">1373</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1374"><a href="#FisherMatrix-1374"><span class="linenos">1374</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1375"><a href="#FisherMatrix-1375"><span class="linenos">1375</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1376"><a href="#FisherMatrix-1376"><span class="linenos">1376</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1377"><a href="#FisherMatrix-1377"><span class="linenos">1377</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1378"><a href="#FisherMatrix-1378"><span class="linenos">1378</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1379"><a href="#FisherMatrix-1379"><span class="linenos">1379</span></a>
</span><span id="FisherMatrix-1380"><a href="#FisherMatrix-1380"><span class="linenos">1380</span></a>    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span>
</span><span id="FisherMatrix-1381"><a href="#FisherMatrix-1381"><span class="linenos">1381</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1382"><a href="#FisherMatrix-1382"><span class="linenos">1382</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-1383"><a href="#FisherMatrix-1383"><span class="linenos">1383</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-1384"><a href="#FisherMatrix-1384"><span class="linenos">1384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the trace of the Fisher object as a numpy array.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1385"><a href="#FisherMatrix-1385"><span class="linenos">1385</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="FisherMatrix-1386"><a href="#FisherMatrix-1386"><span class="linenos">1386</span></a>
</span><span id="FisherMatrix-1387"><a href="#FisherMatrix-1387"><span class="linenos">1387</span></a>    <span class="k">def</span> <span class="nf">eigenvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-1388"><a href="#FisherMatrix-1388"><span class="linenos">1388</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the eigenvalues of the Fisher object as a numpy array.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1389"><a href="#FisherMatrix-1389"><span class="linenos">1389</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-1390"><a href="#FisherMatrix-1390"><span class="linenos">1390</span></a>
</span><span id="FisherMatrix-1391"><a href="#FisherMatrix-1391"><span class="linenos">1391</span></a>    <span class="k">def</span> <span class="nf">eigenvectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-1392"><a href="#FisherMatrix-1392"><span class="linenos">1392</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the right eigenvectors of the Fisher object as a numpy array.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1393"><a href="#FisherMatrix-1393"><span class="linenos">1393</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FisherMatrix-1394"><a href="#FisherMatrix-1394"><span class="linenos">1394</span></a>
</span><span id="FisherMatrix-1395"><a href="#FisherMatrix-1395"><span class="linenos">1395</span></a>    <span class="k">def</span> <span class="nf">condition_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-1396"><a href="#FisherMatrix-1396"><span class="linenos">1396</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1397"><a href="#FisherMatrix-1397"><span class="linenos">1397</span></a><span class="sd">        Return the condition number of the matrix with respect to the $L^2$ norm.</span>
</span><span id="FisherMatrix-1398"><a href="#FisherMatrix-1398"><span class="linenos">1398</span></a>
</span><span id="FisherMatrix-1399"><a href="#FisherMatrix-1399"><span class="linenos">1399</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1400"><a href="#FisherMatrix-1400"><span class="linenos">1400</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1401"><a href="#FisherMatrix-1401"><span class="linenos">1401</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix-1402"><a href="#FisherMatrix-1402"><span class="linenos">1402</span></a><span class="sd">        &gt;&gt;&gt; fm.condition_number()</span>
</span><span id="FisherMatrix-1403"><a href="#FisherMatrix-1403"><span class="linenos">1403</span></a><span class="sd">        3.0</span>
</span><span id="FisherMatrix-1404"><a href="#FisherMatrix-1404"><span class="linenos">1404</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1405"><a href="#FisherMatrix-1405"><span class="linenos">1405</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">())</span>
</span><span id="FisherMatrix-1406"><a href="#FisherMatrix-1406"><span class="linenos">1406</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-1407"><a href="#FisherMatrix-1407"><span class="linenos">1407</span></a>
</span><span id="FisherMatrix-1408"><a href="#FisherMatrix-1408"><span class="linenos">1408</span></a>    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_pinv</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="FisherMatrix-1409"><a href="#FisherMatrix-1409"><span class="linenos">1409</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1410"><a href="#FisherMatrix-1410"><span class="linenos">1410</span></a><span class="sd">        Return the inverse of the Fisher matrix.</span>
</span><span id="FisherMatrix-1411"><a href="#FisherMatrix-1411"><span class="linenos">1411</span></a>
</span><span id="FisherMatrix-1412"><a href="#FisherMatrix-1412"><span class="linenos">1412</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1413"><a href="#FisherMatrix-1413"><span class="linenos">1413</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1414"><a href="#FisherMatrix-1414"><span class="linenos">1414</span></a><span class="sd">        use_pinv : bool, optional</span>
</span><span id="FisherMatrix-1415"><a href="#FisherMatrix-1415"><span class="linenos">1415</span></a><span class="sd">            use the Moore-Penrose pseudoinverse (default: False). Can be useful</span>
</span><span id="FisherMatrix-1416"><a href="#FisherMatrix-1416"><span class="linenos">1416</span></a><span class="sd">            if the Fisher matrix is weakly singular. Use with caution!</span>
</span><span id="FisherMatrix-1417"><a href="#FisherMatrix-1417"><span class="linenos">1417</span></a>
</span><span id="FisherMatrix-1418"><a href="#FisherMatrix-1418"><span class="linenos">1418</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-1419"><a href="#FisherMatrix-1419"><span class="linenos">1419</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-1420"><a href="#FisherMatrix-1420"><span class="linenos">1420</span></a><span class="sd">        LinAlgError</span>
</span><span id="FisherMatrix-1421"><a href="#FisherMatrix-1421"><span class="linenos">1421</span></a><span class="sd">            if the Fisher matrix is singular</span>
</span><span id="FisherMatrix-1422"><a href="#FisherMatrix-1422"><span class="linenos">1422</span></a>
</span><span id="FisherMatrix-1423"><a href="#FisherMatrix-1423"><span class="linenos">1423</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1424"><a href="#FisherMatrix-1424"><span class="linenos">1424</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1425"><a href="#FisherMatrix-1425"><span class="linenos">1425</span></a><span class="sd">        array_like : float</span>
</span><span id="FisherMatrix-1426"><a href="#FisherMatrix-1426"><span class="linenos">1426</span></a><span class="sd">            the covariance matrix as a numpy array</span>
</span><span id="FisherMatrix-1427"><a href="#FisherMatrix-1427"><span class="linenos">1427</span></a>
</span><span id="FisherMatrix-1428"><a href="#FisherMatrix-1428"><span class="linenos">1428</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1429"><a href="#FisherMatrix-1429"><span class="linenos">1429</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1430"><a href="#FisherMatrix-1430"><span class="linenos">1430</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 5]))</span>
</span><span id="FisherMatrix-1431"><a href="#FisherMatrix-1431"><span class="linenos">1431</span></a><span class="sd">        &gt;&gt;&gt; fm.inverse()</span>
</span><span id="FisherMatrix-1432"><a href="#FisherMatrix-1432"><span class="linenos">1432</span></a><span class="sd">        array([[1. , 0. , 0. ],</span>
</span><span id="FisherMatrix-1433"><a href="#FisherMatrix-1433"><span class="linenos">1433</span></a><span class="sd">               [0. , 0.5, 0. ],</span>
</span><span id="FisherMatrix-1434"><a href="#FisherMatrix-1434"><span class="linenos">1434</span></a><span class="sd">               [0. , 0. , 0.2]])</span>
</span><span id="FisherMatrix-1435"><a href="#FisherMatrix-1435"><span class="linenos">1435</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1436"><a href="#FisherMatrix-1436"><span class="linenos">1436</span></a>        <span class="k">if</span> <span class="n">use_pinv</span><span class="p">:</span>
</span><span id="FisherMatrix-1437"><a href="#FisherMatrix-1437"><span class="linenos">1437</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">hermitian</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="FisherMatrix-1438"><a href="#FisherMatrix-1438"><span class="linenos">1438</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-1439"><a href="#FisherMatrix-1439"><span class="linenos">1439</span></a>
</span><span id="FisherMatrix-1440"><a href="#FisherMatrix-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">determinant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-1441"><a href="#FisherMatrix-1441"><span class="linenos">1441</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1442"><a href="#FisherMatrix-1442"><span class="linenos">1442</span></a><span class="sd">        Return the determinant of the matrix.</span>
</span><span id="FisherMatrix-1443"><a href="#FisherMatrix-1443"><span class="linenos">1443</span></a>
</span><span id="FisherMatrix-1444"><a href="#FisherMatrix-1444"><span class="linenos">1444</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1445"><a href="#FisherMatrix-1445"><span class="linenos">1445</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1446"><a href="#FisherMatrix-1446"><span class="linenos">1446</span></a><span class="sd">        float</span>
</span><span id="FisherMatrix-1447"><a href="#FisherMatrix-1447"><span class="linenos">1447</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1448"><a href="#FisherMatrix-1448"><span class="linenos">1448</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-1449"><a href="#FisherMatrix-1449"><span class="linenos">1449</span></a>
</span><span id="FisherMatrix-1450"><a href="#FisherMatrix-1450"><span class="linenos">1450</span></a>    <span class="k">def</span> <span class="nf">constraints</span><span class="p">(</span>
</span><span id="FisherMatrix-1451"><a href="#FisherMatrix-1451"><span class="linenos">1451</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1452"><a href="#FisherMatrix-1452"><span class="linenos">1452</span></a>        <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-1453"><a href="#FisherMatrix-1453"><span class="linenos">1453</span></a>        <span class="n">marginalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FisherMatrix-1454"><a href="#FisherMatrix-1454"><span class="linenos">1454</span></a>        <span class="n">sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-1455"><a href="#FisherMatrix-1455"><span class="linenos">1455</span></a>        <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-1456"><a href="#FisherMatrix-1456"><span class="linenos">1456</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-1457"><a href="#FisherMatrix-1457"><span class="linenos">1457</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-1458"><a href="#FisherMatrix-1458"><span class="linenos">1458</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1459"><a href="#FisherMatrix-1459"><span class="linenos">1459</span></a><span class="sd">        Compute the constraints on parameters.</span>
</span><span id="FisherMatrix-1460"><a href="#FisherMatrix-1460"><span class="linenos">1460</span></a>
</span><span id="FisherMatrix-1461"><a href="#FisherMatrix-1461"><span class="linenos">1461</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1462"><a href="#FisherMatrix-1462"><span class="linenos">1462</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1463"><a href="#FisherMatrix-1463"><span class="linenos">1463</span></a><span class="sd">        name : str, optional</span>
</span><span id="FisherMatrix-1464"><a href="#FisherMatrix-1464"><span class="linenos">1464</span></a><span class="sd">            the name of the parameter for which we we want the constraints</span>
</span><span id="FisherMatrix-1465"><a href="#FisherMatrix-1465"><span class="linenos">1465</span></a><span class="sd">            (default: None)</span>
</span><span id="FisherMatrix-1466"><a href="#FisherMatrix-1466"><span class="linenos">1466</span></a>
</span><span id="FisherMatrix-1467"><a href="#FisherMatrix-1467"><span class="linenos">1467</span></a><span class="sd">        marginalized : bool, optional</span>
</span><span id="FisherMatrix-1468"><a href="#FisherMatrix-1468"><span class="linenos">1468</span></a><span class="sd">            whether we want the marginalized or the unmarginalized</span>
</span><span id="FisherMatrix-1469"><a href="#FisherMatrix-1469"><span class="linenos">1469</span></a><span class="sd">            constraints (default: True).</span>
</span><span id="FisherMatrix-1470"><a href="#FisherMatrix-1470"><span class="linenos">1470</span></a>
</span><span id="FisherMatrix-1471"><a href="#FisherMatrix-1471"><span class="linenos">1471</span></a><span class="sd">        sigma : float, optional</span>
</span><span id="FisherMatrix-1472"><a href="#FisherMatrix-1472"><span class="linenos">1472</span></a><span class="sd">            how many sigmas away (default: 1).</span>
</span><span id="FisherMatrix-1473"><a href="#FisherMatrix-1473"><span class="linenos">1473</span></a>
</span><span id="FisherMatrix-1474"><a href="#FisherMatrix-1474"><span class="linenos">1474</span></a><span class="sd">        p : float, optional</span>
</span><span id="FisherMatrix-1475"><a href="#FisherMatrix-1475"><span class="linenos">1475</span></a><span class="sd">            the confidence interval (p-value) (default: None).</span>
</span><span id="FisherMatrix-1476"><a href="#FisherMatrix-1476"><span class="linenos">1476</span></a>
</span><span id="FisherMatrix-1477"><a href="#FisherMatrix-1477"><span class="linenos">1477</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix-1478"><a href="#FisherMatrix-1478"><span class="linenos">1478</span></a><span class="sd">            any kwargs passed to `inverse`</span>
</span><span id="FisherMatrix-1479"><a href="#FisherMatrix-1479"><span class="linenos">1479</span></a>
</span><span id="FisherMatrix-1480"><a href="#FisherMatrix-1480"><span class="linenos">1480</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1481"><a href="#FisherMatrix-1481"><span class="linenos">1481</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1482"><a href="#FisherMatrix-1482"><span class="linenos">1482</span></a><span class="sd">        float or array_like of float</span>
</span><span id="FisherMatrix-1483"><a href="#FisherMatrix-1483"><span class="linenos">1483</span></a>
</span><span id="FisherMatrix-1484"><a href="#FisherMatrix-1484"><span class="linenos">1484</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-1485"><a href="#FisherMatrix-1485"><span class="linenos">1485</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-1486"><a href="#FisherMatrix-1486"><span class="linenos">1486</span></a><span class="sd">        The user should specify either `sigma` or `p`, but not both</span>
</span><span id="FisherMatrix-1487"><a href="#FisherMatrix-1487"><span class="linenos">1487</span></a><span class="sd">        simultaneously.</span>
</span><span id="FisherMatrix-1488"><a href="#FisherMatrix-1488"><span class="linenos">1488</span></a><span class="sd">        If neither are specified, defaults to `sigma=1`.</span>
</span><span id="FisherMatrix-1489"><a href="#FisherMatrix-1489"><span class="linenos">1489</span></a>
</span><span id="FisherMatrix-1490"><a href="#FisherMatrix-1490"><span class="linenos">1490</span></a><span class="sd">        The relationship between `p` and `sigma` is defined via:</span>
</span><span id="FisherMatrix-1491"><a href="#FisherMatrix-1491"><span class="linenos">1491</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-1492"><a href="#FisherMatrix-1492"><span class="linenos">1492</span></a><span class="sd">            p(\sigma) = \int\limits_{\mu - \sigma}^{\mu + \sigma}</span>
</span><span id="FisherMatrix-1493"><a href="#FisherMatrix-1493"><span class="linenos">1493</span></a><span class="sd">                        f(x, \mu, 1)\, \mathrm{d}x</span>
</span><span id="FisherMatrix-1494"><a href="#FisherMatrix-1494"><span class="linenos">1494</span></a><span class="sd">                      = \mathrm{Erf}(\sigma / \sqrt{2})</span>
</span><span id="FisherMatrix-1495"><a href="#FisherMatrix-1495"><span class="linenos">1495</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-1496"><a href="#FisherMatrix-1496"><span class="linenos">1496</span></a><span class="sd">        and therefore the inverse is simply:</span>
</span><span id="FisherMatrix-1497"><a href="#FisherMatrix-1497"><span class="linenos">1497</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-1498"><a href="#FisherMatrix-1498"><span class="linenos">1498</span></a><span class="sd">            \sigma(p) = \sqrt{2}\, \mathrm{Erf}^{-1}(p)</span>
</span><span id="FisherMatrix-1499"><a href="#FisherMatrix-1499"><span class="linenos">1499</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-1500"><a href="#FisherMatrix-1500"><span class="linenos">1500</span></a><span class="sd">        The values of `p` corresponding to 1, 2, 3 `sigma` are roughly</span>
</span><span id="FisherMatrix-1501"><a href="#FisherMatrix-1501"><span class="linenos">1501</span></a><span class="sd">        0.683, 0.954, and 0.997, respectively.</span>
</span><span id="FisherMatrix-1502"><a href="#FisherMatrix-1502"><span class="linenos">1502</span></a>
</span><span id="FisherMatrix-1503"><a href="#FisherMatrix-1503"><span class="linenos">1503</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1504"><a href="#FisherMatrix-1504"><span class="linenos">1504</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1505"><a href="#FisherMatrix-1505"><span class="linenos">1505</span></a><span class="sd">        Get (marginalized by default) constraints for all parameters:</span>
</span><span id="FisherMatrix-1506"><a href="#FisherMatrix-1506"><span class="linenos">1506</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix([[3, -2], [-2, 5]])</span>
</span><span id="FisherMatrix-1507"><a href="#FisherMatrix-1507"><span class="linenos">1507</span></a><span class="sd">        &gt;&gt;&gt; m.constraints()</span>
</span><span id="FisherMatrix-1508"><a href="#FisherMatrix-1508"><span class="linenos">1508</span></a><span class="sd">        array([0.67419986, 0.52223297])</span>
</span><span id="FisherMatrix-1509"><a href="#FisherMatrix-1509"><span class="linenos">1509</span></a>
</span><span id="FisherMatrix-1510"><a href="#FisherMatrix-1510"><span class="linenos">1510</span></a><span class="sd">        Get the unmarginalized constraints instead:</span>
</span><span id="FisherMatrix-1511"><a href="#FisherMatrix-1511"><span class="linenos">1511</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(marginalized=False)</span>
</span><span id="FisherMatrix-1512"><a href="#FisherMatrix-1512"><span class="linenos">1512</span></a><span class="sd">        array([0.57735027, 0.4472136 ])</span>
</span><span id="FisherMatrix-1513"><a href="#FisherMatrix-1513"><span class="linenos">1513</span></a>
</span><span id="FisherMatrix-1514"><a href="#FisherMatrix-1514"><span class="linenos">1514</span></a><span class="sd">        Get the unmarginalized constraints for a single parameter:</span>
</span><span id="FisherMatrix-1515"><a href="#FisherMatrix-1515"><span class="linenos">1515</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(&#39;p1&#39;, marginalized=False)</span>
</span><span id="FisherMatrix-1516"><a href="#FisherMatrix-1516"><span class="linenos">1516</span></a><span class="sd">        array([0.57735027])</span>
</span><span id="FisherMatrix-1517"><a href="#FisherMatrix-1517"><span class="linenos">1517</span></a>
</span><span id="FisherMatrix-1518"><a href="#FisherMatrix-1518"><span class="linenos">1518</span></a><span class="sd">        Get the marginalized constraints for a single parameter:</span>
</span><span id="FisherMatrix-1519"><a href="#FisherMatrix-1519"><span class="linenos">1519</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(&#39;p1&#39;, p=0.682689) # p-value roughly equal to 1 sigma</span>
</span><span id="FisherMatrix-1520"><a href="#FisherMatrix-1520"><span class="linenos">1520</span></a><span class="sd">        array([0.67419918])</span>
</span><span id="FisherMatrix-1521"><a href="#FisherMatrix-1521"><span class="linenos">1521</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1522"><a href="#FisherMatrix-1522"><span class="linenos">1522</span></a>        <span class="n">sigma</span> <span class="o">=</span> <span class="n">_parse_sigma</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span><span id="FisherMatrix-1523"><a href="#FisherMatrix-1523"><span class="linenos">1523</span></a>
</span><span id="FisherMatrix-1524"><a href="#FisherMatrix-1524"><span class="linenos">1524</span></a>        <span class="k">if</span> <span class="n">marginalized</span><span class="p">:</span>
</span><span id="FisherMatrix-1525"><a href="#FisherMatrix-1525"><span class="linenos">1525</span></a>            <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1526"><a href="#FisherMatrix-1526"><span class="linenos">1526</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="FisherMatrix-1527"><a href="#FisherMatrix-1527"><span class="linenos">1527</span></a>                <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1528"><a href="#FisherMatrix-1528"><span class="linenos">1528</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1529"><a href="#FisherMatrix-1529"><span class="linenos">1529</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1530"><a href="#FisherMatrix-1530"><span class="linenos">1530</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-1531"><a href="#FisherMatrix-1531"><span class="linenos">1531</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">inv</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">*</span> <span class="n">sigma</span>
</span><span id="FisherMatrix-1532"><a href="#FisherMatrix-1532"><span class="linenos">1532</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1533"><a href="#FisherMatrix-1533"><span class="linenos">1533</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">*</span> <span class="n">sigma</span>
</span><span id="FisherMatrix-1534"><a href="#FisherMatrix-1534"><span class="linenos">1534</span></a>
</span><span id="FisherMatrix-1535"><a href="#FisherMatrix-1535"><span class="linenos">1535</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-1536"><a href="#FisherMatrix-1536"><span class="linenos">1536</span></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-1537"><a href="#FisherMatrix-1537"><span class="linenos">1537</span></a>                <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)]</span>
</span><span id="FisherMatrix-1538"><a href="#FisherMatrix-1538"><span class="linenos">1538</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1539"><a href="#FisherMatrix-1539"><span class="linenos">1539</span></a>
</span><span id="FisherMatrix-1540"><a href="#FisherMatrix-1540"><span class="linenos">1540</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="FisherMatrix-1541"><a href="#FisherMatrix-1541"><span class="linenos">1541</span></a>
</span><span id="FisherMatrix-1542"><a href="#FisherMatrix-1542"><span class="linenos">1542</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span>
</span><span id="FisherMatrix-1543"><a href="#FisherMatrix-1543"><span class="linenos">1543</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1544"><a href="#FisherMatrix-1544"><span class="linenos">1544</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherMatrix-1545"><a href="#FisherMatrix-1545"><span class="linenos">1545</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1546"><a href="#FisherMatrix-1546"><span class="linenos">1546</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1547"><a href="#FisherMatrix-1547"><span class="linenos">1547</span></a><span class="sd">        Return the result of adding two Fisher objects.</span>
</span><span id="FisherMatrix-1548"><a href="#FisherMatrix-1548"><span class="linenos">1548</span></a>
</span><span id="FisherMatrix-1549"><a href="#FisherMatrix-1549"><span class="linenos">1549</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-1550"><a href="#FisherMatrix-1550"><span class="linenos">1550</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-1551"><a href="#FisherMatrix-1551"><span class="linenos">1551</span></a><span class="sd">        We can add or subtract Fisher objects which have different parameter</span>
</span><span id="FisherMatrix-1552"><a href="#FisherMatrix-1552"><span class="linenos">1552</span></a><span class="sd">        names.</span>
</span><span id="FisherMatrix-1553"><a href="#FisherMatrix-1553"><span class="linenos">1553</span></a>
</span><span id="FisherMatrix-1554"><a href="#FisherMatrix-1554"><span class="linenos">1554</span></a><span class="sd">        Due to the peculiarities of Python&#39;s `set` built-in, the ordering of</span>
</span><span id="FisherMatrix-1555"><a href="#FisherMatrix-1555"><span class="linenos">1555</span></a><span class="sd">        names in the result is not guaranteed to be preserved, even for</span>
</span><span id="FisherMatrix-1556"><a href="#FisherMatrix-1556"><span class="linenos">1556</span></a><span class="sd">        identical inputs. This is not a problem though, since `__eq__` can</span>
</span><span id="FisherMatrix-1557"><a href="#FisherMatrix-1557"><span class="linenos">1557</span></a><span class="sd">        handle parameter shuffling, so if `m1` and `m2` are instances of</span>
</span><span id="FisherMatrix-1558"><a href="#FisherMatrix-1558"><span class="linenos">1558</span></a><span class="sd">        `FisherMatrix`, `m1 + m2 == m1 + m2` will always yield `True`.</span>
</span><span id="FisherMatrix-1559"><a href="#FisherMatrix-1559"><span class="linenos">1559</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1560"><a href="#FisherMatrix-1560"><span class="linenos">1560</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="FisherMatrix-1561"><a href="#FisherMatrix-1561"><span class="linenos">1561</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="FisherMatrix-1562"><a href="#FisherMatrix-1562"><span class="linenos">1562</span></a>                <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">))]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="FisherMatrix-1563"><a href="#FisherMatrix-1563"><span class="linenos">1563</span></a>                <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
</span><span id="FisherMatrix-1564"><a href="#FisherMatrix-1564"><span class="linenos">1564</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-1565"><a href="#FisherMatrix-1565"><span class="linenos">1565</span></a>
</span><span id="FisherMatrix-1566"><a href="#FisherMatrix-1566"><span class="linenos">1566</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
</span><span id="FisherMatrix-1567"><a href="#FisherMatrix-1567"><span class="linenos">1567</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FisherMatrix-1568"><a href="#FisherMatrix-1568"><span class="linenos">1568</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FisherMatrix-1569"><a href="#FisherMatrix-1569"><span class="linenos">1569</span></a>            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-1570"><a href="#FisherMatrix-1570"><span class="linenos">1570</span></a>                <span class="n">fiducial1</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FisherMatrix-1571"><a href="#FisherMatrix-1571"><span class="linenos">1571</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix-1572"><a href="#FisherMatrix-1572"><span class="linenos">1572</span></a>                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherMatrix-1573"><a href="#FisherMatrix-1573"><span class="linenos">1573</span></a>                    <span class="k">else</span> <span class="kc">None</span>
</span><span id="FisherMatrix-1574"><a href="#FisherMatrix-1574"><span class="linenos">1574</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1575"><a href="#FisherMatrix-1575"><span class="linenos">1575</span></a>                <span class="n">fiducial2</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FisherMatrix-1576"><a href="#FisherMatrix-1576"><span class="linenos">1576</span></a>                    <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix-1577"><a href="#FisherMatrix-1577"><span class="linenos">1577</span></a>                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherMatrix-1578"><a href="#FisherMatrix-1578"><span class="linenos">1578</span></a>                    <span class="k">else</span> <span class="kc">None</span>
</span><span id="FisherMatrix-1579"><a href="#FisherMatrix-1579"><span class="linenos">1579</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1580"><a href="#FisherMatrix-1580"><span class="linenos">1580</span></a>                <span class="n">latex_name1</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FisherMatrix-1581"><a href="#FisherMatrix-1581"><span class="linenos">1581</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix-1582"><a href="#FisherMatrix-1582"><span class="linenos">1582</span></a>                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherMatrix-1583"><a href="#FisherMatrix-1583"><span class="linenos">1583</span></a>                    <span class="k">else</span> <span class="kc">None</span>
</span><span id="FisherMatrix-1584"><a href="#FisherMatrix-1584"><span class="linenos">1584</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1585"><a href="#FisherMatrix-1585"><span class="linenos">1585</span></a>                <span class="n">latex_name2</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FisherMatrix-1586"><a href="#FisherMatrix-1586"><span class="linenos">1586</span></a>                    <span class="n">other</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix-1587"><a href="#FisherMatrix-1587"><span class="linenos">1587</span></a>                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherMatrix-1588"><a href="#FisherMatrix-1588"><span class="linenos">1588</span></a>                    <span class="k">else</span> <span class="kc">None</span>
</span><span id="FisherMatrix-1589"><a href="#FisherMatrix-1589"><span class="linenos">1589</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1590"><a href="#FisherMatrix-1590"><span class="linenos">1590</span></a>
</span><span id="FisherMatrix-1591"><a href="#FisherMatrix-1591"><span class="linenos">1591</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="FisherMatrix-1592"><a href="#FisherMatrix-1592"><span class="linenos">1592</span></a>                    <span class="n">fiducial1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FisherMatrix-1593"><a href="#FisherMatrix-1593"><span class="linenos">1593</span></a>                    <span class="ow">and</span> <span class="n">fiducial2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FisherMatrix-1594"><a href="#FisherMatrix-1594"><span class="linenos">1594</span></a>                    <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducial1</span><span class="p">,</span> <span class="n">fiducial2</span><span class="p">)</span>
</span><span id="FisherMatrix-1595"><a href="#FisherMatrix-1595"><span class="linenos">1595</span></a>                <span class="p">):</span>
</span><span id="FisherMatrix-1596"><a href="#FisherMatrix-1596"><span class="linenos">1596</span></a>                    <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span>
</span><span id="FisherMatrix-1597"><a href="#FisherMatrix-1597"><span class="linenos">1597</span></a>                        <span class="s2">&quot;fiducial values&quot;</span><span class="p">,</span> <span class="n">fiducial1</span><span class="p">,</span> <span class="n">fiducial2</span>
</span><span id="FisherMatrix-1598"><a href="#FisherMatrix-1598"><span class="linenos">1598</span></a>                    <span class="p">)</span>
</span><span id="FisherMatrix-1599"><a href="#FisherMatrix-1599"><span class="linenos">1599</span></a>
</span><span id="FisherMatrix-1600"><a href="#FisherMatrix-1600"><span class="linenos">1600</span></a>                <span class="n">fiducials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fiducial1</span> <span class="k">if</span> <span class="n">fiducial1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fiducial2</span><span class="p">)</span>
</span><span id="FisherMatrix-1601"><a href="#FisherMatrix-1601"><span class="linenos">1601</span></a>                <span class="n">latex_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="FisherMatrix-1602"><a href="#FisherMatrix-1602"><span class="linenos">1602</span></a>                    <span class="n">latex_name1</span> <span class="k">if</span> <span class="n">latex_name1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">latex_name2</span>
</span><span id="FisherMatrix-1603"><a href="#FisherMatrix-1603"><span class="linenos">1603</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1604"><a href="#FisherMatrix-1604"><span class="linenos">1604</span></a>
</span><span id="FisherMatrix-1605"><a href="#FisherMatrix-1605"><span class="linenos">1605</span></a>            <span class="c1"># TODO make this work for arbitrary number of dimensions</span>
</span><span id="FisherMatrix-1606"><a href="#FisherMatrix-1606"><span class="linenos">1606</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">index1</span><span class="p">,</span> <span class="n">name1</span><span class="p">),</span> <span class="p">(</span><span class="n">index2</span><span class="p">,</span> <span class="n">name2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="FisherMatrix-1607"><a href="#FisherMatrix-1607"><span class="linenos">1607</span></a>                <span class="c1"># case 1: the names are in both</span>
</span><span id="FisherMatrix-1608"><a href="#FisherMatrix-1608"><span class="linenos">1608</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="FisherMatrix-1609"><a href="#FisherMatrix-1609"><span class="linenos">1609</span></a>                    <span class="n">name1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherMatrix-1610"><a href="#FisherMatrix-1610"><span class="linenos">1610</span></a>                    <span class="ow">and</span> <span class="n">name2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherMatrix-1611"><a href="#FisherMatrix-1611"><span class="linenos">1611</span></a>                    <span class="ow">and</span> <span class="n">name1</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherMatrix-1612"><a href="#FisherMatrix-1612"><span class="linenos">1612</span></a>                    <span class="ow">and</span> <span class="n">name2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherMatrix-1613"><a href="#FisherMatrix-1613"><span class="linenos">1613</span></a>                <span class="p">):</span>
</span><span id="FisherMatrix-1614"><a href="#FisherMatrix-1614"><span class="linenos">1614</span></a>                    <span class="n">values</span><span class="p">[</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span> <span class="o">+</span> <span class="n">other</span><span class="p">[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span>
</span><span id="FisherMatrix-1615"><a href="#FisherMatrix-1615"><span class="linenos">1615</span></a>                <span class="c1"># case 2a: the names are in the left one only</span>
</span><span id="FisherMatrix-1616"><a href="#FisherMatrix-1616"><span class="linenos">1616</span></a>                <span class="k">elif</span> <span class="n">name1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="ow">and</span> <span class="n">name2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-1617"><a href="#FisherMatrix-1617"><span class="linenos">1617</span></a>                    <span class="n">values</span><span class="p">[</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span>
</span><span id="FisherMatrix-1618"><a href="#FisherMatrix-1618"><span class="linenos">1618</span></a>                <span class="c1"># case 2b: the names are in the right one only</span>
</span><span id="FisherMatrix-1619"><a href="#FisherMatrix-1619"><span class="linenos">1619</span></a>                <span class="k">elif</span> <span class="n">name1</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span> <span class="ow">and</span> <span class="n">name2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-1620"><a href="#FisherMatrix-1620"><span class="linenos">1620</span></a>                    <span class="n">values</span><span class="p">[</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span>
</span><span id="FisherMatrix-1621"><a href="#FisherMatrix-1621"><span class="linenos">1621</span></a>                <span class="c1"># case 3: one name is in one, but not the other</span>
</span><span id="FisherMatrix-1622"><a href="#FisherMatrix-1622"><span class="linenos">1622</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1623"><a href="#FisherMatrix-1623"><span class="linenos">1623</span></a>                    <span class="n">values</span><span class="p">[</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FisherMatrix-1624"><a href="#FisherMatrix-1624"><span class="linenos">1624</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1625"><a href="#FisherMatrix-1625"><span class="linenos">1625</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">other</span>
</span><span id="FisherMatrix-1626"><a href="#FisherMatrix-1626"><span class="linenos">1626</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherMatrix-1627"><a href="#FisherMatrix-1627"><span class="linenos">1627</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span>
</span><span id="FisherMatrix-1628"><a href="#FisherMatrix-1628"><span class="linenos">1628</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span>
</span><span id="FisherMatrix-1629"><a href="#FisherMatrix-1629"><span class="linenos">1629</span></a>
</span><span id="FisherMatrix-1630"><a href="#FisherMatrix-1630"><span class="linenos">1630</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1631"><a href="#FisherMatrix-1631"><span class="linenos">1631</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1632"><a href="#FisherMatrix-1632"><span class="linenos">1632</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1633"><a href="#FisherMatrix-1633"><span class="linenos">1633</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1634"><a href="#FisherMatrix-1634"><span class="linenos">1634</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1635"><a href="#FisherMatrix-1635"><span class="linenos">1635</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1636"><a href="#FisherMatrix-1636"><span class="linenos">1636</span></a>
</span><span id="FisherMatrix-1637"><a href="#FisherMatrix-1637"><span class="linenos">1637</span></a>    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span>
</span><span id="FisherMatrix-1638"><a href="#FisherMatrix-1638"><span class="linenos">1638</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1639"><a href="#FisherMatrix-1639"><span class="linenos">1639</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherMatrix-1640"><a href="#FisherMatrix-1640"><span class="linenos">1640</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1641"><a href="#FisherMatrix-1641"><span class="linenos">1641</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Addition when the Fisher object is the right operand.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1642"><a href="#FisherMatrix-1642"><span class="linenos">1642</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="FisherMatrix-1643"><a href="#FisherMatrix-1643"><span class="linenos">1643</span></a>
</span><span id="FisherMatrix-1644"><a href="#FisherMatrix-1644"><span class="linenos">1644</span></a>    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1645"><a href="#FisherMatrix-1645"><span class="linenos">1645</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the negation of the Fisher object.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1646"><a href="#FisherMatrix-1646"><span class="linenos">1646</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1647"><a href="#FisherMatrix-1647"><span class="linenos">1647</span></a>            <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1648"><a href="#FisherMatrix-1648"><span class="linenos">1648</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1649"><a href="#FisherMatrix-1649"><span class="linenos">1649</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1650"><a href="#FisherMatrix-1650"><span class="linenos">1650</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1651"><a href="#FisherMatrix-1651"><span class="linenos">1651</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1652"><a href="#FisherMatrix-1652"><span class="linenos">1652</span></a>
</span><span id="FisherMatrix-1653"><a href="#FisherMatrix-1653"><span class="linenos">1653</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span>
</span><span id="FisherMatrix-1654"><a href="#FisherMatrix-1654"><span class="linenos">1654</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1655"><a href="#FisherMatrix-1655"><span class="linenos">1655</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherMatrix-1656"><a href="#FisherMatrix-1656"><span class="linenos">1656</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1657"><a href="#FisherMatrix-1657"><span class="linenos">1657</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the result of subtracting two Fisher objects.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1658"><a href="#FisherMatrix-1658"><span class="linenos">1658</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>
</span><span id="FisherMatrix-1659"><a href="#FisherMatrix-1659"><span class="linenos">1659</span></a>
</span><span id="FisherMatrix-1660"><a href="#FisherMatrix-1660"><span class="linenos">1660</span></a>    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span>
</span><span id="FisherMatrix-1661"><a href="#FisherMatrix-1661"><span class="linenos">1661</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1662"><a href="#FisherMatrix-1662"><span class="linenos">1662</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherMatrix-1663"><a href="#FisherMatrix-1663"><span class="linenos">1663</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1664"><a href="#FisherMatrix-1664"><span class="linenos">1664</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Subtraction when the Fisher object is the right operand.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1665"><a href="#FisherMatrix-1665"><span class="linenos">1665</span></a>        <span class="c1"># this will never be called if we subtract two FisherMatrix instances,</span>
</span><span id="FisherMatrix-1666"><a href="#FisherMatrix-1666"><span class="linenos">1666</span></a>        <span class="c1"># so we just need to handle floats</span>
</span><span id="FisherMatrix-1667"><a href="#FisherMatrix-1667"><span class="linenos">1667</span></a>        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>
</span><span id="FisherMatrix-1668"><a href="#FisherMatrix-1668"><span class="linenos">1668</span></a>
</span><span id="FisherMatrix-1669"><a href="#FisherMatrix-1669"><span class="linenos">1669</span></a>    <span class="k">def</span> <span class="nf">__array_ufunc__</span><span class="p">(</span>
</span><span id="FisherMatrix-1670"><a href="#FisherMatrix-1670"><span class="linenos">1670</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1671"><a href="#FisherMatrix-1671"><span class="linenos">1671</span></a>        <span class="n">ufunc</span><span class="p">,</span>
</span><span id="FisherMatrix-1672"><a href="#FisherMatrix-1672"><span class="linenos">1672</span></a>        <span class="n">method</span><span class="p">,</span>
</span><span id="FisherMatrix-1673"><a href="#FisherMatrix-1673"><span class="linenos">1673</span></a>        <span class="o">*</span><span class="n">inputs</span><span class="p">,</span>
</span><span id="FisherMatrix-1674"><a href="#FisherMatrix-1674"><span class="linenos">1674</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-1675"><a href="#FisherMatrix-1675"><span class="linenos">1675</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-1676"><a href="#FisherMatrix-1676"><span class="linenos">1676</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1677"><a href="#FisherMatrix-1677"><span class="linenos">1677</span></a><span class="sd">        Handle numpy&#39;s universal functions.</span>
</span><span id="FisherMatrix-1678"><a href="#FisherMatrix-1678"><span class="linenos">1678</span></a>
</span><span id="FisherMatrix-1679"><a href="#FisherMatrix-1679"><span class="linenos">1679</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-1680"><a href="#FisherMatrix-1680"><span class="linenos">1680</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-1681"><a href="#FisherMatrix-1681"><span class="linenos">1681</span></a><span class="sd">        For a complete list and explanation, see:</span>
</span><span id="FisherMatrix-1682"><a href="#FisherMatrix-1682"><span class="linenos">1682</span></a><span class="sd">        https://numpy.org/doc/stable/reference/ufuncs.html</span>
</span><span id="FisherMatrix-1683"><a href="#FisherMatrix-1683"><span class="linenos">1683</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1684"><a href="#FisherMatrix-1684"><span class="linenos">1684</span></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;__call__&quot;</span><span class="p">:</span>
</span><span id="FisherMatrix-1685"><a href="#FisherMatrix-1685"><span class="linenos">1685</span></a>            <span class="n">scalars</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FisherMatrix-1686"><a href="#FisherMatrix-1686"><span class="linenos">1686</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
</span><span id="FisherMatrix-1687"><a href="#FisherMatrix-1687"><span class="linenos">1687</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="FisherMatrix-1688"><a href="#FisherMatrix-1688"><span class="linenos">1688</span></a>                    <span class="n">scalars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="FisherMatrix-1689"><a href="#FisherMatrix-1689"><span class="linenos">1689</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="FisherMatrix-1690"><a href="#FisherMatrix-1690"><span class="linenos">1690</span></a>                    <span class="n">scalars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-1691"><a href="#FisherMatrix-1691"><span class="linenos">1691</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1692"><a href="#FisherMatrix-1692"><span class="linenos">1692</span></a>                    <span class="k">return</span> <span class="bp">NotImplemented</span>
</span><span id="FisherMatrix-1693"><a href="#FisherMatrix-1693"><span class="linenos">1693</span></a>
</span><span id="FisherMatrix-1694"><a href="#FisherMatrix-1694"><span class="linenos">1694</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">names</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">inputs</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)]</span>
</span><span id="FisherMatrix-1695"><a href="#FisherMatrix-1695"><span class="linenos">1695</span></a>
</span><span id="FisherMatrix-1696"><a href="#FisherMatrix-1696"><span class="linenos">1696</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]):</span>
</span><span id="FisherMatrix-1697"><a href="#FisherMatrix-1697"><span class="linenos">1697</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mismatching names&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-1698"><a href="#FisherMatrix-1698"><span class="linenos">1698</span></a>
</span><span id="FisherMatrix-1699"><a href="#FisherMatrix-1699"><span class="linenos">1699</span></a>            <span class="c1"># make sure the names have the same _ordering_</span>
</span><span id="FisherMatrix-1700"><a href="#FisherMatrix-1700"><span class="linenos">1700</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
</span><span id="FisherMatrix-1701"><a href="#FisherMatrix-1701"><span class="linenos">1701</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="FisherMatrix-1702"><a href="#FisherMatrix-1702"><span class="linenos">1702</span></a>                    <span class="n">scalars</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">_</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span>
</span><span id="FisherMatrix-1703"><a href="#FisherMatrix-1703"><span class="linenos">1703</span></a>                        <span class="n">key</span><span class="o">=</span><span class="n">get_index_of_other_array</span><span class="p">(</span>
</span><span id="FisherMatrix-1704"><a href="#FisherMatrix-1704"><span class="linenos">1704</span></a>                            <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="FisherMatrix-1705"><a href="#FisherMatrix-1705"><span class="linenos">1705</span></a>                            <span class="n">_</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1706"><a href="#FisherMatrix-1706"><span class="linenos">1706</span></a>                        <span class="p">)</span>
</span><span id="FisherMatrix-1707"><a href="#FisherMatrix-1707"><span class="linenos">1707</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">values</span>
</span><span id="FisherMatrix-1708"><a href="#FisherMatrix-1708"><span class="linenos">1708</span></a>
</span><span id="FisherMatrix-1709"><a href="#FisherMatrix-1709"><span class="linenos">1709</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1710"><a href="#FisherMatrix-1710"><span class="linenos">1710</span></a>                <span class="n">ufunc</span><span class="p">(</span><span class="o">*</span><span class="n">scalars</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="FisherMatrix-1711"><a href="#FisherMatrix-1711"><span class="linenos">1711</span></a>                <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1712"><a href="#FisherMatrix-1712"><span class="linenos">1712</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1713"><a href="#FisherMatrix-1713"><span class="linenos">1713</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1714"><a href="#FisherMatrix-1714"><span class="linenos">1714</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-1715"><a href="#FisherMatrix-1715"><span class="linenos">1715</span></a>
</span><span id="FisherMatrix-1716"><a href="#FisherMatrix-1716"><span class="linenos">1716</span></a>        <span class="k">return</span> <span class="bp">NotImplemented</span>
</span><span id="FisherMatrix-1717"><a href="#FisherMatrix-1717"><span class="linenos">1717</span></a>
</span><span id="FisherMatrix-1718"><a href="#FisherMatrix-1718"><span class="linenos">1718</span></a>    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span>
</span><span id="FisherMatrix-1719"><a href="#FisherMatrix-1719"><span class="linenos">1719</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1720"><a href="#FisherMatrix-1720"><span class="linenos">1720</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="FisherMatrix-1721"><a href="#FisherMatrix-1721"><span class="linenos">1721</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1722"><a href="#FisherMatrix-1722"><span class="linenos">1722</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Raise the Fisher object to some power.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1723"><a href="#FisherMatrix-1723"><span class="linenos">1723</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1724"><a href="#FisherMatrix-1724"><span class="linenos">1724</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span>
</span><span id="FisherMatrix-1725"><a href="#FisherMatrix-1725"><span class="linenos">1725</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1726"><a href="#FisherMatrix-1726"><span class="linenos">1726</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1727"><a href="#FisherMatrix-1727"><span class="linenos">1727</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1728"><a href="#FisherMatrix-1728"><span class="linenos">1728</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1729"><a href="#FisherMatrix-1729"><span class="linenos">1729</span></a>
</span><span id="FisherMatrix-1730"><a href="#FisherMatrix-1730"><span class="linenos">1730</span></a>    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span>
</span><span id="FisherMatrix-1731"><a href="#FisherMatrix-1731"><span class="linenos">1731</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1732"><a href="#FisherMatrix-1732"><span class="linenos">1732</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherMatrix-1733"><a href="#FisherMatrix-1733"><span class="linenos">1733</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-1734"><a href="#FisherMatrix-1734"><span class="linenos">1734</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Matrix-multiply two Fisher objects.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1735"><a href="#FisherMatrix-1735"><span class="linenos">1735</span></a>        <span class="c1"># make sure they have the right parameters</span>
</span><span id="FisherMatrix-1736"><a href="#FisherMatrix-1736"><span class="linenos">1736</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-1737"><a href="#FisherMatrix-1737"><span class="linenos">1737</span></a>            <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1738"><a href="#FisherMatrix-1738"><span class="linenos">1738</span></a>
</span><span id="FisherMatrix-1739"><a href="#FisherMatrix-1739"><span class="linenos">1739</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1740"><a href="#FisherMatrix-1740"><span class="linenos">1740</span></a>
</span><span id="FisherMatrix-1741"><a href="#FisherMatrix-1741"><span class="linenos">1741</span></a>        <span class="c1"># make sure the fiducials match</span>
</span><span id="FisherMatrix-1742"><a href="#FisherMatrix-1742"><span class="linenos">1742</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1743"><a href="#FisherMatrix-1743"><span class="linenos">1743</span></a>
</span><span id="FisherMatrix-1744"><a href="#FisherMatrix-1744"><span class="linenos">1744</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">):</span>
</span><span id="FisherMatrix-1745"><a href="#FisherMatrix-1745"><span class="linenos">1745</span></a>            <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;fiducial value&quot;</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix-1746"><a href="#FisherMatrix-1746"><span class="linenos">1746</span></a>
</span><span id="FisherMatrix-1747"><a href="#FisherMatrix-1747"><span class="linenos">1747</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">@</span> <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1748"><a href="#FisherMatrix-1748"><span class="linenos">1748</span></a>
</span><span id="FisherMatrix-1749"><a href="#FisherMatrix-1749"><span class="linenos">1749</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1750"><a href="#FisherMatrix-1750"><span class="linenos">1750</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1751"><a href="#FisherMatrix-1751"><span class="linenos">1751</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1752"><a href="#FisherMatrix-1752"><span class="linenos">1752</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1753"><a href="#FisherMatrix-1753"><span class="linenos">1753</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1754"><a href="#FisherMatrix-1754"><span class="linenos">1754</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1755"><a href="#FisherMatrix-1755"><span class="linenos">1755</span></a>
</span><span id="FisherMatrix-1756"><a href="#FisherMatrix-1756"><span class="linenos">1756</span></a>    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span>
</span><span id="FisherMatrix-1757"><a href="#FisherMatrix-1757"><span class="linenos">1757</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1758"><a href="#FisherMatrix-1758"><span class="linenos">1758</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FisherMatrix</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="FisherMatrix-1759"><a href="#FisherMatrix-1759"><span class="linenos">1759</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1760"><a href="#FisherMatrix-1760"><span class="linenos">1760</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the result of dividing a Fisher object by a number, or another Fisher object (element-wise).&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1761"><a href="#FisherMatrix-1761"><span class="linenos">1761</span></a>        <span class="c1"># we can only divide two objects if they have the same dimensions and sizes</span>
</span><span id="FisherMatrix-1762"><a href="#FisherMatrix-1762"><span class="linenos">1762</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="FisherMatrix-1763"><a href="#FisherMatrix-1763"><span class="linenos">1763</span></a>            <span class="c1"># maybe it&#39;s a FisherMatrix</span>
</span><span id="FisherMatrix-1764"><a href="#FisherMatrix-1764"><span class="linenos">1764</span></a>            <span class="c1"># make sure they have the right parameters</span>
</span><span id="FisherMatrix-1765"><a href="#FisherMatrix-1765"><span class="linenos">1765</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-1766"><a href="#FisherMatrix-1766"><span class="linenos">1766</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1767"><a href="#FisherMatrix-1767"><span class="linenos">1767</span></a>
</span><span id="FisherMatrix-1768"><a href="#FisherMatrix-1768"><span class="linenos">1768</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1769"><a href="#FisherMatrix-1769"><span class="linenos">1769</span></a>
</span><span id="FisherMatrix-1770"><a href="#FisherMatrix-1770"><span class="linenos">1770</span></a>            <span class="c1"># make sure the fiducials match</span>
</span><span id="FisherMatrix-1771"><a href="#FisherMatrix-1771"><span class="linenos">1771</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1772"><a href="#FisherMatrix-1772"><span class="linenos">1772</span></a>
</span><span id="FisherMatrix-1773"><a href="#FisherMatrix-1773"><span class="linenos">1773</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">):</span>
</span><span id="FisherMatrix-1774"><a href="#FisherMatrix-1774"><span class="linenos">1774</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span>
</span><span id="FisherMatrix-1775"><a href="#FisherMatrix-1775"><span class="linenos">1775</span></a>                    <span class="s2">&quot;fiducial value&quot;</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span>
</span><span id="FisherMatrix-1776"><a href="#FisherMatrix-1776"><span class="linenos">1776</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1777"><a href="#FisherMatrix-1777"><span class="linenos">1777</span></a>
</span><span id="FisherMatrix-1778"><a href="#FisherMatrix-1778"><span class="linenos">1778</span></a>            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="FisherMatrix-1779"><a href="#FisherMatrix-1779"><span class="linenos">1779</span></a>                <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1780"><a href="#FisherMatrix-1780"><span class="linenos">1780</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1781"><a href="#FisherMatrix-1781"><span class="linenos">1781</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">other</span>
</span><span id="FisherMatrix-1782"><a href="#FisherMatrix-1782"><span class="linenos">1782</span></a>
</span><span id="FisherMatrix-1783"><a href="#FisherMatrix-1783"><span class="linenos">1783</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1784"><a href="#FisherMatrix-1784"><span class="linenos">1784</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1785"><a href="#FisherMatrix-1785"><span class="linenos">1785</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1786"><a href="#FisherMatrix-1786"><span class="linenos">1786</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1787"><a href="#FisherMatrix-1787"><span class="linenos">1787</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1788"><a href="#FisherMatrix-1788"><span class="linenos">1788</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1789"><a href="#FisherMatrix-1789"><span class="linenos">1789</span></a>
</span><span id="FisherMatrix-1790"><a href="#FisherMatrix-1790"><span class="linenos">1790</span></a>    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span>
</span><span id="FisherMatrix-1791"><a href="#FisherMatrix-1791"><span class="linenos">1791</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1792"><a href="#FisherMatrix-1792"><span class="linenos">1792</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FisherMatrix</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="FisherMatrix-1793"><a href="#FisherMatrix-1793"><span class="linenos">1793</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1794"><a href="#FisherMatrix-1794"><span class="linenos">1794</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the result of multiplying a Fisher object by a number, or another Fisher object (element-wise).&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1795"><a href="#FisherMatrix-1795"><span class="linenos">1795</span></a>        <span class="c1"># we can only multiply two objects if they have the same dimensions and sizes</span>
</span><span id="FisherMatrix-1796"><a href="#FisherMatrix-1796"><span class="linenos">1796</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="FisherMatrix-1797"><a href="#FisherMatrix-1797"><span class="linenos">1797</span></a>            <span class="c1"># maybe it&#39;s a FisherMatrix</span>
</span><span id="FisherMatrix-1798"><a href="#FisherMatrix-1798"><span class="linenos">1798</span></a>            <span class="c1"># make sure they have the right parameters</span>
</span><span id="FisherMatrix-1799"><a href="#FisherMatrix-1799"><span class="linenos">1799</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-1800"><a href="#FisherMatrix-1800"><span class="linenos">1800</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1801"><a href="#FisherMatrix-1801"><span class="linenos">1801</span></a>
</span><span id="FisherMatrix-1802"><a href="#FisherMatrix-1802"><span class="linenos">1802</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1803"><a href="#FisherMatrix-1803"><span class="linenos">1803</span></a>
</span><span id="FisherMatrix-1804"><a href="#FisherMatrix-1804"><span class="linenos">1804</span></a>            <span class="c1"># make sure the fiducials match</span>
</span><span id="FisherMatrix-1805"><a href="#FisherMatrix-1805"><span class="linenos">1805</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1806"><a href="#FisherMatrix-1806"><span class="linenos">1806</span></a>
</span><span id="FisherMatrix-1807"><a href="#FisherMatrix-1807"><span class="linenos">1807</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">):</span>
</span><span id="FisherMatrix-1808"><a href="#FisherMatrix-1808"><span class="linenos">1808</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span>
</span><span id="FisherMatrix-1809"><a href="#FisherMatrix-1809"><span class="linenos">1809</span></a>                    <span class="s2">&quot;fiducial value&quot;</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span>
</span><span id="FisherMatrix-1810"><a href="#FisherMatrix-1810"><span class="linenos">1810</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1811"><a href="#FisherMatrix-1811"><span class="linenos">1811</span></a>
</span><span id="FisherMatrix-1812"><a href="#FisherMatrix-1812"><span class="linenos">1812</span></a>            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="FisherMatrix-1813"><a href="#FisherMatrix-1813"><span class="linenos">1813</span></a>                <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1814"><a href="#FisherMatrix-1814"><span class="linenos">1814</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1815"><a href="#FisherMatrix-1815"><span class="linenos">1815</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">other</span>
</span><span id="FisherMatrix-1816"><a href="#FisherMatrix-1816"><span class="linenos">1816</span></a>
</span><span id="FisherMatrix-1817"><a href="#FisherMatrix-1817"><span class="linenos">1817</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1818"><a href="#FisherMatrix-1818"><span class="linenos">1818</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1819"><a href="#FisherMatrix-1819"><span class="linenos">1819</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1820"><a href="#FisherMatrix-1820"><span class="linenos">1820</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1821"><a href="#FisherMatrix-1821"><span class="linenos">1821</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1822"><a href="#FisherMatrix-1822"><span class="linenos">1822</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1823"><a href="#FisherMatrix-1823"><span class="linenos">1823</span></a>
</span><span id="FisherMatrix-1824"><a href="#FisherMatrix-1824"><span class="linenos">1824</span></a>    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span>
</span><span id="FisherMatrix-1825"><a href="#FisherMatrix-1825"><span class="linenos">1825</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1826"><a href="#FisherMatrix-1826"><span class="linenos">1826</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FisherMatrix</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="FisherMatrix-1827"><a href="#FisherMatrix-1827"><span class="linenos">1827</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1828"><a href="#FisherMatrix-1828"><span class="linenos">1828</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the result of multiplying a number by a Fisher object, or another Fisher object (element-wise).&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1829"><a href="#FisherMatrix-1829"><span class="linenos">1829</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="FisherMatrix-1830"><a href="#FisherMatrix-1830"><span class="linenos">1830</span></a>
</span><span id="FisherMatrix-1831"><a href="#FisherMatrix-1831"><span class="linenos">1831</span></a>    <span class="k">def</span> <span class="nf">reparametrize_symbolic</span><span class="p">(</span>
</span><span id="FisherMatrix-1832"><a href="#FisherMatrix-1832"><span class="linenos">1832</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1833"><a href="#FisherMatrix-1833"><span class="linenos">1833</span></a>        <span class="n">transformation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
</span><span id="FisherMatrix-1834"><a href="#FisherMatrix-1834"><span class="linenos">1834</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-1835"><a href="#FisherMatrix-1835"><span class="linenos">1835</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-1836"><a href="#FisherMatrix-1836"><span class="linenos">1836</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1837"><a href="#FisherMatrix-1837"><span class="linenos">1837</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1838"><a href="#FisherMatrix-1838"><span class="linenos">1838</span></a><span class="sd">        Perform a symbolic transformation of the Fisher object.</span>
</span><span id="FisherMatrix-1839"><a href="#FisherMatrix-1839"><span class="linenos">1839</span></a>
</span><span id="FisherMatrix-1840"><a href="#FisherMatrix-1840"><span class="linenos">1840</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1841"><a href="#FisherMatrix-1841"><span class="linenos">1841</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1842"><a href="#FisherMatrix-1842"><span class="linenos">1842</span></a><span class="sd">        transformation : mapping</span>
</span><span id="FisherMatrix-1843"><a href="#FisherMatrix-1843"><span class="linenos">1843</span></a><span class="sd">            a mapping between the old and new parameters (or new and old ones)</span>
</span><span id="FisherMatrix-1844"><a href="#FisherMatrix-1844"><span class="linenos">1844</span></a>
</span><span id="FisherMatrix-1845"><a href="#FisherMatrix-1845"><span class="linenos">1845</span></a><span class="sd">        latex_names : mapping, optional</span>
</span><span id="FisherMatrix-1846"><a href="#FisherMatrix-1846"><span class="linenos">1846</span></a><span class="sd">            a dictionary with the names of new parameters as keys, and LaTeX</span>
</span><span id="FisherMatrix-1847"><a href="#FisherMatrix-1847"><span class="linenos">1847</span></a><span class="sd">            names of new parameters as values (default: None). If not</span>
</span><span id="FisherMatrix-1848"><a href="#FisherMatrix-1848"><span class="linenos">1848</span></a><span class="sd">            specified, uses the names extracted from `transformation`.</span>
</span><span id="FisherMatrix-1849"><a href="#FisherMatrix-1849"><span class="linenos">1849</span></a>
</span><span id="FisherMatrix-1850"><a href="#FisherMatrix-1850"><span class="linenos">1850</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix-1851"><a href="#FisherMatrix-1851"><span class="linenos">1851</span></a><span class="sd">            any optional keyword arguments passed to the solver for obtaining</span>
</span><span id="FisherMatrix-1852"><a href="#FisherMatrix-1852"><span class="linenos">1852</span></a><span class="sd">            the new fiducials. Available arguments:</span>
</span><span id="FisherMatrix-1853"><a href="#FisherMatrix-1853"><span class="linenos">1853</span></a><span class="sd">            - `solution_index`, int: in case of multiple solutions, one can select</span>
</span><span id="FisherMatrix-1854"><a href="#FisherMatrix-1854"><span class="linenos">1854</span></a><span class="sd">              the index of the solution (default: None, meaning the first</span>
</span><span id="FisherMatrix-1855"><a href="#FisherMatrix-1855"><span class="linenos">1855</span></a><span class="sd">              element is selected)</span>
</span><span id="FisherMatrix-1856"><a href="#FisherMatrix-1856"><span class="linenos">1856</span></a><span class="sd">            - `initial_guess`, dict: in case of using the numerical solver,</span>
</span><span id="FisherMatrix-1857"><a href="#FisherMatrix-1857"><span class="linenos">1857</span></a><span class="sd">              this should be a dictionary of the initial guesses for the new</span>
</span><span id="FisherMatrix-1858"><a href="#FisherMatrix-1858"><span class="linenos">1858</span></a><span class="sd">              fiducials (default: None, and the initial guess is set to all</span>
</span><span id="FisherMatrix-1859"><a href="#FisherMatrix-1859"><span class="linenos">1859</span></a><span class="sd">              ones)</span>
</span><span id="FisherMatrix-1860"><a href="#FisherMatrix-1860"><span class="linenos">1860</span></a>
</span><span id="FisherMatrix-1861"><a href="#FisherMatrix-1861"><span class="linenos">1861</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1862"><a href="#FisherMatrix-1862"><span class="linenos">1862</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1863"><a href="#FisherMatrix-1863"><span class="linenos">1863</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix-1864"><a href="#FisherMatrix-1864"><span class="linenos">1864</span></a><span class="sd">            The new Fisher object with the specified names, LaTeX names, and</span>
</span><span id="FisherMatrix-1865"><a href="#FisherMatrix-1865"><span class="linenos">1865</span></a><span class="sd">            fiducials.</span>
</span><span id="FisherMatrix-1866"><a href="#FisherMatrix-1866"><span class="linenos">1866</span></a>
</span><span id="FisherMatrix-1867"><a href="#FisherMatrix-1867"><span class="linenos">1867</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-1868"><a href="#FisherMatrix-1868"><span class="linenos">1868</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-1869"><a href="#FisherMatrix-1869"><span class="linenos">1869</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix-1870"><a href="#FisherMatrix-1870"><span class="linenos">1870</span></a><span class="sd">            if any of the keys in the mapping is not in the names of the Fisher</span>
</span><span id="FisherMatrix-1871"><a href="#FisherMatrix-1871"><span class="linenos">1871</span></a><span class="sd">            matrix</span>
</span><span id="FisherMatrix-1872"><a href="#FisherMatrix-1872"><span class="linenos">1872</span></a>
</span><span id="FisherMatrix-1873"><a href="#FisherMatrix-1873"><span class="linenos">1873</span></a><span class="sd">        SympifyError</span>
</span><span id="FisherMatrix-1874"><a href="#FisherMatrix-1874"><span class="linenos">1874</span></a><span class="sd">            if any of the expressions in the values cannot be transformed using</span>
</span><span id="FisherMatrix-1875"><a href="#FisherMatrix-1875"><span class="linenos">1875</span></a><span class="sd">            &lt;a</span>
</span><span id="FisherMatrix-1876"><a href="#FisherMatrix-1876"><span class="linenos">1876</span></a><span class="sd">            href=&quot;https://docs.sympy.org/latest/modules/core.html#module-sympy.core.sympify&quot;</span>
</span><span id="FisherMatrix-1877"><a href="#FisherMatrix-1877"><span class="linenos">1877</span></a><span class="sd">            target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;`sympy.sympify`&lt;/a&gt;</span>
</span><span id="FisherMatrix-1878"><a href="#FisherMatrix-1878"><span class="linenos">1878</span></a>
</span><span id="FisherMatrix-1879"><a href="#FisherMatrix-1879"><span class="linenos">1879</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix-1880"><a href="#FisherMatrix-1880"><span class="linenos">1880</span></a><span class="sd">            if SymPy is is unable to find a solution for the new fiducials</span>
</span><span id="FisherMatrix-1881"><a href="#FisherMatrix-1881"><span class="linenos">1881</span></a>
</span><span id="FisherMatrix-1882"><a href="#FisherMatrix-1882"><span class="linenos">1882</span></a><span class="sd">        TypeError</span>
</span><span id="FisherMatrix-1883"><a href="#FisherMatrix-1883"><span class="linenos">1883</span></a><span class="sd">            if SymPy is unable to find a real solution for the new fiducials</span>
</span><span id="FisherMatrix-1884"><a href="#FisherMatrix-1884"><span class="linenos">1884</span></a>
</span><span id="FisherMatrix-1885"><a href="#FisherMatrix-1885"><span class="linenos">1885</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix-1886"><a href="#FisherMatrix-1886"><span class="linenos">1886</span></a><span class="sd">            if any of the old parameters is on both sides of the mapping</span>
</span><span id="FisherMatrix-1887"><a href="#FisherMatrix-1887"><span class="linenos">1887</span></a>
</span><span id="FisherMatrix-1888"><a href="#FisherMatrix-1888"><span class="linenos">1888</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix-1889"><a href="#FisherMatrix-1889"><span class="linenos">1889</span></a><span class="sd">            if the number of new parameters is different from the number of old</span>
</span><span id="FisherMatrix-1890"><a href="#FisherMatrix-1890"><span class="linenos">1890</span></a><span class="sd">            parameters</span>
</span><span id="FisherMatrix-1891"><a href="#FisherMatrix-1891"><span class="linenos">1891</span></a>
</span><span id="FisherMatrix-1892"><a href="#FisherMatrix-1892"><span class="linenos">1892</span></a><span class="sd">        Warns</span>
</span><span id="FisherMatrix-1893"><a href="#FisherMatrix-1893"><span class="linenos">1893</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-1894"><a href="#FisherMatrix-1894"><span class="linenos">1894</span></a><span class="sd">        UserWarning</span>
</span><span id="FisherMatrix-1895"><a href="#FisherMatrix-1895"><span class="linenos">1895</span></a><span class="sd">            if the SymPy solver returns multiple solutions for the values of</span>
</span><span id="FisherMatrix-1896"><a href="#FisherMatrix-1896"><span class="linenos">1896</span></a><span class="sd">            the new fiducials</span>
</span><span id="FisherMatrix-1897"><a href="#FisherMatrix-1897"><span class="linenos">1897</span></a>
</span><span id="FisherMatrix-1898"><a href="#FisherMatrix-1898"><span class="linenos">1898</span></a><span class="sd">        See Also</span>
</span><span id="FisherMatrix-1899"><a href="#FisherMatrix-1899"><span class="linenos">1899</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1900"><a href="#FisherMatrix-1900"><span class="linenos">1900</span></a><span class="sd">        `reparametrize` : the numerical version of this method</span>
</span><span id="FisherMatrix-1901"><a href="#FisherMatrix-1901"><span class="linenos">1901</span></a>
</span><span id="FisherMatrix-1902"><a href="#FisherMatrix-1902"><span class="linenos">1902</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1903"><a href="#FisherMatrix-1903"><span class="linenos">1903</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1904"><a href="#FisherMatrix-1904"><span class="linenos">1904</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="FisherMatrix-1905"><a href="#FisherMatrix-1905"><span class="linenos">1905</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(</span>
</span><span id="FisherMatrix-1906"><a href="#FisherMatrix-1906"><span class="linenos">1906</span></a><span class="sd">        ... np.diag([1, 2, 3]),</span>
</span><span id="FisherMatrix-1907"><a href="#FisherMatrix-1907"><span class="linenos">1907</span></a><span class="sd">        ... names=[&quot;omega_m&quot;, &quot;omega_b&quot;, &quot;h&quot;],</span>
</span><span id="FisherMatrix-1908"><a href="#FisherMatrix-1908"><span class="linenos">1908</span></a><span class="sd">        ... fiducials=[0.147, 0.025, 0.7],</span>
</span><span id="FisherMatrix-1909"><a href="#FisherMatrix-1909"><span class="linenos">1909</span></a><span class="sd">        ... )</span>
</span><span id="FisherMatrix-1910"><a href="#FisherMatrix-1910"><span class="linenos">1910</span></a>
</span><span id="FisherMatrix-1911"><a href="#FisherMatrix-1911"><span class="linenos">1911</span></a><span class="sd">        Reparametrize it:</span>
</span><span id="FisherMatrix-1912"><a href="#FisherMatrix-1912"><span class="linenos">1912</span></a><span class="sd">        &gt;&gt;&gt; fm.reparametrize_symbolic(</span>
</span><span id="FisherMatrix-1913"><a href="#FisherMatrix-1913"><span class="linenos">1913</span></a><span class="sd">        ... {&#39;omega_m&#39; : &#39;Omega_m * h**2&#39;, &#39;omega_b&#39; : &#39;Omega_b * h**2&#39;}</span>
</span><span id="FisherMatrix-1914"><a href="#FisherMatrix-1914"><span class="linenos">1914</span></a><span class="sd">        ... ).sort(key=[&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;])</span>
</span><span id="FisherMatrix-1915"><a href="#FisherMatrix-1915"><span class="linenos">1915</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1916"><a href="#FisherMatrix-1916"><span class="linenos">1916</span></a><span class="sd">            array([[0.2401    , 0.        , 0.2058    ],</span>
</span><span id="FisherMatrix-1917"><a href="#FisherMatrix-1917"><span class="linenos">1917</span></a><span class="sd">               [0.        , 0.4802    , 0.07      ],</span>
</span><span id="FisherMatrix-1918"><a href="#FisherMatrix-1918"><span class="linenos">1918</span></a><span class="sd">               [0.2058    , 0.07      , 3.18660408]]),</span>
</span><span id="FisherMatrix-1919"><a href="#FisherMatrix-1919"><span class="linenos">1919</span></a><span class="sd">            names=array([&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1920"><a href="#FisherMatrix-1920"><span class="linenos">1920</span></a><span class="sd">            latex_names=array([&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1921"><a href="#FisherMatrix-1921"><span class="linenos">1921</span></a><span class="sd">            fiducials=array([0.3       , 0.05102041, 0.7       ]))</span>
</span><span id="FisherMatrix-1922"><a href="#FisherMatrix-1922"><span class="linenos">1922</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1923"><a href="#FisherMatrix-1923"><span class="linenos">1923</span></a>        <span class="c1"># check that the keys of the dictionary are present in the names</span>
</span><span id="FisherMatrix-1924"><a href="#FisherMatrix-1924"><span class="linenos">1924</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">transformation</span><span class="p">:</span>
</span><span id="FisherMatrix-1925"><a href="#FisherMatrix-1925"><span class="linenos">1925</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-1926"><a href="#FisherMatrix-1926"><span class="linenos">1926</span></a>                <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1927"><a href="#FisherMatrix-1927"><span class="linenos">1927</span></a>
</span><span id="FisherMatrix-1928"><a href="#FisherMatrix-1928"><span class="linenos">1928</span></a>        <span class="c1"># check that we can &quot;sympify&quot; all of the expressions</span>
</span><span id="FisherMatrix-1929"><a href="#FisherMatrix-1929"><span class="linenos">1929</span></a>        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">transformation</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="FisherMatrix-1930"><a href="#FisherMatrix-1930"><span class="linenos">1930</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="FisherMatrix-1931"><a href="#FisherMatrix-1931"><span class="linenos">1931</span></a>                <span class="n">sympy</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="FisherMatrix-1932"><a href="#FisherMatrix-1932"><span class="linenos">1932</span></a>            <span class="k">except</span> <span class="n">sympy</span><span class="o">.</span><span class="n">SympifyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="FisherMatrix-1933"><a href="#FisherMatrix-1933"><span class="linenos">1933</span></a>                <span class="k">raise</span> <span class="n">sympy</span><span class="o">.</span><span class="n">SympifyError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="FisherMatrix-1934"><a href="#FisherMatrix-1934"><span class="linenos">1934</span></a>
</span><span id="FisherMatrix-1935"><a href="#FisherMatrix-1935"><span class="linenos">1935</span></a>        <span class="c1"># get the new names, fiducials, and the Jacobian</span>
</span><span id="FisherMatrix-1936"><a href="#FisherMatrix-1936"><span class="linenos">1936</span></a>        <span class="n">names_new</span><span class="p">,</span> <span class="n">fiducials_new</span><span class="p">,</span> <span class="n">jacobian</span> <span class="o">=</span> <span class="n">_jacobian</span><span class="p">(</span>
</span><span id="FisherMatrix-1937"><a href="#FisherMatrix-1937"><span class="linenos">1937</span></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)),</span>
</span><span id="FisherMatrix-1938"><a href="#FisherMatrix-1938"><span class="linenos">1938</span></a>            <span class="n">transformation</span><span class="p">,</span>
</span><span id="FisherMatrix-1939"><a href="#FisherMatrix-1939"><span class="linenos">1939</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-1940"><a href="#FisherMatrix-1940"><span class="linenos">1940</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1941"><a href="#FisherMatrix-1941"><span class="linenos">1941</span></a>
</span><span id="FisherMatrix-1942"><a href="#FisherMatrix-1942"><span class="linenos">1942</span></a>        <span class="c1"># set the new LaTeX names from the old ones (if they&#39;re still present),</span>
</span><span id="FisherMatrix-1943"><a href="#FisherMatrix-1943"><span class="linenos">1943</span></a>        <span class="c1"># otherwise use the new names</span>
</span><span id="FisherMatrix-1944"><a href="#FisherMatrix-1944"><span class="linenos">1944</span></a>        <span class="n">latex_names_new</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="FisherMatrix-1945"><a href="#FisherMatrix-1945"><span class="linenos">1945</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latex_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="k">else</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">names_new</span>
</span><span id="FisherMatrix-1946"><a href="#FisherMatrix-1946"><span class="linenos">1946</span></a>        <span class="p">]</span>
</span><span id="FisherMatrix-1947"><a href="#FisherMatrix-1947"><span class="linenos">1947</span></a>
</span><span id="FisherMatrix-1948"><a href="#FisherMatrix-1948"><span class="linenos">1948</span></a>        <span class="c1"># in case any of the new names are specified, set them</span>
</span><span id="FisherMatrix-1949"><a href="#FisherMatrix-1949"><span class="linenos">1949</span></a>        <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-1950"><a href="#FisherMatrix-1950"><span class="linenos">1950</span></a>            <span class="n">latex_names_new</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="FisherMatrix-1951"><a href="#FisherMatrix-1951"><span class="linenos">1951</span></a>                <span class="n">latex_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">latex_names</span> <span class="k">else</span> <span class="n">key</span>
</span><span id="FisherMatrix-1952"><a href="#FisherMatrix-1952"><span class="linenos">1952</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">latex_names_new</span>
</span><span id="FisherMatrix-1953"><a href="#FisherMatrix-1953"><span class="linenos">1953</span></a>            <span class="p">]</span>
</span><span id="FisherMatrix-1954"><a href="#FisherMatrix-1954"><span class="linenos">1954</span></a>
</span><span id="FisherMatrix-1955"><a href="#FisherMatrix-1955"><span class="linenos">1955</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reparametrize</span><span class="p">(</span>
</span><span id="FisherMatrix-1956"><a href="#FisherMatrix-1956"><span class="linenos">1956</span></a>            <span class="n">jacobian</span><span class="p">,</span>
</span><span id="FisherMatrix-1957"><a href="#FisherMatrix-1957"><span class="linenos">1957</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names_new</span><span class="p">,</span>
</span><span id="FisherMatrix-1958"><a href="#FisherMatrix-1958"><span class="linenos">1958</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials_new</span><span class="p">,</span>
</span><span id="FisherMatrix-1959"><a href="#FisherMatrix-1959"><span class="linenos">1959</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names_new</span><span class="p">,</span>
</span><span id="FisherMatrix-1960"><a href="#FisherMatrix-1960"><span class="linenos">1960</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1961"><a href="#FisherMatrix-1961"><span class="linenos">1961</span></a>
</span><span id="FisherMatrix-1962"><a href="#FisherMatrix-1962"><span class="linenos">1962</span></a>    <span class="k">def</span> <span class="nf">reparametrize</span><span class="p">(</span>
</span><span id="FisherMatrix-1963"><a href="#FisherMatrix-1963"><span class="linenos">1963</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1964"><a href="#FisherMatrix-1964"><span class="linenos">1964</span></a>        <span class="n">jacobian</span><span class="p">,</span>
</span><span id="FisherMatrix-1965"><a href="#FisherMatrix-1965"><span class="linenos">1965</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-1966"><a href="#FisherMatrix-1966"><span class="linenos">1966</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-1967"><a href="#FisherMatrix-1967"><span class="linenos">1967</span></a>        <span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-1968"><a href="#FisherMatrix-1968"><span class="linenos">1968</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1969"><a href="#FisherMatrix-1969"><span class="linenos">1969</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1970"><a href="#FisherMatrix-1970"><span class="linenos">1970</span></a><span class="sd">        Perform a numerical transformation of the Fisher object using a Jacobian.</span>
</span><span id="FisherMatrix-1971"><a href="#FisherMatrix-1971"><span class="linenos">1971</span></a>
</span><span id="FisherMatrix-1972"><a href="#FisherMatrix-1972"><span class="linenos">1972</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1973"><a href="#FisherMatrix-1973"><span class="linenos">1973</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1974"><a href="#FisherMatrix-1974"><span class="linenos">1974</span></a><span class="sd">        transformation : array_like of float</span>
</span><span id="FisherMatrix-1975"><a href="#FisherMatrix-1975"><span class="linenos">1975</span></a><span class="sd">            the Jacobian of the transformation</span>
</span><span id="FisherMatrix-1976"><a href="#FisherMatrix-1976"><span class="linenos">1976</span></a>
</span><span id="FisherMatrix-1977"><a href="#FisherMatrix-1977"><span class="linenos">1977</span></a><span class="sd">        names : array_like of str, optional</span>
</span><span id="FisherMatrix-1978"><a href="#FisherMatrix-1978"><span class="linenos">1978</span></a><span class="sd">            list of new names for the Fisher object (default: None). If None,</span>
</span><span id="FisherMatrix-1979"><a href="#FisherMatrix-1979"><span class="linenos">1979</span></a><span class="sd">            uses the old names.</span>
</span><span id="FisherMatrix-1980"><a href="#FisherMatrix-1980"><span class="linenos">1980</span></a>
</span><span id="FisherMatrix-1981"><a href="#FisherMatrix-1981"><span class="linenos">1981</span></a><span class="sd">        latex_names: array_like of str, optional</span>
</span><span id="FisherMatrix-1982"><a href="#FisherMatrix-1982"><span class="linenos">1982</span></a><span class="sd">            list of new LaTeX names for the Fisher object (default: None). If</span>
</span><span id="FisherMatrix-1983"><a href="#FisherMatrix-1983"><span class="linenos">1983</span></a><span class="sd">            None, and `names` is set, uses those instead, otherwise uses the</span>
</span><span id="FisherMatrix-1984"><a href="#FisherMatrix-1984"><span class="linenos">1984</span></a><span class="sd">            old LaTeX names.</span>
</span><span id="FisherMatrix-1985"><a href="#FisherMatrix-1985"><span class="linenos">1985</span></a>
</span><span id="FisherMatrix-1986"><a href="#FisherMatrix-1986"><span class="linenos">1986</span></a><span class="sd">        fiducials : array_like of float, optional</span>
</span><span id="FisherMatrix-1987"><a href="#FisherMatrix-1987"><span class="linenos">1987</span></a><span class="sd">            the new values of the fiducials (default: None). If None, defaults</span>
</span><span id="FisherMatrix-1988"><a href="#FisherMatrix-1988"><span class="linenos">1988</span></a><span class="sd">            to the old values of the fiducials.</span>
</span><span id="FisherMatrix-1989"><a href="#FisherMatrix-1989"><span class="linenos">1989</span></a>
</span><span id="FisherMatrix-1990"><a href="#FisherMatrix-1990"><span class="linenos">1990</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1991"><a href="#FisherMatrix-1991"><span class="linenos">1991</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1992"><a href="#FisherMatrix-1992"><span class="linenos">1992</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix-1993"><a href="#FisherMatrix-1993"><span class="linenos">1993</span></a><span class="sd">            The new Fisher object with the specified names, LaTeX names, and</span>
</span><span id="FisherMatrix-1994"><a href="#FisherMatrix-1994"><span class="linenos">1994</span></a><span class="sd">            fiducials.</span>
</span><span id="FisherMatrix-1995"><a href="#FisherMatrix-1995"><span class="linenos">1995</span></a>
</span><span id="FisherMatrix-1996"><a href="#FisherMatrix-1996"><span class="linenos">1996</span></a><span class="sd">        See Also</span>
</span><span id="FisherMatrix-1997"><a href="#FisherMatrix-1997"><span class="linenos">1997</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1998"><a href="#FisherMatrix-1998"><span class="linenos">1998</span></a><span class="sd">        `reparametrize_symbolic` : the symbolic version of this method</span>
</span><span id="FisherMatrix-1999"><a href="#FisherMatrix-1999"><span class="linenos">1999</span></a>
</span><span id="FisherMatrix-2000"><a href="#FisherMatrix-2000"><span class="linenos">2000</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-2001"><a href="#FisherMatrix-2001"><span class="linenos">2001</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-2002"><a href="#FisherMatrix-2002"><span class="linenos">2002</span></a><span class="sd">        See the &lt;a</span>
</span><span id="FisherMatrix-2003"><a href="#FisherMatrix-2003"><span class="linenos">2003</span></a><span class="sd">        href=&quot;https://en.wikipedia.org/w/index.php?title=Fisher_information&amp;oldid=1063384000#Reparametrization&quot;</span>
</span><span id="FisherMatrix-2004"><a href="#FisherMatrix-2004"><span class="linenos">2004</span></a><span class="sd">        target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Wikipedia article&lt;/a&gt; for</span>
</span><span id="FisherMatrix-2005"><a href="#FisherMatrix-2005"><span class="linenos">2005</span></a><span class="sd">        more information.</span>
</span><span id="FisherMatrix-2006"><a href="#FisherMatrix-2006"><span class="linenos">2006</span></a>
</span><span id="FisherMatrix-2007"><a href="#FisherMatrix-2007"><span class="linenos">2007</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-2008"><a href="#FisherMatrix-2008"><span class="linenos">2008</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-2009"><a href="#FisherMatrix-2009"><span class="linenos">2009</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]))</span>
</span><span id="FisherMatrix-2010"><a href="#FisherMatrix-2010"><span class="linenos">2010</span></a><span class="sd">        &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix-2011"><a href="#FisherMatrix-2011"><span class="linenos">2011</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-2012"><a href="#FisherMatrix-2012"><span class="linenos">2012</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix-2013"><a href="#FisherMatrix-2013"><span class="linenos">2013</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix-2014"><a href="#FisherMatrix-2014"><span class="linenos">2014</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-2015"><a href="#FisherMatrix-2015"><span class="linenos">2015</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-2016"><a href="#FisherMatrix-2016"><span class="linenos">2016</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-2017"><a href="#FisherMatrix-2017"><span class="linenos">2017</span></a>
</span><span id="FisherMatrix-2018"><a href="#FisherMatrix-2018"><span class="linenos">2018</span></a><span class="sd">        Define a Jacobian:</span>
</span><span id="FisherMatrix-2019"><a href="#FisherMatrix-2019"><span class="linenos">2019</span></a><span class="sd">        &gt;&gt;&gt; jac = [[1, 4], [3, 2]]</span>
</span><span id="FisherMatrix-2020"><a href="#FisherMatrix-2020"><span class="linenos">2020</span></a>
</span><span id="FisherMatrix-2021"><a href="#FisherMatrix-2021"><span class="linenos">2021</span></a><span class="sd">        Reparametrize according to that Jacobian:</span>
</span><span id="FisherMatrix-2022"><a href="#FisherMatrix-2022"><span class="linenos">2022</span></a><span class="sd">        &gt;&gt;&gt; fm.reparametrize(jac, names=[&#39;a&#39;, &#39;b&#39;])</span>
</span><span id="FisherMatrix-2023"><a href="#FisherMatrix-2023"><span class="linenos">2023</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-2024"><a href="#FisherMatrix-2024"><span class="linenos">2024</span></a><span class="sd">            array([[19., 16.],</span>
</span><span id="FisherMatrix-2025"><a href="#FisherMatrix-2025"><span class="linenos">2025</span></a><span class="sd">               [16., 24.]]),</span>
</span><span id="FisherMatrix-2026"><a href="#FisherMatrix-2026"><span class="linenos">2026</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix-2027"><a href="#FisherMatrix-2027"><span class="linenos">2027</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix-2028"><a href="#FisherMatrix-2028"><span class="linenos">2028</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-2029"><a href="#FisherMatrix-2029"><span class="linenos">2029</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2030"><a href="#FisherMatrix-2030"><span class="linenos">2030</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">@</span> <span class="n">jacobian</span>
</span><span id="FisherMatrix-2031"><a href="#FisherMatrix-2031"><span class="linenos">2031</span></a>
</span><span id="FisherMatrix-2032"><a href="#FisherMatrix-2032"><span class="linenos">2032</span></a>        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-2033"><a href="#FisherMatrix-2033"><span class="linenos">2033</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix-2034"><a href="#FisherMatrix-2034"><span class="linenos">2034</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-2035"><a href="#FisherMatrix-2035"><span class="linenos">2035</span></a>            <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-2036"><a href="#FisherMatrix-2036"><span class="linenos">2036</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">latex_names</span><span class="p">))</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix-2037"><a href="#FisherMatrix-2037"><span class="linenos">2037</span></a>                    <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix-2038"><a href="#FisherMatrix-2038"><span class="linenos">2038</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-2039"><a href="#FisherMatrix-2039"><span class="linenos">2039</span></a>                <span class="n">latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-2040"><a href="#FisherMatrix-2040"><span class="linenos">2040</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-2041"><a href="#FisherMatrix-2041"><span class="linenos">2041</span></a>            <span class="c1"># we don&#39;t transform the names</span>
</span><span id="FisherMatrix-2042"><a href="#FisherMatrix-2042"><span class="linenos">2042</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-2043"><a href="#FisherMatrix-2043"><span class="linenos">2043</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix-2044"><a href="#FisherMatrix-2044"><span class="linenos">2044</span></a>
</span><span id="FisherMatrix-2045"><a href="#FisherMatrix-2045"><span class="linenos">2045</span></a>        <span class="k">if</span> <span class="n">fiducials</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-2046"><a href="#FisherMatrix-2046"><span class="linenos">2046</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fiducials</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix-2047"><a href="#FisherMatrix-2047"><span class="linenos">2047</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix-2048"><a href="#FisherMatrix-2048"><span class="linenos">2048</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-2049"><a href="#FisherMatrix-2049"><span class="linenos">2049</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix-2050"><a href="#FisherMatrix-2050"><span class="linenos">2050</span></a>
</span><span id="FisherMatrix-2051"><a href="#FisherMatrix-2051"><span class="linenos">2051</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-2052"><a href="#FisherMatrix-2052"><span class="linenos">2052</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-2053"><a href="#FisherMatrix-2053"><span class="linenos">2053</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-2054"><a href="#FisherMatrix-2054"><span class="linenos">2054</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-2055"><a href="#FisherMatrix-2055"><span class="linenos">2055</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-2056"><a href="#FisherMatrix-2056"><span class="linenos">2056</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-2057"><a href="#FisherMatrix-2057"><span class="linenos">2057</span></a>
</span><span id="FisherMatrix-2058"><a href="#FisherMatrix-2058"><span class="linenos">2058</span></a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="FisherMatrix-2059"><a href="#FisherMatrix-2059"><span class="linenos">2059</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the Fisher object as a dictionary.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2060"><a href="#FisherMatrix-2060"><span class="linenos">2060</span></a>        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="FisherMatrix-2061"><a href="#FisherMatrix-2061"><span class="linenos">2061</span></a>            <span class="n">values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-2062"><a href="#FisherMatrix-2062"><span class="linenos">2062</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-2063"><a href="#FisherMatrix-2063"><span class="linenos">2063</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-2064"><a href="#FisherMatrix-2064"><span class="linenos">2064</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-2065"><a href="#FisherMatrix-2065"><span class="linenos">2065</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-2066"><a href="#FisherMatrix-2066"><span class="linenos">2066</span></a>
</span><span id="FisherMatrix-2067"><a href="#FisherMatrix-2067"><span class="linenos">2067</span></a>    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span>
</span><span id="FisherMatrix-2068"><a href="#FisherMatrix-2068"><span class="linenos">2068</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-2069"><a href="#FisherMatrix-2069"><span class="linenos">2069</span></a>        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
</span><span id="FisherMatrix-2070"><a href="#FisherMatrix-2070"><span class="linenos">2070</span></a>        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-2071"><a href="#FisherMatrix-2071"><span class="linenos">2071</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="FisherMatrix-2072"><a href="#FisherMatrix-2072"><span class="linenos">2072</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2073"><a href="#FisherMatrix-2073"><span class="linenos">2073</span></a><span class="sd">        Save the Fisher object to a file (UTF-8 encoded).</span>
</span><span id="FisherMatrix-2074"><a href="#FisherMatrix-2074"><span class="linenos">2074</span></a>
</span><span id="FisherMatrix-2075"><a href="#FisherMatrix-2075"><span class="linenos">2075</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-2076"><a href="#FisherMatrix-2076"><span class="linenos">2076</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-2077"><a href="#FisherMatrix-2077"><span class="linenos">2077</span></a><span class="sd">        path : str or Path</span>
</span><span id="FisherMatrix-2078"><a href="#FisherMatrix-2078"><span class="linenos">2078</span></a><span class="sd">            the path to save the data to.</span>
</span><span id="FisherMatrix-2079"><a href="#FisherMatrix-2079"><span class="linenos">2079</span></a>
</span><span id="FisherMatrix-2080"><a href="#FisherMatrix-2080"><span class="linenos">2080</span></a><span class="sd">        metadata : dict, optional</span>
</span><span id="FisherMatrix-2081"><a href="#FisherMatrix-2081"><span class="linenos">2081</span></a><span class="sd">            any metadata that should be associated to the object saved, in the</span>
</span><span id="FisherMatrix-2082"><a href="#FisherMatrix-2082"><span class="linenos">2082</span></a><span class="sd">            form of a dictionary-like object</span>
</span><span id="FisherMatrix-2083"><a href="#FisherMatrix-2083"><span class="linenos">2083</span></a>
</span><span id="FisherMatrix-2084"><a href="#FisherMatrix-2084"><span class="linenos">2084</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-2085"><a href="#FisherMatrix-2085"><span class="linenos">2085</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-2086"><a href="#FisherMatrix-2086"><span class="linenos">2086</span></a><span class="sd">        dict</span>
</span><span id="FisherMatrix-2087"><a href="#FisherMatrix-2087"><span class="linenos">2087</span></a><span class="sd">            the dictionary that was saved</span>
</span><span id="FisherMatrix-2088"><a href="#FisherMatrix-2088"><span class="linenos">2088</span></a>
</span><span id="FisherMatrix-2089"><a href="#FisherMatrix-2089"><span class="linenos">2089</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-2090"><a href="#FisherMatrix-2090"><span class="linenos">2090</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-2091"><a href="#FisherMatrix-2091"><span class="linenos">2091</span></a><span class="sd">        The format used is a simple JSON file, containing at least the values of the</span>
</span><span id="FisherMatrix-2092"><a href="#FisherMatrix-2092"><span class="linenos">2092</span></a><span class="sd">        Fisher object, the names of the parameters, the LaTeX names, and the</span>
</span><span id="FisherMatrix-2093"><a href="#FisherMatrix-2093"><span class="linenos">2093</span></a><span class="sd">        fiducial values.</span>
</span><span id="FisherMatrix-2094"><a href="#FisherMatrix-2094"><span class="linenos">2094</span></a>
</span><span id="FisherMatrix-2095"><a href="#FisherMatrix-2095"><span class="linenos">2095</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-2096"><a href="#FisherMatrix-2096"><span class="linenos">2096</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-2097"><a href="#FisherMatrix-2097"><span class="linenos">2097</span></a><span class="sd">        &gt;&gt;&gt; from pprint import pprint</span>
</span><span id="FisherMatrix-2098"><a href="#FisherMatrix-2098"><span class="linenos">2098</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix-2099"><a href="#FisherMatrix-2099"><span class="linenos">2099</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], latex_names=[r&#39;$\mathbf{A}$&#39;, r&#39;$\mathbf{B}$&#39;])</span>
</span><span id="FisherMatrix-2100"><a href="#FisherMatrix-2100"><span class="linenos">2100</span></a><span class="sd">        &gt;&gt;&gt; pprint(fm.to_file(&#39;example_matrix.json&#39;), sort_dicts=False) # doctest: +SKIP</span>
</span><span id="FisherMatrix-2101"><a href="#FisherMatrix-2101"><span class="linenos">2101</span></a><span class="sd">        {&#39;values&#39;: array([[1., 0.],</span>
</span><span id="FisherMatrix-2102"><a href="#FisherMatrix-2102"><span class="linenos">2102</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix-2103"><a href="#FisherMatrix-2103"><span class="linenos">2103</span></a><span class="sd">         &#39;names&#39;: array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix-2104"><a href="#FisherMatrix-2104"><span class="linenos">2104</span></a><span class="sd">         &#39;latex_names&#39;: array([&#39;$\\mathbf{A}$&#39;, &#39;$\\mathbf{B}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-2105"><a href="#FisherMatrix-2105"><span class="linenos">2105</span></a><span class="sd">         &#39;fiducials&#39;: array([0., 0.])}</span>
</span><span id="FisherMatrix-2106"><a href="#FisherMatrix-2106"><span class="linenos">2106</span></a>
</span><span id="FisherMatrix-2107"><a href="#FisherMatrix-2107"><span class="linenos">2107</span></a><span class="sd">        There is also a convenience function for reading it:</span>
</span><span id="FisherMatrix-2108"><a href="#FisherMatrix-2108"><span class="linenos">2108</span></a><span class="sd">        &gt;&gt;&gt; fm_read = FisherMatrix.from_file(&#39;example_matrix.json&#39;) # doctest: +SKIP</span>
</span><span id="FisherMatrix-2109"><a href="#FisherMatrix-2109"><span class="linenos">2109</span></a>
</span><span id="FisherMatrix-2110"><a href="#FisherMatrix-2110"><span class="linenos">2110</span></a><span class="sd">        Verify it&#39;s the same object:</span>
</span><span id="FisherMatrix-2111"><a href="#FisherMatrix-2111"><span class="linenos">2111</span></a><span class="sd">        &gt;&gt;&gt; fm == fm_read # doctest: +SKIP</span>
</span><span id="FisherMatrix-2112"><a href="#FisherMatrix-2112"><span class="linenos">2112</span></a><span class="sd">        True</span>
</span><span id="FisherMatrix-2113"><a href="#FisherMatrix-2113"><span class="linenos">2113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2114"><a href="#FisherMatrix-2114"><span class="linenos">2114</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</span><span id="FisherMatrix-2115"><a href="#FisherMatrix-2115"><span class="linenos">2115</span></a>
</span><span id="FisherMatrix-2116"><a href="#FisherMatrix-2116"><span class="linenos">2116</span></a>        <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-2117"><a href="#FisherMatrix-2117"><span class="linenos">2117</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="FisherMatrix-2118"><a href="#FisherMatrix-2118"><span class="linenos">2118</span></a>                <span class="o">**</span><span class="n">data</span><span class="p">,</span>
</span><span id="FisherMatrix-2119"><a href="#FisherMatrix-2119"><span class="linenos">2119</span></a>                <span class="o">**</span><span class="p">{</span><span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">},</span>
</span><span id="FisherMatrix-2120"><a href="#FisherMatrix-2120"><span class="linenos">2120</span></a>            <span class="p">}</span>
</span><span id="FisherMatrix-2121"><a href="#FisherMatrix-2121"><span class="linenos">2121</span></a>
</span><span id="FisherMatrix-2122"><a href="#FisherMatrix-2122"><span class="linenos">2122</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
</span><span id="FisherMatrix-2123"><a href="#FisherMatrix-2123"><span class="linenos">2123</span></a>            <span class="n">file_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">FisherEncoder</span><span class="p">))</span>
</span><span id="FisherMatrix-2124"><a href="#FisherMatrix-2124"><span class="linenos">2124</span></a>
</span><span id="FisherMatrix-2125"><a href="#FisherMatrix-2125"><span class="linenos">2125</span></a>        <span class="k">return</span> <span class="n">data</span>
</span><span id="FisherMatrix-2126"><a href="#FisherMatrix-2126"><span class="linenos">2126</span></a>
</span><span id="FisherMatrix-2127"><a href="#FisherMatrix-2127"><span class="linenos">2127</span></a>    <span class="k">def</span> <span class="nf">marginalize_over</span><span class="p">(</span>
</span><span id="FisherMatrix-2128"><a href="#FisherMatrix-2128"><span class="linenos">2128</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-2129"><a href="#FisherMatrix-2129"><span class="linenos">2129</span></a>        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix-2130"><a href="#FisherMatrix-2130"><span class="linenos">2130</span></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix-2131"><a href="#FisherMatrix-2131"><span class="linenos">2131</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix-2132"><a href="#FisherMatrix-2132"><span class="linenos">2132</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-2133"><a href="#FisherMatrix-2133"><span class="linenos">2133</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-2134"><a href="#FisherMatrix-2134"><span class="linenos">2134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2135"><a href="#FisherMatrix-2135"><span class="linenos">2135</span></a><span class="sd">        Perform marginalization over some parameters.</span>
</span><span id="FisherMatrix-2136"><a href="#FisherMatrix-2136"><span class="linenos">2136</span></a>
</span><span id="FisherMatrix-2137"><a href="#FisherMatrix-2137"><span class="linenos">2137</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-2138"><a href="#FisherMatrix-2138"><span class="linenos">2138</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-2139"><a href="#FisherMatrix-2139"><span class="linenos">2139</span></a><span class="sd">        names : str</span>
</span><span id="FisherMatrix-2140"><a href="#FisherMatrix-2140"><span class="linenos">2140</span></a><span class="sd">            the names of the parameters to marginalize over</span>
</span><span id="FisherMatrix-2141"><a href="#FisherMatrix-2141"><span class="linenos">2141</span></a>
</span><span id="FisherMatrix-2142"><a href="#FisherMatrix-2142"><span class="linenos">2142</span></a><span class="sd">        invert : bool, optional</span>
</span><span id="FisherMatrix-2143"><a href="#FisherMatrix-2143"><span class="linenos">2143</span></a><span class="sd">            whether to marginalize over all the parameters NOT in names (the complement) (default: False)</span>
</span><span id="FisherMatrix-2144"><a href="#FisherMatrix-2144"><span class="linenos">2144</span></a>
</span><span id="FisherMatrix-2145"><a href="#FisherMatrix-2145"><span class="linenos">2145</span></a><span class="sd">        ignore_errors : bool, optional</span>
</span><span id="FisherMatrix-2146"><a href="#FisherMatrix-2146"><span class="linenos">2146</span></a><span class="sd">            should non-existing parameters be ignored (default: False)</span>
</span><span id="FisherMatrix-2147"><a href="#FisherMatrix-2147"><span class="linenos">2147</span></a>
</span><span id="FisherMatrix-2148"><a href="#FisherMatrix-2148"><span class="linenos">2148</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix-2149"><a href="#FisherMatrix-2149"><span class="linenos">2149</span></a><span class="sd">            any kwargs passed to `inverse`</span>
</span><span id="FisherMatrix-2150"><a href="#FisherMatrix-2150"><span class="linenos">2150</span></a>
</span><span id="FisherMatrix-2151"><a href="#FisherMatrix-2151"><span class="linenos">2151</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-2152"><a href="#FisherMatrix-2152"><span class="linenos">2152</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-2153"><a href="#FisherMatrix-2153"><span class="linenos">2153</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix-2154"><a href="#FisherMatrix-2154"><span class="linenos">2154</span></a><span class="sd">            The Fisher object with the specified parameters marginalized over.</span>
</span><span id="FisherMatrix-2155"><a href="#FisherMatrix-2155"><span class="linenos">2155</span></a>
</span><span id="FisherMatrix-2156"><a href="#FisherMatrix-2156"><span class="linenos">2156</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-2157"><a href="#FisherMatrix-2157"><span class="linenos">2157</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-2158"><a href="#FisherMatrix-2158"><span class="linenos">2158</span></a><span class="sd">        Generate a Fisher object using a random orthogonal matrix:</span>
</span><span id="FisherMatrix-2159"><a href="#FisherMatrix-2159"><span class="linenos">2159</span></a><span class="sd">        &gt;&gt;&gt; rm = np.array([[-0.0942819 ,  0.56164959,  0.7638867 ,  0.18138749, -0.24338518],</span>
</span><span id="FisherMatrix-2160"><a href="#FisherMatrix-2160"><span class="linenos">2160</span></a><span class="sd">        ... [ 0.22058622,  0.74746891, -0.33297073, -0.47219083,  0.24248352],</span>
</span><span id="FisherMatrix-2161"><a href="#FisherMatrix-2161"><span class="linenos">2161</span></a><span class="sd">        ... [-0.23923712,  0.18017836, -0.44325216,  0.05300493, -0.84321964],</span>
</span><span id="FisherMatrix-2162"><a href="#FisherMatrix-2162"><span class="linenos">2162</span></a><span class="sd">        ... [-0.25595188,  0.30540004, -0.32672895,  0.77839888,  0.35855659],</span>
</span><span id="FisherMatrix-2163"><a href="#FisherMatrix-2163"><span class="linenos">2163</span></a><span class="sd">        ... [ 0.90537665,  0.0103218 , -0.04881925,  0.36799464, -0.20587183]])</span>
</span><span id="FisherMatrix-2164"><a href="#FisherMatrix-2164"><span class="linenos">2164</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(rm.T @ np.diag([1, 2, 3, 7, 6]) @ rm)</span>
</span><span id="FisherMatrix-2165"><a href="#FisherMatrix-2165"><span class="linenos">2165</span></a>
</span><span id="FisherMatrix-2166"><a href="#FisherMatrix-2166"><span class="linenos">2166</span></a><span class="sd">        Marginalize over some parameters:</span>
</span><span id="FisherMatrix-2167"><a href="#FisherMatrix-2167"><span class="linenos">2167</span></a><span class="sd">        &gt;&gt;&gt; fm.marginalize_over(&#39;p1&#39;, &#39;p2&#39;)</span>
</span><span id="FisherMatrix-2168"><a href="#FisherMatrix-2168"><span class="linenos">2168</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-2169"><a href="#FisherMatrix-2169"><span class="linenos">2169</span></a><span class="sd">            array([[ 1.67715593, -1.01556087,  0.30020774],</span>
</span><span id="FisherMatrix-2170"><a href="#FisherMatrix-2170"><span class="linenos">2170</span></a><span class="sd">               [-1.01556087,  4.92788973,  0.91219829],</span>
</span><span id="FisherMatrix-2171"><a href="#FisherMatrix-2171"><span class="linenos">2171</span></a><span class="sd">               [ 0.30020774,  0.91219829,  3.1796454 ]]),</span>
</span><span id="FisherMatrix-2172"><a href="#FisherMatrix-2172"><span class="linenos">2172</span></a><span class="sd">            names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
</span><span id="FisherMatrix-2173"><a href="#FisherMatrix-2173"><span class="linenos">2173</span></a><span class="sd">            latex_names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
</span><span id="FisherMatrix-2174"><a href="#FisherMatrix-2174"><span class="linenos">2174</span></a><span class="sd">            fiducials=array([0., 0., 0.]))</span>
</span><span id="FisherMatrix-2175"><a href="#FisherMatrix-2175"><span class="linenos">2175</span></a>
</span><span id="FisherMatrix-2176"><a href="#FisherMatrix-2176"><span class="linenos">2176</span></a><span class="sd">        Marginalize over all parameters which are NOT `p1` or `p2`:</span>
</span><span id="FisherMatrix-2177"><a href="#FisherMatrix-2177"><span class="linenos">2177</span></a><span class="sd">        &gt;&gt;&gt; fm.marginalize_over(&#39;p1&#39;, &#39;p2&#39;, invert=True)</span>
</span><span id="FisherMatrix-2178"><a href="#FisherMatrix-2178"><span class="linenos">2178</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-2179"><a href="#FisherMatrix-2179"><span class="linenos">2179</span></a><span class="sd">            array([[ 5.04480061, -0.04490451],</span>
</span><span id="FisherMatrix-2180"><a href="#FisherMatrix-2180"><span class="linenos">2180</span></a><span class="sd">               [-0.04490451,  1.61599083]]),</span>
</span><span id="FisherMatrix-2181"><a href="#FisherMatrix-2181"><span class="linenos">2181</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-2182"><a href="#FisherMatrix-2182"><span class="linenos">2182</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-2183"><a href="#FisherMatrix-2183"><span class="linenos">2183</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-2184"><a href="#FisherMatrix-2184"><span class="linenos">2184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2185"><a href="#FisherMatrix-2185"><span class="linenos">2185</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-2186"><a href="#FisherMatrix-2186"><span class="linenos">2186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="FisherMatrix-2187"><a href="#FisherMatrix-2187"><span class="linenos">2187</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-2188"><a href="#FisherMatrix-2188"><span class="linenos">2188</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-2189"><a href="#FisherMatrix-2189"><span class="linenos">2189</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-2190"><a href="#FisherMatrix-2190"><span class="linenos">2190</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-2191"><a href="#FisherMatrix-2191"><span class="linenos">2191</span></a>        <span class="k">if</span> <span class="n">invert</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix-2192"><a href="#FisherMatrix-2192"><span class="linenos">2192</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">^</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
</span><span id="FisherMatrix-2193"><a href="#FisherMatrix-2193"><span class="linenos">2193</span></a>        <span class="n">fisher</span> <span class="o">=</span> <span class="n">inv</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="n">ignore_errors</span><span class="p">)</span>
</span><span id="FisherMatrix-2194"><a href="#FisherMatrix-2194"><span class="linenos">2194</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-2195"><a href="#FisherMatrix-2195"><span class="linenos">2195</span></a>            <span class="n">fisher</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="FisherMatrix-2196"><a href="#FisherMatrix-2196"><span class="linenos">2196</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-2197"><a href="#FisherMatrix-2197"><span class="linenos">2197</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-2198"><a href="#FisherMatrix-2198"><span class="linenos">2198</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-2199"><a href="#FisherMatrix-2199"><span class="linenos">2199</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-2200"><a href="#FisherMatrix-2200"><span class="linenos">2200</span></a>
</span><span id="FisherMatrix-2201"><a href="#FisherMatrix-2201"><span class="linenos">2201</span></a>    <span class="nd">@classmethod</span>
</span><span id="FisherMatrix-2202"><a href="#FisherMatrix-2202"><span class="linenos">2202</span></a>    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
</span><span id="FisherMatrix-2203"><a href="#FisherMatrix-2203"><span class="linenos">2203</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="FisherMatrix-2204"><a href="#FisherMatrix-2204"><span class="linenos">2204</span></a>        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
</span><span id="FisherMatrix-2205"><a href="#FisherMatrix-2205"><span class="linenos">2205</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-2206"><a href="#FisherMatrix-2206"><span class="linenos">2206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2207"><a href="#FisherMatrix-2207"><span class="linenos">2207</span></a><span class="sd">        Read a Fisher object from a file.</span>
</span><span id="FisherMatrix-2208"><a href="#FisherMatrix-2208"><span class="linenos">2208</span></a>
</span><span id="FisherMatrix-2209"><a href="#FisherMatrix-2209"><span class="linenos">2209</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-2210"><a href="#FisherMatrix-2210"><span class="linenos">2210</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-2211"><a href="#FisherMatrix-2211"><span class="linenos">2211</span></a><span class="sd">        path : str or Path</span>
</span><span id="FisherMatrix-2212"><a href="#FisherMatrix-2212"><span class="linenos">2212</span></a><span class="sd">            the path to the file</span>
</span><span id="FisherMatrix-2213"><a href="#FisherMatrix-2213"><span class="linenos">2213</span></a>
</span><span id="FisherMatrix-2214"><a href="#FisherMatrix-2214"><span class="linenos">2214</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-2215"><a href="#FisherMatrix-2215"><span class="linenos">2215</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-2216"><a href="#FisherMatrix-2216"><span class="linenos">2216</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix-2217"><a href="#FisherMatrix-2217"><span class="linenos">2217</span></a>
</span><span id="FisherMatrix-2218"><a href="#FisherMatrix-2218"><span class="linenos">2218</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-2219"><a href="#FisherMatrix-2219"><span class="linenos">2219</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-2220"><a href="#FisherMatrix-2220"><span class="linenos">2220</span></a><span class="sd">        Any metadata is ignored when reading the file.</span>
</span><span id="FisherMatrix-2221"><a href="#FisherMatrix-2221"><span class="linenos">2221</span></a><span class="sd">        If you want to read the metadata as well, use something like the following:</span>
</span><span id="FisherMatrix-2222"><a href="#FisherMatrix-2222"><span class="linenos">2222</span></a>
</span><span id="FisherMatrix-2223"><a href="#FisherMatrix-2223"><span class="linenos">2223</span></a><span class="sd">        &gt;&gt;&gt; import json</span>
</span><span id="FisherMatrix-2224"><a href="#FisherMatrix-2224"><span class="linenos">2224</span></a><span class="sd">        &gt;&gt;&gt; with open(&lt;filename&gt;, &#39;r&#39;) as f: # doctest: +SKIP</span>
</span><span id="FisherMatrix-2225"><a href="#FisherMatrix-2225"><span class="linenos">2225</span></a><span class="sd">        ...     data = json.loads(f.read()) # doctest: +SKIP</span>
</span><span id="FisherMatrix-2226"><a href="#FisherMatrix-2226"><span class="linenos">2226</span></a>
</span><span id="FisherMatrix-2227"><a href="#FisherMatrix-2227"><span class="linenos">2227</span></a><span class="sd">        Then `data` will contain a dictionary with all of the data from the</span>
</span><span id="FisherMatrix-2228"><a href="#FisherMatrix-2228"><span class="linenos">2228</span></a><span class="sd">        file, which can be easily parsed.</span>
</span><span id="FisherMatrix-2229"><a href="#FisherMatrix-2229"><span class="linenos">2229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2230"><a href="#FisherMatrix-2230"><span class="linenos">2230</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
</span><span id="FisherMatrix-2231"><a href="#FisherMatrix-2231"><span class="linenos">2231</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file_handle</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="FisherMatrix-2232"><a href="#FisherMatrix-2232"><span class="linenos">2232</span></a>
</span><span id="FisherMatrix-2233"><a href="#FisherMatrix-2233"><span class="linenos">2233</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="FisherMatrix-2234"><a href="#FisherMatrix-2234"><span class="linenos">2234</span></a>
</span><span id="FisherMatrix-2235"><a href="#FisherMatrix-2235"><span class="linenos">2235</span></a>    <span class="nd">@classmethod</span>
</span><span id="FisherMatrix-2236"><a href="#FisherMatrix-2236"><span class="linenos">2236</span></a>    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span>
</span><span id="FisherMatrix-2237"><a href="#FisherMatrix-2237"><span class="linenos">2237</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="FisherMatrix-2238"><a href="#FisherMatrix-2238"><span class="linenos">2238</span></a>        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="FisherMatrix-2239"><a href="#FisherMatrix-2239"><span class="linenos">2239</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-2240"><a href="#FisherMatrix-2240"><span class="linenos">2240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2241"><a href="#FisherMatrix-2241"><span class="linenos">2241</span></a><span class="sd">        Read a Fisher object from a dictionary.</span>
</span><span id="FisherMatrix-2242"><a href="#FisherMatrix-2242"><span class="linenos">2242</span></a>
</span><span id="FisherMatrix-2243"><a href="#FisherMatrix-2243"><span class="linenos">2243</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-2244"><a href="#FisherMatrix-2244"><span class="linenos">2244</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-2245"><a href="#FisherMatrix-2245"><span class="linenos">2245</span></a><span class="sd">        data</span>
</span><span id="FisherMatrix-2246"><a href="#FisherMatrix-2246"><span class="linenos">2246</span></a><span class="sd">            the dictionary</span>
</span><span id="FisherMatrix-2247"><a href="#FisherMatrix-2247"><span class="linenos">2247</span></a>
</span><span id="FisherMatrix-2248"><a href="#FisherMatrix-2248"><span class="linenos">2248</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-2249"><a href="#FisherMatrix-2249"><span class="linenos">2249</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-2250"><a href="#FisherMatrix-2250"><span class="linenos">2250</span></a><span class="sd">        KeyError</span>
</span><span id="FisherMatrix-2251"><a href="#FisherMatrix-2251"><span class="linenos">2251</span></a><span class="sd">            if the dictionary contains malformed data</span>
</span><span id="FisherMatrix-2252"><a href="#FisherMatrix-2252"><span class="linenos">2252</span></a>
</span><span id="FisherMatrix-2253"><a href="#FisherMatrix-2253"><span class="linenos">2253</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-2254"><a href="#FisherMatrix-2254"><span class="linenos">2254</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-2255"><a href="#FisherMatrix-2255"><span class="linenos">2255</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix-2256"><a href="#FisherMatrix-2256"><span class="linenos">2256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2257"><a href="#FisherMatrix-2257"><span class="linenos">2257</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="FisherMatrix-2258"><a href="#FisherMatrix-2258"><span class="linenos">2258</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix-2259"><a href="#FisherMatrix-2259"><span class="linenos">2259</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix-2260"><a href="#FisherMatrix-2260"><span class="linenos">2260</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;latex_names&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix-2261"><a href="#FisherMatrix-2261"><span class="linenos">2261</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fiducials&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix-2262"><a href="#FisherMatrix-2262"><span class="linenos">2262</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-2263"><a href="#FisherMatrix-2263"><span class="linenos">2263</span></a>
</span><span id="FisherMatrix-2264"><a href="#FisherMatrix-2264"><span class="linenos">2264</span></a>    <span class="k">def</span> <span class="nf">correlation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="FisherMatrix-2265"><a href="#FisherMatrix-2265"><span class="linenos">2265</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2266"><a href="#FisherMatrix-2266"><span class="linenos">2266</span></a><span class="sd">        Compute the correlation matrix from the Fisher matrix.</span>
</span><span id="FisherMatrix-2267"><a href="#FisherMatrix-2267"><span class="linenos">2267</span></a>
</span><span id="FisherMatrix-2268"><a href="#FisherMatrix-2268"><span class="linenos">2268</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-2269"><a href="#FisherMatrix-2269"><span class="linenos">2269</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-2270"><a href="#FisherMatrix-2270"><span class="linenos">2270</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix-2271"><a href="#FisherMatrix-2271"><span class="linenos">2271</span></a><span class="sd">            any kwargs passed to `inverse`</span>
</span><span id="FisherMatrix-2272"><a href="#FisherMatrix-2272"><span class="linenos">2272</span></a>
</span><span id="FisherMatrix-2273"><a href="#FisherMatrix-2273"><span class="linenos">2273</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-2274"><a href="#FisherMatrix-2274"><span class="linenos">2274</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-2275"><a href="#FisherMatrix-2275"><span class="linenos">2275</span></a><span class="sd">        array_like : float</span>
</span><span id="FisherMatrix-2276"><a href="#FisherMatrix-2276"><span class="linenos">2276</span></a><span class="sd">            the correlation matrix as a numpy array</span>
</span><span id="FisherMatrix-2277"><a href="#FisherMatrix-2277"><span class="linenos">2277</span></a>
</span><span id="FisherMatrix-2278"><a href="#FisherMatrix-2278"><span class="linenos">2278</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-2279"><a href="#FisherMatrix-2279"><span class="linenos">2279</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-2280"><a href="#FisherMatrix-2280"><span class="linenos">2280</span></a><span class="sd">        The entries of the output matrix are given by:</span>
</span><span id="FisherMatrix-2281"><a href="#FisherMatrix-2281"><span class="linenos">2281</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-2282"><a href="#FisherMatrix-2282"><span class="linenos">2282</span></a><span class="sd">            \mathsf{P}_{ij} \equiv \frac{\mathsf{C}_{ij}}{\sqrt{\mathsf{C}_{ii} \mathsf{C}_{jj}}}</span>
</span><span id="FisherMatrix-2283"><a href="#FisherMatrix-2283"><span class="linenos">2283</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-2284"><a href="#FisherMatrix-2284"><span class="linenos">2284</span></a><span class="sd">        where $\mathsf{C}_{ij}$ is the $(i, j)$ element of the covariance</span>
</span><span id="FisherMatrix-2285"><a href="#FisherMatrix-2285"><span class="linenos">2285</span></a><span class="sd">        matrix (the inverse of the Fisher matrix).</span>
</span><span id="FisherMatrix-2286"><a href="#FisherMatrix-2286"><span class="linenos">2286</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2287"><a href="#FisherMatrix-2287"><span class="linenos">2287</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="FisherMatrix-2288"><a href="#FisherMatrix-2288"><span class="linenos">2288</span></a>        <span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>
</span><span id="FisherMatrix-2289"><a href="#FisherMatrix-2289"><span class="linenos">2289</span></a>
</span><span id="FisherMatrix-2290"><a href="#FisherMatrix-2290"><span class="linenos">2290</span></a>        <span class="k">return</span> <span class="n">inv</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="n">diag</span><span class="p">))</span>
</span><span id="FisherMatrix-2291"><a href="#FisherMatrix-2291"><span class="linenos">2291</span></a>
</span><span id="FisherMatrix-2292"><a href="#FisherMatrix-2292"><span class="linenos">2292</span></a>    <span class="k">def</span> <span class="nf">correlation_coefficient</span><span class="p">(</span>
</span><span id="FisherMatrix-2293"><a href="#FisherMatrix-2293"><span class="linenos">2293</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-2294"><a href="#FisherMatrix-2294"><span class="linenos">2294</span></a>        <span class="n">name1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix-2295"><a href="#FisherMatrix-2295"><span class="linenos">2295</span></a>        <span class="n">name2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix-2296"><a href="#FisherMatrix-2296"><span class="linenos">2296</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-2297"><a href="#FisherMatrix-2297"><span class="linenos">2297</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="FisherMatrix-2298"><a href="#FisherMatrix-2298"><span class="linenos">2298</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2299"><a href="#FisherMatrix-2299"><span class="linenos">2299</span></a><span class="sd">        Return the correlation coefficient between two parameters.</span>
</span><span id="FisherMatrix-2300"><a href="#FisherMatrix-2300"><span class="linenos">2300</span></a>
</span><span id="FisherMatrix-2301"><a href="#FisherMatrix-2301"><span class="linenos">2301</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-2302"><a href="#FisherMatrix-2302"><span class="linenos">2302</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-2303"><a href="#FisherMatrix-2303"><span class="linenos">2303</span></a><span class="sd">        name1 : str</span>
</span><span id="FisherMatrix-2304"><a href="#FisherMatrix-2304"><span class="linenos">2304</span></a><span class="sd">            the name of the first parameter</span>
</span><span id="FisherMatrix-2305"><a href="#FisherMatrix-2305"><span class="linenos">2305</span></a>
</span><span id="FisherMatrix-2306"><a href="#FisherMatrix-2306"><span class="linenos">2306</span></a><span class="sd">        name2 : str</span>
</span><span id="FisherMatrix-2307"><a href="#FisherMatrix-2307"><span class="linenos">2307</span></a><span class="sd">            the name of the second parameter</span>
</span><span id="FisherMatrix-2308"><a href="#FisherMatrix-2308"><span class="linenos">2308</span></a>
</span><span id="FisherMatrix-2309"><a href="#FisherMatrix-2309"><span class="linenos">2309</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix-2310"><a href="#FisherMatrix-2310"><span class="linenos">2310</span></a><span class="sd">            any kwargs passed to `correlation_matrix`</span>
</span><span id="FisherMatrix-2311"><a href="#FisherMatrix-2311"><span class="linenos">2311</span></a>
</span><span id="FisherMatrix-2312"><a href="#FisherMatrix-2312"><span class="linenos">2312</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-2313"><a href="#FisherMatrix-2313"><span class="linenos">2313</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-2314"><a href="#FisherMatrix-2314"><span class="linenos">2314</span></a><span class="sd">        float</span>
</span><span id="FisherMatrix-2315"><a href="#FisherMatrix-2315"><span class="linenos">2315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2316"><a href="#FisherMatrix-2316"><span class="linenos">2316</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-2317"><a href="#FisherMatrix-2317"><span class="linenos">2317</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">correlation_matrix</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="FisherMatrix-2318"><a href="#FisherMatrix-2318"><span class="linenos">2318</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-2319"><a href="#FisherMatrix-2319"><span class="linenos">2319</span></a>        <span class="p">)[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span>
</span><span id="FisherMatrix-2320"><a href="#FisherMatrix-2320"><span class="linenos">2320</span></a>
</span><span id="FisherMatrix-2321"><a href="#FisherMatrix-2321"><span class="linenos">2321</span></a>    <span class="k">def</span> <span class="nf">figure_of_merit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="FisherMatrix-2322"><a href="#FisherMatrix-2322"><span class="linenos">2322</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2323"><a href="#FisherMatrix-2323"><span class="linenos">2323</span></a><span class="sd">        Compute the figure of merit (FoM).</span>
</span><span id="FisherMatrix-2324"><a href="#FisherMatrix-2324"><span class="linenos">2324</span></a>
</span><span id="FisherMatrix-2325"><a href="#FisherMatrix-2325"><span class="linenos">2325</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-2326"><a href="#FisherMatrix-2326"><span class="linenos">2326</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-2327"><a href="#FisherMatrix-2327"><span class="linenos">2327</span></a><span class="sd">        float</span>
</span><span id="FisherMatrix-2328"><a href="#FisherMatrix-2328"><span class="linenos">2328</span></a>
</span><span id="FisherMatrix-2329"><a href="#FisherMatrix-2329"><span class="linenos">2329</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-2330"><a href="#FisherMatrix-2330"><span class="linenos">2330</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-2331"><a href="#FisherMatrix-2331"><span class="linenos">2331</span></a><span class="sd">        The figure of merit is computed as:</span>
</span><span id="FisherMatrix-2332"><a href="#FisherMatrix-2332"><span class="linenos">2332</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-2333"><a href="#FisherMatrix-2333"><span class="linenos">2333</span></a><span class="sd">            \mathrm{FoM} \equiv \frac{1}{2} \log \left[ \det \mathsf{F} \right]</span>
</span><span id="FisherMatrix-2334"><a href="#FisherMatrix-2334"><span class="linenos">2334</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-2335"><a href="#FisherMatrix-2335"><span class="linenos">2335</span></a><span class="sd">        where $\mathsf{F}$ denotes the Fisher matrix.</span>
</span><span id="FisherMatrix-2336"><a href="#FisherMatrix-2336"><span class="linenos">2336</span></a>
</span><span id="FisherMatrix-2337"><a href="#FisherMatrix-2337"><span class="linenos">2337</span></a><span class="sd">        Some authors define the FoM (also sometimes called the signal-to-noise,</span>
</span><span id="FisherMatrix-2338"><a href="#FisherMatrix-2338"><span class="linenos">2338</span></a><span class="sd">        $\mathrm{SNR}$) as:</span>
</span><span id="FisherMatrix-2339"><a href="#FisherMatrix-2339"><span class="linenos">2339</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-2340"><a href="#FisherMatrix-2340"><span class="linenos">2340</span></a><span class="sd">            \mathrm{SNR} = \sqrt{\det \mathsf{F}}</span>
</span><span id="FisherMatrix-2341"><a href="#FisherMatrix-2341"><span class="linenos">2341</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-2342"><a href="#FisherMatrix-2342"><span class="linenos">2342</span></a><span class="sd">        The two are related by a simple transformation:</span>
</span><span id="FisherMatrix-2343"><a href="#FisherMatrix-2343"><span class="linenos">2343</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-2344"><a href="#FisherMatrix-2344"><span class="linenos">2344</span></a><span class="sd">            \mathrm{SNR} = \exp{\left( \mathrm{FoM} \right)}</span>
</span><span id="FisherMatrix-2345"><a href="#FisherMatrix-2345"><span class="linenos">2345</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-2346"><a href="#FisherMatrix-2346"><span class="linenos">2346</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2347"><a href="#FisherMatrix-2347"><span class="linenos">2347</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="FisherMatrix-2348"><a href="#FisherMatrix-2348"><span class="linenos">2348</span></a>
</span><span id="FisherMatrix-2349"><a href="#FisherMatrix-2349"><span class="linenos">2349</span></a>    <span class="k">def</span> <span class="nf">figure_of_correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="FisherMatrix-2350"><a href="#FisherMatrix-2350"><span class="linenos">2350</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2351"><a href="#FisherMatrix-2351"><span class="linenos">2351</span></a><span class="sd">        Compute the figure of correlation (FoC).</span>
</span><span id="FisherMatrix-2352"><a href="#FisherMatrix-2352"><span class="linenos">2352</span></a>
</span><span id="FisherMatrix-2353"><a href="#FisherMatrix-2353"><span class="linenos">2353</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-2354"><a href="#FisherMatrix-2354"><span class="linenos">2354</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-2355"><a href="#FisherMatrix-2355"><span class="linenos">2355</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix-2356"><a href="#FisherMatrix-2356"><span class="linenos">2356</span></a><span class="sd">            any kwargs passed to `correlation_matrix`</span>
</span><span id="FisherMatrix-2357"><a href="#FisherMatrix-2357"><span class="linenos">2357</span></a>
</span><span id="FisherMatrix-2358"><a href="#FisherMatrix-2358"><span class="linenos">2358</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-2359"><a href="#FisherMatrix-2359"><span class="linenos">2359</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-2360"><a href="#FisherMatrix-2360"><span class="linenos">2360</span></a><span class="sd">        float</span>
</span><span id="FisherMatrix-2361"><a href="#FisherMatrix-2361"><span class="linenos">2361</span></a>
</span><span id="FisherMatrix-2362"><a href="#FisherMatrix-2362"><span class="linenos">2362</span></a><span class="sd">        See Also</span>
</span><span id="FisherMatrix-2363"><a href="#FisherMatrix-2363"><span class="linenos">2363</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-2364"><a href="#FisherMatrix-2364"><span class="linenos">2364</span></a><span class="sd">        `correlation_matrix` : compute the correlation matrix</span>
</span><span id="FisherMatrix-2365"><a href="#FisherMatrix-2365"><span class="linenos">2365</span></a>
</span><span id="FisherMatrix-2366"><a href="#FisherMatrix-2366"><span class="linenos">2366</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-2367"><a href="#FisherMatrix-2367"><span class="linenos">2367</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-2368"><a href="#FisherMatrix-2368"><span class="linenos">2368</span></a><span class="sd">        The output is computed as:</span>
</span><span id="FisherMatrix-2369"><a href="#FisherMatrix-2369"><span class="linenos">2369</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-2370"><a href="#FisherMatrix-2370"><span class="linenos">2370</span></a><span class="sd">            \mathrm{FoC} \equiv - \frac{1}{2} \log \left[ \det \mathsf{P} \right]</span>
</span><span id="FisherMatrix-2371"><a href="#FisherMatrix-2371"><span class="linenos">2371</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix-2372"><a href="#FisherMatrix-2372"><span class="linenos">2372</span></a><span class="sd">        where $\mathsf{P}$ denotes the correlation matrix.</span>
</span><span id="FisherMatrix-2373"><a href="#FisherMatrix-2373"><span class="linenos">2373</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-2374"><a href="#FisherMatrix-2374"><span class="linenos">2374</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correlation_matrix</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
</span></pre></div>


            <div class="docstring"><p>Class for handling Fisher objects.</p>

<h6 id="examples">Examples</h6>

<p>Specify a Fisher object with default names and fiducials:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$p_1$&#39;</span><span class="p">,</span> <span class="s1">&#39;$p_2$&#39;</span><span class="p">])</span>
</code></pre>
</div>

<p>The object has a friendly representation in the interactive session:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[5., 0.],</span>
<span class="go">       [0., 4.]]),</span>
<span class="go">    names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$p_1$&#39;, &#39;$p_2$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>

<p>In a Jupyter notebook, it looks similar to the below (you can hover over
the $\LaTeX$ label to show the corresponding name and fiducial of that
parameter):</p>

<table>
<thead>
<tr>
<th></th>
<th title="name = 'p1', fiducial = 0.0">$p_1$</th>
<th title="name = 'p2', fiducial = 0.0">$p_2$</th>
</tr>
</thead>
<tbody>
<tr>
<th title="name = 'p1', fiducial = 0.0">$p_1$</th>
<td>5.000</td>
<td>0.000</td>
</tr>
<tr>
<th title="name = 'p2', fiducial = 0.0">$p_2$</th>
<td>0.000</td>
<td>4.000</td>
</tr>
</tbody>
</table>

<p>List the names:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;p1&#39;, &#39;p2&#39;], dtype=object)</span>
</code></pre>
</div>

<p>List the values of the Fisher object:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([[5., 0.],</span>
<span class="go">       [0., 4.]])</span>
</code></pre>
</div>

<p>List the values of the fiducials:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">fiducials</span>
<span class="go">array([0., 0.])</span>
</code></pre>
</div>

<p>Names can be changed in bulk (ditto for fiducials and values; dimension
must of course match the original):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">latex_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{X}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Y}</span><span class="s1">$&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[5., 0.],</span>
<span class="go">       [0., 4.]]),</span>
<span class="go">    names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>

<p>We can get and set individual elements of the matrix using dict-like notation:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="go">5.0</span>
</code></pre>
</div>

<p>The off-diagonal elements are automatically updated when using the setter:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[ 5., -2.],</span>
<span class="go">       [-2.,  4.]]),</span>
<span class="go">    names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>

<p>We can select submatrices by index:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[2., 0.],</span>
<span class="go">       [0., 3.]]),</span>
<span class="go">    names=array([&#39;y&#39;, &#39;z&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;y&#39;, &#39;z&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>

<p>Fisher object with parameter names:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
<span class="gp">... </span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mathbf</span><span class="si">{X}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mathbf</span><span class="si">{Y}</span><span class="s1">$&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_with_names</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
</code></pre>
</div>

<p>We can add Fisher objects (ordering of names is taken care of):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">+</span> <span class="n">fm_with_names</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[6., 0.],</span>
<span class="go">       [0., 6.]]),</span>
<span class="go">    names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>

<p>We can also do element-wise multiplication or division:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">*</span> <span class="n">fm_with_names</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[5., 0.],</span>
<span class="go">       [0., 8.]]),</span>
<span class="go">    names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>

<p>Furthermore, we can do matrix multiplication:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">@</span> <span class="n">fm_with_names</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[5., 0.],</span>
<span class="go">       [0., 8.]]),</span>
<span class="go">    names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>

<p>We can also perform standard matrix operations like the trace, eigenvalues, determinant:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">9.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="go">array([4., 5.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">19.999999999999996</span>
</code></pre>
</div>

<p>We can also get the inverse (the covariance matrix):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">array([[0.2 , 0.  ],</span>
<span class="go">       [0.  , 0.25]])</span>
</code></pre>
</div>

<p>We can drop parameters from the object:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[4.]]),</span>
<span class="go">    names=array([&#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0.]))</span>
</code></pre>
</div>

<p>We can save it to a file (the returned value is the dictionary that was saved):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;example_matrix.json&#39;</span><span class="p">),</span> <span class="n">sort_dicts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">{&#39;values&#39;: [[5.0, 0.0], [0.0, 4.0]],</span>
<span class="go"> &#39;names&#39;: [&#39;x&#39;, &#39;y&#39;],</span>
<span class="go"> &#39;latex_names&#39;: [&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;],</span>
<span class="go"> &#39;fiducials&#39;: [0.0, 0.0]}</span>
</code></pre>
</div>

<p>Loading is performed by a class method <code><a href="#FisherMatrix.from_file">from_file</a></code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm_new</span> <span class="o">=</span> <span class="n"><a href="#FisherMatrix.from_file">FisherMatrix.from_file</a></span><span class="p">(</span><span class="s1">&#39;example_matrix.json&#39;</span><span class="p">)</span> <span class="c1"># doctest: +SKIP</span>
</code></pre>
</div>
</div>


                            <div id="FisherMatrix.__init__" class="classattr">
                                        <input id="FisherMatrix.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">FisherMatrix</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">values</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.__init__-445"><a href="#FisherMatrix.__init__-445"><span class="linenos">445</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FisherMatrix.__init__-446"><a href="#FisherMatrix.__init__-446"><span class="linenos">446</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-447"><a href="#FisherMatrix.__init__-447"><span class="linenos">447</span></a>        <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-448"><a href="#FisherMatrix.__init__-448"><span class="linenos">448</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-449"><a href="#FisherMatrix.__init__-449"><span class="linenos">449</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-450"><a href="#FisherMatrix.__init__-450"><span class="linenos">450</span></a>        <span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-451"><a href="#FisherMatrix.__init__-451"><span class="linenos">451</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix.__init__-452"><a href="#FisherMatrix.__init__-452"><span class="linenos">452</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.__init__-453"><a href="#FisherMatrix.__init__-453"><span class="linenos">453</span></a><span class="sd">        Create for Fisher object.</span>
</span><span id="FisherMatrix.__init__-454"><a href="#FisherMatrix.__init__-454"><span class="linenos">454</span></a>
</span><span id="FisherMatrix.__init__-455"><a href="#FisherMatrix.__init__-455"><span class="linenos">455</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.__init__-456"><a href="#FisherMatrix.__init__-456"><span class="linenos">456</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.__init__-457"><a href="#FisherMatrix.__init__-457"><span class="linenos">457</span></a><span class="sd">        values : array_like of float</span>
</span><span id="FisherMatrix.__init__-458"><a href="#FisherMatrix.__init__-458"><span class="linenos">458</span></a><span class="sd">            The values of the Fisher object.</span>
</span><span id="FisherMatrix.__init__-459"><a href="#FisherMatrix.__init__-459"><span class="linenos">459</span></a>
</span><span id="FisherMatrix.__init__-460"><a href="#FisherMatrix.__init__-460"><span class="linenos">460</span></a><span class="sd">        names : array_like of str, optional</span>
</span><span id="FisherMatrix.__init__-461"><a href="#FisherMatrix.__init__-461"><span class="linenos">461</span></a><span class="sd">            The names of the parameters (default: None).</span>
</span><span id="FisherMatrix.__init__-462"><a href="#FisherMatrix.__init__-462"><span class="linenos">462</span></a><span class="sd">            If not specified, defaults to `p1, ..., pn`.</span>
</span><span id="FisherMatrix.__init__-463"><a href="#FisherMatrix.__init__-463"><span class="linenos">463</span></a>
</span><span id="FisherMatrix.__init__-464"><a href="#FisherMatrix.__init__-464"><span class="linenos">464</span></a><span class="sd">        latex_names : array_like of str, optional</span>
</span><span id="FisherMatrix.__init__-465"><a href="#FisherMatrix.__init__-465"><span class="linenos">465</span></a><span class="sd">            The LaTeX names of the parameters (default: None).</span>
</span><span id="FisherMatrix.__init__-466"><a href="#FisherMatrix.__init__-466"><span class="linenos">466</span></a><span class="sd">            If not specified, defaults to `names`.</span>
</span><span id="FisherMatrix.__init__-467"><a href="#FisherMatrix.__init__-467"><span class="linenos">467</span></a>
</span><span id="FisherMatrix.__init__-468"><a href="#FisherMatrix.__init__-468"><span class="linenos">468</span></a><span class="sd">        fiducials : array_like of float, optional</span>
</span><span id="FisherMatrix.__init__-469"><a href="#FisherMatrix.__init__-469"><span class="linenos">469</span></a><span class="sd">            The fiducial values of the parameters (default: None). If not</span>
</span><span id="FisherMatrix.__init__-470"><a href="#FisherMatrix.__init__-470"><span class="linenos">470</span></a><span class="sd">            specified, default to 0 for all parameters.</span>
</span><span id="FisherMatrix.__init__-471"><a href="#FisherMatrix.__init__-471"><span class="linenos">471</span></a>
</span><span id="FisherMatrix.__init__-472"><a href="#FisherMatrix.__init__-472"><span class="linenos">472</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix.__init__-473"><a href="#FisherMatrix.__init__-473"><span class="linenos">473</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix.__init__-474"><a href="#FisherMatrix.__init__-474"><span class="linenos">474</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix.__init__-475"><a href="#FisherMatrix.__init__-475"><span class="linenos">475</span></a><span class="sd">            if the input array has the wrong dimensionality (not 2)</span>
</span><span id="FisherMatrix.__init__-476"><a href="#FisherMatrix.__init__-476"><span class="linenos">476</span></a>
</span><span id="FisherMatrix.__init__-477"><a href="#FisherMatrix.__init__-477"><span class="linenos">477</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix.__init__-478"><a href="#FisherMatrix.__init__-478"><span class="linenos">478</span></a><span class="sd">            if the object is not square-like</span>
</span><span id="FisherMatrix.__init__-479"><a href="#FisherMatrix.__init__-479"><span class="linenos">479</span></a>
</span><span id="FisherMatrix.__init__-480"><a href="#FisherMatrix.__init__-480"><span class="linenos">480</span></a><span class="sd">        MismatchingSizeError</span>
</span><span id="FisherMatrix.__init__-481"><a href="#FisherMatrix.__init__-481"><span class="linenos">481</span></a><span class="sd">            if the sizes of the array of names, values, LaTeX names and</span>
</span><span id="FisherMatrix.__init__-482"><a href="#FisherMatrix.__init__-482"><span class="linenos">482</span></a><span class="sd">            fiducials do not match</span>
</span><span id="FisherMatrix.__init__-483"><a href="#FisherMatrix.__init__-483"><span class="linenos">483</span></a>
</span><span id="FisherMatrix.__init__-484"><a href="#FisherMatrix.__init__-484"><span class="linenos">484</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.__init__-485"><a href="#FisherMatrix.__init__-485"><span class="linenos">485</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.__init__-486"><a href="#FisherMatrix.__init__-486"><span class="linenos">486</span></a><span class="sd">        Specify a Fisher object without names:</span>
</span><span id="FisherMatrix.__init__-487"><a href="#FisherMatrix.__init__-487"><span class="linenos">487</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix.__init__-488"><a href="#FisherMatrix.__init__-488"><span class="linenos">488</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.__init__-489"><a href="#FisherMatrix.__init__-489"><span class="linenos">489</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="FisherMatrix.__init__-490"><a href="#FisherMatrix.__init__-490"><span class="linenos">490</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix.__init__-491"><a href="#FisherMatrix.__init__-491"><span class="linenos">491</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix.__init__-492"><a href="#FisherMatrix.__init__-492"><span class="linenos">492</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.__init__-493"><a href="#FisherMatrix.__init__-493"><span class="linenos">493</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.__init__-494"><a href="#FisherMatrix.__init__-494"><span class="linenos">494</span></a><span class="sd">            fiducials=array([0., 0., 0.]))</span>
</span><span id="FisherMatrix.__init__-495"><a href="#FisherMatrix.__init__-495"><span class="linenos">495</span></a>
</span><span id="FisherMatrix.__init__-496"><a href="#FisherMatrix.__init__-496"><span class="linenos">496</span></a><span class="sd">        Specify a Fisher object with names, LaTeX names, and fiducials:</span>
</span><span id="FisherMatrix.__init__-497"><a href="#FisherMatrix.__init__-497"><span class="linenos">497</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([1, 2]), names=[&#39;alpha&#39;, &#39;beta&#39;],</span>
</span><span id="FisherMatrix.__init__-498"><a href="#FisherMatrix.__init__-498"><span class="linenos">498</span></a><span class="sd">        ... latex_names=[r&#39;$\alpha$&#39;, r&#39;$\beta$&#39;], fiducials=[-3, 2])</span>
</span><span id="FisherMatrix.__init__-499"><a href="#FisherMatrix.__init__-499"><span class="linenos">499</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.__init__-500"><a href="#FisherMatrix.__init__-500"><span class="linenos">500</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix.__init__-501"><a href="#FisherMatrix.__init__-501"><span class="linenos">501</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix.__init__-502"><a href="#FisherMatrix.__init__-502"><span class="linenos">502</span></a><span class="sd">            names=array([&#39;alpha&#39;, &#39;beta&#39;], dtype=object),</span>
</span><span id="FisherMatrix.__init__-503"><a href="#FisherMatrix.__init__-503"><span class="linenos">503</span></a><span class="sd">            latex_names=array([&#39;$\\alpha$&#39;, &#39;$\\beta$&#39;], dtype=object),</span>
</span><span id="FisherMatrix.__init__-504"><a href="#FisherMatrix.__init__-504"><span class="linenos">504</span></a><span class="sd">            fiducials=array([-3.,  2.]))</span>
</span><span id="FisherMatrix.__init__-505"><a href="#FisherMatrix.__init__-505"><span class="linenos">505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.__init__-506"><a href="#FisherMatrix.__init__-506"><span class="linenos">506</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-507"><a href="#FisherMatrix.__init__-507"><span class="linenos">507</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2"> is not 2-dimensional&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-508"><a href="#FisherMatrix.__init__-508"><span class="linenos">508</span></a>
</span><span id="FisherMatrix.__init__-509"><a href="#FisherMatrix.__init__-509"><span class="linenos">509</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
</span><span id="FisherMatrix.__init__-510"><a href="#FisherMatrix.__init__-510"><span class="linenos">510</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2"> is not square-like&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-511"><a href="#FisherMatrix.__init__-511"><span class="linenos">511</span></a>
</span><span id="FisherMatrix.__init__-512"><a href="#FisherMatrix.__init__-512"><span class="linenos">512</span></a>        <span class="c1"># try to treat it as an array-like object</span>
</span><span id="FisherMatrix.__init__-513"><a href="#FisherMatrix.__init__-513"><span class="linenos">513</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-514"><a href="#FisherMatrix.__init__-514"><span class="linenos">514</span></a>
</span><span id="FisherMatrix.__init__-515"><a href="#FisherMatrix.__init__-515"><span class="linenos">515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix.__init__-516"><a href="#FisherMatrix.__init__-516"><span class="linenos">516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ndim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-517"><a href="#FisherMatrix.__init__-517"><span class="linenos">517</span></a>        <span class="c1"># setting the fiducials</span>
</span><span id="FisherMatrix.__init__-518"><a href="#FisherMatrix.__init__-518"><span class="linenos">518</span></a>        <span class="k">if</span> <span class="n">fiducials</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-519"><a href="#FisherMatrix.__init__-519"><span class="linenos">519</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-520"><a href="#FisherMatrix.__init__-520"><span class="linenos">520</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-521"><a href="#FisherMatrix.__init__-521"><span class="linenos">521</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-522"><a href="#FisherMatrix.__init__-522"><span class="linenos">522</span></a>
</span><span id="FisherMatrix.__init__-523"><a href="#FisherMatrix.__init__-523"><span class="linenos">523</span></a>        <span class="c1"># setting the names</span>
</span><span id="FisherMatrix.__init__-524"><a href="#FisherMatrix.__init__-524"><span class="linenos">524</span></a>        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-525"><a href="#FisherMatrix.__init__-525"><span class="linenos">525</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">make_default_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-526"><a href="#FisherMatrix.__init__-526"><span class="linenos">526</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-527"><a href="#FisherMatrix.__init__-527"><span class="linenos">527</span></a>            <span class="c1"># check they&#39;re unique</span>
</span><span id="FisherMatrix.__init__-528"><a href="#FisherMatrix.__init__-528"><span class="linenos">528</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix.__init__-529"><a href="#FisherMatrix.__init__-529"><span class="linenos">529</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-530"><a href="#FisherMatrix.__init__-530"><span class="linenos">530</span></a>
</span><span id="FisherMatrix.__init__-531"><a href="#FisherMatrix.__init__-531"><span class="linenos">531</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-532"><a href="#FisherMatrix.__init__-532"><span class="linenos">532</span></a>
</span><span id="FisherMatrix.__init__-533"><a href="#FisherMatrix.__init__-533"><span class="linenos">533</span></a>        <span class="c1"># setting the pretty names (LaTeX)</span>
</span><span id="FisherMatrix.__init__-534"><a href="#FisherMatrix.__init__-534"><span class="linenos">534</span></a>        <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-535"><a href="#FisherMatrix.__init__-535"><span class="linenos">535</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-536"><a href="#FisherMatrix.__init__-536"><span class="linenos">536</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-537"><a href="#FisherMatrix.__init__-537"><span class="linenos">537</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latex_names</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-538"><a href="#FisherMatrix.__init__-538"><span class="linenos">538</span></a>
</span><span id="FisherMatrix.__init__-539"><a href="#FisherMatrix.__init__-539"><span class="linenos">539</span></a>        <span class="c1"># check sizes of inputs</span>
</span><span id="FisherMatrix.__init__-540"><a href="#FisherMatrix.__init__-540"><span class="linenos">540</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="FisherMatrix.__init__-541"><a href="#FisherMatrix.__init__-541"><span class="linenos">541</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span>
</span><span id="FisherMatrix.__init__-542"><a href="#FisherMatrix.__init__-542"><span class="linenos">542</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-543"><a href="#FisherMatrix.__init__-543"><span class="linenos">543</span></a>        <span class="p">):</span>
</span><span id="FisherMatrix.__init__-544"><a href="#FisherMatrix.__init__-544"><span class="linenos">544</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span>
</span><span id="FisherMatrix.__init__-545"><a href="#FisherMatrix.__init__-545"><span class="linenos">545</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="FisherMatrix.__init__-546"><a href="#FisherMatrix.__init__-546"><span class="linenos">546</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-547"><a href="#FisherMatrix.__init__-547"><span class="linenos">547</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-548"><a href="#FisherMatrix.__init__-548"><span class="linenos">548</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-549"><a href="#FisherMatrix.__init__-549"><span class="linenos">549</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create for Fisher object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>values</strong> (array_like of float):
The values of the Fisher object.</li>
<li><strong>names</strong> (array_like of str, optional):
The names of the parameters (default: None).
If not specified, defaults to <code>p1, ..., pn</code>.</li>
<li><strong>latex_names</strong> (array_like of str, optional):
The LaTeX names of the parameters (default: None).
If not specified, defaults to <code><a href="#FisherMatrix.names">names</a></code>.</li>
<li><strong>fiducials</strong> (array_like of float, optional):
The fiducial values of the parameters (default: None). If not
specified, default to 0 for all parameters.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: if the input array has the wrong dimensionality (not 2)</li>
<li><strong>ValueError</strong>: if the object is not square-like</li>
<li><strong>MismatchingSizeError</strong>: if the sizes of the array of names, values, LaTeX names and
fiducials do not match</li>
</ul>

<h6 id="examples">Examples</h6>

<p>Specify a Fisher object without names:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0., 0.],</span>
<span class="go">       [0., 2., 0.],</span>
<span class="go">       [0., 0., 3.]]),</span>
<span class="go">    names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0., 0.]))</span>
</code></pre>
</div>

<p>Specify a Fisher object with names, LaTeX names, and fiducials:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\beta$&#39;</span><span class="p">],</span> <span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0.],</span>
<span class="go">       [0., 2.]]),</span>
<span class="go">    names=array([&#39;alpha&#39;, &#39;beta&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\alpha$&#39;, &#39;$\\beta$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([-3.,  2.]))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.from_parameters" class="classattr">
                                        <input id="FisherMatrix.from_parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_parameters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">values</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n"><a href="utilities.html#P">fitk.utilities.P</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.from_parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.from_parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.from_parameters-551"><a href="#FisherMatrix.from_parameters-551"><span class="linenos">551</span></a>    <span class="nd">@classmethod</span>
</span><span id="FisherMatrix.from_parameters-552"><a href="#FisherMatrix.from_parameters-552"><span class="linenos">552</span></a>    <span class="k">def</span> <span class="nf">from_parameters</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="p">):</span>
</span><span id="FisherMatrix.from_parameters-553"><a href="#FisherMatrix.from_parameters-553"><span class="linenos">553</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.from_parameters-554"><a href="#FisherMatrix.from_parameters-554"><span class="linenos">554</span></a><span class="sd">        Alternative constructor.</span>
</span><span id="FisherMatrix.from_parameters-555"><a href="#FisherMatrix.from_parameters-555"><span class="linenos">555</span></a>
</span><span id="FisherMatrix.from_parameters-556"><a href="#FisherMatrix.from_parameters-556"><span class="linenos">556</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.from_parameters-557"><a href="#FisherMatrix.from_parameters-557"><span class="linenos">557</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.from_parameters-558"><a href="#FisherMatrix.from_parameters-558"><span class="linenos">558</span></a><span class="sd">        values : array_like of float</span>
</span><span id="FisherMatrix.from_parameters-559"><a href="#FisherMatrix.from_parameters-559"><span class="linenos">559</span></a><span class="sd">            the values of the Fisher object</span>
</span><span id="FisherMatrix.from_parameters-560"><a href="#FisherMatrix.from_parameters-560"><span class="linenos">560</span></a>
</span><span id="FisherMatrix.from_parameters-561"><a href="#FisherMatrix.from_parameters-561"><span class="linenos">561</span></a><span class="sd">        *args : P</span>
</span><span id="FisherMatrix.from_parameters-562"><a href="#FisherMatrix.from_parameters-562"><span class="linenos">562</span></a><span class="sd">            the Fisher parameters</span>
</span><span id="FisherMatrix.from_parameters-563"><a href="#FisherMatrix.from_parameters-563"><span class="linenos">563</span></a>
</span><span id="FisherMatrix.from_parameters-564"><a href="#FisherMatrix.from_parameters-564"><span class="linenos">564</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.from_parameters-565"><a href="#FisherMatrix.from_parameters-565"><span class="linenos">565</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.from_parameters-566"><a href="#FisherMatrix.from_parameters-566"><span class="linenos">566</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix.from_parameters(</span>
</span><span id="FisherMatrix.from_parameters-567"><a href="#FisherMatrix.from_parameters-567"><span class="linenos">567</span></a><span class="sd">        ... np.diag([1, 2, 3]),</span>
</span><span id="FisherMatrix.from_parameters-568"><a href="#FisherMatrix.from_parameters-568"><span class="linenos">568</span></a><span class="sd">        ... P(&#39;a&#39;, -1, &#39;$x$&#39;),</span>
</span><span id="FisherMatrix.from_parameters-569"><a href="#FisherMatrix.from_parameters-569"><span class="linenos">569</span></a><span class="sd">        ... P(&#39;b&#39;, 0, &#39;$y$&#39;),</span>
</span><span id="FisherMatrix.from_parameters-570"><a href="#FisherMatrix.from_parameters-570"><span class="linenos">570</span></a><span class="sd">        ... P(&#39;c&#39;, 1, &#39;$z$&#39;)</span>
</span><span id="FisherMatrix.from_parameters-571"><a href="#FisherMatrix.from_parameters-571"><span class="linenos">571</span></a><span class="sd">        ... )</span>
</span><span id="FisherMatrix.from_parameters-572"><a href="#FisherMatrix.from_parameters-572"><span class="linenos">572</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.from_parameters-573"><a href="#FisherMatrix.from_parameters-573"><span class="linenos">573</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="FisherMatrix.from_parameters-574"><a href="#FisherMatrix.from_parameters-574"><span class="linenos">574</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix.from_parameters-575"><a href="#FisherMatrix.from_parameters-575"><span class="linenos">575</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix.from_parameters-576"><a href="#FisherMatrix.from_parameters-576"><span class="linenos">576</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=object),</span>
</span><span id="FisherMatrix.from_parameters-577"><a href="#FisherMatrix.from_parameters-577"><span class="linenos">577</span></a><span class="sd">            latex_names=array([&#39;$x$&#39;, &#39;$y$&#39;, &#39;$z$&#39;], dtype=object),</span>
</span><span id="FisherMatrix.from_parameters-578"><a href="#FisherMatrix.from_parameters-578"><span class="linenos">578</span></a><span class="sd">            fiducials=array([-1.,  0.,  1.]))</span>
</span><span id="FisherMatrix.from_parameters-579"><a href="#FisherMatrix.from_parameters-579"><span class="linenos">579</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.from_parameters-580"><a href="#FisherMatrix.from_parameters-580"><span class="linenos">580</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="FisherMatrix.from_parameters-581"><a href="#FisherMatrix.from_parameters-581"><span class="linenos">581</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.from_parameters-582"><a href="#FisherMatrix.from_parameters-582"><span class="linenos">582</span></a>            <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>
</span><span id="FisherMatrix.from_parameters-583"><a href="#FisherMatrix.from_parameters-583"><span class="linenos">583</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">fiducial</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
</span><span id="FisherMatrix.from_parameters-584"><a href="#FisherMatrix.from_parameters-584"><span class="linenos">584</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">latex_name</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
</span><span id="FisherMatrix.from_parameters-585"><a href="#FisherMatrix.from_parameters-585"><span class="linenos">585</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Alternative constructor.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>values</strong> (array_like of float):
the values of the Fisher object</li>
<li><strong>*args</strong> (P):
the Fisher parameters</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n"><a href="#FisherMatrix.from_parameters">FisherMatrix.from_parameters</a></span><span class="p">(</span>
<span class="gp">... </span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
<span class="gp">... </span><span class="n">P</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;$x$&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="n">P</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;$y$&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="n">P</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;$z$&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0., 0.],</span>
<span class="go">       [0., 2., 0.],</span>
<span class="go">       [0., 0., 3.]]),</span>
<span class="go">    names=array([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$x$&#39;, &#39;$y$&#39;, &#39;$z$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([-1.,  0.,  1.]))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.matrix" class="classattr">
                                <div class="attr variable">
            <span class="name">matrix</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.matrix"></a>
    
            <div class="docstring"><p>Return the (multivariate) Gaussian part of the Fisher object.</p>
</div>


                            </div>
                            <div id="FisherMatrix.values" class="classattr">
                                <div class="attr variable">
            <span class="name">values</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.values"></a>
    
            <div class="docstring"><p>Returns the values in the Fisher object as a numpy array.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MismatchingSizeError</strong>: if the new values do not have the same size as the original ones</li>
<li><strong>ValueError</strong>: if the shape of the new values is not square</li>
<li><strong>TypeError</strong>: if the new values do not have the same type as the original ones</li>
</ul>

<h6 id="notes">Notes</h6>

<p>Currently returns the same output as <code><a href="#FisherMatrix.matrix">matrix</a></code> (subject to change).</p>
</div>


                            </div>
                            <div id="FisherMatrix.fiducials" class="classattr">
                                <div class="attr variable">
            <span class="name">fiducials</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.fiducials"></a>
    
            <div class="docstring"><p>Returns the fiducial values of the Fisher object as a numpy array.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MismatchingSizeError</strong>: if the new values do not have the same size as the original ones</li>
<li><strong>TypeError</strong>: if the new values do not have the same type as the original ones</li>
</ul>
</div>


                            </div>
                            <div id="FisherMatrix.names" class="classattr">
                                <div class="attr variable">
            <span class="name">names</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.names"></a>
    
            <div class="docstring"><p>Returns the parameter names of the Fisher object.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MismatchingSizeError</strong>: if the new values do not have the same size as the original ones</li>
</ul>
</div>


                            </div>
                            <div id="FisherMatrix.latex_names" class="classattr">
                                <div class="attr variable">
            <span class="name">latex_names</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.latex_names"></a>
    
            <div class="docstring"><p>Returns the LaTeX names of the parameters of the Fisher object.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MismatchingSizeError</strong>: if the new values do not have the same size as the original ones</li>
</ul>
</div>


                            </div>
                            <div id="FisherMatrix.rename" class="classattr">
                                        <input id="FisherMatrix.rename-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rename</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">]]</span>,</span><span class="param">	<span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.tensors.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.rename-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.rename"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.rename-696"><a href="#FisherMatrix.rename-696"><span class="linenos">696</span></a>    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
</span><span id="FisherMatrix.rename-697"><a href="#FisherMatrix.rename-697"><span class="linenos">697</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-698"><a href="#FisherMatrix.rename-698"><span class="linenos">698</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">]],</span>
</span><span id="FisherMatrix.rename-699"><a href="#FisherMatrix.rename-699"><span class="linenos">699</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-700"><a href="#FisherMatrix.rename-700"><span class="linenos">700</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.rename-701"><a href="#FisherMatrix.rename-701"><span class="linenos">701</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.rename-702"><a href="#FisherMatrix.rename-702"><span class="linenos">702</span></a><span class="sd">        Return a Fisher object with new names. This is primarily useful for renaming individual parameters.</span>
</span><span id="FisherMatrix.rename-703"><a href="#FisherMatrix.rename-703"><span class="linenos">703</span></a>
</span><span id="FisherMatrix.rename-704"><a href="#FisherMatrix.rename-704"><span class="linenos">704</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.rename-705"><a href="#FisherMatrix.rename-705"><span class="linenos">705</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.rename-706"><a href="#FisherMatrix.rename-706"><span class="linenos">706</span></a><span class="sd">        names : dict-like</span>
</span><span id="FisherMatrix.rename-707"><a href="#FisherMatrix.rename-707"><span class="linenos">707</span></a><span class="sd">            a mapping (dictionary-like object) between the old names and the</span>
</span><span id="FisherMatrix.rename-708"><a href="#FisherMatrix.rename-708"><span class="linenos">708</span></a><span class="sd">            new ones. The values it maps to can either be a string (the new</span>
</span><span id="FisherMatrix.rename-709"><a href="#FisherMatrix.rename-709"><span class="linenos">709</span></a><span class="sd">            name), or a dict with keys `name`, `latex_name`, and `fiducial`</span>
</span><span id="FisherMatrix.rename-710"><a href="#FisherMatrix.rename-710"><span class="linenos">710</span></a><span class="sd">            (only `name` is mandatory).</span>
</span><span id="FisherMatrix.rename-711"><a href="#FisherMatrix.rename-711"><span class="linenos">711</span></a>
</span><span id="FisherMatrix.rename-712"><a href="#FisherMatrix.rename-712"><span class="linenos">712</span></a><span class="sd">        ignore_errors : bool, optional</span>
</span><span id="FisherMatrix.rename-713"><a href="#FisherMatrix.rename-713"><span class="linenos">713</span></a><span class="sd">            if set to True, will not raise an error if a parameter doesn&#39;t</span>
</span><span id="FisherMatrix.rename-714"><a href="#FisherMatrix.rename-714"><span class="linenos">714</span></a><span class="sd">            exist (default: False)</span>
</span><span id="FisherMatrix.rename-715"><a href="#FisherMatrix.rename-715"><span class="linenos">715</span></a>
</span><span id="FisherMatrix.rename-716"><a href="#FisherMatrix.rename-716"><span class="linenos">716</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.rename-717"><a href="#FisherMatrix.rename-717"><span class="linenos">717</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.rename-718"><a href="#FisherMatrix.rename-718"><span class="linenos">718</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix.rename-719"><a href="#FisherMatrix.rename-719"><span class="linenos">719</span></a><span class="sd">            the Fisher object with new names</span>
</span><span id="FisherMatrix.rename-720"><a href="#FisherMatrix.rename-720"><span class="linenos">720</span></a>
</span><span id="FisherMatrix.rename-721"><a href="#FisherMatrix.rename-721"><span class="linenos">721</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.rename-722"><a href="#FisherMatrix.rename-722"><span class="linenos">722</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.rename-723"><a href="#FisherMatrix.rename-723"><span class="linenos">723</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix.rename-724"><a href="#FisherMatrix.rename-724"><span class="linenos">724</span></a><span class="sd">        &gt;&gt;&gt; m.rename({&#39;p1&#39; : &#39;a&#39;, &#39;p2&#39; : dict(name=&#39;b&#39;, latex_name=&#39;$b$&#39;, fiducial=2)})</span>
</span><span id="FisherMatrix.rename-725"><a href="#FisherMatrix.rename-725"><span class="linenos">725</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.rename-726"><a href="#FisherMatrix.rename-726"><span class="linenos">726</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="FisherMatrix.rename-727"><a href="#FisherMatrix.rename-727"><span class="linenos">727</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix.rename-728"><a href="#FisherMatrix.rename-728"><span class="linenos">728</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix.rename-729"><a href="#FisherMatrix.rename-729"><span class="linenos">729</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.rename-730"><a href="#FisherMatrix.rename-730"><span class="linenos">730</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;$b$&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.rename-731"><a href="#FisherMatrix.rename-731"><span class="linenos">731</span></a><span class="sd">            fiducials=array([0., 2., 0.]))</span>
</span><span id="FisherMatrix.rename-732"><a href="#FisherMatrix.rename-732"><span class="linenos">732</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.rename-733"><a href="#FisherMatrix.rename-733"><span class="linenos">733</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_errors</span><span class="p">:</span>
</span><span id="FisherMatrix.rename-734"><a href="#FisherMatrix.rename-734"><span class="linenos">734</span></a>            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.rename-735"><a href="#FisherMatrix.rename-735"><span class="linenos">735</span></a>                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.rename-736"><a href="#FisherMatrix.rename-736"><span class="linenos">736</span></a>                    <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-737"><a href="#FisherMatrix.rename-737"><span class="linenos">737</span></a>
</span><span id="FisherMatrix.rename-738"><a href="#FisherMatrix.rename-738"><span class="linenos">738</span></a>        <span class="n">names_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-739"><a href="#FisherMatrix.rename-739"><span class="linenos">739</span></a>        <span class="n">latex_names_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-740"><a href="#FisherMatrix.rename-740"><span class="linenos">740</span></a>        <span class="n">fiducial_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-741"><a href="#FisherMatrix.rename-741"><span class="linenos">741</span></a>
</span><span id="FisherMatrix.rename-742"><a href="#FisherMatrix.rename-742"><span class="linenos">742</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="FisherMatrix.rename-743"><a href="#FisherMatrix.rename-743"><span class="linenos">743</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">names_new</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-744"><a href="#FisherMatrix.rename-744"><span class="linenos">744</span></a>            <span class="c1"># it&#39;s a mapping</span>
</span><span id="FisherMatrix.rename-745"><a href="#FisherMatrix.rename-745"><span class="linenos">745</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
</span><span id="FisherMatrix.rename-746"><a href="#FisherMatrix.rename-746"><span class="linenos">746</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">_process_fisher_mapping</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-747"><a href="#FisherMatrix.rename-747"><span class="linenos">747</span></a>                <span class="n">latex_names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;latex_name&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix.rename-748"><a href="#FisherMatrix.rename-748"><span class="linenos">748</span></a>                <span class="n">fiducial_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;fiducial&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix.rename-749"><a href="#FisherMatrix.rename-749"><span class="linenos">749</span></a>                <span class="n">names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix.rename-750"><a href="#FisherMatrix.rename-750"><span class="linenos">750</span></a>            <span class="c1"># otherwise, it&#39;s a string</span>
</span><span id="FisherMatrix.rename-751"><a href="#FisherMatrix.rename-751"><span class="linenos">751</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.rename-752"><a href="#FisherMatrix.rename-752"><span class="linenos">752</span></a>                <span class="n">names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix.rename-753"><a href="#FisherMatrix.rename-753"><span class="linenos">753</span></a>                <span class="n">latex_names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix.rename-754"><a href="#FisherMatrix.rename-754"><span class="linenos">754</span></a>
</span><span id="FisherMatrix.rename-755"><a href="#FisherMatrix.rename-755"><span class="linenos">755</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.rename-756"><a href="#FisherMatrix.rename-756"><span class="linenos">756</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-757"><a href="#FisherMatrix.rename-757"><span class="linenos">757</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names_new</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-758"><a href="#FisherMatrix.rename-758"><span class="linenos">758</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names_new</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-759"><a href="#FisherMatrix.rename-759"><span class="linenos">759</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducial_new</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-760"><a href="#FisherMatrix.rename-760"><span class="linenos">760</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a Fisher object with new names. This is primarily useful for renaming individual parameters.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>names</strong> (dict-like):
a mapping (dictionary-like object) between the old names and the
new ones. The values it maps to can either be a string (the new
name), or a dict with keys <code>name</code>, <code><a href="#FisherMatrix.latex_name">latex_name</a></code>, and <code><a href="#FisherMatrix.fiducial">fiducial</a></code>
(only <code>name</code> is mandatory).</li>
<li><strong>ignore_errors</strong> (bool, optional):
if set to True, will not raise an error if a parameter doesn't
exist (default: False)</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>FisherMatrix</strong>: the Fisher object with new names</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;p1&#39;</span> <span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;p2&#39;</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;$b$&#39;</span><span class="p">,</span> <span class="n">fiducial</span><span class="o">=</span><span class="mi">2</span><span class="p">)})</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0., 0.],</span>
<span class="go">       [0., 2., 0.],</span>
<span class="go">       [0., 0., 3.]]),</span>
<span class="go">    names=array([&#39;a&#39;, &#39;b&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;a&#39;, &#39;$b$&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 2., 0.]))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.fiducial" class="classattr">
                                        <input id="FisherMatrix.fiducial-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fiducial</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.fiducial-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.fiducial"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.fiducial-945"><a href="#FisherMatrix.fiducial-945"><span class="linenos">945</span></a>    <span class="k">def</span> <span class="nf">fiducial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="FisherMatrix.fiducial-946"><a href="#FisherMatrix.fiducial-946"><span class="linenos">946</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.fiducial-947"><a href="#FisherMatrix.fiducial-947"><span class="linenos">947</span></a><span class="sd">        Return the value of the fiducial associated to the parameter `name`.</span>
</span><span id="FisherMatrix.fiducial-948"><a href="#FisherMatrix.fiducial-948"><span class="linenos">948</span></a>
</span><span id="FisherMatrix.fiducial-949"><a href="#FisherMatrix.fiducial-949"><span class="linenos">949</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.fiducial-950"><a href="#FisherMatrix.fiducial-950"><span class="linenos">950</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.fiducial-951"><a href="#FisherMatrix.fiducial-951"><span class="linenos">951</span></a><span class="sd">        name : str</span>
</span><span id="FisherMatrix.fiducial-952"><a href="#FisherMatrix.fiducial-952"><span class="linenos">952</span></a><span class="sd">            the name of the parameter</span>
</span><span id="FisherMatrix.fiducial-953"><a href="#FisherMatrix.fiducial-953"><span class="linenos">953</span></a>
</span><span id="FisherMatrix.fiducial-954"><a href="#FisherMatrix.fiducial-954"><span class="linenos">954</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix.fiducial-955"><a href="#FisherMatrix.fiducial-955"><span class="linenos">955</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix.fiducial-956"><a href="#FisherMatrix.fiducial-956"><span class="linenos">956</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix.fiducial-957"><a href="#FisherMatrix.fiducial-957"><span class="linenos">957</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="FisherMatrix.fiducial-958"><a href="#FisherMatrix.fiducial-958"><span class="linenos">958</span></a>
</span><span id="FisherMatrix.fiducial-959"><a href="#FisherMatrix.fiducial-959"><span class="linenos">959</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.fiducial-960"><a href="#FisherMatrix.fiducial-960"><span class="linenos">960</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.fiducial-961"><a href="#FisherMatrix.fiducial-961"><span class="linenos">961</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="FisherMatrix.fiducial-962"><a href="#FisherMatrix.fiducial-962"><span class="linenos">962</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix.fiducial-963"><a href="#FisherMatrix.fiducial-963"><span class="linenos">963</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], fiducials=[2, 3])</span>
</span><span id="FisherMatrix.fiducial-964"><a href="#FisherMatrix.fiducial-964"><span class="linenos">964</span></a>
</span><span id="FisherMatrix.fiducial-965"><a href="#FisherMatrix.fiducial-965"><span class="linenos">965</span></a><span class="sd">        Get the value of the fiducial associated to parameter `b`:</span>
</span><span id="FisherMatrix.fiducial-966"><a href="#FisherMatrix.fiducial-966"><span class="linenos">966</span></a><span class="sd">        &gt;&gt;&gt; fm.fiducial(&#39;b&#39;)</span>
</span><span id="FisherMatrix.fiducial-967"><a href="#FisherMatrix.fiducial-967"><span class="linenos">967</span></a><span class="sd">        3.0</span>
</span><span id="FisherMatrix.fiducial-968"><a href="#FisherMatrix.fiducial-968"><span class="linenos">968</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.fiducial-969"><a href="#FisherMatrix.fiducial-969"><span class="linenos">969</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.fiducial-970"><a href="#FisherMatrix.fiducial-970"><span class="linenos">970</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.fiducial-971"><a href="#FisherMatrix.fiducial-971"><span class="linenos">971</span></a>
</span><span id="FisherMatrix.fiducial-972"><a href="#FisherMatrix.fiducial-972"><span class="linenos">972</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the value of the fiducial associated to the parameter <code>name</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
the name of the parameter</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ParameterNotFoundError</strong>: if the name is not in the Fisher object</li>
</ul>

<h6 id="examples">Examples</h6>

<p>Create a Fisher matrix:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<span class="gp">... </span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre>
</div>

<p>Get the value of the fiducial associated to parameter <code>b</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">fiducial</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">3.0</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.set_fiducial" class="classattr">
                                        <input id="FisherMatrix.set_fiducial-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_fiducial</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">value</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.set_fiducial-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.set_fiducial"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.set_fiducial-974"><a href="#FisherMatrix.set_fiducial-974"><span class="linenos"> 974</span></a>    <span class="k">def</span> <span class="nf">set_fiducial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="FisherMatrix.set_fiducial-975"><a href="#FisherMatrix.set_fiducial-975"><span class="linenos"> 975</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.set_fiducial-976"><a href="#FisherMatrix.set_fiducial-976"><span class="linenos"> 976</span></a><span class="sd">        Set the fiducial of parameter `name`.</span>
</span><span id="FisherMatrix.set_fiducial-977"><a href="#FisherMatrix.set_fiducial-977"><span class="linenos"> 977</span></a>
</span><span id="FisherMatrix.set_fiducial-978"><a href="#FisherMatrix.set_fiducial-978"><span class="linenos"> 978</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.set_fiducial-979"><a href="#FisherMatrix.set_fiducial-979"><span class="linenos"> 979</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.set_fiducial-980"><a href="#FisherMatrix.set_fiducial-980"><span class="linenos"> 980</span></a><span class="sd">        name : str</span>
</span><span id="FisherMatrix.set_fiducial-981"><a href="#FisherMatrix.set_fiducial-981"><span class="linenos"> 981</span></a><span class="sd">            the name of the parameter</span>
</span><span id="FisherMatrix.set_fiducial-982"><a href="#FisherMatrix.set_fiducial-982"><span class="linenos"> 982</span></a>
</span><span id="FisherMatrix.set_fiducial-983"><a href="#FisherMatrix.set_fiducial-983"><span class="linenos"> 983</span></a><span class="sd">        value : float</span>
</span><span id="FisherMatrix.set_fiducial-984"><a href="#FisherMatrix.set_fiducial-984"><span class="linenos"> 984</span></a><span class="sd">            the new fiducial value of the parameter</span>
</span><span id="FisherMatrix.set_fiducial-985"><a href="#FisherMatrix.set_fiducial-985"><span class="linenos"> 985</span></a>
</span><span id="FisherMatrix.set_fiducial-986"><a href="#FisherMatrix.set_fiducial-986"><span class="linenos"> 986</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix.set_fiducial-987"><a href="#FisherMatrix.set_fiducial-987"><span class="linenos"> 987</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix.set_fiducial-988"><a href="#FisherMatrix.set_fiducial-988"><span class="linenos"> 988</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix.set_fiducial-989"><a href="#FisherMatrix.set_fiducial-989"><span class="linenos"> 989</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="FisherMatrix.set_fiducial-990"><a href="#FisherMatrix.set_fiducial-990"><span class="linenos"> 990</span></a>
</span><span id="FisherMatrix.set_fiducial-991"><a href="#FisherMatrix.set_fiducial-991"><span class="linenos"> 991</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.set_fiducial-992"><a href="#FisherMatrix.set_fiducial-992"><span class="linenos"> 992</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.set_fiducial-993"><a href="#FisherMatrix.set_fiducial-993"><span class="linenos"> 993</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="FisherMatrix.set_fiducial-994"><a href="#FisherMatrix.set_fiducial-994"><span class="linenos"> 994</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix.set_fiducial-995"><a href="#FisherMatrix.set_fiducial-995"><span class="linenos"> 995</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], fiducials=[2, 3])</span>
</span><span id="FisherMatrix.set_fiducial-996"><a href="#FisherMatrix.set_fiducial-996"><span class="linenos"> 996</span></a>
</span><span id="FisherMatrix.set_fiducial-997"><a href="#FisherMatrix.set_fiducial-997"><span class="linenos"> 997</span></a><span class="sd">        Set the value of the fiducial associated to parameter `b`:</span>
</span><span id="FisherMatrix.set_fiducial-998"><a href="#FisherMatrix.set_fiducial-998"><span class="linenos"> 998</span></a><span class="sd">        &gt;&gt;&gt; fm.set_fiducial(&#39;b&#39;, 4)</span>
</span><span id="FisherMatrix.set_fiducial-999"><a href="#FisherMatrix.set_fiducial-999"><span class="linenos"> 999</span></a><span class="sd">        &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix.set_fiducial-1000"><a href="#FisherMatrix.set_fiducial-1000"><span class="linenos">1000</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.set_fiducial-1001"><a href="#FisherMatrix.set_fiducial-1001"><span class="linenos">1001</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix.set_fiducial-1002"><a href="#FisherMatrix.set_fiducial-1002"><span class="linenos">1002</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix.set_fiducial-1003"><a href="#FisherMatrix.set_fiducial-1003"><span class="linenos">1003</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix.set_fiducial-1004"><a href="#FisherMatrix.set_fiducial-1004"><span class="linenos">1004</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix.set_fiducial-1005"><a href="#FisherMatrix.set_fiducial-1005"><span class="linenos">1005</span></a><span class="sd">            fiducials=array([2., 4.]))</span>
</span><span id="FisherMatrix.set_fiducial-1006"><a href="#FisherMatrix.set_fiducial-1006"><span class="linenos">1006</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.set_fiducial-1007"><a href="#FisherMatrix.set_fiducial-1007"><span class="linenos">1007</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.set_fiducial-1008"><a href="#FisherMatrix.set_fiducial-1008"><span class="linenos">1008</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.set_fiducial-1009"><a href="#FisherMatrix.set_fiducial-1009"><span class="linenos">1009</span></a>
</span><span id="FisherMatrix.set_fiducial-1010"><a href="#FisherMatrix.set_fiducial-1010"><span class="linenos">1010</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Set the fiducial of parameter <code>name</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
the name of the parameter</li>
<li><strong>value</strong> (float):
the new fiducial value of the parameter</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ParameterNotFoundError</strong>: if the name is not in the Fisher object</li>
</ul>

<h6 id="examples">Examples</h6>

<p>Create a Fisher matrix:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<span class="gp">... </span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre>
</div>

<p>Set the value of the fiducial associated to parameter <code>b</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">set_fiducial</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0.],</span>
<span class="go">       [0., 2.]]),</span>
<span class="go">    names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
<span class="go">    fiducials=array([2., 4.]))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.latex_name" class="classattr">
                                        <input id="FisherMatrix.latex_name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">latex_name</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.latex_name-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.latex_name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.latex_name-1012"><a href="#FisherMatrix.latex_name-1012"><span class="linenos">1012</span></a>    <span class="k">def</span> <span class="nf">latex_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="FisherMatrix.latex_name-1013"><a href="#FisherMatrix.latex_name-1013"><span class="linenos">1013</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.latex_name-1014"><a href="#FisherMatrix.latex_name-1014"><span class="linenos">1014</span></a><span class="sd">        Return the LaTeX name associated to the parameter `name`.</span>
</span><span id="FisherMatrix.latex_name-1015"><a href="#FisherMatrix.latex_name-1015"><span class="linenos">1015</span></a>
</span><span id="FisherMatrix.latex_name-1016"><a href="#FisherMatrix.latex_name-1016"><span class="linenos">1016</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.latex_name-1017"><a href="#FisherMatrix.latex_name-1017"><span class="linenos">1017</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.latex_name-1018"><a href="#FisherMatrix.latex_name-1018"><span class="linenos">1018</span></a><span class="sd">        name : str</span>
</span><span id="FisherMatrix.latex_name-1019"><a href="#FisherMatrix.latex_name-1019"><span class="linenos">1019</span></a><span class="sd">            the name of the parameter</span>
</span><span id="FisherMatrix.latex_name-1020"><a href="#FisherMatrix.latex_name-1020"><span class="linenos">1020</span></a>
</span><span id="FisherMatrix.latex_name-1021"><a href="#FisherMatrix.latex_name-1021"><span class="linenos">1021</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix.latex_name-1022"><a href="#FisherMatrix.latex_name-1022"><span class="linenos">1022</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix.latex_name-1023"><a href="#FisherMatrix.latex_name-1023"><span class="linenos">1023</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix.latex_name-1024"><a href="#FisherMatrix.latex_name-1024"><span class="linenos">1024</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="FisherMatrix.latex_name-1025"><a href="#FisherMatrix.latex_name-1025"><span class="linenos">1025</span></a>
</span><span id="FisherMatrix.latex_name-1026"><a href="#FisherMatrix.latex_name-1026"><span class="linenos">1026</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.latex_name-1027"><a href="#FisherMatrix.latex_name-1027"><span class="linenos">1027</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.latex_name-1028"><a href="#FisherMatrix.latex_name-1028"><span class="linenos">1028</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="FisherMatrix.latex_name-1029"><a href="#FisherMatrix.latex_name-1029"><span class="linenos">1029</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix.latex_name-1030"><a href="#FisherMatrix.latex_name-1030"><span class="linenos">1030</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], latex_names=[r&#39;$\mathbf{A}$&#39;, r&#39;$\mathbf{B}$&#39;])</span>
</span><span id="FisherMatrix.latex_name-1031"><a href="#FisherMatrix.latex_name-1031"><span class="linenos">1031</span></a>
</span><span id="FisherMatrix.latex_name-1032"><a href="#FisherMatrix.latex_name-1032"><span class="linenos">1032</span></a><span class="sd">        Get the LaTeX name associated to parameter `b`:</span>
</span><span id="FisherMatrix.latex_name-1033"><a href="#FisherMatrix.latex_name-1033"><span class="linenos">1033</span></a><span class="sd">        &gt;&gt;&gt; fm.latex_name(&#39;b&#39;)</span>
</span><span id="FisherMatrix.latex_name-1034"><a href="#FisherMatrix.latex_name-1034"><span class="linenos">1034</span></a><span class="sd">        &#39;$\\mathbf{B}$&#39;</span>
</span><span id="FisherMatrix.latex_name-1035"><a href="#FisherMatrix.latex_name-1035"><span class="linenos">1035</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.latex_name-1036"><a href="#FisherMatrix.latex_name-1036"><span class="linenos">1036</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.latex_name-1037"><a href="#FisherMatrix.latex_name-1037"><span class="linenos">1037</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.latex_name-1038"><a href="#FisherMatrix.latex_name-1038"><span class="linenos">1038</span></a>
</span><span id="FisherMatrix.latex_name-1039"><a href="#FisherMatrix.latex_name-1039"><span class="linenos">1039</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the LaTeX name associated to the parameter <code>name</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
the name of the parameter</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ParameterNotFoundError</strong>: if the name is not in the Fisher object</li>
</ul>

<h6 id="examples">Examples</h6>

<p>Create a Fisher matrix:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<span class="gp">... </span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{A}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{B}</span><span class="s1">$&#39;</span><span class="p">])</span>
</code></pre>
</div>

<p>Get the LaTeX name associated to parameter <code>b</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">latex_name</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">&#39;$\\mathbf{B}$&#39;</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.set_latex_name" class="classattr">
                                        <input id="FisherMatrix.set_latex_name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_latex_name</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">value</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.set_latex_name-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.set_latex_name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.set_latex_name-1041"><a href="#FisherMatrix.set_latex_name-1041"><span class="linenos">1041</span></a>    <span class="k">def</span> <span class="nf">set_latex_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FisherMatrix.set_latex_name-1042"><a href="#FisherMatrix.set_latex_name-1042"><span class="linenos">1042</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.set_latex_name-1043"><a href="#FisherMatrix.set_latex_name-1043"><span class="linenos">1043</span></a><span class="sd">        Set the LaTeX name of parameter `name`.</span>
</span><span id="FisherMatrix.set_latex_name-1044"><a href="#FisherMatrix.set_latex_name-1044"><span class="linenos">1044</span></a>
</span><span id="FisherMatrix.set_latex_name-1045"><a href="#FisherMatrix.set_latex_name-1045"><span class="linenos">1045</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.set_latex_name-1046"><a href="#FisherMatrix.set_latex_name-1046"><span class="linenos">1046</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.set_latex_name-1047"><a href="#FisherMatrix.set_latex_name-1047"><span class="linenos">1047</span></a><span class="sd">        name : str</span>
</span><span id="FisherMatrix.set_latex_name-1048"><a href="#FisherMatrix.set_latex_name-1048"><span class="linenos">1048</span></a><span class="sd">            the name of the parameter</span>
</span><span id="FisherMatrix.set_latex_name-1049"><a href="#FisherMatrix.set_latex_name-1049"><span class="linenos">1049</span></a>
</span><span id="FisherMatrix.set_latex_name-1050"><a href="#FisherMatrix.set_latex_name-1050"><span class="linenos">1050</span></a><span class="sd">        value : str</span>
</span><span id="FisherMatrix.set_latex_name-1051"><a href="#FisherMatrix.set_latex_name-1051"><span class="linenos">1051</span></a><span class="sd">            the new LaTeX name of the parameter</span>
</span><span id="FisherMatrix.set_latex_name-1052"><a href="#FisherMatrix.set_latex_name-1052"><span class="linenos">1052</span></a>
</span><span id="FisherMatrix.set_latex_name-1053"><a href="#FisherMatrix.set_latex_name-1053"><span class="linenos">1053</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix.set_latex_name-1054"><a href="#FisherMatrix.set_latex_name-1054"><span class="linenos">1054</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix.set_latex_name-1055"><a href="#FisherMatrix.set_latex_name-1055"><span class="linenos">1055</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix.set_latex_name-1056"><a href="#FisherMatrix.set_latex_name-1056"><span class="linenos">1056</span></a><span class="sd">            if the name is not in the Fisher object</span>
</span><span id="FisherMatrix.set_latex_name-1057"><a href="#FisherMatrix.set_latex_name-1057"><span class="linenos">1057</span></a>
</span><span id="FisherMatrix.set_latex_name-1058"><a href="#FisherMatrix.set_latex_name-1058"><span class="linenos">1058</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.set_latex_name-1059"><a href="#FisherMatrix.set_latex_name-1059"><span class="linenos">1059</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.set_latex_name-1060"><a href="#FisherMatrix.set_latex_name-1060"><span class="linenos">1060</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="FisherMatrix.set_latex_name-1061"><a href="#FisherMatrix.set_latex_name-1061"><span class="linenos">1061</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix.set_latex_name-1062"><a href="#FisherMatrix.set_latex_name-1062"><span class="linenos">1062</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], fiducials=[2, 3])</span>
</span><span id="FisherMatrix.set_latex_name-1063"><a href="#FisherMatrix.set_latex_name-1063"><span class="linenos">1063</span></a>
</span><span id="FisherMatrix.set_latex_name-1064"><a href="#FisherMatrix.set_latex_name-1064"><span class="linenos">1064</span></a><span class="sd">        Set the value of the fiducial associated to parameter `b`:</span>
</span><span id="FisherMatrix.set_latex_name-1065"><a href="#FisherMatrix.set_latex_name-1065"><span class="linenos">1065</span></a><span class="sd">        &gt;&gt;&gt; fm.set_latex_name(&#39;b&#39;, r&#39;$\mathcal{B}$&#39;)</span>
</span><span id="FisherMatrix.set_latex_name-1066"><a href="#FisherMatrix.set_latex_name-1066"><span class="linenos">1066</span></a><span class="sd">        &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix.set_latex_name-1067"><a href="#FisherMatrix.set_latex_name-1067"><span class="linenos">1067</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.set_latex_name-1068"><a href="#FisherMatrix.set_latex_name-1068"><span class="linenos">1068</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix.set_latex_name-1069"><a href="#FisherMatrix.set_latex_name-1069"><span class="linenos">1069</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix.set_latex_name-1070"><a href="#FisherMatrix.set_latex_name-1070"><span class="linenos">1070</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix.set_latex_name-1071"><a href="#FisherMatrix.set_latex_name-1071"><span class="linenos">1071</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;$\\mathcal{B}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix.set_latex_name-1072"><a href="#FisherMatrix.set_latex_name-1072"><span class="linenos">1072</span></a><span class="sd">            fiducials=array([2., 3.]))</span>
</span><span id="FisherMatrix.set_latex_name-1073"><a href="#FisherMatrix.set_latex_name-1073"><span class="linenos">1073</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.set_latex_name-1074"><a href="#FisherMatrix.set_latex_name-1074"><span class="linenos">1074</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.set_latex_name-1075"><a href="#FisherMatrix.set_latex_name-1075"><span class="linenos">1075</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.set_latex_name-1076"><a href="#FisherMatrix.set_latex_name-1076"><span class="linenos">1076</span></a>
</span><span id="FisherMatrix.set_latex_name-1077"><a href="#FisherMatrix.set_latex_name-1077"><span class="linenos">1077</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Set the LaTeX name of parameter <code>name</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
the name of the parameter</li>
<li><strong>value</strong> (str):
the new LaTeX name of the parameter</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ParameterNotFoundError</strong>: if the name is not in the Fisher object</li>
</ul>

<h6 id="examples">Examples</h6>

<p>Create a Fisher matrix:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<span class="gp">... </span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre>
</div>

<p>Set the value of the fiducial associated to parameter <code>b</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">set_latex_name</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathcal</span><span class="si">{B}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0.],</span>
<span class="go">       [0., 2.]]),</span>
<span class="go">    names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;a&#39;, &#39;$\\mathcal{B}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([2., 3.]))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.is_valid" class="classattr">
                                        <input id="FisherMatrix.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.is_valid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.is_valid-1079"><a href="#FisherMatrix.is_valid-1079"><span class="linenos">1079</span></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.is_valid-1080"><a href="#FisherMatrix.is_valid-1080"><span class="linenos">1080</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.is_valid-1081"><a href="#FisherMatrix.is_valid-1081"><span class="linenos">1081</span></a><span class="sd">        Check whether the values make a valid Fisher object.</span>
</span><span id="FisherMatrix.is_valid-1082"><a href="#FisherMatrix.is_valid-1082"><span class="linenos">1082</span></a>
</span><span id="FisherMatrix.is_valid-1083"><a href="#FisherMatrix.is_valid-1083"><span class="linenos">1083</span></a><span class="sd">        A (square) matrix is a Fisher matrix if it satisifies the following two</span>
</span><span id="FisherMatrix.is_valid-1084"><a href="#FisherMatrix.is_valid-1084"><span class="linenos">1084</span></a><span class="sd">        criteria:</span>
</span><span id="FisherMatrix.is_valid-1085"><a href="#FisherMatrix.is_valid-1085"><span class="linenos">1085</span></a>
</span><span id="FisherMatrix.is_valid-1086"><a href="#FisherMatrix.is_valid-1086"><span class="linenos">1086</span></a><span class="sd">        * it is symmetric</span>
</span><span id="FisherMatrix.is_valid-1087"><a href="#FisherMatrix.is_valid-1087"><span class="linenos">1087</span></a><span class="sd">        * it is positive semi-definite</span>
</span><span id="FisherMatrix.is_valid-1088"><a href="#FisherMatrix.is_valid-1088"><span class="linenos">1088</span></a>
</span><span id="FisherMatrix.is_valid-1089"><a href="#FisherMatrix.is_valid-1089"><span class="linenos">1089</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.is_valid-1090"><a href="#FisherMatrix.is_valid-1090"><span class="linenos">1090</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.is_valid-1091"><a href="#FisherMatrix.is_valid-1091"><span class="linenos">1091</span></a><span class="sd">        bool</span>
</span><span id="FisherMatrix.is_valid-1092"><a href="#FisherMatrix.is_valid-1092"><span class="linenos">1092</span></a><span class="sd">            Whether or nor the Fisher object is valid.</span>
</span><span id="FisherMatrix.is_valid-1093"><a href="#FisherMatrix.is_valid-1093"><span class="linenos">1093</span></a>
</span><span id="FisherMatrix.is_valid-1094"><a href="#FisherMatrix.is_valid-1094"><span class="linenos">1094</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.is_valid-1095"><a href="#FisherMatrix.is_valid-1095"><span class="linenos">1095</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.is_valid-1096"><a href="#FisherMatrix.is_valid-1096"><span class="linenos">1096</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix.is_valid-1097"><a href="#FisherMatrix.is_valid-1097"><span class="linenos">1097</span></a><span class="sd">        &gt;&gt;&gt; m.is_valid()</span>
</span><span id="FisherMatrix.is_valid-1098"><a href="#FisherMatrix.is_valid-1098"><span class="linenos">1098</span></a><span class="sd">        True</span>
</span><span id="FisherMatrix.is_valid-1099"><a href="#FisherMatrix.is_valid-1099"><span class="linenos">1099</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([-1, 3])).is_valid()</span>
</span><span id="FisherMatrix.is_valid-1100"><a href="#FisherMatrix.is_valid-1100"><span class="linenos">1100</span></a><span class="sd">        False</span>
</span><span id="FisherMatrix.is_valid-1101"><a href="#FisherMatrix.is_valid-1101"><span class="linenos">1101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.is_valid-1102"><a href="#FisherMatrix.is_valid-1102"><span class="linenos">1102</span></a>        <span class="k">return</span> <span class="n">is_symmetric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_positive_semidefinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Check whether the values make a valid Fisher object.</p>

<p>A (square) matrix is a Fisher matrix if it satisifies the following two
criteria:</p>

<ul>
<li>it is symmetric</li>
<li>it is positive semi-definite</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: Whether or nor the Fisher object is valid.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="go">False</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.sort" class="classattr">
                                        <input id="FisherMatrix.sort-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sort</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.tensors.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.sort-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.sort"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.sort-1104"><a href="#FisherMatrix.sort-1104"><span class="linenos">1104</span></a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span>
</span><span id="FisherMatrix.sort-1105"><a href="#FisherMatrix.sort-1105"><span class="linenos">1105</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-1106"><a href="#FisherMatrix.sort-1106"><span class="linenos">1106</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-1107"><a href="#FisherMatrix.sort-1107"><span class="linenos">1107</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.sort-1108"><a href="#FisherMatrix.sort-1108"><span class="linenos">1108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.sort-1109"><a href="#FisherMatrix.sort-1109"><span class="linenos">1109</span></a><span class="sd">        Sort the Fisher object by name according to some criterion.</span>
</span><span id="FisherMatrix.sort-1110"><a href="#FisherMatrix.sort-1110"><span class="linenos">1110</span></a>
</span><span id="FisherMatrix.sort-1111"><a href="#FisherMatrix.sort-1111"><span class="linenos">1111</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.sort-1112"><a href="#FisherMatrix.sort-1112"><span class="linenos">1112</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.sort-1113"><a href="#FisherMatrix.sort-1113"><span class="linenos">1113</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix.sort-1114"><a href="#FisherMatrix.sort-1114"><span class="linenos">1114</span></a><span class="sd">            all of the other keyword arguments for the Python builtin &lt;a</span>
</span><span id="FisherMatrix.sort-1115"><a href="#FisherMatrix.sort-1115"><span class="linenos">1115</span></a><span class="sd">            href=&quot;https://docs.python.org/3/library/functions.html#sorted&quot;</span>
</span><span id="FisherMatrix.sort-1116"><a href="#FisherMatrix.sort-1116"><span class="linenos">1116</span></a><span class="sd">            target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;`sorted`&lt;/a&gt;.</span>
</span><span id="FisherMatrix.sort-1117"><a href="#FisherMatrix.sort-1117"><span class="linenos">1117</span></a><span class="sd">            If none are specified, will sort according to the names of the parameters.</span>
</span><span id="FisherMatrix.sort-1118"><a href="#FisherMatrix.sort-1118"><span class="linenos">1118</span></a><span class="sd">            In the special case that the value of the keyword `key` is set to</span>
</span><span id="FisherMatrix.sort-1119"><a href="#FisherMatrix.sort-1119"><span class="linenos">1119</span></a><span class="sd">            either `&#39;fiducials&#39;` or `&#39;latex_names&#39;`, it will sort according to those.</span>
</span><span id="FisherMatrix.sort-1120"><a href="#FisherMatrix.sort-1120"><span class="linenos">1120</span></a><span class="sd">            In the second special case that the value of the keyword `key` is</span>
</span><span id="FisherMatrix.sort-1121"><a href="#FisherMatrix.sort-1121"><span class="linenos">1121</span></a><span class="sd">            set to an array of integers of equal size as the Fisher object, sorts them</span>
</span><span id="FisherMatrix.sort-1122"><a href="#FisherMatrix.sort-1122"><span class="linenos">1122</span></a><span class="sd">            according to those instead.</span>
</span><span id="FisherMatrix.sort-1123"><a href="#FisherMatrix.sort-1123"><span class="linenos">1123</span></a><span class="sd">            In the third (and final) special case that the value of the keyword</span>
</span><span id="FisherMatrix.sort-1124"><a href="#FisherMatrix.sort-1124"><span class="linenos">1124</span></a><span class="sd">            `key` is set to an array strings matching those of parameter names</span>
</span><span id="FisherMatrix.sort-1125"><a href="#FisherMatrix.sort-1125"><span class="linenos">1125</span></a><span class="sd">            of the FisherMatrix, the items are sorted according to those</span>
</span><span id="FisherMatrix.sort-1126"><a href="#FisherMatrix.sort-1126"><span class="linenos">1126</span></a><span class="sd">            values.</span>
</span><span id="FisherMatrix.sort-1127"><a href="#FisherMatrix.sort-1127"><span class="linenos">1127</span></a>
</span><span id="FisherMatrix.sort-1128"><a href="#FisherMatrix.sort-1128"><span class="linenos">1128</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.sort-1129"><a href="#FisherMatrix.sort-1129"><span class="linenos">1129</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.sort-1130"><a href="#FisherMatrix.sort-1130"><span class="linenos">1130</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix.sort-1131"><a href="#FisherMatrix.sort-1131"><span class="linenos">1131</span></a><span class="sd">            the Fisher object with sorted names</span>
</span><span id="FisherMatrix.sort-1132"><a href="#FisherMatrix.sort-1132"><span class="linenos">1132</span></a>
</span><span id="FisherMatrix.sort-1133"><a href="#FisherMatrix.sort-1133"><span class="linenos">1133</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix.sort-1134"><a href="#FisherMatrix.sort-1134"><span class="linenos">1134</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix.sort-1135"><a href="#FisherMatrix.sort-1135"><span class="linenos">1135</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix.sort-1136"><a href="#FisherMatrix.sort-1136"><span class="linenos">1136</span></a><span class="sd">            if `key` does not match the names of the Fisher object</span>
</span><span id="FisherMatrix.sort-1137"><a href="#FisherMatrix.sort-1137"><span class="linenos">1137</span></a>
</span><span id="FisherMatrix.sort-1138"><a href="#FisherMatrix.sort-1138"><span class="linenos">1138</span></a><span class="sd">        TypeError</span>
</span><span id="FisherMatrix.sort-1139"><a href="#FisherMatrix.sort-1139"><span class="linenos">1139</span></a><span class="sd">            if `key` is not a callable</span>
</span><span id="FisherMatrix.sort-1140"><a href="#FisherMatrix.sort-1140"><span class="linenos">1140</span></a>
</span><span id="FisherMatrix.sort-1141"><a href="#FisherMatrix.sort-1141"><span class="linenos">1141</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.sort-1142"><a href="#FisherMatrix.sort-1142"><span class="linenos">1142</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.sort-1143"><a href="#FisherMatrix.sort-1143"><span class="linenos">1143</span></a><span class="sd">        Define a Fisher matrix:</span>
</span><span id="FisherMatrix.sort-1144"><a href="#FisherMatrix.sort-1144"><span class="linenos">1144</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([3, 1, 2]), names=list(&#39;sdf&#39;),</span>
</span><span id="FisherMatrix.sort-1145"><a href="#FisherMatrix.sort-1145"><span class="linenos">1145</span></a><span class="sd">        ... latex_names=[&#39;hjkl&#39;, &#39;qwe&#39;, &#39;ll&#39;], fiducials=[8, 7, 3])</span>
</span><span id="FisherMatrix.sort-1146"><a href="#FisherMatrix.sort-1146"><span class="linenos">1146</span></a>
</span><span id="FisherMatrix.sort-1147"><a href="#FisherMatrix.sort-1147"><span class="linenos">1147</span></a><span class="sd">        Sort according to values of the fiducials:</span>
</span><span id="FisherMatrix.sort-1148"><a href="#FisherMatrix.sort-1148"><span class="linenos">1148</span></a><span class="sd">        &gt;&gt;&gt; m.sort(key=&#39;fiducials&#39;)</span>
</span><span id="FisherMatrix.sort-1149"><a href="#FisherMatrix.sort-1149"><span class="linenos">1149</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.sort-1150"><a href="#FisherMatrix.sort-1150"><span class="linenos">1150</span></a><span class="sd">            array([[2., 0., 0.],</span>
</span><span id="FisherMatrix.sort-1151"><a href="#FisherMatrix.sort-1151"><span class="linenos">1151</span></a><span class="sd">               [0., 1., 0.],</span>
</span><span id="FisherMatrix.sort-1152"><a href="#FisherMatrix.sort-1152"><span class="linenos">1152</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix.sort-1153"><a href="#FisherMatrix.sort-1153"><span class="linenos">1153</span></a><span class="sd">            names=array([&#39;f&#39;, &#39;d&#39;, &#39;s&#39;], dtype=object),</span>
</span><span id="FisherMatrix.sort-1154"><a href="#FisherMatrix.sort-1154"><span class="linenos">1154</span></a><span class="sd">            latex_names=array([&#39;ll&#39;, &#39;qwe&#39;, &#39;hjkl&#39;], dtype=object),</span>
</span><span id="FisherMatrix.sort-1155"><a href="#FisherMatrix.sort-1155"><span class="linenos">1155</span></a><span class="sd">            fiducials=array([3., 7., 8.]))</span>
</span><span id="FisherMatrix.sort-1156"><a href="#FisherMatrix.sort-1156"><span class="linenos">1156</span></a>
</span><span id="FisherMatrix.sort-1157"><a href="#FisherMatrix.sort-1157"><span class="linenos">1157</span></a><span class="sd">        Sort according to the LaTeX names (alphabetically):</span>
</span><span id="FisherMatrix.sort-1158"><a href="#FisherMatrix.sort-1158"><span class="linenos">1158</span></a><span class="sd">        &gt;&gt;&gt; m.sort(key=&#39;latex_names&#39;)</span>
</span><span id="FisherMatrix.sort-1159"><a href="#FisherMatrix.sort-1159"><span class="linenos">1159</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.sort-1160"><a href="#FisherMatrix.sort-1160"><span class="linenos">1160</span></a><span class="sd">            array([[3., 0., 0.],</span>
</span><span id="FisherMatrix.sort-1161"><a href="#FisherMatrix.sort-1161"><span class="linenos">1161</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix.sort-1162"><a href="#FisherMatrix.sort-1162"><span class="linenos">1162</span></a><span class="sd">               [0., 0., 1.]]),</span>
</span><span id="FisherMatrix.sort-1163"><a href="#FisherMatrix.sort-1163"><span class="linenos">1163</span></a><span class="sd">            names=array([&#39;s&#39;, &#39;f&#39;, &#39;d&#39;], dtype=object),</span>
</span><span id="FisherMatrix.sort-1164"><a href="#FisherMatrix.sort-1164"><span class="linenos">1164</span></a><span class="sd">            latex_names=array([&#39;hjkl&#39;, &#39;ll&#39;, &#39;qwe&#39;], dtype=object),</span>
</span><span id="FisherMatrix.sort-1165"><a href="#FisherMatrix.sort-1165"><span class="linenos">1165</span></a><span class="sd">            fiducials=array([8., 3., 7.]))</span>
</span><span id="FisherMatrix.sort-1166"><a href="#FisherMatrix.sort-1166"><span class="linenos">1166</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.sort-1167"><a href="#FisherMatrix.sort-1167"><span class="linenos">1167</span></a>        <span class="n">allowed_keys</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;fiducials&quot;</span><span class="p">,</span> <span class="s2">&quot;latex_names&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-1168"><a href="#FisherMatrix.sort-1168"><span class="linenos">1168</span></a>
</span><span id="FisherMatrix.sort-1169"><a href="#FisherMatrix.sort-1169"><span class="linenos">1169</span></a>        <span class="c1"># something that can be passed to `sorted`</span>
</span><span id="FisherMatrix.sort-1170"><a href="#FisherMatrix.sort-1170"><span class="linenos">1170</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;key&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])):</span>
</span><span id="FisherMatrix.sort-1171"><a href="#FisherMatrix.sort-1171"><span class="linenos">1171</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-1172"><a href="#FisherMatrix.sort-1172"><span class="linenos">1172</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-1173"><a href="#FisherMatrix.sort-1173"><span class="linenos">1173</span></a>
</span><span id="FisherMatrix.sort-1174"><a href="#FisherMatrix.sort-1174"><span class="linenos">1174</span></a>        <span class="c1"># an integer index</span>
</span><span id="FisherMatrix.sort-1175"><a href="#FisherMatrix.sort-1175"><span class="linenos">1175</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="FisherMatrix.sort-1176"><a href="#FisherMatrix.sort-1176"><span class="linenos">1176</span></a>            <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
</span><span id="FisherMatrix.sort-1177"><a href="#FisherMatrix.sort-1177"><span class="linenos">1177</span></a>            <span class="ow">and</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
</span><span id="FisherMatrix.sort-1178"><a href="#FisherMatrix.sort-1178"><span class="linenos">1178</span></a>            <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="s2">&quot;__index__&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
</span><span id="FisherMatrix.sort-1179"><a href="#FisherMatrix.sort-1179"><span class="linenos">1179</span></a>        <span class="p">):</span>
</span><span id="FisherMatrix.sort-1180"><a href="#FisherMatrix.sort-1180"><span class="linenos">1180</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-1181"><a href="#FisherMatrix.sort-1181"><span class="linenos">1181</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix.sort-1182"><a href="#FisherMatrix.sort-1182"><span class="linenos">1182</span></a>
</span><span id="FisherMatrix.sort-1183"><a href="#FisherMatrix.sort-1183"><span class="linenos">1183</span></a>        <span class="c1"># either &#39;fiducials&#39; or &#39;latex_names&#39;</span>
</span><span id="FisherMatrix.sort-1184"><a href="#FisherMatrix.sort-1184"><span class="linenos">1184</span></a>        <span class="k">elif</span> <span class="p">(</span>
</span><span id="FisherMatrix.sort-1185"><a href="#FisherMatrix.sort-1185"><span class="linenos">1185</span></a>            <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
</span><span id="FisherMatrix.sort-1186"><a href="#FisherMatrix.sort-1186"><span class="linenos">1186</span></a>            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-1187"><a href="#FisherMatrix.sort-1187"><span class="linenos">1187</span></a>            <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">allowed_keys</span>
</span><span id="FisherMatrix.sort-1188"><a href="#FisherMatrix.sort-1188"><span class="linenos">1188</span></a>        <span class="p">):</span>
</span><span id="FisherMatrix.sort-1189"><a href="#FisherMatrix.sort-1189"><span class="linenos">1189</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]))</span>
</span><span id="FisherMatrix.sort-1190"><a href="#FisherMatrix.sort-1190"><span class="linenos">1190</span></a>            <span class="k">if</span> <span class="s2">&quot;reversed&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix.sort-1191"><a href="#FisherMatrix.sort-1191"><span class="linenos">1191</span></a>                <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-1192"><a href="#FisherMatrix.sort-1192"><span class="linenos">1192</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix.sort-1193"><a href="#FisherMatrix.sort-1193"><span class="linenos">1193</span></a>
</span><span id="FisherMatrix.sort-1194"><a href="#FisherMatrix.sort-1194"><span class="linenos">1194</span></a>        <span class="c1"># the names themselves, in any order</span>
</span><span id="FisherMatrix.sort-1195"><a href="#FisherMatrix.sort-1195"><span class="linenos">1195</span></a>        <span class="k">elif</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]):</span>
</span><span id="FisherMatrix.sort-1196"><a href="#FisherMatrix.sort-1196"><span class="linenos">1196</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix.sort-1197"><a href="#FisherMatrix.sort-1197"><span class="linenos">1197</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix.sort-1198"><a href="#FisherMatrix.sort-1198"><span class="linenos">1198</span></a>                    <span class="sa">f</span><span class="s2">&quot;The object &#39;</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; appears to be an iterable, &quot;</span>
</span><span id="FisherMatrix.sort-1199"><a href="#FisherMatrix.sort-1199"><span class="linenos">1199</span></a>                    <span class="sa">f</span><span class="s2">&quot;but does not contain all of the names in the Fisher object (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">); &quot;</span>
</span><span id="FisherMatrix.sort-1200"><a href="#FisherMatrix.sort-1200"><span class="linenos">1200</span></a>                    <span class="s2">&quot;if you meant to sort by the names, make sure they are all in the passed array!&quot;</span>
</span><span id="FisherMatrix.sort-1201"><a href="#FisherMatrix.sort-1201"><span class="linenos">1201</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix.sort-1202"><a href="#FisherMatrix.sort-1202"><span class="linenos">1202</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-1203"><a href="#FisherMatrix.sort-1203"><span class="linenos">1203</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix.sort-1204"><a href="#FisherMatrix.sort-1204"><span class="linenos">1204</span></a>
</span><span id="FisherMatrix.sort-1205"><a href="#FisherMatrix.sort-1205"><span class="linenos">1205</span></a>        <span class="c1"># something else should throw an error</span>
</span><span id="FisherMatrix.sort-1206"><a href="#FisherMatrix.sort-1206"><span class="linenos">1206</span></a>        <span class="k">elif</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="FisherMatrix.sort-1207"><a href="#FisherMatrix.sort-1207"><span class="linenos">1207</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="FisherMatrix.sort-1208"><a href="#FisherMatrix.sort-1208"><span class="linenos">1208</span></a>                <span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> is not a callable, a list of names, &quot;</span>
</span><span id="FisherMatrix.sort-1209"><a href="#FisherMatrix.sort-1209"><span class="linenos">1209</span></a>                <span class="sa">f</span><span class="s2">&quot;or one of </span><span class="si">{</span><span class="n">allowed_keys</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix.sort-1210"><a href="#FisherMatrix.sort-1210"><span class="linenos">1210</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix.sort-1211"><a href="#FisherMatrix.sort-1211"><span class="linenos">1211</span></a>
</span><span id="FisherMatrix.sort-1212"><a href="#FisherMatrix.sort-1212"><span class="linenos">1212</span></a>        <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix.sort-1213"><a href="#FisherMatrix.sort-1213"><span class="linenos">1213</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix.sort-1214"><a href="#FisherMatrix.sort-1214"><span class="linenos">1214</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">reindex_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-1215"><a href="#FisherMatrix.sort-1215"><span class="linenos">1215</span></a>
</span><span id="FisherMatrix.sort-1216"><a href="#FisherMatrix.sort-1216"><span class="linenos">1216</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.sort-1217"><a href="#FisherMatrix.sort-1217"><span class="linenos">1217</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-1218"><a href="#FisherMatrix.sort-1218"><span class="linenos">1218</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-1219"><a href="#FisherMatrix.sort-1219"><span class="linenos">1219</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-1220"><a href="#FisherMatrix.sort-1220"><span class="linenos">1220</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-1221"><a href="#FisherMatrix.sort-1221"><span class="linenos">1221</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sort the Fisher object by name according to some criterion.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>**kwargs</strong>: all of the other keyword arguments for the Python builtin <a
href="https://docs.python.org/3/library/functions.html#sorted"
target="_blank" rel="noopener noreferrer"><code>sorted</code></a>.
If none are specified, will sort according to the names of the parameters.
In the special case that the value of the keyword <code>key</code> is set to
either <code>'fiducials'</code> or <code>'latex_names'</code>, it will sort according to those.
In the second special case that the value of the keyword <code>key</code> is
set to an array of integers of equal size as the Fisher object, sorts them
according to those instead.
In the third (and final) special case that the value of the keyword
<code>key</code> is set to an array strings matching those of parameter names
of the FisherMatrix, the items are sorted according to those
values.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>FisherMatrix</strong>: the Fisher object with sorted names</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: if <code>key</code> does not match the names of the Fisher object</li>
<li><strong>TypeError</strong>: if <code>key</code> is not a callable</li>
</ul>

<h6 id="examples">Examples</h6>

<p>Define a Fisher matrix:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;sdf&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hjkl&#39;</span><span class="p">,</span> <span class="s1">&#39;qwe&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">],</span> <span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre>
</div>

<p>Sort according to values of the fiducials:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;fiducials&#39;</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[2., 0., 0.],</span>
<span class="go">       [0., 1., 0.],</span>
<span class="go">       [0., 0., 3.]]),</span>
<span class="go">    names=array([&#39;f&#39;, &#39;d&#39;, &#39;s&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;ll&#39;, &#39;qwe&#39;, &#39;hjkl&#39;], dtype=object),</span>
<span class="go">    fiducials=array([3., 7., 8.]))</span>
</code></pre>
</div>

<p>Sort according to the LaTeX names (alphabetically):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;latex_names&#39;</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[3., 0., 0.],</span>
<span class="go">       [0., 2., 0.],</span>
<span class="go">       [0., 0., 1.]]),</span>
<span class="go">    names=array([&#39;s&#39;, &#39;f&#39;, &#39;d&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;hjkl&#39;, &#39;ll&#39;, &#39;qwe&#39;], dtype=object),</span>
<span class="go">    fiducials=array([8., 3., 7.]))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.ndim" class="classattr">
                                <div class="attr variable">
            <span class="name">ndim</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.ndim"></a>
    
            <div class="docstring"><p>Return the number of dimensions of the Fisher object (for now always 2).</p>
</div>


                            </div>
                            <div id="FisherMatrix.is_diagonal" class="classattr">
                                        <input id="FisherMatrix.is_diagonal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_diagonal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.is_diagonal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.is_diagonal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.is_diagonal-1265"><a href="#FisherMatrix.is_diagonal-1265"><span class="linenos">1265</span></a>    <span class="k">def</span> <span class="nf">is_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.is_diagonal-1266"><a href="#FisherMatrix.is_diagonal-1266"><span class="linenos">1266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.is_diagonal-1267"><a href="#FisherMatrix.is_diagonal-1267"><span class="linenos">1267</span></a><span class="sd">        Check whether the Fisher matrix is diagonal.</span>
</span><span id="FisherMatrix.is_diagonal-1268"><a href="#FisherMatrix.is_diagonal-1268"><span class="linenos">1268</span></a>
</span><span id="FisherMatrix.is_diagonal-1269"><a href="#FisherMatrix.is_diagonal-1269"><span class="linenos">1269</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.is_diagonal-1270"><a href="#FisherMatrix.is_diagonal-1270"><span class="linenos">1270</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.is_diagonal-1271"><a href="#FisherMatrix.is_diagonal-1271"><span class="linenos">1271</span></a><span class="sd">        bool</span>
</span><span id="FisherMatrix.is_diagonal-1272"><a href="#FisherMatrix.is_diagonal-1272"><span class="linenos">1272</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.is_diagonal-1273"><a href="#FisherMatrix.is_diagonal-1273"><span class="linenos">1273</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>Check whether the Fisher matrix is diagonal.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong></li>
</ul>
</div>


                            </div>
                            <div id="FisherMatrix.diagonal" class="classattr">
                                        <input id="FisherMatrix.diagonal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">diagonal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.diagonal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.diagonal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.diagonal-1275"><a href="#FisherMatrix.diagonal-1275"><span class="linenos">1275</span></a>    <span class="k">def</span> <span class="nf">diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="FisherMatrix.diagonal-1276"><a href="#FisherMatrix.diagonal-1276"><span class="linenos">1276</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.diagonal-1277"><a href="#FisherMatrix.diagonal-1277"><span class="linenos">1277</span></a><span class="sd">        Return the diagonal elements of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix.diagonal-1278"><a href="#FisherMatrix.diagonal-1278"><span class="linenos">1278</span></a>
</span><span id="FisherMatrix.diagonal-1279"><a href="#FisherMatrix.diagonal-1279"><span class="linenos">1279</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.diagonal-1280"><a href="#FisherMatrix.diagonal-1280"><span class="linenos">1280</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.diagonal-1281"><a href="#FisherMatrix.diagonal-1281"><span class="linenos">1281</span></a><span class="sd">        array_like : float</span>
</span><span id="FisherMatrix.diagonal-1282"><a href="#FisherMatrix.diagonal-1282"><span class="linenos">1282</span></a><span class="sd">            The diagonal elements as a numpy array.</span>
</span><span id="FisherMatrix.diagonal-1283"><a href="#FisherMatrix.diagonal-1283"><span class="linenos">1283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.diagonal-1284"><a href="#FisherMatrix.diagonal-1284"><span class="linenos">1284</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the diagonal elements of the Fisher object as a numpy array.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>array_like</strong> (float):
The diagonal elements as a numpy array.</li>
</ul>
</div>


                            </div>
                            <div id="FisherMatrix.drop" class="classattr">
                                        <input id="FisherMatrix.drop-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">drop</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.tensors.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.drop-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.drop"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.drop-1286"><a href="#FisherMatrix.drop-1286"><span class="linenos">1286</span></a>    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span>
</span><span id="FisherMatrix.drop-1287"><a href="#FisherMatrix.drop-1287"><span class="linenos">1287</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1288"><a href="#FisherMatrix.drop-1288"><span class="linenos">1288</span></a>        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1289"><a href="#FisherMatrix.drop-1289"><span class="linenos">1289</span></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1290"><a href="#FisherMatrix.drop-1290"><span class="linenos">1290</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1291"><a href="#FisherMatrix.drop-1291"><span class="linenos">1291</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.drop-1292"><a href="#FisherMatrix.drop-1292"><span class="linenos">1292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.drop-1293"><a href="#FisherMatrix.drop-1293"><span class="linenos">1293</span></a><span class="sd">        Remove parameters from the Fisher object.</span>
</span><span id="FisherMatrix.drop-1294"><a href="#FisherMatrix.drop-1294"><span class="linenos">1294</span></a>
</span><span id="FisherMatrix.drop-1295"><a href="#FisherMatrix.drop-1295"><span class="linenos">1295</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.drop-1296"><a href="#FisherMatrix.drop-1296"><span class="linenos">1296</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.drop-1297"><a href="#FisherMatrix.drop-1297"><span class="linenos">1297</span></a><span class="sd">        names : str</span>
</span><span id="FisherMatrix.drop-1298"><a href="#FisherMatrix.drop-1298"><span class="linenos">1298</span></a><span class="sd">            the names of the parameters to drop.</span>
</span><span id="FisherMatrix.drop-1299"><a href="#FisherMatrix.drop-1299"><span class="linenos">1299</span></a><span class="sd">            If passing a list or a tuple, make sure to unpack it using the</span>
</span><span id="FisherMatrix.drop-1300"><a href="#FisherMatrix.drop-1300"><span class="linenos">1300</span></a><span class="sd">            asterisk (*).</span>
</span><span id="FisherMatrix.drop-1301"><a href="#FisherMatrix.drop-1301"><span class="linenos">1301</span></a>
</span><span id="FisherMatrix.drop-1302"><a href="#FisherMatrix.drop-1302"><span class="linenos">1302</span></a><span class="sd">        invert : bool, optional</span>
</span><span id="FisherMatrix.drop-1303"><a href="#FisherMatrix.drop-1303"><span class="linenos">1303</span></a><span class="sd">            whether to drop all the parameters NOT in names (the complement)</span>
</span><span id="FisherMatrix.drop-1304"><a href="#FisherMatrix.drop-1304"><span class="linenos">1304</span></a><span class="sd">            (default: False)</span>
</span><span id="FisherMatrix.drop-1305"><a href="#FisherMatrix.drop-1305"><span class="linenos">1305</span></a>
</span><span id="FisherMatrix.drop-1306"><a href="#FisherMatrix.drop-1306"><span class="linenos">1306</span></a><span class="sd">        ignore_errors : bool, optional</span>
</span><span id="FisherMatrix.drop-1307"><a href="#FisherMatrix.drop-1307"><span class="linenos">1307</span></a><span class="sd">            should non-existing parameters be ignored (default: False)</span>
</span><span id="FisherMatrix.drop-1308"><a href="#FisherMatrix.drop-1308"><span class="linenos">1308</span></a>
</span><span id="FisherMatrix.drop-1309"><a href="#FisherMatrix.drop-1309"><span class="linenos">1309</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.drop-1310"><a href="#FisherMatrix.drop-1310"><span class="linenos">1310</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.drop-1311"><a href="#FisherMatrix.drop-1311"><span class="linenos">1311</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix.drop-1312"><a href="#FisherMatrix.drop-1312"><span class="linenos">1312</span></a><span class="sd">            the Fisher object with removed names</span>
</span><span id="FisherMatrix.drop-1313"><a href="#FisherMatrix.drop-1313"><span class="linenos">1313</span></a>
</span><span id="FisherMatrix.drop-1314"><a href="#FisherMatrix.drop-1314"><span class="linenos">1314</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.drop-1315"><a href="#FisherMatrix.drop-1315"><span class="linenos">1315</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.drop-1316"><a href="#FisherMatrix.drop-1316"><span class="linenos">1316</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix.drop-1317"><a href="#FisherMatrix.drop-1317"><span class="linenos">1317</span></a>
</span><span id="FisherMatrix.drop-1318"><a href="#FisherMatrix.drop-1318"><span class="linenos">1318</span></a><span class="sd">        Drop `p1` and `p3`:</span>
</span><span id="FisherMatrix.drop-1319"><a href="#FisherMatrix.drop-1319"><span class="linenos">1319</span></a><span class="sd">        &gt;&gt;&gt; m.drop(&#39;p1&#39;, &#39;p3&#39;)</span>
</span><span id="FisherMatrix.drop-1320"><a href="#FisherMatrix.drop-1320"><span class="linenos">1320</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.drop-1321"><a href="#FisherMatrix.drop-1321"><span class="linenos">1321</span></a><span class="sd">            array([[2.]]),</span>
</span><span id="FisherMatrix.drop-1322"><a href="#FisherMatrix.drop-1322"><span class="linenos">1322</span></a><span class="sd">            names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-1323"><a href="#FisherMatrix.drop-1323"><span class="linenos">1323</span></a><span class="sd">            latex_names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-1324"><a href="#FisherMatrix.drop-1324"><span class="linenos">1324</span></a><span class="sd">            fiducials=array([0.]))</span>
</span><span id="FisherMatrix.drop-1325"><a href="#FisherMatrix.drop-1325"><span class="linenos">1325</span></a>
</span><span id="FisherMatrix.drop-1326"><a href="#FisherMatrix.drop-1326"><span class="linenos">1326</span></a><span class="sd">        Same result, but note the asterisk (`*`):</span>
</span><span id="FisherMatrix.drop-1327"><a href="#FisherMatrix.drop-1327"><span class="linenos">1327</span></a><span class="sd">        &gt;&gt;&gt; m.drop(*[&#39;p1&#39;, &#39;p3&#39;])</span>
</span><span id="FisherMatrix.drop-1328"><a href="#FisherMatrix.drop-1328"><span class="linenos">1328</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.drop-1329"><a href="#FisherMatrix.drop-1329"><span class="linenos">1329</span></a><span class="sd">            array([[2.]]),</span>
</span><span id="FisherMatrix.drop-1330"><a href="#FisherMatrix.drop-1330"><span class="linenos">1330</span></a><span class="sd">            names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-1331"><a href="#FisherMatrix.drop-1331"><span class="linenos">1331</span></a><span class="sd">            latex_names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-1332"><a href="#FisherMatrix.drop-1332"><span class="linenos">1332</span></a><span class="sd">            fiducials=array([0.]))</span>
</span><span id="FisherMatrix.drop-1333"><a href="#FisherMatrix.drop-1333"><span class="linenos">1333</span></a>
</span><span id="FisherMatrix.drop-1334"><a href="#FisherMatrix.drop-1334"><span class="linenos">1334</span></a><span class="sd">        Drop everything *except* `p1` and `p3`:</span>
</span><span id="FisherMatrix.drop-1335"><a href="#FisherMatrix.drop-1335"><span class="linenos">1335</span></a><span class="sd">        &gt;&gt;&gt; m.drop(&#39;p1&#39;, &#39;p3&#39;, invert=True)</span>
</span><span id="FisherMatrix.drop-1336"><a href="#FisherMatrix.drop-1336"><span class="linenos">1336</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.drop-1337"><a href="#FisherMatrix.drop-1337"><span class="linenos">1337</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix.drop-1338"><a href="#FisherMatrix.drop-1338"><span class="linenos">1338</span></a><span class="sd">               [0., 3.]]),</span>
</span><span id="FisherMatrix.drop-1339"><a href="#FisherMatrix.drop-1339"><span class="linenos">1339</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-1340"><a href="#FisherMatrix.drop-1340"><span class="linenos">1340</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-1341"><a href="#FisherMatrix.drop-1341"><span class="linenos">1341</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix.drop-1342"><a href="#FisherMatrix.drop-1342"><span class="linenos">1342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.drop-1343"><a href="#FisherMatrix.drop-1343"><span class="linenos">1343</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)):</span>
</span><span id="FisherMatrix.drop-1344"><a href="#FisherMatrix.drop-1344"><span class="linenos">1344</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix.drop-1345"><a href="#FisherMatrix.drop-1345"><span class="linenos">1345</span></a>                <span class="sa">f</span><span class="s2">&quot;The names (</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">) are not a strict subset &quot;</span>
</span><span id="FisherMatrix.drop-1346"><a href="#FisherMatrix.drop-1346"><span class="linenos">1346</span></a>                <span class="sa">f</span><span class="s2">&quot;of the parameter names in the Fisher object (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">); &quot;</span>
</span><span id="FisherMatrix.drop-1347"><a href="#FisherMatrix.drop-1347"><span class="linenos">1347</span></a>                <span class="s2">&quot;you can pass `ignore_errors=True` to ignore this error&quot;</span>
</span><span id="FisherMatrix.drop-1348"><a href="#FisherMatrix.drop-1348"><span class="linenos">1348</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix.drop-1349"><a href="#FisherMatrix.drop-1349"><span class="linenos">1349</span></a>
</span><span id="FisherMatrix.drop-1350"><a href="#FisherMatrix.drop-1350"><span class="linenos">1350</span></a>        <span class="k">if</span> <span class="n">ignore_errors</span><span class="p">:</span>
</span><span id="FisherMatrix.drop-1351"><a href="#FisherMatrix.drop-1351"><span class="linenos">1351</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">]))</span>
</span><span id="FisherMatrix.drop-1352"><a href="#FisherMatrix.drop-1352"><span class="linenos">1352</span></a>
</span><span id="FisherMatrix.drop-1353"><a href="#FisherMatrix.drop-1353"><span class="linenos">1353</span></a>        <span class="k">if</span> <span class="n">invert</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix.drop-1354"><a href="#FisherMatrix.drop-1354"><span class="linenos">1354</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">^</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
</span><span id="FisherMatrix.drop-1355"><a href="#FisherMatrix.drop-1355"><span class="linenos">1355</span></a>
</span><span id="FisherMatrix.drop-1356"><a href="#FisherMatrix.drop-1356"><span class="linenos">1356</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix.drop-1357"><a href="#FisherMatrix.drop-1357"><span class="linenos">1357</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to remove all parameters&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix.drop-1358"><a href="#FisherMatrix.drop-1358"><span class="linenos">1358</span></a>
</span><span id="FisherMatrix.drop-1359"><a href="#FisherMatrix.drop-1359"><span class="linenos">1359</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
</span><span id="FisherMatrix.drop-1360"><a href="#FisherMatrix.drop-1360"><span class="linenos">1360</span></a>
</span><span id="FisherMatrix.drop-1361"><a href="#FisherMatrix.drop-1361"><span class="linenos">1361</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
</span><span id="FisherMatrix.drop-1362"><a href="#FisherMatrix.drop-1362"><span class="linenos">1362</span></a>        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
</span><span id="FisherMatrix.drop-1363"><a href="#FisherMatrix.drop-1363"><span class="linenos">1363</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
</span><span id="FisherMatrix.drop-1364"><a href="#FisherMatrix.drop-1364"><span class="linenos">1364</span></a>                <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1365"><a href="#FisherMatrix.drop-1365"><span class="linenos">1365</span></a>                <span class="n">index</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1366"><a href="#FisherMatrix.drop-1366"><span class="linenos">1366</span></a>                <span class="n">axis</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1367"><a href="#FisherMatrix.drop-1367"><span class="linenos">1367</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix.drop-1368"><a href="#FisherMatrix.drop-1368"><span class="linenos">1368</span></a>
</span><span id="FisherMatrix.drop-1369"><a href="#FisherMatrix.drop-1369"><span class="linenos">1369</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix.drop-1370"><a href="#FisherMatrix.drop-1370"><span class="linenos">1370</span></a>        <span class="n">latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix.drop-1371"><a href="#FisherMatrix.drop-1371"><span class="linenos">1371</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
</span><span id="FisherMatrix.drop-1372"><a href="#FisherMatrix.drop-1372"><span class="linenos">1372</span></a>
</span><span id="FisherMatrix.drop-1373"><a href="#FisherMatrix.drop-1373"><span class="linenos">1373</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.drop-1374"><a href="#FisherMatrix.drop-1374"><span class="linenos">1374</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1375"><a href="#FisherMatrix.drop-1375"><span class="linenos">1375</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1376"><a href="#FisherMatrix.drop-1376"><span class="linenos">1376</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1377"><a href="#FisherMatrix.drop-1377"><span class="linenos">1377</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-1378"><a href="#FisherMatrix.drop-1378"><span class="linenos">1378</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Remove parameters from the Fisher object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>names</strong> (str):
the names of the parameters to drop.
If passing a list or a tuple, make sure to unpack it using the
asterisk (*).</li>
<li><strong>invert</strong> (bool, optional):
whether to drop all the parameters NOT in names (the complement)
(default: False)</li>
<li><strong>ignore_errors</strong> (bool, optional):
should non-existing parameters be ignored (default: False)</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>FisherMatrix</strong>: the Fisher object with removed names</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
</code></pre>
</div>

<p>Drop <code>p1</code> and <code>p3</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p3&#39;</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[2.]]),</span>
<span class="go">    names=array([&#39;p2&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p2&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0.]))</span>
</code></pre>
</div>

<p>Same result, but note the asterisk (<code>*</code>):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p3&#39;</span><span class="p">])</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[2.]]),</span>
<span class="go">    names=array([&#39;p2&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p2&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0.]))</span>
</code></pre>
</div>

<p>Drop everything <em>except</em> <code>p1</code> and <code>p3</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p3&#39;</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0.],</span>
<span class="go">       [0., 3.]]),</span>
<span class="go">    names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.trace" class="classattr">
                                        <input id="FisherMatrix.trace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trace</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.trace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.trace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.trace-1380"><a href="#FisherMatrix.trace-1380"><span class="linenos">1380</span></a>    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span>
</span><span id="FisherMatrix.trace-1381"><a href="#FisherMatrix.trace-1381"><span class="linenos">1381</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.trace-1382"><a href="#FisherMatrix.trace-1382"><span class="linenos">1382</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix.trace-1383"><a href="#FisherMatrix.trace-1383"><span class="linenos">1383</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix.trace-1384"><a href="#FisherMatrix.trace-1384"><span class="linenos">1384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the trace of the Fisher object as a numpy array.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.trace-1385"><a href="#FisherMatrix.trace-1385"><span class="linenos">1385</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the trace of the Fisher object as a numpy array.</p>
</div>


                            </div>
                            <div id="FisherMatrix.eigenvalues" class="classattr">
                                        <input id="FisherMatrix.eigenvalues-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">eigenvalues</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.eigenvalues-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.eigenvalues"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.eigenvalues-1387"><a href="#FisherMatrix.eigenvalues-1387"><span class="linenos">1387</span></a>    <span class="k">def</span> <span class="nf">eigenvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.eigenvalues-1388"><a href="#FisherMatrix.eigenvalues-1388"><span class="linenos">1388</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the eigenvalues of the Fisher object as a numpy array.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.eigenvalues-1389"><a href="#FisherMatrix.eigenvalues-1389"><span class="linenos">1389</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the eigenvalues of the Fisher object as a numpy array.</p>
</div>


                            </div>
                            <div id="FisherMatrix.eigenvectors" class="classattr">
                                        <input id="FisherMatrix.eigenvectors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">eigenvectors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.eigenvectors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.eigenvectors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.eigenvectors-1391"><a href="#FisherMatrix.eigenvectors-1391"><span class="linenos">1391</span></a>    <span class="k">def</span> <span class="nf">eigenvectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.eigenvectors-1392"><a href="#FisherMatrix.eigenvectors-1392"><span class="linenos">1392</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the right eigenvectors of the Fisher object as a numpy array.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.eigenvectors-1393"><a href="#FisherMatrix.eigenvectors-1393"><span class="linenos">1393</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the right eigenvectors of the Fisher object as a numpy array.</p>
</div>


                            </div>
                            <div id="FisherMatrix.condition_number" class="classattr">
                                        <input id="FisherMatrix.condition_number-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">condition_number</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.condition_number-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.condition_number"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.condition_number-1395"><a href="#FisherMatrix.condition_number-1395"><span class="linenos">1395</span></a>    <span class="k">def</span> <span class="nf">condition_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.condition_number-1396"><a href="#FisherMatrix.condition_number-1396"><span class="linenos">1396</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.condition_number-1397"><a href="#FisherMatrix.condition_number-1397"><span class="linenos">1397</span></a><span class="sd">        Return the condition number of the matrix with respect to the $L^2$ norm.</span>
</span><span id="FisherMatrix.condition_number-1398"><a href="#FisherMatrix.condition_number-1398"><span class="linenos">1398</span></a>
</span><span id="FisherMatrix.condition_number-1399"><a href="#FisherMatrix.condition_number-1399"><span class="linenos">1399</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.condition_number-1400"><a href="#FisherMatrix.condition_number-1400"><span class="linenos">1400</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.condition_number-1401"><a href="#FisherMatrix.condition_number-1401"><span class="linenos">1401</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix.condition_number-1402"><a href="#FisherMatrix.condition_number-1402"><span class="linenos">1402</span></a><span class="sd">        &gt;&gt;&gt; fm.condition_number()</span>
</span><span id="FisherMatrix.condition_number-1403"><a href="#FisherMatrix.condition_number-1403"><span class="linenos">1403</span></a><span class="sd">        3.0</span>
</span><span id="FisherMatrix.condition_number-1404"><a href="#FisherMatrix.condition_number-1404"><span class="linenos">1404</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.condition_number-1405"><a href="#FisherMatrix.condition_number-1405"><span class="linenos">1405</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">())</span>
</span><span id="FisherMatrix.condition_number-1406"><a href="#FisherMatrix.condition_number-1406"><span class="linenos">1406</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the condition number of the matrix with respect to the $L^2$ norm.</p>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">condition_number</span><span class="p">()</span>
<span class="go">3.0</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.inverse" class="classattr">
                                        <input id="FisherMatrix.inverse-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">inverse</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">use_pinv</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.inverse-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.inverse"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.inverse-1408"><a href="#FisherMatrix.inverse-1408"><span class="linenos">1408</span></a>    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_pinv</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="FisherMatrix.inverse-1409"><a href="#FisherMatrix.inverse-1409"><span class="linenos">1409</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.inverse-1410"><a href="#FisherMatrix.inverse-1410"><span class="linenos">1410</span></a><span class="sd">        Return the inverse of the Fisher matrix.</span>
</span><span id="FisherMatrix.inverse-1411"><a href="#FisherMatrix.inverse-1411"><span class="linenos">1411</span></a>
</span><span id="FisherMatrix.inverse-1412"><a href="#FisherMatrix.inverse-1412"><span class="linenos">1412</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.inverse-1413"><a href="#FisherMatrix.inverse-1413"><span class="linenos">1413</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.inverse-1414"><a href="#FisherMatrix.inverse-1414"><span class="linenos">1414</span></a><span class="sd">        use_pinv : bool, optional</span>
</span><span id="FisherMatrix.inverse-1415"><a href="#FisherMatrix.inverse-1415"><span class="linenos">1415</span></a><span class="sd">            use the Moore-Penrose pseudoinverse (default: False). Can be useful</span>
</span><span id="FisherMatrix.inverse-1416"><a href="#FisherMatrix.inverse-1416"><span class="linenos">1416</span></a><span class="sd">            if the Fisher matrix is weakly singular. Use with caution!</span>
</span><span id="FisherMatrix.inverse-1417"><a href="#FisherMatrix.inverse-1417"><span class="linenos">1417</span></a>
</span><span id="FisherMatrix.inverse-1418"><a href="#FisherMatrix.inverse-1418"><span class="linenos">1418</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix.inverse-1419"><a href="#FisherMatrix.inverse-1419"><span class="linenos">1419</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix.inverse-1420"><a href="#FisherMatrix.inverse-1420"><span class="linenos">1420</span></a><span class="sd">        LinAlgError</span>
</span><span id="FisherMatrix.inverse-1421"><a href="#FisherMatrix.inverse-1421"><span class="linenos">1421</span></a><span class="sd">            if the Fisher matrix is singular</span>
</span><span id="FisherMatrix.inverse-1422"><a href="#FisherMatrix.inverse-1422"><span class="linenos">1422</span></a>
</span><span id="FisherMatrix.inverse-1423"><a href="#FisherMatrix.inverse-1423"><span class="linenos">1423</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.inverse-1424"><a href="#FisherMatrix.inverse-1424"><span class="linenos">1424</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.inverse-1425"><a href="#FisherMatrix.inverse-1425"><span class="linenos">1425</span></a><span class="sd">        array_like : float</span>
</span><span id="FisherMatrix.inverse-1426"><a href="#FisherMatrix.inverse-1426"><span class="linenos">1426</span></a><span class="sd">            the covariance matrix as a numpy array</span>
</span><span id="FisherMatrix.inverse-1427"><a href="#FisherMatrix.inverse-1427"><span class="linenos">1427</span></a>
</span><span id="FisherMatrix.inverse-1428"><a href="#FisherMatrix.inverse-1428"><span class="linenos">1428</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.inverse-1429"><a href="#FisherMatrix.inverse-1429"><span class="linenos">1429</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.inverse-1430"><a href="#FisherMatrix.inverse-1430"><span class="linenos">1430</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 5]))</span>
</span><span id="FisherMatrix.inverse-1431"><a href="#FisherMatrix.inverse-1431"><span class="linenos">1431</span></a><span class="sd">        &gt;&gt;&gt; fm.inverse()</span>
</span><span id="FisherMatrix.inverse-1432"><a href="#FisherMatrix.inverse-1432"><span class="linenos">1432</span></a><span class="sd">        array([[1. , 0. , 0. ],</span>
</span><span id="FisherMatrix.inverse-1433"><a href="#FisherMatrix.inverse-1433"><span class="linenos">1433</span></a><span class="sd">               [0. , 0.5, 0. ],</span>
</span><span id="FisherMatrix.inverse-1434"><a href="#FisherMatrix.inverse-1434"><span class="linenos">1434</span></a><span class="sd">               [0. , 0. , 0.2]])</span>
</span><span id="FisherMatrix.inverse-1435"><a href="#FisherMatrix.inverse-1435"><span class="linenos">1435</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.inverse-1436"><a href="#FisherMatrix.inverse-1436"><span class="linenos">1436</span></a>        <span class="k">if</span> <span class="n">use_pinv</span><span class="p">:</span>
</span><span id="FisherMatrix.inverse-1437"><a href="#FisherMatrix.inverse-1437"><span class="linenos">1437</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">hermitian</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="FisherMatrix.inverse-1438"><a href="#FisherMatrix.inverse-1438"><span class="linenos">1438</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the inverse of the Fisher matrix.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>use_pinv</strong> (bool, optional):
use the Moore-Penrose pseudoinverse (default: False). Can be useful
if the Fisher matrix is weakly singular. Use with caution!</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>LinAlgError</strong>: if the Fisher matrix is singular</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>array_like</strong> (float):
the covariance matrix as a numpy array</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">array([[1. , 0. , 0. ],</span>
<span class="go">       [0. , 0.5, 0. ],</span>
<span class="go">       [0. , 0. , 0.2]])</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.determinant" class="classattr">
                                        <input id="FisherMatrix.determinant-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">determinant</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.determinant-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.determinant"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.determinant-1440"><a href="#FisherMatrix.determinant-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">determinant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.determinant-1441"><a href="#FisherMatrix.determinant-1441"><span class="linenos">1441</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.determinant-1442"><a href="#FisherMatrix.determinant-1442"><span class="linenos">1442</span></a><span class="sd">        Return the determinant of the matrix.</span>
</span><span id="FisherMatrix.determinant-1443"><a href="#FisherMatrix.determinant-1443"><span class="linenos">1443</span></a>
</span><span id="FisherMatrix.determinant-1444"><a href="#FisherMatrix.determinant-1444"><span class="linenos">1444</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.determinant-1445"><a href="#FisherMatrix.determinant-1445"><span class="linenos">1445</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.determinant-1446"><a href="#FisherMatrix.determinant-1446"><span class="linenos">1446</span></a><span class="sd">        float</span>
</span><span id="FisherMatrix.determinant-1447"><a href="#FisherMatrix.determinant-1447"><span class="linenos">1447</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.determinant-1448"><a href="#FisherMatrix.determinant-1448"><span class="linenos">1448</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the determinant of the matrix.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>float</strong></li>
</ul>
</div>


                            </div>
                            <div id="FisherMatrix.constraints" class="classattr">
                                        <input id="FisherMatrix.constraints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">constraints</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">marginalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.constraints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.constraints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.constraints-1450"><a href="#FisherMatrix.constraints-1450"><span class="linenos">1450</span></a>    <span class="k">def</span> <span class="nf">constraints</span><span class="p">(</span>
</span><span id="FisherMatrix.constraints-1451"><a href="#FisherMatrix.constraints-1451"><span class="linenos">1451</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-1452"><a href="#FisherMatrix.constraints-1452"><span class="linenos">1452</span></a>        <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-1453"><a href="#FisherMatrix.constraints-1453"><span class="linenos">1453</span></a>        <span class="n">marginalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-1454"><a href="#FisherMatrix.constraints-1454"><span class="linenos">1454</span></a>        <span class="n">sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-1455"><a href="#FisherMatrix.constraints-1455"><span class="linenos">1455</span></a>        <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-1456"><a href="#FisherMatrix.constraints-1456"><span class="linenos">1456</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-1457"><a href="#FisherMatrix.constraints-1457"><span class="linenos">1457</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix.constraints-1458"><a href="#FisherMatrix.constraints-1458"><span class="linenos">1458</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.constraints-1459"><a href="#FisherMatrix.constraints-1459"><span class="linenos">1459</span></a><span class="sd">        Compute the constraints on parameters.</span>
</span><span id="FisherMatrix.constraints-1460"><a href="#FisherMatrix.constraints-1460"><span class="linenos">1460</span></a>
</span><span id="FisherMatrix.constraints-1461"><a href="#FisherMatrix.constraints-1461"><span class="linenos">1461</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.constraints-1462"><a href="#FisherMatrix.constraints-1462"><span class="linenos">1462</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.constraints-1463"><a href="#FisherMatrix.constraints-1463"><span class="linenos">1463</span></a><span class="sd">        name : str, optional</span>
</span><span id="FisherMatrix.constraints-1464"><a href="#FisherMatrix.constraints-1464"><span class="linenos">1464</span></a><span class="sd">            the name of the parameter for which we we want the constraints</span>
</span><span id="FisherMatrix.constraints-1465"><a href="#FisherMatrix.constraints-1465"><span class="linenos">1465</span></a><span class="sd">            (default: None)</span>
</span><span id="FisherMatrix.constraints-1466"><a href="#FisherMatrix.constraints-1466"><span class="linenos">1466</span></a>
</span><span id="FisherMatrix.constraints-1467"><a href="#FisherMatrix.constraints-1467"><span class="linenos">1467</span></a><span class="sd">        marginalized : bool, optional</span>
</span><span id="FisherMatrix.constraints-1468"><a href="#FisherMatrix.constraints-1468"><span class="linenos">1468</span></a><span class="sd">            whether we want the marginalized or the unmarginalized</span>
</span><span id="FisherMatrix.constraints-1469"><a href="#FisherMatrix.constraints-1469"><span class="linenos">1469</span></a><span class="sd">            constraints (default: True).</span>
</span><span id="FisherMatrix.constraints-1470"><a href="#FisherMatrix.constraints-1470"><span class="linenos">1470</span></a>
</span><span id="FisherMatrix.constraints-1471"><a href="#FisherMatrix.constraints-1471"><span class="linenos">1471</span></a><span class="sd">        sigma : float, optional</span>
</span><span id="FisherMatrix.constraints-1472"><a href="#FisherMatrix.constraints-1472"><span class="linenos">1472</span></a><span class="sd">            how many sigmas away (default: 1).</span>
</span><span id="FisherMatrix.constraints-1473"><a href="#FisherMatrix.constraints-1473"><span class="linenos">1473</span></a>
</span><span id="FisherMatrix.constraints-1474"><a href="#FisherMatrix.constraints-1474"><span class="linenos">1474</span></a><span class="sd">        p : float, optional</span>
</span><span id="FisherMatrix.constraints-1475"><a href="#FisherMatrix.constraints-1475"><span class="linenos">1475</span></a><span class="sd">            the confidence interval (p-value) (default: None).</span>
</span><span id="FisherMatrix.constraints-1476"><a href="#FisherMatrix.constraints-1476"><span class="linenos">1476</span></a>
</span><span id="FisherMatrix.constraints-1477"><a href="#FisherMatrix.constraints-1477"><span class="linenos">1477</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix.constraints-1478"><a href="#FisherMatrix.constraints-1478"><span class="linenos">1478</span></a><span class="sd">            any kwargs passed to `inverse`</span>
</span><span id="FisherMatrix.constraints-1479"><a href="#FisherMatrix.constraints-1479"><span class="linenos">1479</span></a>
</span><span id="FisherMatrix.constraints-1480"><a href="#FisherMatrix.constraints-1480"><span class="linenos">1480</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.constraints-1481"><a href="#FisherMatrix.constraints-1481"><span class="linenos">1481</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.constraints-1482"><a href="#FisherMatrix.constraints-1482"><span class="linenos">1482</span></a><span class="sd">        float or array_like of float</span>
</span><span id="FisherMatrix.constraints-1483"><a href="#FisherMatrix.constraints-1483"><span class="linenos">1483</span></a>
</span><span id="FisherMatrix.constraints-1484"><a href="#FisherMatrix.constraints-1484"><span class="linenos">1484</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix.constraints-1485"><a href="#FisherMatrix.constraints-1485"><span class="linenos">1485</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix.constraints-1486"><a href="#FisherMatrix.constraints-1486"><span class="linenos">1486</span></a><span class="sd">        The user should specify either `sigma` or `p`, but not both</span>
</span><span id="FisherMatrix.constraints-1487"><a href="#FisherMatrix.constraints-1487"><span class="linenos">1487</span></a><span class="sd">        simultaneously.</span>
</span><span id="FisherMatrix.constraints-1488"><a href="#FisherMatrix.constraints-1488"><span class="linenos">1488</span></a><span class="sd">        If neither are specified, defaults to `sigma=1`.</span>
</span><span id="FisherMatrix.constraints-1489"><a href="#FisherMatrix.constraints-1489"><span class="linenos">1489</span></a>
</span><span id="FisherMatrix.constraints-1490"><a href="#FisherMatrix.constraints-1490"><span class="linenos">1490</span></a><span class="sd">        The relationship between `p` and `sigma` is defined via:</span>
</span><span id="FisherMatrix.constraints-1491"><a href="#FisherMatrix.constraints-1491"><span class="linenos">1491</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.constraints-1492"><a href="#FisherMatrix.constraints-1492"><span class="linenos">1492</span></a><span class="sd">            p(\sigma) = \int\limits_{\mu - \sigma}^{\mu + \sigma}</span>
</span><span id="FisherMatrix.constraints-1493"><a href="#FisherMatrix.constraints-1493"><span class="linenos">1493</span></a><span class="sd">                        f(x, \mu, 1)\, \mathrm{d}x</span>
</span><span id="FisherMatrix.constraints-1494"><a href="#FisherMatrix.constraints-1494"><span class="linenos">1494</span></a><span class="sd">                      = \mathrm{Erf}(\sigma / \sqrt{2})</span>
</span><span id="FisherMatrix.constraints-1495"><a href="#FisherMatrix.constraints-1495"><span class="linenos">1495</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.constraints-1496"><a href="#FisherMatrix.constraints-1496"><span class="linenos">1496</span></a><span class="sd">        and therefore the inverse is simply:</span>
</span><span id="FisherMatrix.constraints-1497"><a href="#FisherMatrix.constraints-1497"><span class="linenos">1497</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.constraints-1498"><a href="#FisherMatrix.constraints-1498"><span class="linenos">1498</span></a><span class="sd">            \sigma(p) = \sqrt{2}\, \mathrm{Erf}^{-1}(p)</span>
</span><span id="FisherMatrix.constraints-1499"><a href="#FisherMatrix.constraints-1499"><span class="linenos">1499</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.constraints-1500"><a href="#FisherMatrix.constraints-1500"><span class="linenos">1500</span></a><span class="sd">        The values of `p` corresponding to 1, 2, 3 `sigma` are roughly</span>
</span><span id="FisherMatrix.constraints-1501"><a href="#FisherMatrix.constraints-1501"><span class="linenos">1501</span></a><span class="sd">        0.683, 0.954, and 0.997, respectively.</span>
</span><span id="FisherMatrix.constraints-1502"><a href="#FisherMatrix.constraints-1502"><span class="linenos">1502</span></a>
</span><span id="FisherMatrix.constraints-1503"><a href="#FisherMatrix.constraints-1503"><span class="linenos">1503</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.constraints-1504"><a href="#FisherMatrix.constraints-1504"><span class="linenos">1504</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.constraints-1505"><a href="#FisherMatrix.constraints-1505"><span class="linenos">1505</span></a><span class="sd">        Get (marginalized by default) constraints for all parameters:</span>
</span><span id="FisherMatrix.constraints-1506"><a href="#FisherMatrix.constraints-1506"><span class="linenos">1506</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix([[3, -2], [-2, 5]])</span>
</span><span id="FisherMatrix.constraints-1507"><a href="#FisherMatrix.constraints-1507"><span class="linenos">1507</span></a><span class="sd">        &gt;&gt;&gt; m.constraints()</span>
</span><span id="FisherMatrix.constraints-1508"><a href="#FisherMatrix.constraints-1508"><span class="linenos">1508</span></a><span class="sd">        array([0.67419986, 0.52223297])</span>
</span><span id="FisherMatrix.constraints-1509"><a href="#FisherMatrix.constraints-1509"><span class="linenos">1509</span></a>
</span><span id="FisherMatrix.constraints-1510"><a href="#FisherMatrix.constraints-1510"><span class="linenos">1510</span></a><span class="sd">        Get the unmarginalized constraints instead:</span>
</span><span id="FisherMatrix.constraints-1511"><a href="#FisherMatrix.constraints-1511"><span class="linenos">1511</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(marginalized=False)</span>
</span><span id="FisherMatrix.constraints-1512"><a href="#FisherMatrix.constraints-1512"><span class="linenos">1512</span></a><span class="sd">        array([0.57735027, 0.4472136 ])</span>
</span><span id="FisherMatrix.constraints-1513"><a href="#FisherMatrix.constraints-1513"><span class="linenos">1513</span></a>
</span><span id="FisherMatrix.constraints-1514"><a href="#FisherMatrix.constraints-1514"><span class="linenos">1514</span></a><span class="sd">        Get the unmarginalized constraints for a single parameter:</span>
</span><span id="FisherMatrix.constraints-1515"><a href="#FisherMatrix.constraints-1515"><span class="linenos">1515</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(&#39;p1&#39;, marginalized=False)</span>
</span><span id="FisherMatrix.constraints-1516"><a href="#FisherMatrix.constraints-1516"><span class="linenos">1516</span></a><span class="sd">        array([0.57735027])</span>
</span><span id="FisherMatrix.constraints-1517"><a href="#FisherMatrix.constraints-1517"><span class="linenos">1517</span></a>
</span><span id="FisherMatrix.constraints-1518"><a href="#FisherMatrix.constraints-1518"><span class="linenos">1518</span></a><span class="sd">        Get the marginalized constraints for a single parameter:</span>
</span><span id="FisherMatrix.constraints-1519"><a href="#FisherMatrix.constraints-1519"><span class="linenos">1519</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(&#39;p1&#39;, p=0.682689) # p-value roughly equal to 1 sigma</span>
</span><span id="FisherMatrix.constraints-1520"><a href="#FisherMatrix.constraints-1520"><span class="linenos">1520</span></a><span class="sd">        array([0.67419918])</span>
</span><span id="FisherMatrix.constraints-1521"><a href="#FisherMatrix.constraints-1521"><span class="linenos">1521</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.constraints-1522"><a href="#FisherMatrix.constraints-1522"><span class="linenos">1522</span></a>        <span class="n">sigma</span> <span class="o">=</span> <span class="n">_parse_sigma</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span><span id="FisherMatrix.constraints-1523"><a href="#FisherMatrix.constraints-1523"><span class="linenos">1523</span></a>
</span><span id="FisherMatrix.constraints-1524"><a href="#FisherMatrix.constraints-1524"><span class="linenos">1524</span></a>        <span class="k">if</span> <span class="n">marginalized</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-1525"><a href="#FisherMatrix.constraints-1525"><span class="linenos">1525</span></a>            <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.constraints-1526"><a href="#FisherMatrix.constraints-1526"><span class="linenos">1526</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="FisherMatrix.constraints-1527"><a href="#FisherMatrix.constraints-1527"><span class="linenos">1527</span></a>                <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-1528"><a href="#FisherMatrix.constraints-1528"><span class="linenos">1528</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-1529"><a href="#FisherMatrix.constraints-1529"><span class="linenos">1529</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-1530"><a href="#FisherMatrix.constraints-1530"><span class="linenos">1530</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix.constraints-1531"><a href="#FisherMatrix.constraints-1531"><span class="linenos">1531</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">inv</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">*</span> <span class="n">sigma</span>
</span><span id="FisherMatrix.constraints-1532"><a href="#FisherMatrix.constraints-1532"><span class="linenos">1532</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-1533"><a href="#FisherMatrix.constraints-1533"><span class="linenos">1533</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">*</span> <span class="n">sigma</span>
</span><span id="FisherMatrix.constraints-1534"><a href="#FisherMatrix.constraints-1534"><span class="linenos">1534</span></a>
</span><span id="FisherMatrix.constraints-1535"><a href="#FisherMatrix.constraints-1535"><span class="linenos">1535</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-1536"><a href="#FisherMatrix.constraints-1536"><span class="linenos">1536</span></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-1537"><a href="#FisherMatrix.constraints-1537"><span class="linenos">1537</span></a>                <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)]</span>
</span><span id="FisherMatrix.constraints-1538"><a href="#FisherMatrix.constraints-1538"><span class="linenos">1538</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.constraints-1539"><a href="#FisherMatrix.constraints-1539"><span class="linenos">1539</span></a>
</span><span id="FisherMatrix.constraints-1540"><a href="#FisherMatrix.constraints-1540"><span class="linenos">1540</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Compute the constraints on parameters.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str, optional):
the name of the parameter for which we we want the constraints
(default: None)</li>
<li><strong>marginalized</strong> (bool, optional):
whether we want the marginalized or the unmarginalized
constraints (default: True).</li>
<li><strong>sigma</strong> (float, optional):
how many sigmas away (default: 1).</li>
<li><strong>p</strong> (float, optional):
the confidence interval (p-value) (default: None).</li>
<li><strong>**kwargs</strong>: any kwargs passed to <code><a href="#FisherMatrix.inverse">inverse</a></code></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>float or array_like of float</strong></li>
</ul>

<h6 id="notes">Notes</h6>

<p>The user should specify either <code>sigma</code> or <code>p</code>, but not both
simultaneously.
If neither are specified, defaults to <code>sigma=1</code>.</p>

<p>The relationship between <code>p</code> and <code>sigma</code> is defined via:
$$
    p(\sigma) = \int\limits_{\mu - \sigma}^{\mu + \sigma}
                f(x, \mu, 1)\, \mathrm{d}x
              = \mathrm{Erf}(\sigma / \sqrt{2})
$$
and therefore the inverse is simply:
$$
    \sigma(p) = \sqrt{2}\, \mathrm{Erf}^{-1}(p)
$$
The values of <code>p</code> corresponding to 1, 2, 3 <code>sigma</code> are roughly
0.683, 0.954, and 0.997, respectively.</p>

<h6 id="examples">Examples</h6>

<p>Get (marginalized by default) constraints for all parameters:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">constraints</span><span class="p">()</span>
<span class="go">array([0.67419986, 0.52223297])</span>
</code></pre>
</div>

<p>Get the unmarginalized constraints instead:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">marginalized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([0.57735027, 0.4472136 ])</span>
</code></pre>
</div>

<p>Get the unmarginalized constraints for a single parameter:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([0.57735027])</span>
</code></pre>
</div>

<p>Get the marginalized constraints for a single parameter:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.682689</span><span class="p">)</span> <span class="c1"># p-value roughly equal to 1 sigma</span>
<span class="go">array([0.67419918])</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.reparametrize_symbolic" class="classattr">
                                        <input id="FisherMatrix.reparametrize_symbolic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reparametrize_symbolic</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">transformation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.tensors.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.reparametrize_symbolic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.reparametrize_symbolic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.reparametrize_symbolic-1831"><a href="#FisherMatrix.reparametrize_symbolic-1831"><span class="linenos">1831</span></a>    <span class="k">def</span> <span class="nf">reparametrize_symbolic</span><span class="p">(</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1832"><a href="#FisherMatrix.reparametrize_symbolic-1832"><span class="linenos">1832</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1833"><a href="#FisherMatrix.reparametrize_symbolic-1833"><span class="linenos">1833</span></a>        <span class="n">transformation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1834"><a href="#FisherMatrix.reparametrize_symbolic-1834"><span class="linenos">1834</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1835"><a href="#FisherMatrix.reparametrize_symbolic-1835"><span class="linenos">1835</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1836"><a href="#FisherMatrix.reparametrize_symbolic-1836"><span class="linenos">1836</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1837"><a href="#FisherMatrix.reparametrize_symbolic-1837"><span class="linenos">1837</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1838"><a href="#FisherMatrix.reparametrize_symbolic-1838"><span class="linenos">1838</span></a><span class="sd">        Perform a symbolic transformation of the Fisher object.</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1839"><a href="#FisherMatrix.reparametrize_symbolic-1839"><span class="linenos">1839</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1840"><a href="#FisherMatrix.reparametrize_symbolic-1840"><span class="linenos">1840</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1841"><a href="#FisherMatrix.reparametrize_symbolic-1841"><span class="linenos">1841</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1842"><a href="#FisherMatrix.reparametrize_symbolic-1842"><span class="linenos">1842</span></a><span class="sd">        transformation : mapping</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1843"><a href="#FisherMatrix.reparametrize_symbolic-1843"><span class="linenos">1843</span></a><span class="sd">            a mapping between the old and new parameters (or new and old ones)</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1844"><a href="#FisherMatrix.reparametrize_symbolic-1844"><span class="linenos">1844</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1845"><a href="#FisherMatrix.reparametrize_symbolic-1845"><span class="linenos">1845</span></a><span class="sd">        latex_names : mapping, optional</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1846"><a href="#FisherMatrix.reparametrize_symbolic-1846"><span class="linenos">1846</span></a><span class="sd">            a dictionary with the names of new parameters as keys, and LaTeX</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1847"><a href="#FisherMatrix.reparametrize_symbolic-1847"><span class="linenos">1847</span></a><span class="sd">            names of new parameters as values (default: None). If not</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1848"><a href="#FisherMatrix.reparametrize_symbolic-1848"><span class="linenos">1848</span></a><span class="sd">            specified, uses the names extracted from `transformation`.</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1849"><a href="#FisherMatrix.reparametrize_symbolic-1849"><span class="linenos">1849</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1850"><a href="#FisherMatrix.reparametrize_symbolic-1850"><span class="linenos">1850</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1851"><a href="#FisherMatrix.reparametrize_symbolic-1851"><span class="linenos">1851</span></a><span class="sd">            any optional keyword arguments passed to the solver for obtaining</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1852"><a href="#FisherMatrix.reparametrize_symbolic-1852"><span class="linenos">1852</span></a><span class="sd">            the new fiducials. Available arguments:</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1853"><a href="#FisherMatrix.reparametrize_symbolic-1853"><span class="linenos">1853</span></a><span class="sd">            - `solution_index`, int: in case of multiple solutions, one can select</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1854"><a href="#FisherMatrix.reparametrize_symbolic-1854"><span class="linenos">1854</span></a><span class="sd">              the index of the solution (default: None, meaning the first</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1855"><a href="#FisherMatrix.reparametrize_symbolic-1855"><span class="linenos">1855</span></a><span class="sd">              element is selected)</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1856"><a href="#FisherMatrix.reparametrize_symbolic-1856"><span class="linenos">1856</span></a><span class="sd">            - `initial_guess`, dict: in case of using the numerical solver,</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1857"><a href="#FisherMatrix.reparametrize_symbolic-1857"><span class="linenos">1857</span></a><span class="sd">              this should be a dictionary of the initial guesses for the new</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1858"><a href="#FisherMatrix.reparametrize_symbolic-1858"><span class="linenos">1858</span></a><span class="sd">              fiducials (default: None, and the initial guess is set to all</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1859"><a href="#FisherMatrix.reparametrize_symbolic-1859"><span class="linenos">1859</span></a><span class="sd">              ones)</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1860"><a href="#FisherMatrix.reparametrize_symbolic-1860"><span class="linenos">1860</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1861"><a href="#FisherMatrix.reparametrize_symbolic-1861"><span class="linenos">1861</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1862"><a href="#FisherMatrix.reparametrize_symbolic-1862"><span class="linenos">1862</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1863"><a href="#FisherMatrix.reparametrize_symbolic-1863"><span class="linenos">1863</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1864"><a href="#FisherMatrix.reparametrize_symbolic-1864"><span class="linenos">1864</span></a><span class="sd">            The new Fisher object with the specified names, LaTeX names, and</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1865"><a href="#FisherMatrix.reparametrize_symbolic-1865"><span class="linenos">1865</span></a><span class="sd">            fiducials.</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1866"><a href="#FisherMatrix.reparametrize_symbolic-1866"><span class="linenos">1866</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1867"><a href="#FisherMatrix.reparametrize_symbolic-1867"><span class="linenos">1867</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1868"><a href="#FisherMatrix.reparametrize_symbolic-1868"><span class="linenos">1868</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1869"><a href="#FisherMatrix.reparametrize_symbolic-1869"><span class="linenos">1869</span></a><span class="sd">        ParameterNotFoundError</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1870"><a href="#FisherMatrix.reparametrize_symbolic-1870"><span class="linenos">1870</span></a><span class="sd">            if any of the keys in the mapping is not in the names of the Fisher</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1871"><a href="#FisherMatrix.reparametrize_symbolic-1871"><span class="linenos">1871</span></a><span class="sd">            matrix</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1872"><a href="#FisherMatrix.reparametrize_symbolic-1872"><span class="linenos">1872</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1873"><a href="#FisherMatrix.reparametrize_symbolic-1873"><span class="linenos">1873</span></a><span class="sd">        SympifyError</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1874"><a href="#FisherMatrix.reparametrize_symbolic-1874"><span class="linenos">1874</span></a><span class="sd">            if any of the expressions in the values cannot be transformed using</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1875"><a href="#FisherMatrix.reparametrize_symbolic-1875"><span class="linenos">1875</span></a><span class="sd">            &lt;a</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1876"><a href="#FisherMatrix.reparametrize_symbolic-1876"><span class="linenos">1876</span></a><span class="sd">            href=&quot;https://docs.sympy.org/latest/modules/core.html#module-sympy.core.sympify&quot;</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1877"><a href="#FisherMatrix.reparametrize_symbolic-1877"><span class="linenos">1877</span></a><span class="sd">            target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;`sympy.sympify`&lt;/a&gt;</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1878"><a href="#FisherMatrix.reparametrize_symbolic-1878"><span class="linenos">1878</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1879"><a href="#FisherMatrix.reparametrize_symbolic-1879"><span class="linenos">1879</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1880"><a href="#FisherMatrix.reparametrize_symbolic-1880"><span class="linenos">1880</span></a><span class="sd">            if SymPy is is unable to find a solution for the new fiducials</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1881"><a href="#FisherMatrix.reparametrize_symbolic-1881"><span class="linenos">1881</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1882"><a href="#FisherMatrix.reparametrize_symbolic-1882"><span class="linenos">1882</span></a><span class="sd">        TypeError</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1883"><a href="#FisherMatrix.reparametrize_symbolic-1883"><span class="linenos">1883</span></a><span class="sd">            if SymPy is unable to find a real solution for the new fiducials</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1884"><a href="#FisherMatrix.reparametrize_symbolic-1884"><span class="linenos">1884</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1885"><a href="#FisherMatrix.reparametrize_symbolic-1885"><span class="linenos">1885</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1886"><a href="#FisherMatrix.reparametrize_symbolic-1886"><span class="linenos">1886</span></a><span class="sd">            if any of the old parameters is on both sides of the mapping</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1887"><a href="#FisherMatrix.reparametrize_symbolic-1887"><span class="linenos">1887</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1888"><a href="#FisherMatrix.reparametrize_symbolic-1888"><span class="linenos">1888</span></a><span class="sd">        ValueError</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1889"><a href="#FisherMatrix.reparametrize_symbolic-1889"><span class="linenos">1889</span></a><span class="sd">            if the number of new parameters is different from the number of old</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1890"><a href="#FisherMatrix.reparametrize_symbolic-1890"><span class="linenos">1890</span></a><span class="sd">            parameters</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1891"><a href="#FisherMatrix.reparametrize_symbolic-1891"><span class="linenos">1891</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1892"><a href="#FisherMatrix.reparametrize_symbolic-1892"><span class="linenos">1892</span></a><span class="sd">        Warns</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1893"><a href="#FisherMatrix.reparametrize_symbolic-1893"><span class="linenos">1893</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1894"><a href="#FisherMatrix.reparametrize_symbolic-1894"><span class="linenos">1894</span></a><span class="sd">        UserWarning</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1895"><a href="#FisherMatrix.reparametrize_symbolic-1895"><span class="linenos">1895</span></a><span class="sd">            if the SymPy solver returns multiple solutions for the values of</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1896"><a href="#FisherMatrix.reparametrize_symbolic-1896"><span class="linenos">1896</span></a><span class="sd">            the new fiducials</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1897"><a href="#FisherMatrix.reparametrize_symbolic-1897"><span class="linenos">1897</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1898"><a href="#FisherMatrix.reparametrize_symbolic-1898"><span class="linenos">1898</span></a><span class="sd">        See Also</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1899"><a href="#FisherMatrix.reparametrize_symbolic-1899"><span class="linenos">1899</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1900"><a href="#FisherMatrix.reparametrize_symbolic-1900"><span class="linenos">1900</span></a><span class="sd">        `reparametrize` : the numerical version of this method</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1901"><a href="#FisherMatrix.reparametrize_symbolic-1901"><span class="linenos">1901</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1902"><a href="#FisherMatrix.reparametrize_symbolic-1902"><span class="linenos">1902</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1903"><a href="#FisherMatrix.reparametrize_symbolic-1903"><span class="linenos">1903</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1904"><a href="#FisherMatrix.reparametrize_symbolic-1904"><span class="linenos">1904</span></a><span class="sd">        Create a Fisher matrix:</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1905"><a href="#FisherMatrix.reparametrize_symbolic-1905"><span class="linenos">1905</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1906"><a href="#FisherMatrix.reparametrize_symbolic-1906"><span class="linenos">1906</span></a><span class="sd">        ... np.diag([1, 2, 3]),</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1907"><a href="#FisherMatrix.reparametrize_symbolic-1907"><span class="linenos">1907</span></a><span class="sd">        ... names=[&quot;omega_m&quot;, &quot;omega_b&quot;, &quot;h&quot;],</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1908"><a href="#FisherMatrix.reparametrize_symbolic-1908"><span class="linenos">1908</span></a><span class="sd">        ... fiducials=[0.147, 0.025, 0.7],</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1909"><a href="#FisherMatrix.reparametrize_symbolic-1909"><span class="linenos">1909</span></a><span class="sd">        ... )</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1910"><a href="#FisherMatrix.reparametrize_symbolic-1910"><span class="linenos">1910</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1911"><a href="#FisherMatrix.reparametrize_symbolic-1911"><span class="linenos">1911</span></a><span class="sd">        Reparametrize it:</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1912"><a href="#FisherMatrix.reparametrize_symbolic-1912"><span class="linenos">1912</span></a><span class="sd">        &gt;&gt;&gt; fm.reparametrize_symbolic(</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1913"><a href="#FisherMatrix.reparametrize_symbolic-1913"><span class="linenos">1913</span></a><span class="sd">        ... {&#39;omega_m&#39; : &#39;Omega_m * h**2&#39;, &#39;omega_b&#39; : &#39;Omega_b * h**2&#39;}</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1914"><a href="#FisherMatrix.reparametrize_symbolic-1914"><span class="linenos">1914</span></a><span class="sd">        ... ).sort(key=[&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;])</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1915"><a href="#FisherMatrix.reparametrize_symbolic-1915"><span class="linenos">1915</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1916"><a href="#FisherMatrix.reparametrize_symbolic-1916"><span class="linenos">1916</span></a><span class="sd">            array([[0.2401    , 0.        , 0.2058    ],</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1917"><a href="#FisherMatrix.reparametrize_symbolic-1917"><span class="linenos">1917</span></a><span class="sd">               [0.        , 0.4802    , 0.07      ],</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1918"><a href="#FisherMatrix.reparametrize_symbolic-1918"><span class="linenos">1918</span></a><span class="sd">               [0.2058    , 0.07      , 3.18660408]]),</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1919"><a href="#FisherMatrix.reparametrize_symbolic-1919"><span class="linenos">1919</span></a><span class="sd">            names=array([&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;], dtype=object),</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1920"><a href="#FisherMatrix.reparametrize_symbolic-1920"><span class="linenos">1920</span></a><span class="sd">            latex_names=array([&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;], dtype=object),</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1921"><a href="#FisherMatrix.reparametrize_symbolic-1921"><span class="linenos">1921</span></a><span class="sd">            fiducials=array([0.3       , 0.05102041, 0.7       ]))</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1922"><a href="#FisherMatrix.reparametrize_symbolic-1922"><span class="linenos">1922</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1923"><a href="#FisherMatrix.reparametrize_symbolic-1923"><span class="linenos">1923</span></a>        <span class="c1"># check that the keys of the dictionary are present in the names</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1924"><a href="#FisherMatrix.reparametrize_symbolic-1924"><span class="linenos">1924</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">transformation</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1925"><a href="#FisherMatrix.reparametrize_symbolic-1925"><span class="linenos">1925</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1926"><a href="#FisherMatrix.reparametrize_symbolic-1926"><span class="linenos">1926</span></a>                <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1927"><a href="#FisherMatrix.reparametrize_symbolic-1927"><span class="linenos">1927</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1928"><a href="#FisherMatrix.reparametrize_symbolic-1928"><span class="linenos">1928</span></a>        <span class="c1"># check that we can &quot;sympify&quot; all of the expressions</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1929"><a href="#FisherMatrix.reparametrize_symbolic-1929"><span class="linenos">1929</span></a>        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">transformation</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1930"><a href="#FisherMatrix.reparametrize_symbolic-1930"><span class="linenos">1930</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1931"><a href="#FisherMatrix.reparametrize_symbolic-1931"><span class="linenos">1931</span></a>                <span class="n">sympy</span><span class="o">.</span><span class="n">sympify</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1932"><a href="#FisherMatrix.reparametrize_symbolic-1932"><span class="linenos">1932</span></a>            <span class="k">except</span> <span class="n">sympy</span><span class="o">.</span><span class="n">SympifyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1933"><a href="#FisherMatrix.reparametrize_symbolic-1933"><span class="linenos">1933</span></a>                <span class="k">raise</span> <span class="n">sympy</span><span class="o">.</span><span class="n">SympifyError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1934"><a href="#FisherMatrix.reparametrize_symbolic-1934"><span class="linenos">1934</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1935"><a href="#FisherMatrix.reparametrize_symbolic-1935"><span class="linenos">1935</span></a>        <span class="c1"># get the new names, fiducials, and the Jacobian</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1936"><a href="#FisherMatrix.reparametrize_symbolic-1936"><span class="linenos">1936</span></a>        <span class="n">names_new</span><span class="p">,</span> <span class="n">fiducials_new</span><span class="p">,</span> <span class="n">jacobian</span> <span class="o">=</span> <span class="n">_jacobian</span><span class="p">(</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1937"><a href="#FisherMatrix.reparametrize_symbolic-1937"><span class="linenos">1937</span></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)),</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1938"><a href="#FisherMatrix.reparametrize_symbolic-1938"><span class="linenos">1938</span></a>            <span class="n">transformation</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1939"><a href="#FisherMatrix.reparametrize_symbolic-1939"><span class="linenos">1939</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1940"><a href="#FisherMatrix.reparametrize_symbolic-1940"><span class="linenos">1940</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1941"><a href="#FisherMatrix.reparametrize_symbolic-1941"><span class="linenos">1941</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1942"><a href="#FisherMatrix.reparametrize_symbolic-1942"><span class="linenos">1942</span></a>        <span class="c1"># set the new LaTeX names from the old ones (if they&#39;re still present),</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1943"><a href="#FisherMatrix.reparametrize_symbolic-1943"><span class="linenos">1943</span></a>        <span class="c1"># otherwise use the new names</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1944"><a href="#FisherMatrix.reparametrize_symbolic-1944"><span class="linenos">1944</span></a>        <span class="n">latex_names_new</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1945"><a href="#FisherMatrix.reparametrize_symbolic-1945"><span class="linenos">1945</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">latex_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="k">else</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">names_new</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1946"><a href="#FisherMatrix.reparametrize_symbolic-1946"><span class="linenos">1946</span></a>        <span class="p">]</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1947"><a href="#FisherMatrix.reparametrize_symbolic-1947"><span class="linenos">1947</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1948"><a href="#FisherMatrix.reparametrize_symbolic-1948"><span class="linenos">1948</span></a>        <span class="c1"># in case any of the new names are specified, set them</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1949"><a href="#FisherMatrix.reparametrize_symbolic-1949"><span class="linenos">1949</span></a>        <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1950"><a href="#FisherMatrix.reparametrize_symbolic-1950"><span class="linenos">1950</span></a>            <span class="n">latex_names_new</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1951"><a href="#FisherMatrix.reparametrize_symbolic-1951"><span class="linenos">1951</span></a>                <span class="n">latex_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">latex_names</span> <span class="k">else</span> <span class="n">key</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1952"><a href="#FisherMatrix.reparametrize_symbolic-1952"><span class="linenos">1952</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">latex_names_new</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1953"><a href="#FisherMatrix.reparametrize_symbolic-1953"><span class="linenos">1953</span></a>            <span class="p">]</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1954"><a href="#FisherMatrix.reparametrize_symbolic-1954"><span class="linenos">1954</span></a>
</span><span id="FisherMatrix.reparametrize_symbolic-1955"><a href="#FisherMatrix.reparametrize_symbolic-1955"><span class="linenos">1955</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reparametrize</span><span class="p">(</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1956"><a href="#FisherMatrix.reparametrize_symbolic-1956"><span class="linenos">1956</span></a>            <span class="n">jacobian</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1957"><a href="#FisherMatrix.reparametrize_symbolic-1957"><span class="linenos">1957</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names_new</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1958"><a href="#FisherMatrix.reparametrize_symbolic-1958"><span class="linenos">1958</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials_new</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1959"><a href="#FisherMatrix.reparametrize_symbolic-1959"><span class="linenos">1959</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names_new</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize_symbolic-1960"><a href="#FisherMatrix.reparametrize_symbolic-1960"><span class="linenos">1960</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Perform a symbolic transformation of the Fisher object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>transformation</strong> (mapping):
a mapping between the old and new parameters (or new and old ones)</li>
<li><strong>latex_names</strong> (mapping, optional):
a dictionary with the names of new parameters as keys, and LaTeX
names of new parameters as values (default: None). If not
specified, uses the names extracted from <code>transformation</code>.</li>
<li><strong>**kwargs</strong>: any optional keyword arguments passed to the solver for obtaining
the new fiducials. Available arguments:
<ul>
<li><code>solution_index</code>, int: in case of multiple solutions, one can select
the index of the solution (default: None, meaning the first
element is selected)</li>
<li><code>initial_guess</code>, dict: in case of using the numerical solver,
this should be a dictionary of the initial guesses for the new
fiducials (default: None, and the initial guess is set to all
ones)</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>FisherMatrix</strong>: The new Fisher object with the specified names, LaTeX names, and
fiducials.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ParameterNotFoundError</strong>: if any of the keys in the mapping is not in the names of the Fisher
matrix</li>
<li><strong>SympifyError</strong>: if any of the expressions in the values cannot be transformed using
<a
href="https://docs.sympy.org/latest/modules/core.html#module-sympy.core.sympify"
target="_blank" rel="noopener noreferrer"><code>sympy.sympify</code></a></li>
<li><strong>ValueError</strong>: if SymPy is is unable to find a solution for the new fiducials</li>
<li><strong>TypeError</strong>: if SymPy is unable to find a real solution for the new fiducials</li>
<li><strong>ValueError</strong>: if any of the old parameters is on both sides of the mapping</li>
<li><strong>ValueError</strong>: if the number of new parameters is different from the number of old
parameters</li>
</ul>

<h6 id="warns">Warns</h6>

<ul>
<li><strong>UserWarning</strong>: if the SymPy solver returns multiple solutions for the values of
the new fiducials</li>
</ul>

<h6 id="see-also">See Also</h6>

<p><code><a href="#FisherMatrix.reparametrize">reparametrize</a></code>:  the numerical version of this method  </p>

<h6 id="examples">Examples</h6>

<p>Create a Fisher matrix:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span>
<span class="gp">... </span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
<span class="gp">... </span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;omega_m&quot;</span><span class="p">,</span> <span class="s2">&quot;omega_b&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">],</span>
<span class="gp">... </span><span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="mf">0.147</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre>
</div>

<p>Reparametrize it:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">reparametrize_symbolic</span><span class="p">(</span>
<span class="gp">... </span><span class="p">{</span><span class="s1">&#39;omega_m&#39;</span> <span class="p">:</span> <span class="s1">&#39;Omega_m * h**2&#39;</span><span class="p">,</span> <span class="s1">&#39;omega_b&#39;</span> <span class="p">:</span> <span class="s1">&#39;Omega_b * h**2&#39;</span><span class="p">}</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Omega_m&#39;</span><span class="p">,</span> <span class="s1">&#39;Omega_b&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">])</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[0.2401    , 0.        , 0.2058    ],</span>
<span class="go">       [0.        , 0.4802    , 0.07      ],</span>
<span class="go">       [0.2058    , 0.07      , 3.18660408]]),</span>
<span class="go">    names=array([&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;Omega_m&#39;, &#39;Omega_b&#39;, &#39;h&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0.3       , 0.05102041, 0.7       ]))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.reparametrize" class="classattr">
                                        <input id="FisherMatrix.reparametrize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reparametrize</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">jacobian</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.tensors.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.reparametrize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.reparametrize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.reparametrize-1962"><a href="#FisherMatrix.reparametrize-1962"><span class="linenos">1962</span></a>    <span class="k">def</span> <span class="nf">reparametrize</span><span class="p">(</span>
</span><span id="FisherMatrix.reparametrize-1963"><a href="#FisherMatrix.reparametrize-1963"><span class="linenos">1963</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1964"><a href="#FisherMatrix.reparametrize-1964"><span class="linenos">1964</span></a>        <span class="n">jacobian</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1965"><a href="#FisherMatrix.reparametrize-1965"><span class="linenos">1965</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1966"><a href="#FisherMatrix.reparametrize-1966"><span class="linenos">1966</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1967"><a href="#FisherMatrix.reparametrize-1967"><span class="linenos">1967</span></a>        <span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1968"><a href="#FisherMatrix.reparametrize-1968"><span class="linenos">1968</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-1969"><a href="#FisherMatrix.reparametrize-1969"><span class="linenos">1969</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.reparametrize-1970"><a href="#FisherMatrix.reparametrize-1970"><span class="linenos">1970</span></a><span class="sd">        Perform a numerical transformation of the Fisher object using a Jacobian.</span>
</span><span id="FisherMatrix.reparametrize-1971"><a href="#FisherMatrix.reparametrize-1971"><span class="linenos">1971</span></a>
</span><span id="FisherMatrix.reparametrize-1972"><a href="#FisherMatrix.reparametrize-1972"><span class="linenos">1972</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.reparametrize-1973"><a href="#FisherMatrix.reparametrize-1973"><span class="linenos">1973</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.reparametrize-1974"><a href="#FisherMatrix.reparametrize-1974"><span class="linenos">1974</span></a><span class="sd">        transformation : array_like of float</span>
</span><span id="FisherMatrix.reparametrize-1975"><a href="#FisherMatrix.reparametrize-1975"><span class="linenos">1975</span></a><span class="sd">            the Jacobian of the transformation</span>
</span><span id="FisherMatrix.reparametrize-1976"><a href="#FisherMatrix.reparametrize-1976"><span class="linenos">1976</span></a>
</span><span id="FisherMatrix.reparametrize-1977"><a href="#FisherMatrix.reparametrize-1977"><span class="linenos">1977</span></a><span class="sd">        names : array_like of str, optional</span>
</span><span id="FisherMatrix.reparametrize-1978"><a href="#FisherMatrix.reparametrize-1978"><span class="linenos">1978</span></a><span class="sd">            list of new names for the Fisher object (default: None). If None,</span>
</span><span id="FisherMatrix.reparametrize-1979"><a href="#FisherMatrix.reparametrize-1979"><span class="linenos">1979</span></a><span class="sd">            uses the old names.</span>
</span><span id="FisherMatrix.reparametrize-1980"><a href="#FisherMatrix.reparametrize-1980"><span class="linenos">1980</span></a>
</span><span id="FisherMatrix.reparametrize-1981"><a href="#FisherMatrix.reparametrize-1981"><span class="linenos">1981</span></a><span class="sd">        latex_names: array_like of str, optional</span>
</span><span id="FisherMatrix.reparametrize-1982"><a href="#FisherMatrix.reparametrize-1982"><span class="linenos">1982</span></a><span class="sd">            list of new LaTeX names for the Fisher object (default: None). If</span>
</span><span id="FisherMatrix.reparametrize-1983"><a href="#FisherMatrix.reparametrize-1983"><span class="linenos">1983</span></a><span class="sd">            None, and `names` is set, uses those instead, otherwise uses the</span>
</span><span id="FisherMatrix.reparametrize-1984"><a href="#FisherMatrix.reparametrize-1984"><span class="linenos">1984</span></a><span class="sd">            old LaTeX names.</span>
</span><span id="FisherMatrix.reparametrize-1985"><a href="#FisherMatrix.reparametrize-1985"><span class="linenos">1985</span></a>
</span><span id="FisherMatrix.reparametrize-1986"><a href="#FisherMatrix.reparametrize-1986"><span class="linenos">1986</span></a><span class="sd">        fiducials : array_like of float, optional</span>
</span><span id="FisherMatrix.reparametrize-1987"><a href="#FisherMatrix.reparametrize-1987"><span class="linenos">1987</span></a><span class="sd">            the new values of the fiducials (default: None). If None, defaults</span>
</span><span id="FisherMatrix.reparametrize-1988"><a href="#FisherMatrix.reparametrize-1988"><span class="linenos">1988</span></a><span class="sd">            to the old values of the fiducials.</span>
</span><span id="FisherMatrix.reparametrize-1989"><a href="#FisherMatrix.reparametrize-1989"><span class="linenos">1989</span></a>
</span><span id="FisherMatrix.reparametrize-1990"><a href="#FisherMatrix.reparametrize-1990"><span class="linenos">1990</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.reparametrize-1991"><a href="#FisherMatrix.reparametrize-1991"><span class="linenos">1991</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.reparametrize-1992"><a href="#FisherMatrix.reparametrize-1992"><span class="linenos">1992</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix.reparametrize-1993"><a href="#FisherMatrix.reparametrize-1993"><span class="linenos">1993</span></a><span class="sd">            The new Fisher object with the specified names, LaTeX names, and</span>
</span><span id="FisherMatrix.reparametrize-1994"><a href="#FisherMatrix.reparametrize-1994"><span class="linenos">1994</span></a><span class="sd">            fiducials.</span>
</span><span id="FisherMatrix.reparametrize-1995"><a href="#FisherMatrix.reparametrize-1995"><span class="linenos">1995</span></a>
</span><span id="FisherMatrix.reparametrize-1996"><a href="#FisherMatrix.reparametrize-1996"><span class="linenos">1996</span></a><span class="sd">        See Also</span>
</span><span id="FisherMatrix.reparametrize-1997"><a href="#FisherMatrix.reparametrize-1997"><span class="linenos">1997</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.reparametrize-1998"><a href="#FisherMatrix.reparametrize-1998"><span class="linenos">1998</span></a><span class="sd">        `reparametrize_symbolic` : the symbolic version of this method</span>
</span><span id="FisherMatrix.reparametrize-1999"><a href="#FisherMatrix.reparametrize-1999"><span class="linenos">1999</span></a>
</span><span id="FisherMatrix.reparametrize-2000"><a href="#FisherMatrix.reparametrize-2000"><span class="linenos">2000</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix.reparametrize-2001"><a href="#FisherMatrix.reparametrize-2001"><span class="linenos">2001</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix.reparametrize-2002"><a href="#FisherMatrix.reparametrize-2002"><span class="linenos">2002</span></a><span class="sd">        See the &lt;a</span>
</span><span id="FisherMatrix.reparametrize-2003"><a href="#FisherMatrix.reparametrize-2003"><span class="linenos">2003</span></a><span class="sd">        href=&quot;https://en.wikipedia.org/w/index.php?title=Fisher_information&amp;oldid=1063384000#Reparametrization&quot;</span>
</span><span id="FisherMatrix.reparametrize-2004"><a href="#FisherMatrix.reparametrize-2004"><span class="linenos">2004</span></a><span class="sd">        target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Wikipedia article&lt;/a&gt; for</span>
</span><span id="FisherMatrix.reparametrize-2005"><a href="#FisherMatrix.reparametrize-2005"><span class="linenos">2005</span></a><span class="sd">        more information.</span>
</span><span id="FisherMatrix.reparametrize-2006"><a href="#FisherMatrix.reparametrize-2006"><span class="linenos">2006</span></a>
</span><span id="FisherMatrix.reparametrize-2007"><a href="#FisherMatrix.reparametrize-2007"><span class="linenos">2007</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.reparametrize-2008"><a href="#FisherMatrix.reparametrize-2008"><span class="linenos">2008</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.reparametrize-2009"><a href="#FisherMatrix.reparametrize-2009"><span class="linenos">2009</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]))</span>
</span><span id="FisherMatrix.reparametrize-2010"><a href="#FisherMatrix.reparametrize-2010"><span class="linenos">2010</span></a><span class="sd">        &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix.reparametrize-2011"><a href="#FisherMatrix.reparametrize-2011"><span class="linenos">2011</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.reparametrize-2012"><a href="#FisherMatrix.reparametrize-2012"><span class="linenos">2012</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix.reparametrize-2013"><a href="#FisherMatrix.reparametrize-2013"><span class="linenos">2013</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix.reparametrize-2014"><a href="#FisherMatrix.reparametrize-2014"><span class="linenos">2014</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.reparametrize-2015"><a href="#FisherMatrix.reparametrize-2015"><span class="linenos">2015</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.reparametrize-2016"><a href="#FisherMatrix.reparametrize-2016"><span class="linenos">2016</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix.reparametrize-2017"><a href="#FisherMatrix.reparametrize-2017"><span class="linenos">2017</span></a>
</span><span id="FisherMatrix.reparametrize-2018"><a href="#FisherMatrix.reparametrize-2018"><span class="linenos">2018</span></a><span class="sd">        Define a Jacobian:</span>
</span><span id="FisherMatrix.reparametrize-2019"><a href="#FisherMatrix.reparametrize-2019"><span class="linenos">2019</span></a><span class="sd">        &gt;&gt;&gt; jac = [[1, 4], [3, 2]]</span>
</span><span id="FisherMatrix.reparametrize-2020"><a href="#FisherMatrix.reparametrize-2020"><span class="linenos">2020</span></a>
</span><span id="FisherMatrix.reparametrize-2021"><a href="#FisherMatrix.reparametrize-2021"><span class="linenos">2021</span></a><span class="sd">        Reparametrize according to that Jacobian:</span>
</span><span id="FisherMatrix.reparametrize-2022"><a href="#FisherMatrix.reparametrize-2022"><span class="linenos">2022</span></a><span class="sd">        &gt;&gt;&gt; fm.reparametrize(jac, names=[&#39;a&#39;, &#39;b&#39;])</span>
</span><span id="FisherMatrix.reparametrize-2023"><a href="#FisherMatrix.reparametrize-2023"><span class="linenos">2023</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.reparametrize-2024"><a href="#FisherMatrix.reparametrize-2024"><span class="linenos">2024</span></a><span class="sd">            array([[19., 16.],</span>
</span><span id="FisherMatrix.reparametrize-2025"><a href="#FisherMatrix.reparametrize-2025"><span class="linenos">2025</span></a><span class="sd">               [16., 24.]]),</span>
</span><span id="FisherMatrix.reparametrize-2026"><a href="#FisherMatrix.reparametrize-2026"><span class="linenos">2026</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix.reparametrize-2027"><a href="#FisherMatrix.reparametrize-2027"><span class="linenos">2027</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix.reparametrize-2028"><a href="#FisherMatrix.reparametrize-2028"><span class="linenos">2028</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix.reparametrize-2029"><a href="#FisherMatrix.reparametrize-2029"><span class="linenos">2029</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.reparametrize-2030"><a href="#FisherMatrix.reparametrize-2030"><span class="linenos">2030</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">@</span> <span class="n">jacobian</span>
</span><span id="FisherMatrix.reparametrize-2031"><a href="#FisherMatrix.reparametrize-2031"><span class="linenos">2031</span></a>
</span><span id="FisherMatrix.reparametrize-2032"><a href="#FisherMatrix.reparametrize-2032"><span class="linenos">2032</span></a>        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-2033"><a href="#FisherMatrix.reparametrize-2033"><span class="linenos">2033</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix.reparametrize-2034"><a href="#FisherMatrix.reparametrize-2034"><span class="linenos">2034</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-2035"><a href="#FisherMatrix.reparametrize-2035"><span class="linenos">2035</span></a>            <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-2036"><a href="#FisherMatrix.reparametrize-2036"><span class="linenos">2036</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">latex_names</span><span class="p">))</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix.reparametrize-2037"><a href="#FisherMatrix.reparametrize-2037"><span class="linenos">2037</span></a>                    <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-2038"><a href="#FisherMatrix.reparametrize-2038"><span class="linenos">2038</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-2039"><a href="#FisherMatrix.reparametrize-2039"><span class="linenos">2039</span></a>                <span class="n">latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-2040"><a href="#FisherMatrix.reparametrize-2040"><span class="linenos">2040</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-2041"><a href="#FisherMatrix.reparametrize-2041"><span class="linenos">2041</span></a>            <span class="c1"># we don&#39;t transform the names</span>
</span><span id="FisherMatrix.reparametrize-2042"><a href="#FisherMatrix.reparametrize-2042"><span class="linenos">2042</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-2043"><a href="#FisherMatrix.reparametrize-2043"><span class="linenos">2043</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-2044"><a href="#FisherMatrix.reparametrize-2044"><span class="linenos">2044</span></a>
</span><span id="FisherMatrix.reparametrize-2045"><a href="#FisherMatrix.reparametrize-2045"><span class="linenos">2045</span></a>        <span class="k">if</span> <span class="n">fiducials</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-2046"><a href="#FisherMatrix.reparametrize-2046"><span class="linenos">2046</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fiducials</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix.reparametrize-2047"><a href="#FisherMatrix.reparametrize-2047"><span class="linenos">2047</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-2048"><a href="#FisherMatrix.reparametrize-2048"><span class="linenos">2048</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-2049"><a href="#FisherMatrix.reparametrize-2049"><span class="linenos">2049</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-2050"><a href="#FisherMatrix.reparametrize-2050"><span class="linenos">2050</span></a>
</span><span id="FisherMatrix.reparametrize-2051"><a href="#FisherMatrix.reparametrize-2051"><span class="linenos">2051</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.reparametrize-2052"><a href="#FisherMatrix.reparametrize-2052"><span class="linenos">2052</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-2053"><a href="#FisherMatrix.reparametrize-2053"><span class="linenos">2053</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-2054"><a href="#FisherMatrix.reparametrize-2054"><span class="linenos">2054</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-2055"><a href="#FisherMatrix.reparametrize-2055"><span class="linenos">2055</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-2056"><a href="#FisherMatrix.reparametrize-2056"><span class="linenos">2056</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Perform a numerical transformation of the Fisher object using a Jacobian.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>transformation</strong> (array_like of float):
the Jacobian of the transformation</li>
<li><strong>names</strong> (array_like of str, optional):
list of new names for the Fisher object (default: None). If None,
uses the old names.</li>
<li><strong>latex_names</strong> (array_like of str, optional):
list of new LaTeX names for the Fisher object (default: None). If
None, and <code><a href="#FisherMatrix.names">names</a></code> is set, uses those instead, otherwise uses the
old LaTeX names.</li>
<li><strong>fiducials</strong> (array_like of float, optional):
the new values of the fiducials (default: None). If None, defaults
to the old values of the fiducials.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>FisherMatrix</strong>: The new Fisher object with the specified names, LaTeX names, and
fiducials.</li>
</ul>

<h6 id="see-also">See Also</h6>

<p><code><a href="#FisherMatrix.reparametrize_symbolic">reparametrize_symbolic</a></code>:  the symbolic version of this method  </p>

<h6 id="notes">Notes</h6>

<p>See the <a
href="https://en.wikipedia.org/w/index.php?title=Fisher_information&amp;oldid=1063384000#Reparametrization"
target="_blank" rel="noopener noreferrer">Wikipedia article</a> for
more information.</p>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0.],</span>
<span class="go">       [0., 2.]]),</span>
<span class="go">    names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>

<p>Define a Jacobian:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">jac</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</code></pre>
</div>

<p>Reparametrize according to that Jacobian:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">reparametrize</span><span class="p">(</span><span class="n">jac</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[19., 16.],</span>
<span class="go">       [16., 24.]]),</span>
<span class="go">    names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.to_dict" class="classattr">
                                        <input id="FisherMatrix.to_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.to_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.to_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.to_dict-2058"><a href="#FisherMatrix.to_dict-2058"><span class="linenos">2058</span></a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="FisherMatrix.to_dict-2059"><a href="#FisherMatrix.to_dict-2059"><span class="linenos">2059</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the Fisher object as a dictionary.&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.to_dict-2060"><a href="#FisherMatrix.to_dict-2060"><span class="linenos">2060</span></a>        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="FisherMatrix.to_dict-2061"><a href="#FisherMatrix.to_dict-2061"><span class="linenos">2061</span></a>            <span class="n">values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.to_dict-2062"><a href="#FisherMatrix.to_dict-2062"><span class="linenos">2062</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.to_dict-2063"><a href="#FisherMatrix.to_dict-2063"><span class="linenos">2063</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.to_dict-2064"><a href="#FisherMatrix.to_dict-2064"><span class="linenos">2064</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.to_dict-2065"><a href="#FisherMatrix.to_dict-2065"><span class="linenos">2065</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the Fisher object as a dictionary.</p>
</div>


                            </div>
                            <div id="FisherMatrix.to_file" class="classattr">
                                        <input id="FisherMatrix.to_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_file</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span>,</span><span class="param">	<span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.to_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.to_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.to_file-2067"><a href="#FisherMatrix.to_file-2067"><span class="linenos">2067</span></a>    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span>
</span><span id="FisherMatrix.to_file-2068"><a href="#FisherMatrix.to_file-2068"><span class="linenos">2068</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.to_file-2069"><a href="#FisherMatrix.to_file-2069"><span class="linenos">2069</span></a>        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
</span><span id="FisherMatrix.to_file-2070"><a href="#FisherMatrix.to_file-2070"><span class="linenos">2070</span></a>        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.to_file-2071"><a href="#FisherMatrix.to_file-2071"><span class="linenos">2071</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="FisherMatrix.to_file-2072"><a href="#FisherMatrix.to_file-2072"><span class="linenos">2072</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.to_file-2073"><a href="#FisherMatrix.to_file-2073"><span class="linenos">2073</span></a><span class="sd">        Save the Fisher object to a file (UTF-8 encoded).</span>
</span><span id="FisherMatrix.to_file-2074"><a href="#FisherMatrix.to_file-2074"><span class="linenos">2074</span></a>
</span><span id="FisherMatrix.to_file-2075"><a href="#FisherMatrix.to_file-2075"><span class="linenos">2075</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.to_file-2076"><a href="#FisherMatrix.to_file-2076"><span class="linenos">2076</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.to_file-2077"><a href="#FisherMatrix.to_file-2077"><span class="linenos">2077</span></a><span class="sd">        path : str or Path</span>
</span><span id="FisherMatrix.to_file-2078"><a href="#FisherMatrix.to_file-2078"><span class="linenos">2078</span></a><span class="sd">            the path to save the data to.</span>
</span><span id="FisherMatrix.to_file-2079"><a href="#FisherMatrix.to_file-2079"><span class="linenos">2079</span></a>
</span><span id="FisherMatrix.to_file-2080"><a href="#FisherMatrix.to_file-2080"><span class="linenos">2080</span></a><span class="sd">        metadata : dict, optional</span>
</span><span id="FisherMatrix.to_file-2081"><a href="#FisherMatrix.to_file-2081"><span class="linenos">2081</span></a><span class="sd">            any metadata that should be associated to the object saved, in the</span>
</span><span id="FisherMatrix.to_file-2082"><a href="#FisherMatrix.to_file-2082"><span class="linenos">2082</span></a><span class="sd">            form of a dictionary-like object</span>
</span><span id="FisherMatrix.to_file-2083"><a href="#FisherMatrix.to_file-2083"><span class="linenos">2083</span></a>
</span><span id="FisherMatrix.to_file-2084"><a href="#FisherMatrix.to_file-2084"><span class="linenos">2084</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.to_file-2085"><a href="#FisherMatrix.to_file-2085"><span class="linenos">2085</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.to_file-2086"><a href="#FisherMatrix.to_file-2086"><span class="linenos">2086</span></a><span class="sd">        dict</span>
</span><span id="FisherMatrix.to_file-2087"><a href="#FisherMatrix.to_file-2087"><span class="linenos">2087</span></a><span class="sd">            the dictionary that was saved</span>
</span><span id="FisherMatrix.to_file-2088"><a href="#FisherMatrix.to_file-2088"><span class="linenos">2088</span></a>
</span><span id="FisherMatrix.to_file-2089"><a href="#FisherMatrix.to_file-2089"><span class="linenos">2089</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix.to_file-2090"><a href="#FisherMatrix.to_file-2090"><span class="linenos">2090</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix.to_file-2091"><a href="#FisherMatrix.to_file-2091"><span class="linenos">2091</span></a><span class="sd">        The format used is a simple JSON file, containing at least the values of the</span>
</span><span id="FisherMatrix.to_file-2092"><a href="#FisherMatrix.to_file-2092"><span class="linenos">2092</span></a><span class="sd">        Fisher object, the names of the parameters, the LaTeX names, and the</span>
</span><span id="FisherMatrix.to_file-2093"><a href="#FisherMatrix.to_file-2093"><span class="linenos">2093</span></a><span class="sd">        fiducial values.</span>
</span><span id="FisherMatrix.to_file-2094"><a href="#FisherMatrix.to_file-2094"><span class="linenos">2094</span></a>
</span><span id="FisherMatrix.to_file-2095"><a href="#FisherMatrix.to_file-2095"><span class="linenos">2095</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.to_file-2096"><a href="#FisherMatrix.to_file-2096"><span class="linenos">2096</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.to_file-2097"><a href="#FisherMatrix.to_file-2097"><span class="linenos">2097</span></a><span class="sd">        &gt;&gt;&gt; from pprint import pprint</span>
</span><span id="FisherMatrix.to_file-2098"><a href="#FisherMatrix.to_file-2098"><span class="linenos">2098</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix.to_file-2099"><a href="#FisherMatrix.to_file-2099"><span class="linenos">2099</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], latex_names=[r&#39;$\mathbf{A}$&#39;, r&#39;$\mathbf{B}$&#39;])</span>
</span><span id="FisherMatrix.to_file-2100"><a href="#FisherMatrix.to_file-2100"><span class="linenos">2100</span></a><span class="sd">        &gt;&gt;&gt; pprint(fm.to_file(&#39;example_matrix.json&#39;), sort_dicts=False) # doctest: +SKIP</span>
</span><span id="FisherMatrix.to_file-2101"><a href="#FisherMatrix.to_file-2101"><span class="linenos">2101</span></a><span class="sd">        {&#39;values&#39;: array([[1., 0.],</span>
</span><span id="FisherMatrix.to_file-2102"><a href="#FisherMatrix.to_file-2102"><span class="linenos">2102</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix.to_file-2103"><a href="#FisherMatrix.to_file-2103"><span class="linenos">2103</span></a><span class="sd">         &#39;names&#39;: array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix.to_file-2104"><a href="#FisherMatrix.to_file-2104"><span class="linenos">2104</span></a><span class="sd">         &#39;latex_names&#39;: array([&#39;$\\mathbf{A}$&#39;, &#39;$\\mathbf{B}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix.to_file-2105"><a href="#FisherMatrix.to_file-2105"><span class="linenos">2105</span></a><span class="sd">         &#39;fiducials&#39;: array([0., 0.])}</span>
</span><span id="FisherMatrix.to_file-2106"><a href="#FisherMatrix.to_file-2106"><span class="linenos">2106</span></a>
</span><span id="FisherMatrix.to_file-2107"><a href="#FisherMatrix.to_file-2107"><span class="linenos">2107</span></a><span class="sd">        There is also a convenience function for reading it:</span>
</span><span id="FisherMatrix.to_file-2108"><a href="#FisherMatrix.to_file-2108"><span class="linenos">2108</span></a><span class="sd">        &gt;&gt;&gt; fm_read = FisherMatrix.from_file(&#39;example_matrix.json&#39;) # doctest: +SKIP</span>
</span><span id="FisherMatrix.to_file-2109"><a href="#FisherMatrix.to_file-2109"><span class="linenos">2109</span></a>
</span><span id="FisherMatrix.to_file-2110"><a href="#FisherMatrix.to_file-2110"><span class="linenos">2110</span></a><span class="sd">        Verify it&#39;s the same object:</span>
</span><span id="FisherMatrix.to_file-2111"><a href="#FisherMatrix.to_file-2111"><span class="linenos">2111</span></a><span class="sd">        &gt;&gt;&gt; fm == fm_read # doctest: +SKIP</span>
</span><span id="FisherMatrix.to_file-2112"><a href="#FisherMatrix.to_file-2112"><span class="linenos">2112</span></a><span class="sd">        True</span>
</span><span id="FisherMatrix.to_file-2113"><a href="#FisherMatrix.to_file-2113"><span class="linenos">2113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.to_file-2114"><a href="#FisherMatrix.to_file-2114"><span class="linenos">2114</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</span><span id="FisherMatrix.to_file-2115"><a href="#FisherMatrix.to_file-2115"><span class="linenos">2115</span></a>
</span><span id="FisherMatrix.to_file-2116"><a href="#FisherMatrix.to_file-2116"><span class="linenos">2116</span></a>        <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.to_file-2117"><a href="#FisherMatrix.to_file-2117"><span class="linenos">2117</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="FisherMatrix.to_file-2118"><a href="#FisherMatrix.to_file-2118"><span class="linenos">2118</span></a>                <span class="o">**</span><span class="n">data</span><span class="p">,</span>
</span><span id="FisherMatrix.to_file-2119"><a href="#FisherMatrix.to_file-2119"><span class="linenos">2119</span></a>                <span class="o">**</span><span class="p">{</span><span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">},</span>
</span><span id="FisherMatrix.to_file-2120"><a href="#FisherMatrix.to_file-2120"><span class="linenos">2120</span></a>            <span class="p">}</span>
</span><span id="FisherMatrix.to_file-2121"><a href="#FisherMatrix.to_file-2121"><span class="linenos">2121</span></a>
</span><span id="FisherMatrix.to_file-2122"><a href="#FisherMatrix.to_file-2122"><span class="linenos">2122</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
</span><span id="FisherMatrix.to_file-2123"><a href="#FisherMatrix.to_file-2123"><span class="linenos">2123</span></a>            <span class="n">file_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">FisherEncoder</span><span class="p">))</span>
</span><span id="FisherMatrix.to_file-2124"><a href="#FisherMatrix.to_file-2124"><span class="linenos">2124</span></a>
</span><span id="FisherMatrix.to_file-2125"><a href="#FisherMatrix.to_file-2125"><span class="linenos">2125</span></a>        <span class="k">return</span> <span class="n">data</span>
</span></pre></div>


            <div class="docstring"><p>Save the Fisher object to a file (UTF-8 encoded).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>path</strong> (str or Path):
the path to save the data to.</li>
<li><strong>metadata</strong> (dict, optional):
any metadata that should be associated to the object saved, in the
form of a dictionary-like object</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>dict</strong>: the dictionary that was saved</li>
</ul>

<h6 id="notes">Notes</h6>

<p>The format used is a simple JSON file, containing at least the values of the
Fisher object, the names of the parameters, the LaTeX names, and the
fiducial values.</p>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<span class="gp">... </span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{A}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{B}</span><span class="s1">$&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;example_matrix.json&#39;</span><span class="p">),</span> <span class="n">sort_dicts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">{&#39;values&#39;: array([[1., 0.],</span>
<span class="go">       [0., 2.]]),</span>
<span class="go"> &#39;names&#39;: array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
<span class="go"> &#39;latex_names&#39;: array([&#39;$\\mathbf{A}$&#39;, &#39;$\\mathbf{B}$&#39;], dtype=object),</span>
<span class="go"> &#39;fiducials&#39;: array([0., 0.])}</span>
</code></pre>
</div>

<p>There is also a convenience function for reading it:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm_read</span> <span class="o">=</span> <span class="n"><a href="#FisherMatrix.from_file">FisherMatrix.from_file</a></span><span class="p">(</span><span class="s1">&#39;example_matrix.json&#39;</span><span class="p">)</span> <span class="c1"># doctest: +SKIP</span>
</code></pre>
</div>

<p>Verify it's the same object:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">==</span> <span class="n">fm_read</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.marginalize_over" class="classattr">
                                        <input id="FisherMatrix.marginalize_over-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">marginalize_over</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.tensors.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.marginalize_over-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.marginalize_over"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.marginalize_over-2127"><a href="#FisherMatrix.marginalize_over-2127"><span class="linenos">2127</span></a>    <span class="k">def</span> <span class="nf">marginalize_over</span><span class="p">(</span>
</span><span id="FisherMatrix.marginalize_over-2128"><a href="#FisherMatrix.marginalize_over-2128"><span class="linenos">2128</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2129"><a href="#FisherMatrix.marginalize_over-2129"><span class="linenos">2129</span></a>        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2130"><a href="#FisherMatrix.marginalize_over-2130"><span class="linenos">2130</span></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2131"><a href="#FisherMatrix.marginalize_over-2131"><span class="linenos">2131</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2132"><a href="#FisherMatrix.marginalize_over-2132"><span class="linenos">2132</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2133"><a href="#FisherMatrix.marginalize_over-2133"><span class="linenos">2133</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.marginalize_over-2134"><a href="#FisherMatrix.marginalize_over-2134"><span class="linenos">2134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.marginalize_over-2135"><a href="#FisherMatrix.marginalize_over-2135"><span class="linenos">2135</span></a><span class="sd">        Perform marginalization over some parameters.</span>
</span><span id="FisherMatrix.marginalize_over-2136"><a href="#FisherMatrix.marginalize_over-2136"><span class="linenos">2136</span></a>
</span><span id="FisherMatrix.marginalize_over-2137"><a href="#FisherMatrix.marginalize_over-2137"><span class="linenos">2137</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.marginalize_over-2138"><a href="#FisherMatrix.marginalize_over-2138"><span class="linenos">2138</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.marginalize_over-2139"><a href="#FisherMatrix.marginalize_over-2139"><span class="linenos">2139</span></a><span class="sd">        names : str</span>
</span><span id="FisherMatrix.marginalize_over-2140"><a href="#FisherMatrix.marginalize_over-2140"><span class="linenos">2140</span></a><span class="sd">            the names of the parameters to marginalize over</span>
</span><span id="FisherMatrix.marginalize_over-2141"><a href="#FisherMatrix.marginalize_over-2141"><span class="linenos">2141</span></a>
</span><span id="FisherMatrix.marginalize_over-2142"><a href="#FisherMatrix.marginalize_over-2142"><span class="linenos">2142</span></a><span class="sd">        invert : bool, optional</span>
</span><span id="FisherMatrix.marginalize_over-2143"><a href="#FisherMatrix.marginalize_over-2143"><span class="linenos">2143</span></a><span class="sd">            whether to marginalize over all the parameters NOT in names (the complement) (default: False)</span>
</span><span id="FisherMatrix.marginalize_over-2144"><a href="#FisherMatrix.marginalize_over-2144"><span class="linenos">2144</span></a>
</span><span id="FisherMatrix.marginalize_over-2145"><a href="#FisherMatrix.marginalize_over-2145"><span class="linenos">2145</span></a><span class="sd">        ignore_errors : bool, optional</span>
</span><span id="FisherMatrix.marginalize_over-2146"><a href="#FisherMatrix.marginalize_over-2146"><span class="linenos">2146</span></a><span class="sd">            should non-existing parameters be ignored (default: False)</span>
</span><span id="FisherMatrix.marginalize_over-2147"><a href="#FisherMatrix.marginalize_over-2147"><span class="linenos">2147</span></a>
</span><span id="FisherMatrix.marginalize_over-2148"><a href="#FisherMatrix.marginalize_over-2148"><span class="linenos">2148</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix.marginalize_over-2149"><a href="#FisherMatrix.marginalize_over-2149"><span class="linenos">2149</span></a><span class="sd">            any kwargs passed to `inverse`</span>
</span><span id="FisherMatrix.marginalize_over-2150"><a href="#FisherMatrix.marginalize_over-2150"><span class="linenos">2150</span></a>
</span><span id="FisherMatrix.marginalize_over-2151"><a href="#FisherMatrix.marginalize_over-2151"><span class="linenos">2151</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.marginalize_over-2152"><a href="#FisherMatrix.marginalize_over-2152"><span class="linenos">2152</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.marginalize_over-2153"><a href="#FisherMatrix.marginalize_over-2153"><span class="linenos">2153</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix.marginalize_over-2154"><a href="#FisherMatrix.marginalize_over-2154"><span class="linenos">2154</span></a><span class="sd">            The Fisher object with the specified parameters marginalized over.</span>
</span><span id="FisherMatrix.marginalize_over-2155"><a href="#FisherMatrix.marginalize_over-2155"><span class="linenos">2155</span></a>
</span><span id="FisherMatrix.marginalize_over-2156"><a href="#FisherMatrix.marginalize_over-2156"><span class="linenos">2156</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.marginalize_over-2157"><a href="#FisherMatrix.marginalize_over-2157"><span class="linenos">2157</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.marginalize_over-2158"><a href="#FisherMatrix.marginalize_over-2158"><span class="linenos">2158</span></a><span class="sd">        Generate a Fisher object using a random orthogonal matrix:</span>
</span><span id="FisherMatrix.marginalize_over-2159"><a href="#FisherMatrix.marginalize_over-2159"><span class="linenos">2159</span></a><span class="sd">        &gt;&gt;&gt; rm = np.array([[-0.0942819 ,  0.56164959,  0.7638867 ,  0.18138749, -0.24338518],</span>
</span><span id="FisherMatrix.marginalize_over-2160"><a href="#FisherMatrix.marginalize_over-2160"><span class="linenos">2160</span></a><span class="sd">        ... [ 0.22058622,  0.74746891, -0.33297073, -0.47219083,  0.24248352],</span>
</span><span id="FisherMatrix.marginalize_over-2161"><a href="#FisherMatrix.marginalize_over-2161"><span class="linenos">2161</span></a><span class="sd">        ... [-0.23923712,  0.18017836, -0.44325216,  0.05300493, -0.84321964],</span>
</span><span id="FisherMatrix.marginalize_over-2162"><a href="#FisherMatrix.marginalize_over-2162"><span class="linenos">2162</span></a><span class="sd">        ... [-0.25595188,  0.30540004, -0.32672895,  0.77839888,  0.35855659],</span>
</span><span id="FisherMatrix.marginalize_over-2163"><a href="#FisherMatrix.marginalize_over-2163"><span class="linenos">2163</span></a><span class="sd">        ... [ 0.90537665,  0.0103218 , -0.04881925,  0.36799464, -0.20587183]])</span>
</span><span id="FisherMatrix.marginalize_over-2164"><a href="#FisherMatrix.marginalize_over-2164"><span class="linenos">2164</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(rm.T @ np.diag([1, 2, 3, 7, 6]) @ rm)</span>
</span><span id="FisherMatrix.marginalize_over-2165"><a href="#FisherMatrix.marginalize_over-2165"><span class="linenos">2165</span></a>
</span><span id="FisherMatrix.marginalize_over-2166"><a href="#FisherMatrix.marginalize_over-2166"><span class="linenos">2166</span></a><span class="sd">        Marginalize over some parameters:</span>
</span><span id="FisherMatrix.marginalize_over-2167"><a href="#FisherMatrix.marginalize_over-2167"><span class="linenos">2167</span></a><span class="sd">        &gt;&gt;&gt; fm.marginalize_over(&#39;p1&#39;, &#39;p2&#39;)</span>
</span><span id="FisherMatrix.marginalize_over-2168"><a href="#FisherMatrix.marginalize_over-2168"><span class="linenos">2168</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.marginalize_over-2169"><a href="#FisherMatrix.marginalize_over-2169"><span class="linenos">2169</span></a><span class="sd">            array([[ 1.67715593, -1.01556087,  0.30020774],</span>
</span><span id="FisherMatrix.marginalize_over-2170"><a href="#FisherMatrix.marginalize_over-2170"><span class="linenos">2170</span></a><span class="sd">               [-1.01556087,  4.92788973,  0.91219829],</span>
</span><span id="FisherMatrix.marginalize_over-2171"><a href="#FisherMatrix.marginalize_over-2171"><span class="linenos">2171</span></a><span class="sd">               [ 0.30020774,  0.91219829,  3.1796454 ]]),</span>
</span><span id="FisherMatrix.marginalize_over-2172"><a href="#FisherMatrix.marginalize_over-2172"><span class="linenos">2172</span></a><span class="sd">            names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
</span><span id="FisherMatrix.marginalize_over-2173"><a href="#FisherMatrix.marginalize_over-2173"><span class="linenos">2173</span></a><span class="sd">            latex_names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
</span><span id="FisherMatrix.marginalize_over-2174"><a href="#FisherMatrix.marginalize_over-2174"><span class="linenos">2174</span></a><span class="sd">            fiducials=array([0., 0., 0.]))</span>
</span><span id="FisherMatrix.marginalize_over-2175"><a href="#FisherMatrix.marginalize_over-2175"><span class="linenos">2175</span></a>
</span><span id="FisherMatrix.marginalize_over-2176"><a href="#FisherMatrix.marginalize_over-2176"><span class="linenos">2176</span></a><span class="sd">        Marginalize over all parameters which are NOT `p1` or `p2`:</span>
</span><span id="FisherMatrix.marginalize_over-2177"><a href="#FisherMatrix.marginalize_over-2177"><span class="linenos">2177</span></a><span class="sd">        &gt;&gt;&gt; fm.marginalize_over(&#39;p1&#39;, &#39;p2&#39;, invert=True)</span>
</span><span id="FisherMatrix.marginalize_over-2178"><a href="#FisherMatrix.marginalize_over-2178"><span class="linenos">2178</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.marginalize_over-2179"><a href="#FisherMatrix.marginalize_over-2179"><span class="linenos">2179</span></a><span class="sd">            array([[ 5.04480061, -0.04490451],</span>
</span><span id="FisherMatrix.marginalize_over-2180"><a href="#FisherMatrix.marginalize_over-2180"><span class="linenos">2180</span></a><span class="sd">               [-0.04490451,  1.61599083]]),</span>
</span><span id="FisherMatrix.marginalize_over-2181"><a href="#FisherMatrix.marginalize_over-2181"><span class="linenos">2181</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.marginalize_over-2182"><a href="#FisherMatrix.marginalize_over-2182"><span class="linenos">2182</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.marginalize_over-2183"><a href="#FisherMatrix.marginalize_over-2183"><span class="linenos">2183</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix.marginalize_over-2184"><a href="#FisherMatrix.marginalize_over-2184"><span class="linenos">2184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.marginalize_over-2185"><a href="#FisherMatrix.marginalize_over-2185"><span class="linenos">2185</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.marginalize_over-2186"><a href="#FisherMatrix.marginalize_over-2186"><span class="linenos">2186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="FisherMatrix.marginalize_over-2187"><a href="#FisherMatrix.marginalize_over-2187"><span class="linenos">2187</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2188"><a href="#FisherMatrix.marginalize_over-2188"><span class="linenos">2188</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2189"><a href="#FisherMatrix.marginalize_over-2189"><span class="linenos">2189</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2190"><a href="#FisherMatrix.marginalize_over-2190"><span class="linenos">2190</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix.marginalize_over-2191"><a href="#FisherMatrix.marginalize_over-2191"><span class="linenos">2191</span></a>        <span class="k">if</span> <span class="n">invert</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix.marginalize_over-2192"><a href="#FisherMatrix.marginalize_over-2192"><span class="linenos">2192</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">^</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
</span><span id="FisherMatrix.marginalize_over-2193"><a href="#FisherMatrix.marginalize_over-2193"><span class="linenos">2193</span></a>        <span class="n">fisher</span> <span class="o">=</span> <span class="n">inv</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="n">ignore_errors</span><span class="p">)</span>
</span><span id="FisherMatrix.marginalize_over-2194"><a href="#FisherMatrix.marginalize_over-2194"><span class="linenos">2194</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.marginalize_over-2195"><a href="#FisherMatrix.marginalize_over-2195"><span class="linenos">2195</span></a>            <span class="n">fisher</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="FisherMatrix.marginalize_over-2196"><a href="#FisherMatrix.marginalize_over-2196"><span class="linenos">2196</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2197"><a href="#FisherMatrix.marginalize_over-2197"><span class="linenos">2197</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2198"><a href="#FisherMatrix.marginalize_over-2198"><span class="linenos">2198</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-2199"><a href="#FisherMatrix.marginalize_over-2199"><span class="linenos">2199</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Perform marginalization over some parameters.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>names</strong> (str):
the names of the parameters to marginalize over</li>
<li><strong>invert</strong> (bool, optional):
whether to marginalize over all the parameters NOT in names (the complement) (default: False)</li>
<li><strong>ignore_errors</strong> (bool, optional):
should non-existing parameters be ignored (default: False)</li>
<li><strong>**kwargs</strong>: any kwargs passed to <code><a href="#FisherMatrix.inverse">inverse</a></code></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>FisherMatrix</strong>: The Fisher object with the specified parameters marginalized over.</li>
</ul>

<h6 id="examples">Examples</h6>

<p>Generate a Fisher object using a random orthogonal matrix:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">rm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.0942819</span> <span class="p">,</span>  <span class="mf">0.56164959</span><span class="p">,</span>  <span class="mf">0.7638867</span> <span class="p">,</span>  <span class="mf">0.18138749</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24338518</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span> <span class="mf">0.22058622</span><span class="p">,</span>  <span class="mf">0.74746891</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33297073</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.47219083</span><span class="p">,</span>  <span class="mf">0.24248352</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span><span class="o">-</span><span class="mf">0.23923712</span><span class="p">,</span>  <span class="mf">0.18017836</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44325216</span><span class="p">,</span>  <span class="mf">0.05300493</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.84321964</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span><span class="o">-</span><span class="mf">0.25595188</span><span class="p">,</span>  <span class="mf">0.30540004</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32672895</span><span class="p">,</span>  <span class="mf">0.77839888</span><span class="p">,</span>  <span class="mf">0.35855659</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span> <span class="mf">0.90537665</span><span class="p">,</span>  <span class="mf">0.0103218</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.04881925</span><span class="p">,</span>  <span class="mf">0.36799464</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20587183</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">rm</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span> <span class="o">@</span> <span class="n">rm</span><span class="p">)</span>
</code></pre>
</div>

<p>Marginalize over some parameters:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">marginalize_over</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p2&#39;</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[ 1.67715593, -1.01556087,  0.30020774],</span>
<span class="go">       [-1.01556087,  4.92788973,  0.91219829],</span>
<span class="go">       [ 0.30020774,  0.91219829,  3.1796454 ]]),</span>
<span class="go">    names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0., 0.]))</span>
</code></pre>
</div>

<p>Marginalize over all parameters which are NOT <code>p1</code> or <code>p2</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">marginalize_over</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p2&#39;</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[ 5.04480061, -0.04490451],</span>
<span class="go">       [-0.04490451,  1.61599083]]),</span>
<span class="go">    names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="FisherMatrix.from_file" class="classattr">
                                        <input id="FisherMatrix.from_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.from_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.from_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.from_file-2201"><a href="#FisherMatrix.from_file-2201"><span class="linenos">2201</span></a>    <span class="nd">@classmethod</span>
</span><span id="FisherMatrix.from_file-2202"><a href="#FisherMatrix.from_file-2202"><span class="linenos">2202</span></a>    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
</span><span id="FisherMatrix.from_file-2203"><a href="#FisherMatrix.from_file-2203"><span class="linenos">2203</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="FisherMatrix.from_file-2204"><a href="#FisherMatrix.from_file-2204"><span class="linenos">2204</span></a>        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
</span><span id="FisherMatrix.from_file-2205"><a href="#FisherMatrix.from_file-2205"><span class="linenos">2205</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix.from_file-2206"><a href="#FisherMatrix.from_file-2206"><span class="linenos">2206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.from_file-2207"><a href="#FisherMatrix.from_file-2207"><span class="linenos">2207</span></a><span class="sd">        Read a Fisher object from a file.</span>
</span><span id="FisherMatrix.from_file-2208"><a href="#FisherMatrix.from_file-2208"><span class="linenos">2208</span></a>
</span><span id="FisherMatrix.from_file-2209"><a href="#FisherMatrix.from_file-2209"><span class="linenos">2209</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.from_file-2210"><a href="#FisherMatrix.from_file-2210"><span class="linenos">2210</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.from_file-2211"><a href="#FisherMatrix.from_file-2211"><span class="linenos">2211</span></a><span class="sd">        path : str or Path</span>
</span><span id="FisherMatrix.from_file-2212"><a href="#FisherMatrix.from_file-2212"><span class="linenos">2212</span></a><span class="sd">            the path to the file</span>
</span><span id="FisherMatrix.from_file-2213"><a href="#FisherMatrix.from_file-2213"><span class="linenos">2213</span></a>
</span><span id="FisherMatrix.from_file-2214"><a href="#FisherMatrix.from_file-2214"><span class="linenos">2214</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.from_file-2215"><a href="#FisherMatrix.from_file-2215"><span class="linenos">2215</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.from_file-2216"><a href="#FisherMatrix.from_file-2216"><span class="linenos">2216</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix.from_file-2217"><a href="#FisherMatrix.from_file-2217"><span class="linenos">2217</span></a>
</span><span id="FisherMatrix.from_file-2218"><a href="#FisherMatrix.from_file-2218"><span class="linenos">2218</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix.from_file-2219"><a href="#FisherMatrix.from_file-2219"><span class="linenos">2219</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix.from_file-2220"><a href="#FisherMatrix.from_file-2220"><span class="linenos">2220</span></a><span class="sd">        Any metadata is ignored when reading the file.</span>
</span><span id="FisherMatrix.from_file-2221"><a href="#FisherMatrix.from_file-2221"><span class="linenos">2221</span></a><span class="sd">        If you want to read the metadata as well, use something like the following:</span>
</span><span id="FisherMatrix.from_file-2222"><a href="#FisherMatrix.from_file-2222"><span class="linenos">2222</span></a>
</span><span id="FisherMatrix.from_file-2223"><a href="#FisherMatrix.from_file-2223"><span class="linenos">2223</span></a><span class="sd">        &gt;&gt;&gt; import json</span>
</span><span id="FisherMatrix.from_file-2224"><a href="#FisherMatrix.from_file-2224"><span class="linenos">2224</span></a><span class="sd">        &gt;&gt;&gt; with open(&lt;filename&gt;, &#39;r&#39;) as f: # doctest: +SKIP</span>
</span><span id="FisherMatrix.from_file-2225"><a href="#FisherMatrix.from_file-2225"><span class="linenos">2225</span></a><span class="sd">        ...     data = json.loads(f.read()) # doctest: +SKIP</span>
</span><span id="FisherMatrix.from_file-2226"><a href="#FisherMatrix.from_file-2226"><span class="linenos">2226</span></a>
</span><span id="FisherMatrix.from_file-2227"><a href="#FisherMatrix.from_file-2227"><span class="linenos">2227</span></a><span class="sd">        Then `data` will contain a dictionary with all of the data from the</span>
</span><span id="FisherMatrix.from_file-2228"><a href="#FisherMatrix.from_file-2228"><span class="linenos">2228</span></a><span class="sd">        file, which can be easily parsed.</span>
</span><span id="FisherMatrix.from_file-2229"><a href="#FisherMatrix.from_file-2229"><span class="linenos">2229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.from_file-2230"><a href="#FisherMatrix.from_file-2230"><span class="linenos">2230</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
</span><span id="FisherMatrix.from_file-2231"><a href="#FisherMatrix.from_file-2231"><span class="linenos">2231</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file_handle</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="FisherMatrix.from_file-2232"><a href="#FisherMatrix.from_file-2232"><span class="linenos">2232</span></a>
</span><span id="FisherMatrix.from_file-2233"><a href="#FisherMatrix.from_file-2233"><span class="linenos">2233</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Read a Fisher object from a file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>path</strong> (str or Path):
the path to the file</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>FisherMatrix</strong></li>
</ul>

<h6 id="notes">Notes</h6>

<p>Any metadata is ignored when reading the file.
If you want to read the metadata as well, use something like the following:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="c1"># doctest: +SKIP</span>
<span class="gp">... </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span> <span class="c1"># doctest: +SKIP</span>
</code></pre>
</div>

<p>Then <code>data</code> will contain a dictionary with all of the data from the
file, which can be easily parsed.</p>
</div>


                            </div>
                            <div id="FisherMatrix.from_dict" class="classattr">
                                        <input id="FisherMatrix.from_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.from_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.from_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.from_dict-2235"><a href="#FisherMatrix.from_dict-2235"><span class="linenos">2235</span></a>    <span class="nd">@classmethod</span>
</span><span id="FisherMatrix.from_dict-2236"><a href="#FisherMatrix.from_dict-2236"><span class="linenos">2236</span></a>    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span>
</span><span id="FisherMatrix.from_dict-2237"><a href="#FisherMatrix.from_dict-2237"><span class="linenos">2237</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="FisherMatrix.from_dict-2238"><a href="#FisherMatrix.from_dict-2238"><span class="linenos">2238</span></a>        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="FisherMatrix.from_dict-2239"><a href="#FisherMatrix.from_dict-2239"><span class="linenos">2239</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix.from_dict-2240"><a href="#FisherMatrix.from_dict-2240"><span class="linenos">2240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.from_dict-2241"><a href="#FisherMatrix.from_dict-2241"><span class="linenos">2241</span></a><span class="sd">        Read a Fisher object from a dictionary.</span>
</span><span id="FisherMatrix.from_dict-2242"><a href="#FisherMatrix.from_dict-2242"><span class="linenos">2242</span></a>
</span><span id="FisherMatrix.from_dict-2243"><a href="#FisherMatrix.from_dict-2243"><span class="linenos">2243</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.from_dict-2244"><a href="#FisherMatrix.from_dict-2244"><span class="linenos">2244</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.from_dict-2245"><a href="#FisherMatrix.from_dict-2245"><span class="linenos">2245</span></a><span class="sd">        data</span>
</span><span id="FisherMatrix.from_dict-2246"><a href="#FisherMatrix.from_dict-2246"><span class="linenos">2246</span></a><span class="sd">            the dictionary</span>
</span><span id="FisherMatrix.from_dict-2247"><a href="#FisherMatrix.from_dict-2247"><span class="linenos">2247</span></a>
</span><span id="FisherMatrix.from_dict-2248"><a href="#FisherMatrix.from_dict-2248"><span class="linenos">2248</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix.from_dict-2249"><a href="#FisherMatrix.from_dict-2249"><span class="linenos">2249</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix.from_dict-2250"><a href="#FisherMatrix.from_dict-2250"><span class="linenos">2250</span></a><span class="sd">        KeyError</span>
</span><span id="FisherMatrix.from_dict-2251"><a href="#FisherMatrix.from_dict-2251"><span class="linenos">2251</span></a><span class="sd">            if the dictionary contains malformed data</span>
</span><span id="FisherMatrix.from_dict-2252"><a href="#FisherMatrix.from_dict-2252"><span class="linenos">2252</span></a>
</span><span id="FisherMatrix.from_dict-2253"><a href="#FisherMatrix.from_dict-2253"><span class="linenos">2253</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.from_dict-2254"><a href="#FisherMatrix.from_dict-2254"><span class="linenos">2254</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.from_dict-2255"><a href="#FisherMatrix.from_dict-2255"><span class="linenos">2255</span></a><span class="sd">        FisherMatrix</span>
</span><span id="FisherMatrix.from_dict-2256"><a href="#FisherMatrix.from_dict-2256"><span class="linenos">2256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.from_dict-2257"><a href="#FisherMatrix.from_dict-2257"><span class="linenos">2257</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="FisherMatrix.from_dict-2258"><a href="#FisherMatrix.from_dict-2258"><span class="linenos">2258</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix.from_dict-2259"><a href="#FisherMatrix.from_dict-2259"><span class="linenos">2259</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix.from_dict-2260"><a href="#FisherMatrix.from_dict-2260"><span class="linenos">2260</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;latex_names&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix.from_dict-2261"><a href="#FisherMatrix.from_dict-2261"><span class="linenos">2261</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fiducials&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix.from_dict-2262"><a href="#FisherMatrix.from_dict-2262"><span class="linenos">2262</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Read a Fisher object from a dictionary.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>data</strong>: the dictionary</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>KeyError</strong>: if the dictionary contains malformed data</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>FisherMatrix</strong></li>
</ul>
</div>


                            </div>
                            <div id="FisherMatrix.correlation_matrix" class="classattr">
                                        <input id="FisherMatrix.correlation_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">correlation_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FisherMatrix.correlation_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.correlation_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.correlation_matrix-2264"><a href="#FisherMatrix.correlation_matrix-2264"><span class="linenos">2264</span></a>    <span class="k">def</span> <span class="nf">correlation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="FisherMatrix.correlation_matrix-2265"><a href="#FisherMatrix.correlation_matrix-2265"><span class="linenos">2265</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.correlation_matrix-2266"><a href="#FisherMatrix.correlation_matrix-2266"><span class="linenos">2266</span></a><span class="sd">        Compute the correlation matrix from the Fisher matrix.</span>
</span><span id="FisherMatrix.correlation_matrix-2267"><a href="#FisherMatrix.correlation_matrix-2267"><span class="linenos">2267</span></a>
</span><span id="FisherMatrix.correlation_matrix-2268"><a href="#FisherMatrix.correlation_matrix-2268"><span class="linenos">2268</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.correlation_matrix-2269"><a href="#FisherMatrix.correlation_matrix-2269"><span class="linenos">2269</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.correlation_matrix-2270"><a href="#FisherMatrix.correlation_matrix-2270"><span class="linenos">2270</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix.correlation_matrix-2271"><a href="#FisherMatrix.correlation_matrix-2271"><span class="linenos">2271</span></a><span class="sd">            any kwargs passed to `inverse`</span>
</span><span id="FisherMatrix.correlation_matrix-2272"><a href="#FisherMatrix.correlation_matrix-2272"><span class="linenos">2272</span></a>
</span><span id="FisherMatrix.correlation_matrix-2273"><a href="#FisherMatrix.correlation_matrix-2273"><span class="linenos">2273</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.correlation_matrix-2274"><a href="#FisherMatrix.correlation_matrix-2274"><span class="linenos">2274</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.correlation_matrix-2275"><a href="#FisherMatrix.correlation_matrix-2275"><span class="linenos">2275</span></a><span class="sd">        array_like : float</span>
</span><span id="FisherMatrix.correlation_matrix-2276"><a href="#FisherMatrix.correlation_matrix-2276"><span class="linenos">2276</span></a><span class="sd">            the correlation matrix as a numpy array</span>
</span><span id="FisherMatrix.correlation_matrix-2277"><a href="#FisherMatrix.correlation_matrix-2277"><span class="linenos">2277</span></a>
</span><span id="FisherMatrix.correlation_matrix-2278"><a href="#FisherMatrix.correlation_matrix-2278"><span class="linenos">2278</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix.correlation_matrix-2279"><a href="#FisherMatrix.correlation_matrix-2279"><span class="linenos">2279</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix.correlation_matrix-2280"><a href="#FisherMatrix.correlation_matrix-2280"><span class="linenos">2280</span></a><span class="sd">        The entries of the output matrix are given by:</span>
</span><span id="FisherMatrix.correlation_matrix-2281"><a href="#FisherMatrix.correlation_matrix-2281"><span class="linenos">2281</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.correlation_matrix-2282"><a href="#FisherMatrix.correlation_matrix-2282"><span class="linenos">2282</span></a><span class="sd">            \mathsf{P}_{ij} \equiv \frac{\mathsf{C}_{ij}}{\sqrt{\mathsf{C}_{ii} \mathsf{C}_{jj}}}</span>
</span><span id="FisherMatrix.correlation_matrix-2283"><a href="#FisherMatrix.correlation_matrix-2283"><span class="linenos">2283</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.correlation_matrix-2284"><a href="#FisherMatrix.correlation_matrix-2284"><span class="linenos">2284</span></a><span class="sd">        where $\mathsf{C}_{ij}$ is the $(i, j)$ element of the covariance</span>
</span><span id="FisherMatrix.correlation_matrix-2285"><a href="#FisherMatrix.correlation_matrix-2285"><span class="linenos">2285</span></a><span class="sd">        matrix (the inverse of the Fisher matrix).</span>
</span><span id="FisherMatrix.correlation_matrix-2286"><a href="#FisherMatrix.correlation_matrix-2286"><span class="linenos">2286</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.correlation_matrix-2287"><a href="#FisherMatrix.correlation_matrix-2287"><span class="linenos">2287</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="FisherMatrix.correlation_matrix-2288"><a href="#FisherMatrix.correlation_matrix-2288"><span class="linenos">2288</span></a>        <span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>
</span><span id="FisherMatrix.correlation_matrix-2289"><a href="#FisherMatrix.correlation_matrix-2289"><span class="linenos">2289</span></a>
</span><span id="FisherMatrix.correlation_matrix-2290"><a href="#FisherMatrix.correlation_matrix-2290"><span class="linenos">2290</span></a>        <span class="k">return</span> <span class="n">inv</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="n">diag</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Compute the correlation matrix from the Fisher matrix.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>**kwargs</strong>: any kwargs passed to <code><a href="#FisherMatrix.inverse">inverse</a></code></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>array_like</strong> (float):
the correlation matrix as a numpy array</li>
</ul>

<h6 id="notes">Notes</h6>

<p>The entries of the output matrix are given by:
$$
    \mathsf{P}_{ij} \equiv \frac{\mathsf{C}_{ij}}{\sqrt{\mathsf{C}_{ii} \mathsf{C}_{jj}}}
$$
where $\mathsf{C}_{ij}$ is the $(i, j)$ element of the covariance
matrix (the inverse of the Fisher matrix).</p>
</div>


                            </div>
                            <div id="FisherMatrix.correlation_coefficient" class="classattr">
                                        <input id="FisherMatrix.correlation_coefficient-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">correlation_coefficient</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name1</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">name2</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.correlation_coefficient-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.correlation_coefficient"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.correlation_coefficient-2292"><a href="#FisherMatrix.correlation_coefficient-2292"><span class="linenos">2292</span></a>    <span class="k">def</span> <span class="nf">correlation_coefficient</span><span class="p">(</span>
</span><span id="FisherMatrix.correlation_coefficient-2293"><a href="#FisherMatrix.correlation_coefficient-2293"><span class="linenos">2293</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.correlation_coefficient-2294"><a href="#FisherMatrix.correlation_coefficient-2294"><span class="linenos">2294</span></a>        <span class="n">name1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix.correlation_coefficient-2295"><a href="#FisherMatrix.correlation_coefficient-2295"><span class="linenos">2295</span></a>        <span class="n">name2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix.correlation_coefficient-2296"><a href="#FisherMatrix.correlation_coefficient-2296"><span class="linenos">2296</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix.correlation_coefficient-2297"><a href="#FisherMatrix.correlation_coefficient-2297"><span class="linenos">2297</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="FisherMatrix.correlation_coefficient-2298"><a href="#FisherMatrix.correlation_coefficient-2298"><span class="linenos">2298</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.correlation_coefficient-2299"><a href="#FisherMatrix.correlation_coefficient-2299"><span class="linenos">2299</span></a><span class="sd">        Return the correlation coefficient between two parameters.</span>
</span><span id="FisherMatrix.correlation_coefficient-2300"><a href="#FisherMatrix.correlation_coefficient-2300"><span class="linenos">2300</span></a>
</span><span id="FisherMatrix.correlation_coefficient-2301"><a href="#FisherMatrix.correlation_coefficient-2301"><span class="linenos">2301</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.correlation_coefficient-2302"><a href="#FisherMatrix.correlation_coefficient-2302"><span class="linenos">2302</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.correlation_coefficient-2303"><a href="#FisherMatrix.correlation_coefficient-2303"><span class="linenos">2303</span></a><span class="sd">        name1 : str</span>
</span><span id="FisherMatrix.correlation_coefficient-2304"><a href="#FisherMatrix.correlation_coefficient-2304"><span class="linenos">2304</span></a><span class="sd">            the name of the first parameter</span>
</span><span id="FisherMatrix.correlation_coefficient-2305"><a href="#FisherMatrix.correlation_coefficient-2305"><span class="linenos">2305</span></a>
</span><span id="FisherMatrix.correlation_coefficient-2306"><a href="#FisherMatrix.correlation_coefficient-2306"><span class="linenos">2306</span></a><span class="sd">        name2 : str</span>
</span><span id="FisherMatrix.correlation_coefficient-2307"><a href="#FisherMatrix.correlation_coefficient-2307"><span class="linenos">2307</span></a><span class="sd">            the name of the second parameter</span>
</span><span id="FisherMatrix.correlation_coefficient-2308"><a href="#FisherMatrix.correlation_coefficient-2308"><span class="linenos">2308</span></a>
</span><span id="FisherMatrix.correlation_coefficient-2309"><a href="#FisherMatrix.correlation_coefficient-2309"><span class="linenos">2309</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix.correlation_coefficient-2310"><a href="#FisherMatrix.correlation_coefficient-2310"><span class="linenos">2310</span></a><span class="sd">            any kwargs passed to `correlation_matrix`</span>
</span><span id="FisherMatrix.correlation_coefficient-2311"><a href="#FisherMatrix.correlation_coefficient-2311"><span class="linenos">2311</span></a>
</span><span id="FisherMatrix.correlation_coefficient-2312"><a href="#FisherMatrix.correlation_coefficient-2312"><span class="linenos">2312</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.correlation_coefficient-2313"><a href="#FisherMatrix.correlation_coefficient-2313"><span class="linenos">2313</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.correlation_coefficient-2314"><a href="#FisherMatrix.correlation_coefficient-2314"><span class="linenos">2314</span></a><span class="sd">        float</span>
</span><span id="FisherMatrix.correlation_coefficient-2315"><a href="#FisherMatrix.correlation_coefficient-2315"><span class="linenos">2315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.correlation_coefficient-2316"><a href="#FisherMatrix.correlation_coefficient-2316"><span class="linenos">2316</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.correlation_coefficient-2317"><a href="#FisherMatrix.correlation_coefficient-2317"><span class="linenos">2317</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">correlation_matrix</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="FisherMatrix.correlation_coefficient-2318"><a href="#FisherMatrix.correlation_coefficient-2318"><span class="linenos">2318</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.correlation_coefficient-2319"><a href="#FisherMatrix.correlation_coefficient-2319"><span class="linenos">2319</span></a>        <span class="p">)[</span><span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the correlation coefficient between two parameters.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name1</strong> (str):
the name of the first parameter</li>
<li><strong>name2</strong> (str):
the name of the second parameter</li>
<li><strong>**kwargs</strong>: any kwargs passed to <code><a href="#FisherMatrix.correlation_matrix">correlation_matrix</a></code></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>float</strong></li>
</ul>
</div>


                            </div>
                            <div id="FisherMatrix.figure_of_merit" class="classattr">
                                        <input id="FisherMatrix.figure_of_merit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">figure_of_merit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.figure_of_merit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.figure_of_merit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.figure_of_merit-2321"><a href="#FisherMatrix.figure_of_merit-2321"><span class="linenos">2321</span></a>    <span class="k">def</span> <span class="nf">figure_of_merit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="FisherMatrix.figure_of_merit-2322"><a href="#FisherMatrix.figure_of_merit-2322"><span class="linenos">2322</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.figure_of_merit-2323"><a href="#FisherMatrix.figure_of_merit-2323"><span class="linenos">2323</span></a><span class="sd">        Compute the figure of merit (FoM).</span>
</span><span id="FisherMatrix.figure_of_merit-2324"><a href="#FisherMatrix.figure_of_merit-2324"><span class="linenos">2324</span></a>
</span><span id="FisherMatrix.figure_of_merit-2325"><a href="#FisherMatrix.figure_of_merit-2325"><span class="linenos">2325</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.figure_of_merit-2326"><a href="#FisherMatrix.figure_of_merit-2326"><span class="linenos">2326</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.figure_of_merit-2327"><a href="#FisherMatrix.figure_of_merit-2327"><span class="linenos">2327</span></a><span class="sd">        float</span>
</span><span id="FisherMatrix.figure_of_merit-2328"><a href="#FisherMatrix.figure_of_merit-2328"><span class="linenos">2328</span></a>
</span><span id="FisherMatrix.figure_of_merit-2329"><a href="#FisherMatrix.figure_of_merit-2329"><span class="linenos">2329</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix.figure_of_merit-2330"><a href="#FisherMatrix.figure_of_merit-2330"><span class="linenos">2330</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix.figure_of_merit-2331"><a href="#FisherMatrix.figure_of_merit-2331"><span class="linenos">2331</span></a><span class="sd">        The figure of merit is computed as:</span>
</span><span id="FisherMatrix.figure_of_merit-2332"><a href="#FisherMatrix.figure_of_merit-2332"><span class="linenos">2332</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.figure_of_merit-2333"><a href="#FisherMatrix.figure_of_merit-2333"><span class="linenos">2333</span></a><span class="sd">            \mathrm{FoM} \equiv \frac{1}{2} \log \left[ \det \mathsf{F} \right]</span>
</span><span id="FisherMatrix.figure_of_merit-2334"><a href="#FisherMatrix.figure_of_merit-2334"><span class="linenos">2334</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.figure_of_merit-2335"><a href="#FisherMatrix.figure_of_merit-2335"><span class="linenos">2335</span></a><span class="sd">        where $\mathsf{F}$ denotes the Fisher matrix.</span>
</span><span id="FisherMatrix.figure_of_merit-2336"><a href="#FisherMatrix.figure_of_merit-2336"><span class="linenos">2336</span></a>
</span><span id="FisherMatrix.figure_of_merit-2337"><a href="#FisherMatrix.figure_of_merit-2337"><span class="linenos">2337</span></a><span class="sd">        Some authors define the FoM (also sometimes called the signal-to-noise,</span>
</span><span id="FisherMatrix.figure_of_merit-2338"><a href="#FisherMatrix.figure_of_merit-2338"><span class="linenos">2338</span></a><span class="sd">        $\mathrm{SNR}$) as:</span>
</span><span id="FisherMatrix.figure_of_merit-2339"><a href="#FisherMatrix.figure_of_merit-2339"><span class="linenos">2339</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.figure_of_merit-2340"><a href="#FisherMatrix.figure_of_merit-2340"><span class="linenos">2340</span></a><span class="sd">            \mathrm{SNR} = \sqrt{\det \mathsf{F}}</span>
</span><span id="FisherMatrix.figure_of_merit-2341"><a href="#FisherMatrix.figure_of_merit-2341"><span class="linenos">2341</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.figure_of_merit-2342"><a href="#FisherMatrix.figure_of_merit-2342"><span class="linenos">2342</span></a><span class="sd">        The two are related by a simple transformation:</span>
</span><span id="FisherMatrix.figure_of_merit-2343"><a href="#FisherMatrix.figure_of_merit-2343"><span class="linenos">2343</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.figure_of_merit-2344"><a href="#FisherMatrix.figure_of_merit-2344"><span class="linenos">2344</span></a><span class="sd">            \mathrm{SNR} = \exp{\left( \mathrm{FoM} \right)}</span>
</span><span id="FisherMatrix.figure_of_merit-2345"><a href="#FisherMatrix.figure_of_merit-2345"><span class="linenos">2345</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.figure_of_merit-2346"><a href="#FisherMatrix.figure_of_merit-2346"><span class="linenos">2346</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.figure_of_merit-2347"><a href="#FisherMatrix.figure_of_merit-2347"><span class="linenos">2347</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
</span></pre></div>


            <div class="docstring"><p>Compute the figure of merit (FoM).</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>float</strong></li>
</ul>

<h6 id="notes">Notes</h6>

<p>The figure of merit is computed as:
$$
    \mathrm{FoM} \equiv \frac{1}{2} \log \left[ \det \mathsf{F} \right]
$$
where $\mathsf{F}$ denotes the Fisher matrix.</p>

<p>Some authors define the FoM (also sometimes called the signal-to-noise,
$\mathrm{SNR}$) as:
$$
    \mathrm{SNR} = \sqrt{\det \mathsf{F}}
$$
The two are related by a simple transformation:
$$
    \mathrm{SNR} = \exp{\left( \mathrm{FoM} \right)}
$$</p>
</div>


                            </div>
                            <div id="FisherMatrix.figure_of_correlation" class="classattr">
                                        <input id="FisherMatrix.figure_of_correlation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">figure_of_correlation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.figure_of_correlation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.figure_of_correlation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.figure_of_correlation-2349"><a href="#FisherMatrix.figure_of_correlation-2349"><span class="linenos">2349</span></a>    <span class="k">def</span> <span class="nf">figure_of_correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="FisherMatrix.figure_of_correlation-2350"><a href="#FisherMatrix.figure_of_correlation-2350"><span class="linenos">2350</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.figure_of_correlation-2351"><a href="#FisherMatrix.figure_of_correlation-2351"><span class="linenos">2351</span></a><span class="sd">        Compute the figure of correlation (FoC).</span>
</span><span id="FisherMatrix.figure_of_correlation-2352"><a href="#FisherMatrix.figure_of_correlation-2352"><span class="linenos">2352</span></a>
</span><span id="FisherMatrix.figure_of_correlation-2353"><a href="#FisherMatrix.figure_of_correlation-2353"><span class="linenos">2353</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.figure_of_correlation-2354"><a href="#FisherMatrix.figure_of_correlation-2354"><span class="linenos">2354</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.figure_of_correlation-2355"><a href="#FisherMatrix.figure_of_correlation-2355"><span class="linenos">2355</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix.figure_of_correlation-2356"><a href="#FisherMatrix.figure_of_correlation-2356"><span class="linenos">2356</span></a><span class="sd">            any kwargs passed to `correlation_matrix`</span>
</span><span id="FisherMatrix.figure_of_correlation-2357"><a href="#FisherMatrix.figure_of_correlation-2357"><span class="linenos">2357</span></a>
</span><span id="FisherMatrix.figure_of_correlation-2358"><a href="#FisherMatrix.figure_of_correlation-2358"><span class="linenos">2358</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.figure_of_correlation-2359"><a href="#FisherMatrix.figure_of_correlation-2359"><span class="linenos">2359</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.figure_of_correlation-2360"><a href="#FisherMatrix.figure_of_correlation-2360"><span class="linenos">2360</span></a><span class="sd">        float</span>
</span><span id="FisherMatrix.figure_of_correlation-2361"><a href="#FisherMatrix.figure_of_correlation-2361"><span class="linenos">2361</span></a>
</span><span id="FisherMatrix.figure_of_correlation-2362"><a href="#FisherMatrix.figure_of_correlation-2362"><span class="linenos">2362</span></a><span class="sd">        See Also</span>
</span><span id="FisherMatrix.figure_of_correlation-2363"><a href="#FisherMatrix.figure_of_correlation-2363"><span class="linenos">2363</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.figure_of_correlation-2364"><a href="#FisherMatrix.figure_of_correlation-2364"><span class="linenos">2364</span></a><span class="sd">        `correlation_matrix` : compute the correlation matrix</span>
</span><span id="FisherMatrix.figure_of_correlation-2365"><a href="#FisherMatrix.figure_of_correlation-2365"><span class="linenos">2365</span></a>
</span><span id="FisherMatrix.figure_of_correlation-2366"><a href="#FisherMatrix.figure_of_correlation-2366"><span class="linenos">2366</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix.figure_of_correlation-2367"><a href="#FisherMatrix.figure_of_correlation-2367"><span class="linenos">2367</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix.figure_of_correlation-2368"><a href="#FisherMatrix.figure_of_correlation-2368"><span class="linenos">2368</span></a><span class="sd">        The output is computed as:</span>
</span><span id="FisherMatrix.figure_of_correlation-2369"><a href="#FisherMatrix.figure_of_correlation-2369"><span class="linenos">2369</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.figure_of_correlation-2370"><a href="#FisherMatrix.figure_of_correlation-2370"><span class="linenos">2370</span></a><span class="sd">            \mathrm{FoC} \equiv - \frac{1}{2} \log \left[ \det \mathsf{P} \right]</span>
</span><span id="FisherMatrix.figure_of_correlation-2371"><a href="#FisherMatrix.figure_of_correlation-2371"><span class="linenos">2371</span></a><span class="sd">        $$</span>
</span><span id="FisherMatrix.figure_of_correlation-2372"><a href="#FisherMatrix.figure_of_correlation-2372"><span class="linenos">2372</span></a><span class="sd">        where $\mathsf{P}$ denotes the correlation matrix.</span>
</span><span id="FisherMatrix.figure_of_correlation-2373"><a href="#FisherMatrix.figure_of_correlation-2373"><span class="linenos">2373</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.figure_of_correlation-2374"><a href="#FisherMatrix.figure_of_correlation-2374"><span class="linenos">2374</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correlation_matrix</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
</span></pre></div>


            <div class="docstring"><p>Compute the figure of correlation (FoC).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>**kwargs</strong>: any kwargs passed to <code><a href="#FisherMatrix.correlation_matrix">correlation_matrix</a></code></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>float</strong></li>
</ul>

<h6 id="see-also">See Also</h6>

<p><code><a href="#FisherMatrix.correlation_matrix">correlation_matrix</a></code>:  compute the correlation matrix  </p>

<h6 id="notes">Notes</h6>

<p>The output is computed as:
$$
    \mathrm{FoC} \equiv - \frac{1}{2} \log \left[ \det \mathsf{P} \right]
$$
where $\mathsf{P}$ denotes the correlation matrix.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>