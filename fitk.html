<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.0.1"/>
    <title>fitk API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>


        <h2>Contents</h2>
        <ul>
  <li><a href="#notes">Notes</a></li>
</ul>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#FisherMatrix">FisherMatrix</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FisherMatrix.__init__">FisherMatrix</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.rename">rename</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.is_valid">is_valid</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.sort">sort</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.ndim">ndim</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.values">values</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.is_diagonal">is_diagonal</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.diagonal">diagonal</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.drop">drop</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.trace">trace</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.eigenvalues">eigenvalues</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.eigenvectors">eigenvectors</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.condition_number">condition_number</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.inverse">inverse</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.determinant">determinant</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.constraints">constraints</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.fiducials">fiducials</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.names">names</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherMatrix.latex_names">latex_names</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.reparametrize">reparametrize</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.to_file">to_file</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.marginalize_over">marginalize_over</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherMatrix.from_file">from_file</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FisherFigure1D">FisherFigure1D</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#FisherFigure2D">FisherFigure2D</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#FisherPlotter">FisherPlotter</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FisherPlotter.__init__">FisherPlotter</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherPlotter.values">values</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherPlotter.labels">labels</a>
                        </li>
                        <li>
                                <a class="variable" href="#FisherPlotter.ylabel1d">ylabel1d</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherPlotter.plot_1d">plot_1d</a>
                        </li>
                        <li>
                                <a class="function" href="#FisherPlotter.plot_triangle">plot_triangle</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#bayes_factor">bayes_factor</a>
            </li>
            <li>
                    <a class="function" href="#kl_divergence">kl_divergence</a>
            </li>
            <li>
                    <a class="function" href="#plot_curve_1d">plot_curve_1d</a>
            </li>
            <li>
                    <a class="function" href="#plot_curve_2d">plot_curve_2d</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
fitk    </h1>

                        <div class="docstring"><p>FITK - Fisher Information ToolKit</p>

<p>A Python package for manipulating and plotting Fisher-like objects.</p>

<h2 id="notes">Notes</h2>

<p>Througout the documentation, it is assumed that the modules are imported in the
following way:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fitk</span> <span class="kn">import</span> <span class="n">FisherMatrix</span><span class="p">,</span> <span class="n">FisherPlotter</span>
</code></pre></div>
</div>

                        <input id="fitk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="fitk-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">FITK - Fisher Information ToolKit</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="sd">A Python package for manipulating and plotting Fisher-like objects.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="sd">Notes</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="sd">--------</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="sd">Througout the documentation, it is assumed that the modules are imported in the</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">following way:</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="sd">&gt;&gt;&gt; import numpy as np</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="sd">&gt;&gt;&gt; from fitk import FisherMatrix, FisherPlotter</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>    <span class="s2">&quot;FisherMatrix&quot;</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a>    <span class="s2">&quot;FisherFigure1D&quot;</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a>    <span class="s2">&quot;FisherFigure2D&quot;</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a>    <span class="s2">&quot;FisherPlotter&quot;</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a>    <span class="s2">&quot;bayes_factor&quot;</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a>    <span class="s2">&quot;kl_divergence&quot;</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>    <span class="s2">&quot;plot_curve_1d&quot;</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a>    <span class="s2">&quot;plot_curve_2d&quot;</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="p">]</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="kn">from</span> <span class="nn">fitk.fisher_matrix</span> <span class="kn">import</span> <span class="n">FisherMatrix</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="kn">from</span> <span class="nn">fitk.fisher_operations</span> <span class="kn">import</span> <span class="n">bayes_factor</span><span class="p">,</span> <span class="n">kl_divergence</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="kn">from</span> <span class="nn">fitk.fisher_plotter</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>    <span class="n">FisherFigure1D</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>    <span class="n">FisherFigure2D</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>    <span class="n">FisherPlotter</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>    <span class="n">plot_curve_1d</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="n">plot_curve_2d</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="FisherMatrix">
                            <input id="FisherMatrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FisherMatrix</span>:

                <label class="view-source-button" for="FisherMatrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix-56"><a href="#FisherMatrix-56"><span class="linenos">  56</span></a><span class="k">class</span> <span class="nc">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-57"><a href="#FisherMatrix-57"><span class="linenos">  57</span></a>    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-58"><a href="#FisherMatrix-58"><span class="linenos">  58</span></a><span class="sd">    Class for handling Fisher objects.</span>
</span><span id="FisherMatrix-59"><a href="#FisherMatrix-59"><span class="linenos">  59</span></a>
</span><span id="FisherMatrix-60"><a href="#FisherMatrix-60"><span class="linenos">  60</span></a><span class="sd">    Examples</span>
</span><span id="FisherMatrix-61"><a href="#FisherMatrix-61"><span class="linenos">  61</span></a><span class="sd">    --------</span>
</span><span id="FisherMatrix-62"><a href="#FisherMatrix-62"><span class="linenos">  62</span></a><span class="sd">    Specify a Fisher object with default names and fiducials:</span>
</span><span id="FisherMatrix-63"><a href="#FisherMatrix-63"><span class="linenos">  63</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]))</span>
</span><span id="FisherMatrix-64"><a href="#FisherMatrix-64"><span class="linenos">  64</span></a>
</span><span id="FisherMatrix-65"><a href="#FisherMatrix-65"><span class="linenos">  65</span></a><span class="sd">    The object has a friendly representation in the interactive session:</span>
</span><span id="FisherMatrix-66"><a href="#FisherMatrix-66"><span class="linenos">  66</span></a><span class="sd">    &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix-67"><a href="#FisherMatrix-67"><span class="linenos">  67</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-68"><a href="#FisherMatrix-68"><span class="linenos">  68</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="FisherMatrix-69"><a href="#FisherMatrix-69"><span class="linenos">  69</span></a><span class="sd">           [0., 4.]]),</span>
</span><span id="FisherMatrix-70"><a href="#FisherMatrix-70"><span class="linenos">  70</span></a><span class="sd">        names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-71"><a href="#FisherMatrix-71"><span class="linenos">  71</span></a><span class="sd">        latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-72"><a href="#FisherMatrix-72"><span class="linenos">  72</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-73"><a href="#FisherMatrix-73"><span class="linenos">  73</span></a>
</span><span id="FisherMatrix-74"><a href="#FisherMatrix-74"><span class="linenos">  74</span></a><span class="sd">    List the names:</span>
</span><span id="FisherMatrix-75"><a href="#FisherMatrix-75"><span class="linenos">  75</span></a><span class="sd">    &gt;&gt;&gt; fm.names</span>
</span><span id="FisherMatrix-76"><a href="#FisherMatrix-76"><span class="linenos">  76</span></a><span class="sd">    array([&#39;p1&#39;, &#39;p2&#39;], dtype=object)</span>
</span><span id="FisherMatrix-77"><a href="#FisherMatrix-77"><span class="linenos">  77</span></a>
</span><span id="FisherMatrix-78"><a href="#FisherMatrix-78"><span class="linenos">  78</span></a><span class="sd">    List the values of the Fisher object:</span>
</span><span id="FisherMatrix-79"><a href="#FisherMatrix-79"><span class="linenos">  79</span></a><span class="sd">    &gt;&gt;&gt; fm.values</span>
</span><span id="FisherMatrix-80"><a href="#FisherMatrix-80"><span class="linenos">  80</span></a><span class="sd">    array([[5., 0.],</span>
</span><span id="FisherMatrix-81"><a href="#FisherMatrix-81"><span class="linenos">  81</span></a><span class="sd">           [0., 4.]])</span>
</span><span id="FisherMatrix-82"><a href="#FisherMatrix-82"><span class="linenos">  82</span></a>
</span><span id="FisherMatrix-83"><a href="#FisherMatrix-83"><span class="linenos">  83</span></a><span class="sd">    List the values of the fiducials:</span>
</span><span id="FisherMatrix-84"><a href="#FisherMatrix-84"><span class="linenos">  84</span></a><span class="sd">    &gt;&gt;&gt; fm.fiducials</span>
</span><span id="FisherMatrix-85"><a href="#FisherMatrix-85"><span class="linenos">  85</span></a><span class="sd">    array([0., 0.])</span>
</span><span id="FisherMatrix-86"><a href="#FisherMatrix-86"><span class="linenos">  86</span></a>
</span><span id="FisherMatrix-87"><a href="#FisherMatrix-87"><span class="linenos">  87</span></a><span class="sd">    Names can be changed in bulk (ditto for fiducials and values; dimension</span>
</span><span id="FisherMatrix-88"><a href="#FisherMatrix-88"><span class="linenos">  88</span></a><span class="sd">    must of course match the original):</span>
</span><span id="FisherMatrix-89"><a href="#FisherMatrix-89"><span class="linenos">  89</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]))</span>
</span><span id="FisherMatrix-90"><a href="#FisherMatrix-90"><span class="linenos">  90</span></a><span class="sd">    &gt;&gt;&gt; fm.names = [&#39;x&#39;, &#39;y&#39;]</span>
</span><span id="FisherMatrix-91"><a href="#FisherMatrix-91"><span class="linenos">  91</span></a><span class="sd">    &gt;&gt;&gt; fm.latex_names = [r&#39;$\mathbf{X}$&#39;, r&#39;$\mathbf{Y}$&#39;]</span>
</span><span id="FisherMatrix-92"><a href="#FisherMatrix-92"><span class="linenos">  92</span></a><span class="sd">    &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix-93"><a href="#FisherMatrix-93"><span class="linenos">  93</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-94"><a href="#FisherMatrix-94"><span class="linenos">  94</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="FisherMatrix-95"><a href="#FisherMatrix-95"><span class="linenos">  95</span></a><span class="sd">           [0., 4.]]),</span>
</span><span id="FisherMatrix-96"><a href="#FisherMatrix-96"><span class="linenos">  96</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-97"><a href="#FisherMatrix-97"><span class="linenos">  97</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-98"><a href="#FisherMatrix-98"><span class="linenos">  98</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-99"><a href="#FisherMatrix-99"><span class="linenos">  99</span></a>
</span><span id="FisherMatrix-100"><a href="#FisherMatrix-100"><span class="linenos"> 100</span></a><span class="sd">    We can get and set individual elements of the matrix using dict-like notation:</span>
</span><span id="FisherMatrix-101"><a href="#FisherMatrix-101"><span class="linenos"> 101</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]), names=[&#39;x&#39;, &#39;y&#39;])</span>
</span><span id="FisherMatrix-102"><a href="#FisherMatrix-102"><span class="linenos"> 102</span></a><span class="sd">    &gt;&gt;&gt; fm[&#39;x&#39;, &#39;x&#39;]</span>
</span><span id="FisherMatrix-103"><a href="#FisherMatrix-103"><span class="linenos"> 103</span></a><span class="sd">    5.0</span>
</span><span id="FisherMatrix-104"><a href="#FisherMatrix-104"><span class="linenos"> 104</span></a>
</span><span id="FisherMatrix-105"><a href="#FisherMatrix-105"><span class="linenos"> 105</span></a><span class="sd">    The off-diagonal elements are automatically updated when using the setter:</span>
</span><span id="FisherMatrix-106"><a href="#FisherMatrix-106"><span class="linenos"> 106</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]), names=[&#39;x&#39;, &#39;y&#39;])</span>
</span><span id="FisherMatrix-107"><a href="#FisherMatrix-107"><span class="linenos"> 107</span></a><span class="sd">    &gt;&gt;&gt; fm[&#39;x&#39;, &#39;y&#39;] = -2</span>
</span><span id="FisherMatrix-108"><a href="#FisherMatrix-108"><span class="linenos"> 108</span></a><span class="sd">    &gt;&gt;&gt; fm</span>
</span><span id="FisherMatrix-109"><a href="#FisherMatrix-109"><span class="linenos"> 109</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-110"><a href="#FisherMatrix-110"><span class="linenos"> 110</span></a><span class="sd">        array([[ 5., -2.],</span>
</span><span id="FisherMatrix-111"><a href="#FisherMatrix-111"><span class="linenos"> 111</span></a><span class="sd">           [-2.,  4.]]),</span>
</span><span id="FisherMatrix-112"><a href="#FisherMatrix-112"><span class="linenos"> 112</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-113"><a href="#FisherMatrix-113"><span class="linenos"> 113</span></a><span class="sd">        latex_names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-114"><a href="#FisherMatrix-114"><span class="linenos"> 114</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-115"><a href="#FisherMatrix-115"><span class="linenos"> 115</span></a>
</span><span id="FisherMatrix-116"><a href="#FisherMatrix-116"><span class="linenos"> 116</span></a><span class="sd">    We can select submatrices by index:</span>
</span><span id="FisherMatrix-117"><a href="#FisherMatrix-117"><span class="linenos"> 117</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 3]), names=[&#39;x&#39;, &#39;y&#39;, &#39;z&#39;])</span>
</span><span id="FisherMatrix-118"><a href="#FisherMatrix-118"><span class="linenos"> 118</span></a><span class="sd">    &gt;&gt;&gt; fm[1:]</span>
</span><span id="FisherMatrix-119"><a href="#FisherMatrix-119"><span class="linenos"> 119</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-120"><a href="#FisherMatrix-120"><span class="linenos"> 120</span></a><span class="sd">        array([[2., 0.],</span>
</span><span id="FisherMatrix-121"><a href="#FisherMatrix-121"><span class="linenos"> 121</span></a><span class="sd">           [0., 3.]]),</span>
</span><span id="FisherMatrix-122"><a href="#FisherMatrix-122"><span class="linenos"> 122</span></a><span class="sd">        names=array([&#39;y&#39;, &#39;z&#39;], dtype=object),</span>
</span><span id="FisherMatrix-123"><a href="#FisherMatrix-123"><span class="linenos"> 123</span></a><span class="sd">        latex_names=array([&#39;y&#39;, &#39;z&#39;], dtype=object),</span>
</span><span id="FisherMatrix-124"><a href="#FisherMatrix-124"><span class="linenos"> 124</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-125"><a href="#FisherMatrix-125"><span class="linenos"> 125</span></a>
</span><span id="FisherMatrix-126"><a href="#FisherMatrix-126"><span class="linenos"> 126</span></a><span class="sd">    Fisher object with parameter names:</span>
</span><span id="FisherMatrix-127"><a href="#FisherMatrix-127"><span class="linenos"> 127</span></a><span class="sd">    &gt;&gt;&gt; fm = FisherMatrix(np.diag([5, 4]),</span>
</span><span id="FisherMatrix-128"><a href="#FisherMatrix-128"><span class="linenos"> 128</span></a><span class="sd">    ... names=[&#39;x&#39;, &#39;y&#39;], latex_names=[&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;])</span>
</span><span id="FisherMatrix-129"><a href="#FisherMatrix-129"><span class="linenos"> 129</span></a><span class="sd">    &gt;&gt;&gt; fm_with_names = FisherMatrix(np.diag([1, 2]), names=[&#39;x&#39;, &#39;y&#39;])</span>
</span><span id="FisherMatrix-130"><a href="#FisherMatrix-130"><span class="linenos"> 130</span></a>
</span><span id="FisherMatrix-131"><a href="#FisherMatrix-131"><span class="linenos"> 131</span></a><span class="sd">    We can add Fisher objects (ordering of names is taken care of):</span>
</span><span id="FisherMatrix-132"><a href="#FisherMatrix-132"><span class="linenos"> 132</span></a><span class="sd">    &gt;&gt;&gt; fm + fm_with_names # doctest: +SKIP</span>
</span><span id="FisherMatrix-133"><a href="#FisherMatrix-133"><span class="linenos"> 133</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-134"><a href="#FisherMatrix-134"><span class="linenos"> 134</span></a><span class="sd">        array([[6., 0.],</span>
</span><span id="FisherMatrix-135"><a href="#FisherMatrix-135"><span class="linenos"> 135</span></a><span class="sd">           [0., 6.]]),</span>
</span><span id="FisherMatrix-136"><a href="#FisherMatrix-136"><span class="linenos"> 136</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-137"><a href="#FisherMatrix-137"><span class="linenos"> 137</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-138"><a href="#FisherMatrix-138"><span class="linenos"> 138</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-139"><a href="#FisherMatrix-139"><span class="linenos"> 139</span></a>
</span><span id="FisherMatrix-140"><a href="#FisherMatrix-140"><span class="linenos"> 140</span></a><span class="sd">    We can also do element-wise multiplication or division:</span>
</span><span id="FisherMatrix-141"><a href="#FisherMatrix-141"><span class="linenos"> 141</span></a><span class="sd">    &gt;&gt;&gt; fm * fm_with_names</span>
</span><span id="FisherMatrix-142"><a href="#FisherMatrix-142"><span class="linenos"> 142</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-143"><a href="#FisherMatrix-143"><span class="linenos"> 143</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="FisherMatrix-144"><a href="#FisherMatrix-144"><span class="linenos"> 144</span></a><span class="sd">           [0., 8.]]),</span>
</span><span id="FisherMatrix-145"><a href="#FisherMatrix-145"><span class="linenos"> 145</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-146"><a href="#FisherMatrix-146"><span class="linenos"> 146</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-147"><a href="#FisherMatrix-147"><span class="linenos"> 147</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-148"><a href="#FisherMatrix-148"><span class="linenos"> 148</span></a>
</span><span id="FisherMatrix-149"><a href="#FisherMatrix-149"><span class="linenos"> 149</span></a><span class="sd">    Furthermore, we can do matrix multiplication:</span>
</span><span id="FisherMatrix-150"><a href="#FisherMatrix-150"><span class="linenos"> 150</span></a><span class="sd">    &gt;&gt;&gt; fm @ fm_with_names</span>
</span><span id="FisherMatrix-151"><a href="#FisherMatrix-151"><span class="linenos"> 151</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-152"><a href="#FisherMatrix-152"><span class="linenos"> 152</span></a><span class="sd">        array([[5., 0.],</span>
</span><span id="FisherMatrix-153"><a href="#FisherMatrix-153"><span class="linenos"> 153</span></a><span class="sd">           [0., 8.]]),</span>
</span><span id="FisherMatrix-154"><a href="#FisherMatrix-154"><span class="linenos"> 154</span></a><span class="sd">        names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-155"><a href="#FisherMatrix-155"><span class="linenos"> 155</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-156"><a href="#FisherMatrix-156"><span class="linenos"> 156</span></a><span class="sd">        fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-157"><a href="#FisherMatrix-157"><span class="linenos"> 157</span></a>
</span><span id="FisherMatrix-158"><a href="#FisherMatrix-158"><span class="linenos"> 158</span></a><span class="sd">    We can also perform standard matrix operations like the trace, eigenvalues, determinant:</span>
</span><span id="FisherMatrix-159"><a href="#FisherMatrix-159"><span class="linenos"> 159</span></a><span class="sd">    &gt;&gt;&gt; fm.trace()</span>
</span><span id="FisherMatrix-160"><a href="#FisherMatrix-160"><span class="linenos"> 160</span></a><span class="sd">    9.0</span>
</span><span id="FisherMatrix-161"><a href="#FisherMatrix-161"><span class="linenos"> 161</span></a><span class="sd">    &gt;&gt;&gt; fm.eigenvalues()</span>
</span><span id="FisherMatrix-162"><a href="#FisherMatrix-162"><span class="linenos"> 162</span></a><span class="sd">    array([4., 5.])</span>
</span><span id="FisherMatrix-163"><a href="#FisherMatrix-163"><span class="linenos"> 163</span></a><span class="sd">    &gt;&gt;&gt; fm.determinant()</span>
</span><span id="FisherMatrix-164"><a href="#FisherMatrix-164"><span class="linenos"> 164</span></a><span class="sd">    19.999999999999996</span>
</span><span id="FisherMatrix-165"><a href="#FisherMatrix-165"><span class="linenos"> 165</span></a>
</span><span id="FisherMatrix-166"><a href="#FisherMatrix-166"><span class="linenos"> 166</span></a><span class="sd">    We can also get the inverse (the covariance matrix):</span>
</span><span id="FisherMatrix-167"><a href="#FisherMatrix-167"><span class="linenos"> 167</span></a><span class="sd">    &gt;&gt;&gt; fm.inverse()</span>
</span><span id="FisherMatrix-168"><a href="#FisherMatrix-168"><span class="linenos"> 168</span></a><span class="sd">    array([[0.2 , 0.  ],</span>
</span><span id="FisherMatrix-169"><a href="#FisherMatrix-169"><span class="linenos"> 169</span></a><span class="sd">           [0.  , 0.25]])</span>
</span><span id="FisherMatrix-170"><a href="#FisherMatrix-170"><span class="linenos"> 170</span></a>
</span><span id="FisherMatrix-171"><a href="#FisherMatrix-171"><span class="linenos"> 171</span></a><span class="sd">    We can drop parameters from the object:</span>
</span><span id="FisherMatrix-172"><a href="#FisherMatrix-172"><span class="linenos"> 172</span></a><span class="sd">    &gt;&gt;&gt; fm.drop(&#39;x&#39;)</span>
</span><span id="FisherMatrix-173"><a href="#FisherMatrix-173"><span class="linenos"> 173</span></a><span class="sd">    FisherMatrix(</span>
</span><span id="FisherMatrix-174"><a href="#FisherMatrix-174"><span class="linenos"> 174</span></a><span class="sd">        array([[4.]]),</span>
</span><span id="FisherMatrix-175"><a href="#FisherMatrix-175"><span class="linenos"> 175</span></a><span class="sd">        names=array([&#39;y&#39;], dtype=object),</span>
</span><span id="FisherMatrix-176"><a href="#FisherMatrix-176"><span class="linenos"> 176</span></a><span class="sd">        latex_names=array([&#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-177"><a href="#FisherMatrix-177"><span class="linenos"> 177</span></a><span class="sd">        fiducials=array([0.]))</span>
</span><span id="FisherMatrix-178"><a href="#FisherMatrix-178"><span class="linenos"> 178</span></a>
</span><span id="FisherMatrix-179"><a href="#FisherMatrix-179"><span class="linenos"> 179</span></a><span class="sd">    We can save it to a file (the returned value is the dictionary that was saved):</span>
</span><span id="FisherMatrix-180"><a href="#FisherMatrix-180"><span class="linenos"> 180</span></a><span class="sd">    &gt;&gt;&gt; pprint(fm.to_file(&#39;example_matrix.json&#39;), sort_dicts=False) # doctest: +SKIP</span>
</span><span id="FisherMatrix-181"><a href="#FisherMatrix-181"><span class="linenos"> 181</span></a><span class="sd">    {&#39;values&#39;: [[5.0, 0.0], [0.0, 4.0]],</span>
</span><span id="FisherMatrix-182"><a href="#FisherMatrix-182"><span class="linenos"> 182</span></a><span class="sd">     &#39;names&#39;: [&#39;x&#39;, &#39;y&#39;],</span>
</span><span id="FisherMatrix-183"><a href="#FisherMatrix-183"><span class="linenos"> 183</span></a><span class="sd">     &#39;latex_names&#39;: [&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;],</span>
</span><span id="FisherMatrix-184"><a href="#FisherMatrix-184"><span class="linenos"> 184</span></a><span class="sd">     &#39;fiducials&#39;: [0.0, 0.0]}</span>
</span><span id="FisherMatrix-185"><a href="#FisherMatrix-185"><span class="linenos"> 185</span></a>
</span><span id="FisherMatrix-186"><a href="#FisherMatrix-186"><span class="linenos"> 186</span></a><span class="sd">    Loading is performed by a class method `from_file`:</span>
</span><span id="FisherMatrix-187"><a href="#FisherMatrix-187"><span class="linenos"> 187</span></a><span class="sd">    &gt;&gt;&gt; fm_new = FisherMatrix.from_file(&#39;example_matrix.json&#39;)</span>
</span><span id="FisherMatrix-188"><a href="#FisherMatrix-188"><span class="linenos"> 188</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-189"><a href="#FisherMatrix-189"><span class="linenos"> 189</span></a>
</span><span id="FisherMatrix-190"><a href="#FisherMatrix-190"><span class="linenos"> 190</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FisherMatrix-191"><a href="#FisherMatrix-191"><span class="linenos"> 191</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-192"><a href="#FisherMatrix-192"><span class="linenos"> 192</span></a>        <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-193"><a href="#FisherMatrix-193"><span class="linenos"> 193</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-194"><a href="#FisherMatrix-194"><span class="linenos"> 194</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-195"><a href="#FisherMatrix-195"><span class="linenos"> 195</span></a>        <span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-196"><a href="#FisherMatrix-196"><span class="linenos"> 196</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-197"><a href="#FisherMatrix-197"><span class="linenos"> 197</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-198"><a href="#FisherMatrix-198"><span class="linenos"> 198</span></a><span class="sd">        Constructor for Fisher object.</span>
</span><span id="FisherMatrix-199"><a href="#FisherMatrix-199"><span class="linenos"> 199</span></a>
</span><span id="FisherMatrix-200"><a href="#FisherMatrix-200"><span class="linenos"> 200</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-201"><a href="#FisherMatrix-201"><span class="linenos"> 201</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-202"><a href="#FisherMatrix-202"><span class="linenos"> 202</span></a><span class="sd">        values : Collection</span>
</span><span id="FisherMatrix-203"><a href="#FisherMatrix-203"><span class="linenos"> 203</span></a><span class="sd">            The values of the Fisher object.</span>
</span><span id="FisherMatrix-204"><a href="#FisherMatrix-204"><span class="linenos"> 204</span></a>
</span><span id="FisherMatrix-205"><a href="#FisherMatrix-205"><span class="linenos"> 205</span></a><span class="sd">        names : Optional[Collection[str]] = None</span>
</span><span id="FisherMatrix-206"><a href="#FisherMatrix-206"><span class="linenos"> 206</span></a><span class="sd">            The names of the parameters.</span>
</span><span id="FisherMatrix-207"><a href="#FisherMatrix-207"><span class="linenos"> 207</span></a><span class="sd">            If not specified, defaults to `p1, ..., pn`.</span>
</span><span id="FisherMatrix-208"><a href="#FisherMatrix-208"><span class="linenos"> 208</span></a>
</span><span id="FisherMatrix-209"><a href="#FisherMatrix-209"><span class="linenos"> 209</span></a><span class="sd">        latex_names : Optional[Collection[str]] = None</span>
</span><span id="FisherMatrix-210"><a href="#FisherMatrix-210"><span class="linenos"> 210</span></a><span class="sd">            The LaTeX names of the parameters.</span>
</span><span id="FisherMatrix-211"><a href="#FisherMatrix-211"><span class="linenos"> 211</span></a><span class="sd">            If not specified, defaults to `names`.</span>
</span><span id="FisherMatrix-212"><a href="#FisherMatrix-212"><span class="linenos"> 212</span></a>
</span><span id="FisherMatrix-213"><a href="#FisherMatrix-213"><span class="linenos"> 213</span></a><span class="sd">        fiducials : Optional[Collection[float]] = None</span>
</span><span id="FisherMatrix-214"><a href="#FisherMatrix-214"><span class="linenos"> 214</span></a><span class="sd">            The fiducial values of the parameters. If not specified, default to</span>
</span><span id="FisherMatrix-215"><a href="#FisherMatrix-215"><span class="linenos"> 215</span></a><span class="sd">            0 for all parameters.</span>
</span><span id="FisherMatrix-216"><a href="#FisherMatrix-216"><span class="linenos"> 216</span></a>
</span><span id="FisherMatrix-217"><a href="#FisherMatrix-217"><span class="linenos"> 217</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix-218"><a href="#FisherMatrix-218"><span class="linenos"> 218</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix-219"><a href="#FisherMatrix-219"><span class="linenos"> 219</span></a><span class="sd">        * `ValueError` if the input array has the wrong dimensionality (not 2)</span>
</span><span id="FisherMatrix-220"><a href="#FisherMatrix-220"><span class="linenos"> 220</span></a><span class="sd">        * `ValueError` if the object is not square-like</span>
</span><span id="FisherMatrix-221"><a href="#FisherMatrix-221"><span class="linenos"> 221</span></a><span class="sd">        * `MismatchingSizeError` if the sizes of the array of names, values,</span>
</span><span id="FisherMatrix-222"><a href="#FisherMatrix-222"><span class="linenos"> 222</span></a><span class="sd">        LaTeX names and fiducials do not match</span>
</span><span id="FisherMatrix-223"><a href="#FisherMatrix-223"><span class="linenos"> 223</span></a>
</span><span id="FisherMatrix-224"><a href="#FisherMatrix-224"><span class="linenos"> 224</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-225"><a href="#FisherMatrix-225"><span class="linenos"> 225</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-226"><a href="#FisherMatrix-226"><span class="linenos"> 226</span></a><span class="sd">        Specify a Fisher object without names:</span>
</span><span id="FisherMatrix-227"><a href="#FisherMatrix-227"><span class="linenos"> 227</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix-228"><a href="#FisherMatrix-228"><span class="linenos"> 228</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-229"><a href="#FisherMatrix-229"><span class="linenos"> 229</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="FisherMatrix-230"><a href="#FisherMatrix-230"><span class="linenos"> 230</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix-231"><a href="#FisherMatrix-231"><span class="linenos"> 231</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix-232"><a href="#FisherMatrix-232"><span class="linenos"> 232</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-233"><a href="#FisherMatrix-233"><span class="linenos"> 233</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-234"><a href="#FisherMatrix-234"><span class="linenos"> 234</span></a><span class="sd">            fiducials=array([0., 0., 0.]))</span>
</span><span id="FisherMatrix-235"><a href="#FisherMatrix-235"><span class="linenos"> 235</span></a>
</span><span id="FisherMatrix-236"><a href="#FisherMatrix-236"><span class="linenos"> 236</span></a><span class="sd">        Specify a Fisher object with names, LaTeX names, and fiducials:</span>
</span><span id="FisherMatrix-237"><a href="#FisherMatrix-237"><span class="linenos"> 237</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([1, 2]), names=[&#39;alpha&#39;, &#39;beta&#39;],</span>
</span><span id="FisherMatrix-238"><a href="#FisherMatrix-238"><span class="linenos"> 238</span></a><span class="sd">        ... latex_names=[r&#39;$\alpha$&#39;, r&#39;$\beta$&#39;], fiducials=[-3, 2])</span>
</span><span id="FisherMatrix-239"><a href="#FisherMatrix-239"><span class="linenos"> 239</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-240"><a href="#FisherMatrix-240"><span class="linenos"> 240</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix-241"><a href="#FisherMatrix-241"><span class="linenos"> 241</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix-242"><a href="#FisherMatrix-242"><span class="linenos"> 242</span></a><span class="sd">            names=array([&#39;alpha&#39;, &#39;beta&#39;], dtype=object),</span>
</span><span id="FisherMatrix-243"><a href="#FisherMatrix-243"><span class="linenos"> 243</span></a><span class="sd">            latex_names=array([&#39;$\\alpha$&#39;, &#39;$\\beta$&#39;], dtype=object),</span>
</span><span id="FisherMatrix-244"><a href="#FisherMatrix-244"><span class="linenos"> 244</span></a><span class="sd">            fiducials=array([-3.,  2.]))</span>
</span><span id="FisherMatrix-245"><a href="#FisherMatrix-245"><span class="linenos"> 245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-246"><a href="#FisherMatrix-246"><span class="linenos"> 246</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="FisherMatrix-247"><a href="#FisherMatrix-247"><span class="linenos"> 247</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2"> is not 2-dimensional&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-248"><a href="#FisherMatrix-248"><span class="linenos"> 248</span></a>
</span><span id="FisherMatrix-249"><a href="#FisherMatrix-249"><span class="linenos"> 249</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
</span><span id="FisherMatrix-250"><a href="#FisherMatrix-250"><span class="linenos"> 250</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2"> is not square-like&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-251"><a href="#FisherMatrix-251"><span class="linenos"> 251</span></a>
</span><span id="FisherMatrix-252"><a href="#FisherMatrix-252"><span class="linenos"> 252</span></a>        <span class="c1"># try to treat it as an array-like object</span>
</span><span id="FisherMatrix-253"><a href="#FisherMatrix-253"><span class="linenos"> 253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix-254"><a href="#FisherMatrix-254"><span class="linenos"> 254</span></a>
</span><span id="FisherMatrix-255"><a href="#FisherMatrix-255"><span class="linenos"> 255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix-256"><a href="#FisherMatrix-256"><span class="linenos"> 256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ndim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="FisherMatrix-257"><a href="#FisherMatrix-257"><span class="linenos"> 257</span></a>
</span><span id="FisherMatrix-258"><a href="#FisherMatrix-258"><span class="linenos"> 258</span></a>        <span class="c1"># setting the fiducials</span>
</span><span id="FisherMatrix-259"><a href="#FisherMatrix-259"><span class="linenos"> 259</span></a>        <span class="k">if</span> <span class="n">fiducials</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-260"><a href="#FisherMatrix-260"><span class="linenos"> 260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix-261"><a href="#FisherMatrix-261"><span class="linenos"> 261</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-262"><a href="#FisherMatrix-262"><span class="linenos"> 262</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix-263"><a href="#FisherMatrix-263"><span class="linenos"> 263</span></a>
</span><span id="FisherMatrix-264"><a href="#FisherMatrix-264"><span class="linenos"> 264</span></a>        <span class="c1"># setting the names</span>
</span><span id="FisherMatrix-265"><a href="#FisherMatrix-265"><span class="linenos"> 265</span></a>        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-266"><a href="#FisherMatrix-266"><span class="linenos"> 266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">make_default_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>
</span><span id="FisherMatrix-267"><a href="#FisherMatrix-267"><span class="linenos"> 267</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-268"><a href="#FisherMatrix-268"><span class="linenos"> 268</span></a>            <span class="c1"># check they&#39;re unique</span>
</span><span id="FisherMatrix-269"><a href="#FisherMatrix-269"><span class="linenos"> 269</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-270"><a href="#FisherMatrix-270"><span class="linenos"> 270</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-271"><a href="#FisherMatrix-271"><span class="linenos"> 271</span></a>
</span><span id="FisherMatrix-272"><a href="#FisherMatrix-272"><span class="linenos"> 272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix-273"><a href="#FisherMatrix-273"><span class="linenos"> 273</span></a>
</span><span id="FisherMatrix-274"><a href="#FisherMatrix-274"><span class="linenos"> 274</span></a>        <span class="c1"># setting the pretty names (LaTeX)</span>
</span><span id="FisherMatrix-275"><a href="#FisherMatrix-275"><span class="linenos"> 275</span></a>        <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-276"><a href="#FisherMatrix-276"><span class="linenos"> 276</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">)</span>
</span><span id="FisherMatrix-277"><a href="#FisherMatrix-277"><span class="linenos"> 277</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-278"><a href="#FisherMatrix-278"><span class="linenos"> 278</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latex_names</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix-279"><a href="#FisherMatrix-279"><span class="linenos"> 279</span></a>
</span><span id="FisherMatrix-280"><a href="#FisherMatrix-280"><span class="linenos"> 280</span></a>        <span class="c1"># check sizes of inputs</span>
</span><span id="FisherMatrix-281"><a href="#FisherMatrix-281"><span class="linenos"> 281</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="FisherMatrix-282"><a href="#FisherMatrix-282"><span class="linenos"> 282</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span>
</span><span id="FisherMatrix-283"><a href="#FisherMatrix-283"><span class="linenos"> 283</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fiducial</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix-284"><a href="#FisherMatrix-284"><span class="linenos"> 284</span></a>        <span class="p">):</span>
</span><span id="FisherMatrix-285"><a href="#FisherMatrix-285"><span class="linenos"> 285</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span>
</span><span id="FisherMatrix-286"><a href="#FisherMatrix-286"><span class="linenos"> 286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="FisherMatrix-287"><a href="#FisherMatrix-287"><span class="linenos"> 287</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">,</span>
</span><span id="FisherMatrix-288"><a href="#FisherMatrix-288"><span class="linenos"> 288</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_fiducial</span><span class="p">,</span>
</span><span id="FisherMatrix-289"><a href="#FisherMatrix-289"><span class="linenos"> 289</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-290"><a href="#FisherMatrix-290"><span class="linenos"> 290</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-291"><a href="#FisherMatrix-291"><span class="linenos"> 291</span></a>
</span><span id="FisherMatrix-292"><a href="#FisherMatrix-292"><span class="linenos"> 292</span></a>    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
</span><span id="FisherMatrix-293"><a href="#FisherMatrix-293"><span class="linenos"> 293</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-294"><a href="#FisherMatrix-294"><span class="linenos"> 294</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">]],</span>
</span><span id="FisherMatrix-295"><a href="#FisherMatrix-295"><span class="linenos"> 295</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix-296"><a href="#FisherMatrix-296"><span class="linenos"> 296</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-297"><a href="#FisherMatrix-297"><span class="linenos"> 297</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-298"><a href="#FisherMatrix-298"><span class="linenos"> 298</span></a><span class="sd">        Returns a Fisher object with new names. This is primarily useful for</span>
</span><span id="FisherMatrix-299"><a href="#FisherMatrix-299"><span class="linenos"> 299</span></a><span class="sd">        renaming individual parameters.</span>
</span><span id="FisherMatrix-300"><a href="#FisherMatrix-300"><span class="linenos"> 300</span></a>
</span><span id="FisherMatrix-301"><a href="#FisherMatrix-301"><span class="linenos"> 301</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-302"><a href="#FisherMatrix-302"><span class="linenos"> 302</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-303"><a href="#FisherMatrix-303"><span class="linenos"> 303</span></a><span class="sd">        names : Mapping[str, Union[str, abc.Mapping]]</span>
</span><span id="FisherMatrix-304"><a href="#FisherMatrix-304"><span class="linenos"> 304</span></a><span class="sd">            a mapping (dictionary-like object) between the old names and the</span>
</span><span id="FisherMatrix-305"><a href="#FisherMatrix-305"><span class="linenos"> 305</span></a><span class="sd">            new ones. The values it maps to can either be a string (the new name), or a dict</span>
</span><span id="FisherMatrix-306"><a href="#FisherMatrix-306"><span class="linenos"> 306</span></a><span class="sd">            with keys `name`, `latex_name`, and `fiducial` (only `name` is mandatory).</span>
</span><span id="FisherMatrix-307"><a href="#FisherMatrix-307"><span class="linenos"> 307</span></a>
</span><span id="FisherMatrix-308"><a href="#FisherMatrix-308"><span class="linenos"> 308</span></a><span class="sd">        ignore_errors : bool = False</span>
</span><span id="FisherMatrix-309"><a href="#FisherMatrix-309"><span class="linenos"> 309</span></a><span class="sd">            if set to True, will not raise an error if a parameter doesn&#39;t exist</span>
</span><span id="FisherMatrix-310"><a href="#FisherMatrix-310"><span class="linenos"> 310</span></a>
</span><span id="FisherMatrix-311"><a href="#FisherMatrix-311"><span class="linenos"> 311</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-312"><a href="#FisherMatrix-312"><span class="linenos"> 312</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-313"><a href="#FisherMatrix-313"><span class="linenos"> 313</span></a><span class="sd">        Instance of `FisherMatrix`.</span>
</span><span id="FisherMatrix-314"><a href="#FisherMatrix-314"><span class="linenos"> 314</span></a>
</span><span id="FisherMatrix-315"><a href="#FisherMatrix-315"><span class="linenos"> 315</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-316"><a href="#FisherMatrix-316"><span class="linenos"> 316</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-317"><a href="#FisherMatrix-317"><span class="linenos"> 317</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix-318"><a href="#FisherMatrix-318"><span class="linenos"> 318</span></a><span class="sd">        &gt;&gt;&gt; m.rename({&#39;p1&#39; : &#39;a&#39;, &#39;p2&#39; : dict(name=&#39;b&#39;, latex_name=&#39;$b$&#39;, fiducial=2)})</span>
</span><span id="FisherMatrix-319"><a href="#FisherMatrix-319"><span class="linenos"> 319</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-320"><a href="#FisherMatrix-320"><span class="linenos"> 320</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="FisherMatrix-321"><a href="#FisherMatrix-321"><span class="linenos"> 321</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix-322"><a href="#FisherMatrix-322"><span class="linenos"> 322</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix-323"><a href="#FisherMatrix-323"><span class="linenos"> 323</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-324"><a href="#FisherMatrix-324"><span class="linenos"> 324</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;$b$&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-325"><a href="#FisherMatrix-325"><span class="linenos"> 325</span></a><span class="sd">            fiducials=array([0., 2., 0.]))</span>
</span><span id="FisherMatrix-326"><a href="#FisherMatrix-326"><span class="linenos"> 326</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-327"><a href="#FisherMatrix-327"><span class="linenos"> 327</span></a>        <span class="c1"># check uniqueness and size</span>
</span><span id="FisherMatrix-328"><a href="#FisherMatrix-328"><span class="linenos"> 328</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-329"><a href="#FisherMatrix-329"><span class="linenos"> 329</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-330"><a href="#FisherMatrix-330"><span class="linenos"> 330</span></a>
</span><span id="FisherMatrix-331"><a href="#FisherMatrix-331"><span class="linenos"> 331</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_errors</span><span class="p">:</span>
</span><span id="FisherMatrix-332"><a href="#FisherMatrix-332"><span class="linenos"> 332</span></a>            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-333"><a href="#FisherMatrix-333"><span class="linenos"> 333</span></a>                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-334"><a href="#FisherMatrix-334"><span class="linenos"> 334</span></a>                    <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-335"><a href="#FisherMatrix-335"><span class="linenos"> 335</span></a>
</span><span id="FisherMatrix-336"><a href="#FisherMatrix-336"><span class="linenos"> 336</span></a>        <span class="n">names_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-337"><a href="#FisherMatrix-337"><span class="linenos"> 337</span></a>        <span class="n">latex_names_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix-338"><a href="#FisherMatrix-338"><span class="linenos"> 338</span></a>        <span class="n">fiducial_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix-339"><a href="#FisherMatrix-339"><span class="linenos"> 339</span></a>
</span><span id="FisherMatrix-340"><a href="#FisherMatrix-340"><span class="linenos"> 340</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="FisherMatrix-341"><a href="#FisherMatrix-341"><span class="linenos"> 341</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">names_new</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span>
</span><span id="FisherMatrix-342"><a href="#FisherMatrix-342"><span class="linenos"> 342</span></a>            <span class="c1"># it&#39;s a mapping</span>
</span><span id="FisherMatrix-343"><a href="#FisherMatrix-343"><span class="linenos"> 343</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
</span><span id="FisherMatrix-344"><a href="#FisherMatrix-344"><span class="linenos"> 344</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">_process_fisher_mapping</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="FisherMatrix-345"><a href="#FisherMatrix-345"><span class="linenos"> 345</span></a>                <span class="n">latex_names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;latex_name&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix-346"><a href="#FisherMatrix-346"><span class="linenos"> 346</span></a>                <span class="n">fiducial_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;fiducial&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix-347"><a href="#FisherMatrix-347"><span class="linenos"> 347</span></a>                <span class="n">names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix-348"><a href="#FisherMatrix-348"><span class="linenos"> 348</span></a>            <span class="c1"># otherwise, it&#39;s a string</span>
</span><span id="FisherMatrix-349"><a href="#FisherMatrix-349"><span class="linenos"> 349</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-350"><a href="#FisherMatrix-350"><span class="linenos"> 350</span></a>                <span class="n">names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix-351"><a href="#FisherMatrix-351"><span class="linenos"> 351</span></a>                <span class="n">latex_names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix-352"><a href="#FisherMatrix-352"><span class="linenos"> 352</span></a>
</span><span id="FisherMatrix-353"><a href="#FisherMatrix-353"><span class="linenos"> 353</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-354"><a href="#FisherMatrix-354"><span class="linenos"> 354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-355"><a href="#FisherMatrix-355"><span class="linenos"> 355</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names_new</span><span class="p">,</span>
</span><span id="FisherMatrix-356"><a href="#FisherMatrix-356"><span class="linenos"> 356</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names_new</span><span class="p">,</span>
</span><span id="FisherMatrix-357"><a href="#FisherMatrix-357"><span class="linenos"> 357</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducial_new</span><span class="p">,</span>
</span><span id="FisherMatrix-358"><a href="#FisherMatrix-358"><span class="linenos"> 358</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-359"><a href="#FisherMatrix-359"><span class="linenos"> 359</span></a>
</span><span id="FisherMatrix-360"><a href="#FisherMatrix-360"><span class="linenos"> 360</span></a>    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-361"><a href="#FisherMatrix-361"><span class="linenos"> 361</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-362"><a href="#FisherMatrix-362"><span class="linenos"> 362</span></a><span class="sd">        Representation of the Fisher object suitable for viewing in Jupyter</span>
</span><span id="FisherMatrix-363"><a href="#FisherMatrix-363"><span class="linenos"> 363</span></a><span class="sd">        notebook environments.</span>
</span><span id="FisherMatrix-364"><a href="#FisherMatrix-364"><span class="linenos"> 364</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-365"><a href="#FisherMatrix-365"><span class="linenos"> 365</span></a>        <span class="n">header_matrix</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FisherMatrix-366"><a href="#FisherMatrix-366"><span class="linenos"> 366</span></a>            <span class="s2">&quot;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&quot;</span>
</span><span id="FisherMatrix-367"><a href="#FisherMatrix-367"><span class="linenos"> 367</span></a>            <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;&lt;th&gt;</span><span class="si">{}</span><span class="s2">&lt;/th&gt;&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix-368"><a href="#FisherMatrix-368"><span class="linenos"> 368</span></a>            <span class="o">+</span> <span class="s2">&quot;&lt;/tr&gt;&lt;/thead&gt;&quot;</span>
</span><span id="FisherMatrix-369"><a href="#FisherMatrix-369"><span class="linenos"> 369</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-370"><a href="#FisherMatrix-370"><span class="linenos"> 370</span></a>
</span><span id="FisherMatrix-371"><a href="#FisherMatrix-371"><span class="linenos"> 371</span></a>        <span class="n">body_matrix</span> <span class="o">=</span> <span class="s2">&quot;&lt;tbody&gt;&quot;</span>
</span><span id="FisherMatrix-372"><a href="#FisherMatrix-372"><span class="linenos"> 372</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">):</span>
</span><span id="FisherMatrix-373"><a href="#FisherMatrix-373"><span class="linenos"> 373</span></a>            <span class="n">body_matrix</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="FisherMatrix-374"><a href="#FisherMatrix-374"><span class="linenos"> 374</span></a>                <span class="sa">f</span><span class="s2">&quot;&lt;tr&gt;&lt;th&gt;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&lt;/th&gt;&quot;</span>
</span><span id="FisherMatrix-375"><a href="#FisherMatrix-375"><span class="linenos"> 375</span></a>                <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;&lt;td&gt;</span><span class="si">{:.3f}</span><span class="s2">&lt;/td&gt;&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]))</span>
</span><span id="FisherMatrix-376"><a href="#FisherMatrix-376"><span class="linenos"> 376</span></a>                <span class="o">+</span> <span class="s2">&quot;&lt;/tr&gt;&quot;</span>
</span><span id="FisherMatrix-377"><a href="#FisherMatrix-377"><span class="linenos"> 377</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-378"><a href="#FisherMatrix-378"><span class="linenos"> 378</span></a>        <span class="n">body_matrix</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/tbody&gt;&quot;</span>
</span><span id="FisherMatrix-379"><a href="#FisherMatrix-379"><span class="linenos"> 379</span></a>
</span><span id="FisherMatrix-380"><a href="#FisherMatrix-380"><span class="linenos"> 380</span></a>        <span class="n">html_matrix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;table&gt;</span><span class="si">{</span><span class="n">header_matrix</span><span class="si">}{</span><span class="n">body_matrix</span><span class="si">}</span><span class="s2">&lt;/table&gt;&quot;</span>
</span><span id="FisherMatrix-381"><a href="#FisherMatrix-381"><span class="linenos"> 381</span></a>
</span><span id="FisherMatrix-382"><a href="#FisherMatrix-382"><span class="linenos"> 382</span></a>        <span class="k">return</span> <span class="n">html_matrix</span>
</span><span id="FisherMatrix-383"><a href="#FisherMatrix-383"><span class="linenos"> 383</span></a>
</span><span id="FisherMatrix-384"><a href="#FisherMatrix-384"><span class="linenos"> 384</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-385"><a href="#FisherMatrix-385"><span class="linenos"> 385</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-386"><a href="#FisherMatrix-386"><span class="linenos"> 386</span></a><span class="sd">        Representation of the Fisher object for non-Jupyter interfaces.</span>
</span><span id="FisherMatrix-387"><a href="#FisherMatrix-387"><span class="linenos"> 387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-388"><a href="#FisherMatrix-388"><span class="linenos"> 388</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="FisherMatrix-389"><a href="#FisherMatrix-389"><span class="linenos"> 389</span></a>            <span class="s2">&quot;FisherMatrix(</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-390"><a href="#FisherMatrix-390"><span class="linenos"> 390</span></a>            <span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-391"><a href="#FisherMatrix-391"><span class="linenos"> 391</span></a>            <span class="sa">f</span><span class="s2">&quot;    names=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-392"><a href="#FisherMatrix-392"><span class="linenos"> 392</span></a>            <span class="sa">f</span><span class="s2">&quot;    latex_names=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-393"><a href="#FisherMatrix-393"><span class="linenos"> 393</span></a>            <span class="sa">f</span><span class="s2">&quot;    fiducials=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="FisherMatrix-394"><a href="#FisherMatrix-394"><span class="linenos"> 394</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-395"><a href="#FisherMatrix-395"><span class="linenos"> 395</span></a>
</span><span id="FisherMatrix-396"><a href="#FisherMatrix-396"><span class="linenos"> 396</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-397"><a href="#FisherMatrix-397"><span class="linenos"> 397</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-398"><a href="#FisherMatrix-398"><span class="linenos"> 398</span></a><span class="sd">        String representation of the Fisher object.</span>
</span><span id="FisherMatrix-399"><a href="#FisherMatrix-399"><span class="linenos"> 399</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-400"><a href="#FisherMatrix-400"><span class="linenos"> 400</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="FisherMatrix-401"><a href="#FisherMatrix-401"><span class="linenos"> 401</span></a>            <span class="s2">&quot;FisherMatrix(</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-402"><a href="#FisherMatrix-402"><span class="linenos"> 402</span></a>            <span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-403"><a href="#FisherMatrix-403"><span class="linenos"> 403</span></a>            <span class="sa">f</span><span class="s2">&quot;    names=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-404"><a href="#FisherMatrix-404"><span class="linenos"> 404</span></a>            <span class="sa">f</span><span class="s2">&quot;    latex_names=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="FisherMatrix-405"><a href="#FisherMatrix-405"><span class="linenos"> 405</span></a>            <span class="sa">f</span><span class="s2">&quot;    fiducials=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="FisherMatrix-406"><a href="#FisherMatrix-406"><span class="linenos"> 406</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-407"><a href="#FisherMatrix-407"><span class="linenos"> 407</span></a>
</span><span id="FisherMatrix-408"><a href="#FisherMatrix-408"><span class="linenos"> 408</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span>
</span><span id="FisherMatrix-409"><a href="#FisherMatrix-409"><span class="linenos"> 409</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-410"><a href="#FisherMatrix-410"><span class="linenos"> 410</span></a>        <span class="n">keys</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">slice</span><span class="p">],</span>
</span><span id="FisherMatrix-411"><a href="#FisherMatrix-411"><span class="linenos"> 411</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-412"><a href="#FisherMatrix-412"><span class="linenos"> 412</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-413"><a href="#FisherMatrix-413"><span class="linenos"> 413</span></a><span class="sd">        Implements access to elements in the Fisher object.</span>
</span><span id="FisherMatrix-414"><a href="#FisherMatrix-414"><span class="linenos"> 414</span></a><span class="sd">        Has support for slicing.</span>
</span><span id="FisherMatrix-415"><a href="#FisherMatrix-415"><span class="linenos"> 415</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-416"><a href="#FisherMatrix-416"><span class="linenos"> 416</span></a>        <span class="c1"># the object can be sliced</span>
</span><span id="FisherMatrix-417"><a href="#FisherMatrix-417"><span class="linenos"> 417</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="FisherMatrix-418"><a href="#FisherMatrix-418"><span class="linenos"> 418</span></a>            <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="FisherMatrix-419"><a href="#FisherMatrix-419"><span class="linenos"> 419</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">),)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span>
</span><span id="FisherMatrix-420"><a href="#FisherMatrix-420"><span class="linenos"> 420</span></a>            <span class="n">sl</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
</span><span id="FisherMatrix-421"><a href="#FisherMatrix-421"><span class="linenos"> 421</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="FisherMatrix-422"><a href="#FisherMatrix-422"><span class="linenos"> 422</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
</span><span id="FisherMatrix-423"><a href="#FisherMatrix-423"><span class="linenos"> 423</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
</span><span id="FisherMatrix-424"><a href="#FisherMatrix-424"><span class="linenos"> 424</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
</span><span id="FisherMatrix-425"><a href="#FisherMatrix-425"><span class="linenos"> 425</span></a>
</span><span id="FisherMatrix-426"><a href="#FisherMatrix-426"><span class="linenos"> 426</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-427"><a href="#FisherMatrix-427"><span class="linenos"> 427</span></a>                <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-428"><a href="#FisherMatrix-428"><span class="linenos"> 428</span></a>                <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-429"><a href="#FisherMatrix-429"><span class="linenos"> 429</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-430"><a href="#FisherMatrix-430"><span class="linenos"> 430</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-431"><a href="#FisherMatrix-431"><span class="linenos"> 431</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-432"><a href="#FisherMatrix-432"><span class="linenos"> 432</span></a>
</span><span id="FisherMatrix-433"><a href="#FisherMatrix-433"><span class="linenos"> 433</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FisherMatrix-434"><a href="#FisherMatrix-434"><span class="linenos"> 434</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</span><span id="FisherMatrix-435"><a href="#FisherMatrix-435"><span class="linenos"> 435</span></a>        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="FisherMatrix-436"><a href="#FisherMatrix-436"><span class="linenos"> 436</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="FisherMatrix-437"><a href="#FisherMatrix-437"><span class="linenos"> 437</span></a>
</span><span id="FisherMatrix-438"><a href="#FisherMatrix-438"><span class="linenos"> 438</span></a>        <span class="c1"># the keys can be a tuple</span>
</span><span id="FisherMatrix-439"><a href="#FisherMatrix-439"><span class="linenos"> 439</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="FisherMatrix-440"><a href="#FisherMatrix-440"><span class="linenos"> 440</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="FisherMatrix-441"><a href="#FisherMatrix-441"><span class="linenos"> 441</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> arguments, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-442"><a href="#FisherMatrix-442"><span class="linenos"> 442</span></a>
</span><span id="FisherMatrix-443"><a href="#FisherMatrix-443"><span class="linenos"> 443</span></a>            <span class="c1"># error checking</span>
</span><span id="FisherMatrix-444"><a href="#FisherMatrix-444"><span class="linenos"> 444</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="FisherMatrix-445"><a href="#FisherMatrix-445"><span class="linenos"> 445</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-446"><a href="#FisherMatrix-446"><span class="linenos"> 446</span></a>                    <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-447"><a href="#FisherMatrix-447"><span class="linenos"> 447</span></a>
</span><span id="FisherMatrix-448"><a href="#FisherMatrix-448"><span class="linenos"> 448</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
</span><span id="FisherMatrix-449"><a href="#FisherMatrix-449"><span class="linenos"> 449</span></a>
</span><span id="FisherMatrix-450"><a href="#FisherMatrix-450"><span class="linenos"> 450</span></a>        <span class="c1"># otherwise, it&#39;s some generic object</span>
</span><span id="FisherMatrix-451"><a href="#FisherMatrix-451"><span class="linenos"> 451</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-452"><a href="#FisherMatrix-452"><span class="linenos"> 452</span></a>            <span class="k">if</span> <span class="n">keys</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-453"><a href="#FisherMatrix-453"><span class="linenos"> 453</span></a>                <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-454"><a href="#FisherMatrix-454"><span class="linenos"> 454</span></a>
</span><span id="FisherMatrix-455"><a href="#FisherMatrix-455"><span class="linenos"> 455</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">keys</span><span class="p">),)</span>
</span><span id="FisherMatrix-456"><a href="#FisherMatrix-456"><span class="linenos"> 456</span></a>
</span><span id="FisherMatrix-457"><a href="#FisherMatrix-457"><span class="linenos"> 457</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">indices</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix-458"><a href="#FisherMatrix-458"><span class="linenos"> 458</span></a>
</span><span id="FisherMatrix-459"><a href="#FisherMatrix-459"><span class="linenos"> 459</span></a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span>
</span><span id="FisherMatrix-460"><a href="#FisherMatrix-460"><span class="linenos"> 460</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-461"><a href="#FisherMatrix-461"><span class="linenos"> 461</span></a>        <span class="n">keys</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="FisherMatrix-462"><a href="#FisherMatrix-462"><span class="linenos"> 462</span></a>        <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="FisherMatrix-463"><a href="#FisherMatrix-463"><span class="linenos"> 463</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-464"><a href="#FisherMatrix-464"><span class="linenos"> 464</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-465"><a href="#FisherMatrix-465"><span class="linenos"> 465</span></a><span class="sd">        Implements setting of elements in the Fisher object.</span>
</span><span id="FisherMatrix-466"><a href="#FisherMatrix-466"><span class="linenos"> 466</span></a><span class="sd">        Does not support slicing.</span>
</span><span id="FisherMatrix-467"><a href="#FisherMatrix-467"><span class="linenos"> 467</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-468"><a href="#FisherMatrix-468"><span class="linenos"> 468</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FisherMatrix-469"><a href="#FisherMatrix-469"><span class="linenos"> 469</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</span><span id="FisherMatrix-470"><a href="#FisherMatrix-470"><span class="linenos"> 470</span></a>        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="FisherMatrix-471"><a href="#FisherMatrix-471"><span class="linenos"> 471</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="FisherMatrix-472"><a href="#FisherMatrix-472"><span class="linenos"> 472</span></a>
</span><span id="FisherMatrix-473"><a href="#FisherMatrix-473"><span class="linenos"> 473</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="FisherMatrix-474"><a href="#FisherMatrix-474"><span class="linenos"> 474</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Got length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-475"><a href="#FisherMatrix-475"><span class="linenos"> 475</span></a>
</span><span id="FisherMatrix-476"><a href="#FisherMatrix-476"><span class="linenos"> 476</span></a>        <span class="c1"># automatically raises a value error</span>
</span><span id="FisherMatrix-477"><a href="#FisherMatrix-477"><span class="linenos"> 477</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
</span><span id="FisherMatrix-478"><a href="#FisherMatrix-478"><span class="linenos"> 478</span></a>
</span><span id="FisherMatrix-479"><a href="#FisherMatrix-479"><span class="linenos"> 479</span></a>        <span class="n">temp_data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="FisherMatrix-480"><a href="#FisherMatrix-480"><span class="linenos"> 480</span></a>
</span><span id="FisherMatrix-481"><a href="#FisherMatrix-481"><span class="linenos"> 481</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">):</span>
</span><span id="FisherMatrix-482"><a href="#FisherMatrix-482"><span class="linenos"> 482</span></a>            <span class="k">for</span> <span class="n">permutation</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">permutations</span><span class="p">(</span><span class="n">indices</span><span class="p">)):</span>
</span><span id="FisherMatrix-483"><a href="#FisherMatrix-483"><span class="linenos"> 483</span></a>                <span class="c1"># update all symmetric parts</span>
</span><span id="FisherMatrix-484"><a href="#FisherMatrix-484"><span class="linenos"> 484</span></a>                <span class="n">temp_data</span><span class="p">[</span><span class="n">permutation</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix-485"><a href="#FisherMatrix-485"><span class="linenos"> 485</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-486"><a href="#FisherMatrix-486"><span class="linenos"> 486</span></a>            <span class="n">temp_data</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix-487"><a href="#FisherMatrix-487"><span class="linenos"> 487</span></a>
</span><span id="FisherMatrix-488"><a href="#FisherMatrix-488"><span class="linenos"> 488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span>
</span><span id="FisherMatrix-489"><a href="#FisherMatrix-489"><span class="linenos"> 489</span></a>
</span><span id="FisherMatrix-490"><a href="#FisherMatrix-490"><span class="linenos"> 490</span></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-491"><a href="#FisherMatrix-491"><span class="linenos"> 491</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-492"><a href="#FisherMatrix-492"><span class="linenos"> 492</span></a><span class="sd">        Checks whether the values make a valid Fisher object.</span>
</span><span id="FisherMatrix-493"><a href="#FisherMatrix-493"><span class="linenos"> 493</span></a><span class="sd">        A (square) matrix is a Fisher matrix if it satisifies the following two</span>
</span><span id="FisherMatrix-494"><a href="#FisherMatrix-494"><span class="linenos"> 494</span></a><span class="sd">        criteria:</span>
</span><span id="FisherMatrix-495"><a href="#FisherMatrix-495"><span class="linenos"> 495</span></a>
</span><span id="FisherMatrix-496"><a href="#FisherMatrix-496"><span class="linenos"> 496</span></a><span class="sd">        * it is symmetric</span>
</span><span id="FisherMatrix-497"><a href="#FisherMatrix-497"><span class="linenos"> 497</span></a><span class="sd">        * it is positive semi-definite</span>
</span><span id="FisherMatrix-498"><a href="#FisherMatrix-498"><span class="linenos"> 498</span></a>
</span><span id="FisherMatrix-499"><a href="#FisherMatrix-499"><span class="linenos"> 499</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-500"><a href="#FisherMatrix-500"><span class="linenos"> 500</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-501"><a href="#FisherMatrix-501"><span class="linenos"> 501</span></a><span class="sd">        `True` or `False`</span>
</span><span id="FisherMatrix-502"><a href="#FisherMatrix-502"><span class="linenos"> 502</span></a>
</span><span id="FisherMatrix-503"><a href="#FisherMatrix-503"><span class="linenos"> 503</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-504"><a href="#FisherMatrix-504"><span class="linenos"> 504</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-505"><a href="#FisherMatrix-505"><span class="linenos"> 505</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix-506"><a href="#FisherMatrix-506"><span class="linenos"> 506</span></a><span class="sd">        &gt;&gt;&gt; m.is_valid()</span>
</span><span id="FisherMatrix-507"><a href="#FisherMatrix-507"><span class="linenos"> 507</span></a><span class="sd">        True</span>
</span><span id="FisherMatrix-508"><a href="#FisherMatrix-508"><span class="linenos"> 508</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([-1, 3])).is_valid()</span>
</span><span id="FisherMatrix-509"><a href="#FisherMatrix-509"><span class="linenos"> 509</span></a><span class="sd">        False</span>
</span><span id="FisherMatrix-510"><a href="#FisherMatrix-510"><span class="linenos"> 510</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-511"><a href="#FisherMatrix-511"><span class="linenos"> 511</span></a>        <span class="k">return</span> <span class="n">is_symmetric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_positive_semidefinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-512"><a href="#FisherMatrix-512"><span class="linenos"> 512</span></a>
</span><span id="FisherMatrix-513"><a href="#FisherMatrix-513"><span class="linenos"> 513</span></a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span>
</span><span id="FisherMatrix-514"><a href="#FisherMatrix-514"><span class="linenos"> 514</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-515"><a href="#FisherMatrix-515"><span class="linenos"> 515</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-516"><a href="#FisherMatrix-516"><span class="linenos"> 516</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-517"><a href="#FisherMatrix-517"><span class="linenos"> 517</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-518"><a href="#FisherMatrix-518"><span class="linenos"> 518</span></a><span class="sd">        Sorts the Fisher object by name according to some criterion.</span>
</span><span id="FisherMatrix-519"><a href="#FisherMatrix-519"><span class="linenos"> 519</span></a>
</span><span id="FisherMatrix-520"><a href="#FisherMatrix-520"><span class="linenos"> 520</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-521"><a href="#FisherMatrix-521"><span class="linenos"> 521</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-522"><a href="#FisherMatrix-522"><span class="linenos"> 522</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix-523"><a href="#FisherMatrix-523"><span class="linenos"> 523</span></a><span class="sd">            all of the other keyword arguments for the Python builtin `sorted`.</span>
</span><span id="FisherMatrix-524"><a href="#FisherMatrix-524"><span class="linenos"> 524</span></a><span class="sd">            If none are specified, will sort according to the names of the parameters.</span>
</span><span id="FisherMatrix-525"><a href="#FisherMatrix-525"><span class="linenos"> 525</span></a><span class="sd">            In the special case that the value of the keyword `key` is set to</span>
</span><span id="FisherMatrix-526"><a href="#FisherMatrix-526"><span class="linenos"> 526</span></a><span class="sd">            either `&#39;fiducials&#39;` or `&#39;latex_names&#39;`, it will sort according to those.</span>
</span><span id="FisherMatrix-527"><a href="#FisherMatrix-527"><span class="linenos"> 527</span></a><span class="sd">            In the second special case that the value of the keyword `key` is</span>
</span><span id="FisherMatrix-528"><a href="#FisherMatrix-528"><span class="linenos"> 528</span></a><span class="sd">            set to an array of integers of equal size as the Fisher object, sorts them</span>
</span><span id="FisherMatrix-529"><a href="#FisherMatrix-529"><span class="linenos"> 529</span></a><span class="sd">            according to those instead.</span>
</span><span id="FisherMatrix-530"><a href="#FisherMatrix-530"><span class="linenos"> 530</span></a><span class="sd">            In the third (and final) special case that the value of the keyword</span>
</span><span id="FisherMatrix-531"><a href="#FisherMatrix-531"><span class="linenos"> 531</span></a><span class="sd">            `key` is set to an array strings matching those of parameter names</span>
</span><span id="FisherMatrix-532"><a href="#FisherMatrix-532"><span class="linenos"> 532</span></a><span class="sd">            of the FisherMatrix, the items are sorted according to those</span>
</span><span id="FisherMatrix-533"><a href="#FisherMatrix-533"><span class="linenos"> 533</span></a><span class="sd">            values.</span>
</span><span id="FisherMatrix-534"><a href="#FisherMatrix-534"><span class="linenos"> 534</span></a>
</span><span id="FisherMatrix-535"><a href="#FisherMatrix-535"><span class="linenos"> 535</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-536"><a href="#FisherMatrix-536"><span class="linenos"> 536</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-537"><a href="#FisherMatrix-537"><span class="linenos"> 537</span></a><span class="sd">        Instance of `FisherMatrix`.</span>
</span><span id="FisherMatrix-538"><a href="#FisherMatrix-538"><span class="linenos"> 538</span></a>
</span><span id="FisherMatrix-539"><a href="#FisherMatrix-539"><span class="linenos"> 539</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-540"><a href="#FisherMatrix-540"><span class="linenos"> 540</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-541"><a href="#FisherMatrix-541"><span class="linenos"> 541</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([3, 1, 2]), names=list(&#39;sdf&#39;),</span>
</span><span id="FisherMatrix-542"><a href="#FisherMatrix-542"><span class="linenos"> 542</span></a><span class="sd">        ... latex_names=[&#39;hjkl&#39;, &#39;qwe&#39;, &#39;ll&#39;], fiducials=[8, 7, 3])</span>
</span><span id="FisherMatrix-543"><a href="#FisherMatrix-543"><span class="linenos"> 543</span></a><span class="sd">        &gt;&gt;&gt; m.sort(key=&#39;fiducials&#39;)</span>
</span><span id="FisherMatrix-544"><a href="#FisherMatrix-544"><span class="linenos"> 544</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-545"><a href="#FisherMatrix-545"><span class="linenos"> 545</span></a><span class="sd">            array([[2., 0., 0.],</span>
</span><span id="FisherMatrix-546"><a href="#FisherMatrix-546"><span class="linenos"> 546</span></a><span class="sd">               [0., 1., 0.],</span>
</span><span id="FisherMatrix-547"><a href="#FisherMatrix-547"><span class="linenos"> 547</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix-548"><a href="#FisherMatrix-548"><span class="linenos"> 548</span></a><span class="sd">            names=array([&#39;f&#39;, &#39;d&#39;, &#39;s&#39;], dtype=object),</span>
</span><span id="FisherMatrix-549"><a href="#FisherMatrix-549"><span class="linenos"> 549</span></a><span class="sd">            latex_names=array([&#39;ll&#39;, &#39;qwe&#39;, &#39;hjkl&#39;], dtype=object),</span>
</span><span id="FisherMatrix-550"><a href="#FisherMatrix-550"><span class="linenos"> 550</span></a><span class="sd">            fiducials=array([3., 7., 8.]))</span>
</span><span id="FisherMatrix-551"><a href="#FisherMatrix-551"><span class="linenos"> 551</span></a><span class="sd">        &gt;&gt;&gt; m.sort(key=&#39;latex_names&#39;)</span>
</span><span id="FisherMatrix-552"><a href="#FisherMatrix-552"><span class="linenos"> 552</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-553"><a href="#FisherMatrix-553"><span class="linenos"> 553</span></a><span class="sd">            array([[3., 0., 0.],</span>
</span><span id="FisherMatrix-554"><a href="#FisherMatrix-554"><span class="linenos"> 554</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix-555"><a href="#FisherMatrix-555"><span class="linenos"> 555</span></a><span class="sd">               [0., 0., 1.]]),</span>
</span><span id="FisherMatrix-556"><a href="#FisherMatrix-556"><span class="linenos"> 556</span></a><span class="sd">            names=array([&#39;s&#39;, &#39;f&#39;, &#39;d&#39;], dtype=object),</span>
</span><span id="FisherMatrix-557"><a href="#FisherMatrix-557"><span class="linenos"> 557</span></a><span class="sd">            latex_names=array([&#39;hjkl&#39;, &#39;ll&#39;, &#39;qwe&#39;], dtype=object),</span>
</span><span id="FisherMatrix-558"><a href="#FisherMatrix-558"><span class="linenos"> 558</span></a><span class="sd">            fiducials=array([8., 3., 7.]))</span>
</span><span id="FisherMatrix-559"><a href="#FisherMatrix-559"><span class="linenos"> 559</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-560"><a href="#FisherMatrix-560"><span class="linenos"> 560</span></a>        <span class="n">allowed_keys</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;fiducials&quot;</span><span class="p">,</span> <span class="s2">&quot;latex_names&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-561"><a href="#FisherMatrix-561"><span class="linenos"> 561</span></a>        <span class="c1"># an integer index</span>
</span><span id="FisherMatrix-562"><a href="#FisherMatrix-562"><span class="linenos"> 562</span></a>        <span class="k">if</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="s2">&quot;__index__&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]):</span>
</span><span id="FisherMatrix-563"><a href="#FisherMatrix-563"><span class="linenos"> 563</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="FisherMatrix-564"><a href="#FisherMatrix-564"><span class="linenos"> 564</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-565"><a href="#FisherMatrix-565"><span class="linenos"> 565</span></a>        <span class="c1"># either &#39;fiducials&#39; or &#39;latex_names&#39;</span>
</span><span id="FisherMatrix-566"><a href="#FisherMatrix-566"><span class="linenos"> 566</span></a>        <span class="k">elif</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">allowed_keys</span><span class="p">:</span>
</span><span id="FisherMatrix-567"><a href="#FisherMatrix-567"><span class="linenos"> 567</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]))</span>
</span><span id="FisherMatrix-568"><a href="#FisherMatrix-568"><span class="linenos"> 568</span></a>            <span class="k">if</span> <span class="s2">&quot;reversed&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix-569"><a href="#FisherMatrix-569"><span class="linenos"> 569</span></a>                <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-570"><a href="#FisherMatrix-570"><span class="linenos"> 570</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-571"><a href="#FisherMatrix-571"><span class="linenos"> 571</span></a>        <span class="c1"># the names themselves, in any order</span>
</span><span id="FisherMatrix-572"><a href="#FisherMatrix-572"><span class="linenos"> 572</span></a>        <span class="k">elif</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-573"><a href="#FisherMatrix-573"><span class="linenos"> 573</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
</span><span id="FisherMatrix-574"><a href="#FisherMatrix-574"><span class="linenos"> 574</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-575"><a href="#FisherMatrix-575"><span class="linenos"> 575</span></a>        <span class="c1"># something that can be passed to `sorted`</span>
</span><span id="FisherMatrix-576"><a href="#FisherMatrix-576"><span class="linenos"> 576</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-577"><a href="#FisherMatrix-577"><span class="linenos"> 577</span></a>            <span class="k">if</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]):</span>
</span><span id="FisherMatrix-578"><a href="#FisherMatrix-578"><span class="linenos"> 578</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`key=</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">` is not callable&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-579"><a href="#FisherMatrix-579"><span class="linenos"> 579</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="FisherMatrix-580"><a href="#FisherMatrix-580"><span class="linenos"> 580</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-581"><a href="#FisherMatrix-581"><span class="linenos"> 581</span></a>
</span><span id="FisherMatrix-582"><a href="#FisherMatrix-582"><span class="linenos"> 582</span></a>        <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-583"><a href="#FisherMatrix-583"><span class="linenos"> 583</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-584"><a href="#FisherMatrix-584"><span class="linenos"> 584</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">reindex_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-585"><a href="#FisherMatrix-585"><span class="linenos"> 585</span></a>
</span><span id="FisherMatrix-586"><a href="#FisherMatrix-586"><span class="linenos"> 586</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-587"><a href="#FisherMatrix-587"><span class="linenos"> 587</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-588"><a href="#FisherMatrix-588"><span class="linenos"> 588</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-589"><a href="#FisherMatrix-589"><span class="linenos"> 589</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-590"><a href="#FisherMatrix-590"><span class="linenos"> 590</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-591"><a href="#FisherMatrix-591"><span class="linenos"> 591</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-592"><a href="#FisherMatrix-592"><span class="linenos"> 592</span></a>
</span><span id="FisherMatrix-593"><a href="#FisherMatrix-593"><span class="linenos"> 593</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="FisherMatrix-594"><a href="#FisherMatrix-594"><span class="linenos"> 594</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-595"><a href="#FisherMatrix-595"><span class="linenos"> 595</span></a><span class="sd">        The equality operator.</span>
</span><span id="FisherMatrix-596"><a href="#FisherMatrix-596"><span class="linenos"> 596</span></a><span class="sd">        Returns `True` if the operands have the following properties:</span>
</span><span id="FisherMatrix-597"><a href="#FisherMatrix-597"><span class="linenos"> 597</span></a>
</span><span id="FisherMatrix-598"><a href="#FisherMatrix-598"><span class="linenos"> 598</span></a><span class="sd">        * are instances of FisherMatrix</span>
</span><span id="FisherMatrix-599"><a href="#FisherMatrix-599"><span class="linenos"> 599</span></a><span class="sd">        * have same names (potentially shuffled)</span>
</span><span id="FisherMatrix-600"><a href="#FisherMatrix-600"><span class="linenos"> 600</span></a><span class="sd">        * have same dimensionality</span>
</span><span id="FisherMatrix-601"><a href="#FisherMatrix-601"><span class="linenos"> 601</span></a><span class="sd">        * have same fiducials (potentially shuffled)</span>
</span><span id="FisherMatrix-602"><a href="#FisherMatrix-602"><span class="linenos"> 602</span></a><span class="sd">        * have same values (potentially shuffled)</span>
</span><span id="FisherMatrix-603"><a href="#FisherMatrix-603"><span class="linenos"> 603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-604"><a href="#FisherMatrix-604"><span class="linenos"> 604</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-605"><a href="#FisherMatrix-605"><span class="linenos"> 605</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="FisherMatrix-606"><a href="#FisherMatrix-606"><span class="linenos"> 606</span></a>
</span><span id="FisherMatrix-607"><a href="#FisherMatrix-607"><span class="linenos"> 607</span></a>        <span class="c1"># index for re-shuffling parameters</span>
</span><span id="FisherMatrix-608"><a href="#FisherMatrix-608"><span class="linenos"> 608</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-609"><a href="#FisherMatrix-609"><span class="linenos"> 609</span></a>
</span><span id="FisherMatrix-610"><a href="#FisherMatrix-610"><span class="linenos"> 610</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="FisherMatrix-611"><a href="#FisherMatrix-611"><span class="linenos"> 611</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
</span><span id="FisherMatrix-612"><a href="#FisherMatrix-612"><span class="linenos"> 612</span></a>            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">ndim</span>
</span><span id="FisherMatrix-613"><a href="#FisherMatrix-613"><span class="linenos"> 613</span></a>            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="FisherMatrix-614"><a href="#FisherMatrix-614"><span class="linenos"> 614</span></a>            <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-615"><a href="#FisherMatrix-615"><span class="linenos"> 615</span></a>            <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
</span><span id="FisherMatrix-616"><a href="#FisherMatrix-616"><span class="linenos"> 616</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-617"><a href="#FisherMatrix-617"><span class="linenos"> 617</span></a>                <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
</span><span id="FisherMatrix-618"><a href="#FisherMatrix-618"><span class="linenos"> 618</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-619"><a href="#FisherMatrix-619"><span class="linenos"> 619</span></a>            <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
</span><span id="FisherMatrix-620"><a href="#FisherMatrix-620"><span class="linenos"> 620</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-621"><a href="#FisherMatrix-621"><span class="linenos"> 621</span></a>                <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">),</span>
</span><span id="FisherMatrix-622"><a href="#FisherMatrix-622"><span class="linenos"> 622</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-623"><a href="#FisherMatrix-623"><span class="linenos"> 623</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-624"><a href="#FisherMatrix-624"><span class="linenos"> 624</span></a>
</span><span id="FisherMatrix-625"><a href="#FisherMatrix-625"><span class="linenos"> 625</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-626"><a href="#FisherMatrix-626"><span class="linenos"> 626</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-627"><a href="#FisherMatrix-627"><span class="linenos"> 627</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-628"><a href="#FisherMatrix-628"><span class="linenos"> 628</span></a><span class="sd">        Returns the number of dimensions of the Fisher object (for now always 2).</span>
</span><span id="FisherMatrix-629"><a href="#FisherMatrix-629"><span class="linenos"> 629</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-630"><a href="#FisherMatrix-630"><span class="linenos"> 630</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="FisherMatrix-631"><a href="#FisherMatrix-631"><span class="linenos"> 631</span></a>
</span><span id="FisherMatrix-632"><a href="#FisherMatrix-632"><span class="linenos"> 632</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-633"><a href="#FisherMatrix-633"><span class="linenos"> 633</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-634"><a href="#FisherMatrix-634"><span class="linenos"> 634</span></a><span class="sd">        Returns the number of parameters in the Fisher object.</span>
</span><span id="FisherMatrix-635"><a href="#FisherMatrix-635"><span class="linenos"> 635</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-636"><a href="#FisherMatrix-636"><span class="linenos"> 636</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span>
</span><span id="FisherMatrix-637"><a href="#FisherMatrix-637"><span class="linenos"> 637</span></a>
</span><span id="FisherMatrix-638"><a href="#FisherMatrix-638"><span class="linenos"> 638</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-639"><a href="#FisherMatrix-639"><span class="linenos"> 639</span></a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-640"><a href="#FisherMatrix-640"><span class="linenos"> 640</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-641"><a href="#FisherMatrix-641"><span class="linenos"> 641</span></a><span class="sd">        Returns the values in the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix-642"><a href="#FisherMatrix-642"><span class="linenos"> 642</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-643"><a href="#FisherMatrix-643"><span class="linenos"> 643</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
</span><span id="FisherMatrix-644"><a href="#FisherMatrix-644"><span class="linenos"> 644</span></a>
</span><span id="FisherMatrix-645"><a href="#FisherMatrix-645"><span class="linenos"> 645</span></a>    <span class="nd">@values</span><span class="o">.</span><span class="n">setter</span>
</span><span id="FisherMatrix-646"><a href="#FisherMatrix-646"><span class="linenos"> 646</span></a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span>
</span><span id="FisherMatrix-647"><a href="#FisherMatrix-647"><span class="linenos"> 647</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-648"><a href="#FisherMatrix-648"><span class="linenos"> 648</span></a>        <span class="n">value</span><span class="p">,</span>
</span><span id="FisherMatrix-649"><a href="#FisherMatrix-649"><span class="linenos"> 649</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-650"><a href="#FisherMatrix-650"><span class="linenos"> 650</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-651"><a href="#FisherMatrix-651"><span class="linenos"> 651</span></a><span class="sd">        Setter for the values of the Fisher object.</span>
</span><span id="FisherMatrix-652"><a href="#FisherMatrix-652"><span class="linenos"> 652</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-653"><a href="#FisherMatrix-653"><span class="linenos"> 653</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span><span id="FisherMatrix-654"><a href="#FisherMatrix-654"><span class="linenos"> 654</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="FisherMatrix-655"><a href="#FisherMatrix-655"><span class="linenos"> 655</span></a>
</span><span id="FisherMatrix-656"><a href="#FisherMatrix-656"><span class="linenos"> 656</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span><span id="FisherMatrix-657"><a href="#FisherMatrix-657"><span class="linenos"> 657</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> is not a square object&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-658"><a href="#FisherMatrix-658"><span class="linenos"> 658</span></a>
</span><span id="FisherMatrix-659"><a href="#FisherMatrix-659"><span class="linenos"> 659</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix-660"><a href="#FisherMatrix-660"><span class="linenos"> 660</span></a>
</span><span id="FisherMatrix-661"><a href="#FisherMatrix-661"><span class="linenos"> 661</span></a>    <span class="k">def</span> <span class="nf">is_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-662"><a href="#FisherMatrix-662"><span class="linenos"> 662</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-663"><a href="#FisherMatrix-663"><span class="linenos"> 663</span></a><span class="sd">        Checks whether the Fisher matrix is diagonal.</span>
</span><span id="FisherMatrix-664"><a href="#FisherMatrix-664"><span class="linenos"> 664</span></a>
</span><span id="FisherMatrix-665"><a href="#FisherMatrix-665"><span class="linenos"> 665</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-666"><a href="#FisherMatrix-666"><span class="linenos"> 666</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-667"><a href="#FisherMatrix-667"><span class="linenos"> 667</span></a><span class="sd">        `True` or `False`</span>
</span><span id="FisherMatrix-668"><a href="#FisherMatrix-668"><span class="linenos"> 668</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-669"><a href="#FisherMatrix-669"><span class="linenos"> 669</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
</span><span id="FisherMatrix-670"><a href="#FisherMatrix-670"><span class="linenos"> 670</span></a>
</span><span id="FisherMatrix-671"><a href="#FisherMatrix-671"><span class="linenos"> 671</span></a>    <span class="k">def</span> <span class="nf">diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="FisherMatrix-672"><a href="#FisherMatrix-672"><span class="linenos"> 672</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-673"><a href="#FisherMatrix-673"><span class="linenos"> 673</span></a><span class="sd">        Returns the diagonal elements of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix-674"><a href="#FisherMatrix-674"><span class="linenos"> 674</span></a>
</span><span id="FisherMatrix-675"><a href="#FisherMatrix-675"><span class="linenos"> 675</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-676"><a href="#FisherMatrix-676"><span class="linenos"> 676</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-677"><a href="#FisherMatrix-677"><span class="linenos"> 677</span></a><span class="sd">        array-like of floats</span>
</span><span id="FisherMatrix-678"><a href="#FisherMatrix-678"><span class="linenos"> 678</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-679"><a href="#FisherMatrix-679"><span class="linenos"> 679</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="FisherMatrix-680"><a href="#FisherMatrix-680"><span class="linenos"> 680</span></a>
</span><span id="FisherMatrix-681"><a href="#FisherMatrix-681"><span class="linenos"> 681</span></a>    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span>
</span><span id="FisherMatrix-682"><a href="#FisherMatrix-682"><span class="linenos"> 682</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-683"><a href="#FisherMatrix-683"><span class="linenos"> 683</span></a>        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix-684"><a href="#FisherMatrix-684"><span class="linenos"> 684</span></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix-685"><a href="#FisherMatrix-685"><span class="linenos"> 685</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix-686"><a href="#FisherMatrix-686"><span class="linenos"> 686</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-687"><a href="#FisherMatrix-687"><span class="linenos"> 687</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-688"><a href="#FisherMatrix-688"><span class="linenos"> 688</span></a><span class="sd">        Removes parameters from the Fisher object.</span>
</span><span id="FisherMatrix-689"><a href="#FisherMatrix-689"><span class="linenos"> 689</span></a>
</span><span id="FisherMatrix-690"><a href="#FisherMatrix-690"><span class="linenos"> 690</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-691"><a href="#FisherMatrix-691"><span class="linenos"> 691</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-692"><a href="#FisherMatrix-692"><span class="linenos"> 692</span></a><span class="sd">        names : string-like</span>
</span><span id="FisherMatrix-693"><a href="#FisherMatrix-693"><span class="linenos"> 693</span></a><span class="sd">            the names of the parameters to drop.</span>
</span><span id="FisherMatrix-694"><a href="#FisherMatrix-694"><span class="linenos"> 694</span></a><span class="sd">            If passing a list or a tuple, make sure to unpack it using the</span>
</span><span id="FisherMatrix-695"><a href="#FisherMatrix-695"><span class="linenos"> 695</span></a><span class="sd">            asterisk (*).</span>
</span><span id="FisherMatrix-696"><a href="#FisherMatrix-696"><span class="linenos"> 696</span></a>
</span><span id="FisherMatrix-697"><a href="#FisherMatrix-697"><span class="linenos"> 697</span></a><span class="sd">        invert : bool = False</span>
</span><span id="FisherMatrix-698"><a href="#FisherMatrix-698"><span class="linenos"> 698</span></a><span class="sd">            whether to drop all the parameters NOT in names (the complement)</span>
</span><span id="FisherMatrix-699"><a href="#FisherMatrix-699"><span class="linenos"> 699</span></a>
</span><span id="FisherMatrix-700"><a href="#FisherMatrix-700"><span class="linenos"> 700</span></a><span class="sd">        ignore_errors : bool = False</span>
</span><span id="FisherMatrix-701"><a href="#FisherMatrix-701"><span class="linenos"> 701</span></a><span class="sd">            should non-existing parameters be ignored</span>
</span><span id="FisherMatrix-702"><a href="#FisherMatrix-702"><span class="linenos"> 702</span></a>
</span><span id="FisherMatrix-703"><a href="#FisherMatrix-703"><span class="linenos"> 703</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-704"><a href="#FisherMatrix-704"><span class="linenos"> 704</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-705"><a href="#FisherMatrix-705"><span class="linenos"> 705</span></a><span class="sd">        Instance of `FisherMatrix`</span>
</span><span id="FisherMatrix-706"><a href="#FisherMatrix-706"><span class="linenos"> 706</span></a>
</span><span id="FisherMatrix-707"><a href="#FisherMatrix-707"><span class="linenos"> 707</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-708"><a href="#FisherMatrix-708"><span class="linenos"> 708</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-709"><a href="#FisherMatrix-709"><span class="linenos"> 709</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix-710"><a href="#FisherMatrix-710"><span class="linenos"> 710</span></a><span class="sd">        &gt;&gt;&gt; m.drop(&#39;p1&#39;, &#39;p3&#39;)</span>
</span><span id="FisherMatrix-711"><a href="#FisherMatrix-711"><span class="linenos"> 711</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-712"><a href="#FisherMatrix-712"><span class="linenos"> 712</span></a><span class="sd">            array([[2.]]),</span>
</span><span id="FisherMatrix-713"><a href="#FisherMatrix-713"><span class="linenos"> 713</span></a><span class="sd">            names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-714"><a href="#FisherMatrix-714"><span class="linenos"> 714</span></a><span class="sd">            latex_names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-715"><a href="#FisherMatrix-715"><span class="linenos"> 715</span></a><span class="sd">            fiducials=array([0.]))</span>
</span><span id="FisherMatrix-716"><a href="#FisherMatrix-716"><span class="linenos"> 716</span></a><span class="sd">        &gt;&gt;&gt; m.drop(*[&#39;p1&#39;, &#39;p3&#39;]) # same thing, but note the asterisk (*)</span>
</span><span id="FisherMatrix-717"><a href="#FisherMatrix-717"><span class="linenos"> 717</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-718"><a href="#FisherMatrix-718"><span class="linenos"> 718</span></a><span class="sd">            array([[2.]]),</span>
</span><span id="FisherMatrix-719"><a href="#FisherMatrix-719"><span class="linenos"> 719</span></a><span class="sd">            names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-720"><a href="#FisherMatrix-720"><span class="linenos"> 720</span></a><span class="sd">            latex_names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-721"><a href="#FisherMatrix-721"><span class="linenos"> 721</span></a><span class="sd">            fiducials=array([0.]))</span>
</span><span id="FisherMatrix-722"><a href="#FisherMatrix-722"><span class="linenos"> 722</span></a><span class="sd">        &gt;&gt;&gt; # drop everything that&#39;s NOT `p1` or `p3`</span>
</span><span id="FisherMatrix-723"><a href="#FisherMatrix-723"><span class="linenos"> 723</span></a><span class="sd">        &gt;&gt;&gt; m.drop(&#39;p1&#39;, &#39;p3&#39;, invert=True)</span>
</span><span id="FisherMatrix-724"><a href="#FisherMatrix-724"><span class="linenos"> 724</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-725"><a href="#FisherMatrix-725"><span class="linenos"> 725</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix-726"><a href="#FisherMatrix-726"><span class="linenos"> 726</span></a><span class="sd">               [0., 3.]]),</span>
</span><span id="FisherMatrix-727"><a href="#FisherMatrix-727"><span class="linenos"> 727</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-728"><a href="#FisherMatrix-728"><span class="linenos"> 728</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix-729"><a href="#FisherMatrix-729"><span class="linenos"> 729</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-730"><a href="#FisherMatrix-730"><span class="linenos"> 730</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-731"><a href="#FisherMatrix-731"><span class="linenos"> 731</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)):</span>
</span><span id="FisherMatrix-732"><a href="#FisherMatrix-732"><span class="linenos"> 732</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix-733"><a href="#FisherMatrix-733"><span class="linenos"> 733</span></a>                <span class="sa">f</span><span class="s2">&quot;The names (</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">) are not a strict subset &quot;</span>
</span><span id="FisherMatrix-734"><a href="#FisherMatrix-734"><span class="linenos"> 734</span></a>                <span class="sa">f</span><span class="s2">&quot;of the parameter names in the Fisher object (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">); &quot;</span>
</span><span id="FisherMatrix-735"><a href="#FisherMatrix-735"><span class="linenos"> 735</span></a>                <span class="s2">&quot;you can pass `ignore_errors=True` to ignore this error&quot;</span>
</span><span id="FisherMatrix-736"><a href="#FisherMatrix-736"><span class="linenos"> 736</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-737"><a href="#FisherMatrix-737"><span class="linenos"> 737</span></a>
</span><span id="FisherMatrix-738"><a href="#FisherMatrix-738"><span class="linenos"> 738</span></a>        <span class="k">if</span> <span class="n">ignore_errors</span><span class="p">:</span>
</span><span id="FisherMatrix-739"><a href="#FisherMatrix-739"><span class="linenos"> 739</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">])</span>
</span><span id="FisherMatrix-740"><a href="#FisherMatrix-740"><span class="linenos"> 740</span></a>
</span><span id="FisherMatrix-741"><a href="#FisherMatrix-741"><span class="linenos"> 741</span></a>        <span class="k">if</span> <span class="n">invert</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix-742"><a href="#FisherMatrix-742"><span class="linenos"> 742</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">^</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-743"><a href="#FisherMatrix-743"><span class="linenos"> 743</span></a>
</span><span id="FisherMatrix-744"><a href="#FisherMatrix-744"><span class="linenos"> 744</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-745"><a href="#FisherMatrix-745"><span class="linenos"> 745</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to remove all parameters&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-746"><a href="#FisherMatrix-746"><span class="linenos"> 746</span></a>
</span><span id="FisherMatrix-747"><a href="#FisherMatrix-747"><span class="linenos"> 747</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
</span><span id="FisherMatrix-748"><a href="#FisherMatrix-748"><span class="linenos"> 748</span></a>
</span><span id="FisherMatrix-749"><a href="#FisherMatrix-749"><span class="linenos"> 749</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
</span><span id="FisherMatrix-750"><a href="#FisherMatrix-750"><span class="linenos"> 750</span></a>        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
</span><span id="FisherMatrix-751"><a href="#FisherMatrix-751"><span class="linenos"> 751</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
</span><span id="FisherMatrix-752"><a href="#FisherMatrix-752"><span class="linenos"> 752</span></a>                <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-753"><a href="#FisherMatrix-753"><span class="linenos"> 753</span></a>                <span class="n">index</span><span class="p">,</span>
</span><span id="FisherMatrix-754"><a href="#FisherMatrix-754"><span class="linenos"> 754</span></a>                <span class="n">axis</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
</span><span id="FisherMatrix-755"><a href="#FisherMatrix-755"><span class="linenos"> 755</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-756"><a href="#FisherMatrix-756"><span class="linenos"> 756</span></a>
</span><span id="FisherMatrix-757"><a href="#FisherMatrix-757"><span class="linenos"> 757</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-758"><a href="#FisherMatrix-758"><span class="linenos"> 758</span></a>        <span class="n">latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-759"><a href="#FisherMatrix-759"><span class="linenos"> 759</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-760"><a href="#FisherMatrix-760"><span class="linenos"> 760</span></a>
</span><span id="FisherMatrix-761"><a href="#FisherMatrix-761"><span class="linenos"> 761</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-762"><a href="#FisherMatrix-762"><span class="linenos"> 762</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-763"><a href="#FisherMatrix-763"><span class="linenos"> 763</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-764"><a href="#FisherMatrix-764"><span class="linenos"> 764</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-765"><a href="#FisherMatrix-765"><span class="linenos"> 765</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-766"><a href="#FisherMatrix-766"><span class="linenos"> 766</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-767"><a href="#FisherMatrix-767"><span class="linenos"> 767</span></a>
</span><span id="FisherMatrix-768"><a href="#FisherMatrix-768"><span class="linenos"> 768</span></a>    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span>
</span><span id="FisherMatrix-769"><a href="#FisherMatrix-769"><span class="linenos"> 769</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-770"><a href="#FisherMatrix-770"><span class="linenos"> 770</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-771"><a href="#FisherMatrix-771"><span class="linenos"> 771</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-772"><a href="#FisherMatrix-772"><span class="linenos"> 772</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-773"><a href="#FisherMatrix-773"><span class="linenos"> 773</span></a><span class="sd">        Returns the trace of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix-774"><a href="#FisherMatrix-774"><span class="linenos"> 774</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-775"><a href="#FisherMatrix-775"><span class="linenos"> 775</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="FisherMatrix-776"><a href="#FisherMatrix-776"><span class="linenos"> 776</span></a>
</span><span id="FisherMatrix-777"><a href="#FisherMatrix-777"><span class="linenos"> 777</span></a>    <span class="k">def</span> <span class="nf">eigenvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-778"><a href="#FisherMatrix-778"><span class="linenos"> 778</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-779"><a href="#FisherMatrix-779"><span class="linenos"> 779</span></a><span class="sd">        Returns the eigenvalues of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix-780"><a href="#FisherMatrix-780"><span class="linenos"> 780</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-781"><a href="#FisherMatrix-781"><span class="linenos"> 781</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-782"><a href="#FisherMatrix-782"><span class="linenos"> 782</span></a>
</span><span id="FisherMatrix-783"><a href="#FisherMatrix-783"><span class="linenos"> 783</span></a>    <span class="k">def</span> <span class="nf">eigenvectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-784"><a href="#FisherMatrix-784"><span class="linenos"> 784</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-785"><a href="#FisherMatrix-785"><span class="linenos"> 785</span></a><span class="sd">        Returns the right eigenvectors of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix-786"><a href="#FisherMatrix-786"><span class="linenos"> 786</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-787"><a href="#FisherMatrix-787"><span class="linenos"> 787</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FisherMatrix-788"><a href="#FisherMatrix-788"><span class="linenos"> 788</span></a>
</span><span id="FisherMatrix-789"><a href="#FisherMatrix-789"><span class="linenos"> 789</span></a>    <span class="k">def</span> <span class="nf">condition_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-790"><a href="#FisherMatrix-790"><span class="linenos"> 790</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-791"><a href="#FisherMatrix-791"><span class="linenos"> 791</span></a><span class="sd">        Returns the condition number of the matrix with respect to the $L^2$ norm.</span>
</span><span id="FisherMatrix-792"><a href="#FisherMatrix-792"><span class="linenos"> 792</span></a>
</span><span id="FisherMatrix-793"><a href="#FisherMatrix-793"><span class="linenos"> 793</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-794"><a href="#FisherMatrix-794"><span class="linenos"> 794</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-795"><a href="#FisherMatrix-795"><span class="linenos"> 795</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix-796"><a href="#FisherMatrix-796"><span class="linenos"> 796</span></a><span class="sd">        &gt;&gt;&gt; fm.condition_number()</span>
</span><span id="FisherMatrix-797"><a href="#FisherMatrix-797"><span class="linenos"> 797</span></a><span class="sd">        3.0</span>
</span><span id="FisherMatrix-798"><a href="#FisherMatrix-798"><span class="linenos"> 798</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-799"><a href="#FisherMatrix-799"><span class="linenos"> 799</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">())</span>
</span><span id="FisherMatrix-800"><a href="#FisherMatrix-800"><span class="linenos"> 800</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-801"><a href="#FisherMatrix-801"><span class="linenos"> 801</span></a>
</span><span id="FisherMatrix-802"><a href="#FisherMatrix-802"><span class="linenos"> 802</span></a>    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-803"><a href="#FisherMatrix-803"><span class="linenos"> 803</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-804"><a href="#FisherMatrix-804"><span class="linenos"> 804</span></a><span class="sd">        Returns the inverse of the Fisher matrix.</span>
</span><span id="FisherMatrix-805"><a href="#FisherMatrix-805"><span class="linenos"> 805</span></a>
</span><span id="FisherMatrix-806"><a href="#FisherMatrix-806"><span class="linenos"> 806</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-807"><a href="#FisherMatrix-807"><span class="linenos"> 807</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-808"><a href="#FisherMatrix-808"><span class="linenos"> 808</span></a><span class="sd">        array containing the covariance matrix</span>
</span><span id="FisherMatrix-809"><a href="#FisherMatrix-809"><span class="linenos"> 809</span></a>
</span><span id="FisherMatrix-810"><a href="#FisherMatrix-810"><span class="linenos"> 810</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-811"><a href="#FisherMatrix-811"><span class="linenos"> 811</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-812"><a href="#FisherMatrix-812"><span class="linenos"> 812</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 5]))</span>
</span><span id="FisherMatrix-813"><a href="#FisherMatrix-813"><span class="linenos"> 813</span></a><span class="sd">        &gt;&gt;&gt; fm.inverse()</span>
</span><span id="FisherMatrix-814"><a href="#FisherMatrix-814"><span class="linenos"> 814</span></a><span class="sd">        array([[1. , 0. , 0. ],</span>
</span><span id="FisherMatrix-815"><a href="#FisherMatrix-815"><span class="linenos"> 815</span></a><span class="sd">               [0. , 0.5, 0. ],</span>
</span><span id="FisherMatrix-816"><a href="#FisherMatrix-816"><span class="linenos"> 816</span></a><span class="sd">               [0. , 0. , 0.2]])</span>
</span><span id="FisherMatrix-817"><a href="#FisherMatrix-817"><span class="linenos"> 817</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-818"><a href="#FisherMatrix-818"><span class="linenos"> 818</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-819"><a href="#FisherMatrix-819"><span class="linenos"> 819</span></a>
</span><span id="FisherMatrix-820"><a href="#FisherMatrix-820"><span class="linenos"> 820</span></a>    <span class="k">def</span> <span class="nf">determinant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-821"><a href="#FisherMatrix-821"><span class="linenos"> 821</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-822"><a href="#FisherMatrix-822"><span class="linenos"> 822</span></a><span class="sd">        Returns the determinant of the matrix.</span>
</span><span id="FisherMatrix-823"><a href="#FisherMatrix-823"><span class="linenos"> 823</span></a>
</span><span id="FisherMatrix-824"><a href="#FisherMatrix-824"><span class="linenos"> 824</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-825"><a href="#FisherMatrix-825"><span class="linenos"> 825</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-826"><a href="#FisherMatrix-826"><span class="linenos"> 826</span></a><span class="sd">        float</span>
</span><span id="FisherMatrix-827"><a href="#FisherMatrix-827"><span class="linenos"> 827</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-828"><a href="#FisherMatrix-828"><span class="linenos"> 828</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-829"><a href="#FisherMatrix-829"><span class="linenos"> 829</span></a>
</span><span id="FisherMatrix-830"><a href="#FisherMatrix-830"><span class="linenos"> 830</span></a>    <span class="k">def</span> <span class="nf">constraints</span><span class="p">(</span>
</span><span id="FisherMatrix-831"><a href="#FisherMatrix-831"><span class="linenos"> 831</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-832"><a href="#FisherMatrix-832"><span class="linenos"> 832</span></a>        <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-833"><a href="#FisherMatrix-833"><span class="linenos"> 833</span></a>        <span class="n">marginalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FisherMatrix-834"><a href="#FisherMatrix-834"><span class="linenos"> 834</span></a>        <span class="n">sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-835"><a href="#FisherMatrix-835"><span class="linenos"> 835</span></a>        <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-836"><a href="#FisherMatrix-836"><span class="linenos"> 836</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-837"><a href="#FisherMatrix-837"><span class="linenos"> 837</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-838"><a href="#FisherMatrix-838"><span class="linenos"> 838</span></a><span class="sd">        Returns the constraints on a parameter as a float, or on all of them</span>
</span><span id="FisherMatrix-839"><a href="#FisherMatrix-839"><span class="linenos"> 839</span></a><span class="sd">        as a numpy array if `name` is not specified.</span>
</span><span id="FisherMatrix-840"><a href="#FisherMatrix-840"><span class="linenos"> 840</span></a>
</span><span id="FisherMatrix-841"><a href="#FisherMatrix-841"><span class="linenos"> 841</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-842"><a href="#FisherMatrix-842"><span class="linenos"> 842</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-843"><a href="#FisherMatrix-843"><span class="linenos"> 843</span></a><span class="sd">        name : Optional[str] = None</span>
</span><span id="FisherMatrix-844"><a href="#FisherMatrix-844"><span class="linenos"> 844</span></a><span class="sd">            the name of the parameter for which we we want the constraints</span>
</span><span id="FisherMatrix-845"><a href="#FisherMatrix-845"><span class="linenos"> 845</span></a>
</span><span id="FisherMatrix-846"><a href="#FisherMatrix-846"><span class="linenos"> 846</span></a><span class="sd">        marginalized : bool = True</span>
</span><span id="FisherMatrix-847"><a href="#FisherMatrix-847"><span class="linenos"> 847</span></a><span class="sd">            whether we want the marginalized or the unmarginalized</span>
</span><span id="FisherMatrix-848"><a href="#FisherMatrix-848"><span class="linenos"> 848</span></a><span class="sd">            constraints.</span>
</span><span id="FisherMatrix-849"><a href="#FisherMatrix-849"><span class="linenos"> 849</span></a>
</span><span id="FisherMatrix-850"><a href="#FisherMatrix-850"><span class="linenos"> 850</span></a><span class="sd">        sigma : Optional[float] = None</span>
</span><span id="FisherMatrix-851"><a href="#FisherMatrix-851"><span class="linenos"> 851</span></a><span class="sd">            how many sigmas away.</span>
</span><span id="FisherMatrix-852"><a href="#FisherMatrix-852"><span class="linenos"> 852</span></a>
</span><span id="FisherMatrix-853"><a href="#FisherMatrix-853"><span class="linenos"> 853</span></a><span class="sd">        p : Optional[float] = None</span>
</span><span id="FisherMatrix-854"><a href="#FisherMatrix-854"><span class="linenos"> 854</span></a><span class="sd">            the confidence interval (p-value).</span>
</span><span id="FisherMatrix-855"><a href="#FisherMatrix-855"><span class="linenos"> 855</span></a><span class="sd">            The relationship between `p` and `sigma` is defined via:</span>
</span><span id="FisherMatrix-856"><a href="#FisherMatrix-856"><span class="linenos"> 856</span></a><span class="sd">            $$</span>
</span><span id="FisherMatrix-857"><a href="#FisherMatrix-857"><span class="linenos"> 857</span></a><span class="sd">                p(\sigma) = \int\limits_{\mu - \sigma}^{\mu + \sigma}</span>
</span><span id="FisherMatrix-858"><a href="#FisherMatrix-858"><span class="linenos"> 858</span></a><span class="sd">                            f(x, \mu, 1)\, \mathrm{d}x</span>
</span><span id="FisherMatrix-859"><a href="#FisherMatrix-859"><span class="linenos"> 859</span></a><span class="sd">                          = \mathrm{Erf}(\sigma / \sqrt{2})</span>
</span><span id="FisherMatrix-860"><a href="#FisherMatrix-860"><span class="linenos"> 860</span></a><span class="sd">            $$</span>
</span><span id="FisherMatrix-861"><a href="#FisherMatrix-861"><span class="linenos"> 861</span></a><span class="sd">            and therefore the inverse is simply:</span>
</span><span id="FisherMatrix-862"><a href="#FisherMatrix-862"><span class="linenos"> 862</span></a><span class="sd">            $$</span>
</span><span id="FisherMatrix-863"><a href="#FisherMatrix-863"><span class="linenos"> 863</span></a><span class="sd">                \sigma(p) = \sqrt{2}\, \mathrm{Erf}^{-1}(p)</span>
</span><span id="FisherMatrix-864"><a href="#FisherMatrix-864"><span class="linenos"> 864</span></a><span class="sd">            $$</span>
</span><span id="FisherMatrix-865"><a href="#FisherMatrix-865"><span class="linenos"> 865</span></a><span class="sd">            The values of `p` corresponding to 1, 2, 3 `sigma` are roughly</span>
</span><span id="FisherMatrix-866"><a href="#FisherMatrix-866"><span class="linenos"> 866</span></a><span class="sd">            0.683, 0.954, and 0.997, respectively.</span>
</span><span id="FisherMatrix-867"><a href="#FisherMatrix-867"><span class="linenos"> 867</span></a>
</span><span id="FisherMatrix-868"><a href="#FisherMatrix-868"><span class="linenos"> 868</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-869"><a href="#FisherMatrix-869"><span class="linenos"> 869</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-870"><a href="#FisherMatrix-870"><span class="linenos"> 870</span></a><span class="sd">        array-like of floats or single float</span>
</span><span id="FisherMatrix-871"><a href="#FisherMatrix-871"><span class="linenos"> 871</span></a>
</span><span id="FisherMatrix-872"><a href="#FisherMatrix-872"><span class="linenos"> 872</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-873"><a href="#FisherMatrix-873"><span class="linenos"> 873</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-874"><a href="#FisherMatrix-874"><span class="linenos"> 874</span></a><span class="sd">        The user should specify either `sigma` or `p`, but not both</span>
</span><span id="FisherMatrix-875"><a href="#FisherMatrix-875"><span class="linenos"> 875</span></a><span class="sd">        simultaneously.</span>
</span><span id="FisherMatrix-876"><a href="#FisherMatrix-876"><span class="linenos"> 876</span></a><span class="sd">        If neither are specified, defaults to `sigma=1`.</span>
</span><span id="FisherMatrix-877"><a href="#FisherMatrix-877"><span class="linenos"> 877</span></a>
</span><span id="FisherMatrix-878"><a href="#FisherMatrix-878"><span class="linenos"> 878</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-879"><a href="#FisherMatrix-879"><span class="linenos"> 879</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-880"><a href="#FisherMatrix-880"><span class="linenos"> 880</span></a><span class="sd">        Get (marginalized by default) constraints for all parameters:</span>
</span><span id="FisherMatrix-881"><a href="#FisherMatrix-881"><span class="linenos"> 881</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix([[3, -2], [-2, 5]])</span>
</span><span id="FisherMatrix-882"><a href="#FisherMatrix-882"><span class="linenos"> 882</span></a><span class="sd">        &gt;&gt;&gt; m.constraints()</span>
</span><span id="FisherMatrix-883"><a href="#FisherMatrix-883"><span class="linenos"> 883</span></a><span class="sd">        array([0.67419986, 0.52223297])</span>
</span><span id="FisherMatrix-884"><a href="#FisherMatrix-884"><span class="linenos"> 884</span></a>
</span><span id="FisherMatrix-885"><a href="#FisherMatrix-885"><span class="linenos"> 885</span></a><span class="sd">        Get the unmarginalized constraints instead:</span>
</span><span id="FisherMatrix-886"><a href="#FisherMatrix-886"><span class="linenos"> 886</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(marginalized=False)</span>
</span><span id="FisherMatrix-887"><a href="#FisherMatrix-887"><span class="linenos"> 887</span></a><span class="sd">        array([0.57735027, 0.4472136 ])</span>
</span><span id="FisherMatrix-888"><a href="#FisherMatrix-888"><span class="linenos"> 888</span></a>
</span><span id="FisherMatrix-889"><a href="#FisherMatrix-889"><span class="linenos"> 889</span></a><span class="sd">        Get the unmarginalized constraints for a single parameter:</span>
</span><span id="FisherMatrix-890"><a href="#FisherMatrix-890"><span class="linenos"> 890</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(&#39;p1&#39;, marginalized=False)</span>
</span><span id="FisherMatrix-891"><a href="#FisherMatrix-891"><span class="linenos"> 891</span></a><span class="sd">        array([0.57735027])</span>
</span><span id="FisherMatrix-892"><a href="#FisherMatrix-892"><span class="linenos"> 892</span></a>
</span><span id="FisherMatrix-893"><a href="#FisherMatrix-893"><span class="linenos"> 893</span></a><span class="sd">        Get the marginalized constraints for a single parameter:</span>
</span><span id="FisherMatrix-894"><a href="#FisherMatrix-894"><span class="linenos"> 894</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(&#39;p1&#39;, p=0.682689) # p-value roughly equal to 1 sigma</span>
</span><span id="FisherMatrix-895"><a href="#FisherMatrix-895"><span class="linenos"> 895</span></a><span class="sd">        array([0.67419918])</span>
</span><span id="FisherMatrix-896"><a href="#FisherMatrix-896"><span class="linenos"> 896</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-897"><a href="#FisherMatrix-897"><span class="linenos"> 897</span></a>        <span class="k">if</span> <span class="n">sigma</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-898"><a href="#FisherMatrix-898"><span class="linenos"> 898</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix-899"><a href="#FisherMatrix-899"><span class="linenos"> 899</span></a>                <span class="s2">&quot;Cannot specify both `p` and `sigma` simultaneously; &quot;</span>
</span><span id="FisherMatrix-900"><a href="#FisherMatrix-900"><span class="linenos"> 900</span></a>                <span class="s2">&quot;please specify at most one of those&quot;</span>
</span><span id="FisherMatrix-901"><a href="#FisherMatrix-901"><span class="linenos"> 901</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-902"><a href="#FisherMatrix-902"><span class="linenos"> 902</span></a>
</span><span id="FisherMatrix-903"><a href="#FisherMatrix-903"><span class="linenos"> 903</span></a>        <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-904"><a href="#FisherMatrix-904"><span class="linenos"> 904</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FisherMatrix-905"><a href="#FisherMatrix-905"><span class="linenos"> 905</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix-906"><a href="#FisherMatrix-906"><span class="linenos"> 906</span></a>                    <span class="sa">f</span><span class="s2">&quot;The value of `p` </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2"> is outside of the allowed range (0, 1)&quot;</span>
</span><span id="FisherMatrix-907"><a href="#FisherMatrix-907"><span class="linenos"> 907</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-908"><a href="#FisherMatrix-908"><span class="linenos"> 908</span></a>            <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">erfinv</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="FisherMatrix-909"><a href="#FisherMatrix-909"><span class="linenos"> 909</span></a>        <span class="k">elif</span> <span class="n">sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-910"><a href="#FisherMatrix-910"><span class="linenos"> 910</span></a>            <span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="FisherMatrix-911"><a href="#FisherMatrix-911"><span class="linenos"> 911</span></a>
</span><span id="FisherMatrix-912"><a href="#FisherMatrix-912"><span class="linenos"> 912</span></a>        <span class="k">if</span> <span class="n">sigma</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FisherMatrix-913"><a href="#FisherMatrix-913"><span class="linenos"> 913</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix-914"><a href="#FisherMatrix-914"><span class="linenos"> 914</span></a>                <span class="sa">f</span><span class="s2">&quot;The value of `sigma` </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2"> is outside of the allowed range (0, infinify)&quot;</span>
</span><span id="FisherMatrix-915"><a href="#FisherMatrix-915"><span class="linenos"> 915</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-916"><a href="#FisherMatrix-916"><span class="linenos"> 916</span></a>
</span><span id="FisherMatrix-917"><a href="#FisherMatrix-917"><span class="linenos"> 917</span></a>        <span class="k">if</span> <span class="n">marginalized</span><span class="p">:</span>
</span><span id="FisherMatrix-918"><a href="#FisherMatrix-918"><span class="linenos"> 918</span></a>            <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-919"><a href="#FisherMatrix-919"><span class="linenos"> 919</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span>
</span><span id="FisherMatrix-920"><a href="#FisherMatrix-920"><span class="linenos"> 920</span></a>                <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-921"><a href="#FisherMatrix-921"><span class="linenos"> 921</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-922"><a href="#FisherMatrix-922"><span class="linenos"> 922</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-923"><a href="#FisherMatrix-923"><span class="linenos"> 923</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-924"><a href="#FisherMatrix-924"><span class="linenos"> 924</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">inv</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">*</span> <span class="n">sigma</span>
</span><span id="FisherMatrix-925"><a href="#FisherMatrix-925"><span class="linenos"> 925</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-926"><a href="#FisherMatrix-926"><span class="linenos"> 926</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">*</span> <span class="n">sigma</span>
</span><span id="FisherMatrix-927"><a href="#FisherMatrix-927"><span class="linenos"> 927</span></a>
</span><span id="FisherMatrix-928"><a href="#FisherMatrix-928"><span class="linenos"> 928</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-929"><a href="#FisherMatrix-929"><span class="linenos"> 929</span></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix-930"><a href="#FisherMatrix-930"><span class="linenos"> 930</span></a>                <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)]</span>
</span><span id="FisherMatrix-931"><a href="#FisherMatrix-931"><span class="linenos"> 931</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-932"><a href="#FisherMatrix-932"><span class="linenos"> 932</span></a>
</span><span id="FisherMatrix-933"><a href="#FisherMatrix-933"><span class="linenos"> 933</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="FisherMatrix-934"><a href="#FisherMatrix-934"><span class="linenos"> 934</span></a>
</span><span id="FisherMatrix-935"><a href="#FisherMatrix-935"><span class="linenos"> 935</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-936"><a href="#FisherMatrix-936"><span class="linenos"> 936</span></a>    <span class="k">def</span> <span class="nf">fiducials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-937"><a href="#FisherMatrix-937"><span class="linenos"> 937</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-938"><a href="#FisherMatrix-938"><span class="linenos"> 938</span></a><span class="sd">        Returns the fiducial values of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix-939"><a href="#FisherMatrix-939"><span class="linenos"> 939</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-940"><a href="#FisherMatrix-940"><span class="linenos"> 940</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fiducial</span>
</span><span id="FisherMatrix-941"><a href="#FisherMatrix-941"><span class="linenos"> 941</span></a>
</span><span id="FisherMatrix-942"><a href="#FisherMatrix-942"><span class="linenos"> 942</span></a>    <span class="nd">@fiducials</span><span class="o">.</span><span class="n">setter</span>
</span><span id="FisherMatrix-943"><a href="#FisherMatrix-943"><span class="linenos"> 943</span></a>    <span class="k">def</span> <span class="nf">fiducials</span><span class="p">(</span>
</span><span id="FisherMatrix-944"><a href="#FisherMatrix-944"><span class="linenos"> 944</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-945"><a href="#FisherMatrix-945"><span class="linenos"> 945</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
</span><span id="FisherMatrix-946"><a href="#FisherMatrix-946"><span class="linenos"> 946</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-947"><a href="#FisherMatrix-947"><span class="linenos"> 947</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-948"><a href="#FisherMatrix-948"><span class="linenos"> 948</span></a><span class="sd">        The setter for the fiducial values of the Fisher object.</span>
</span><span id="FisherMatrix-949"><a href="#FisherMatrix-949"><span class="linenos"> 949</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-950"><a href="#FisherMatrix-950"><span class="linenos"> 950</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-951"><a href="#FisherMatrix-951"><span class="linenos"> 951</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="FisherMatrix-952"><a href="#FisherMatrix-952"><span class="linenos"> 952</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="FisherMatrix-953"><a href="#FisherMatrix-953"><span class="linenos"> 953</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">value</span><span class="p">])</span>
</span><span id="FisherMatrix-954"><a href="#FisherMatrix-954"><span class="linenos"> 954</span></a>        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="FisherMatrix-955"><a href="#FisherMatrix-955"><span class="linenos"> 955</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</span><span id="FisherMatrix-956"><a href="#FisherMatrix-956"><span class="linenos"> 956</span></a>
</span><span id="FisherMatrix-957"><a href="#FisherMatrix-957"><span class="linenos"> 957</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-958"><a href="#FisherMatrix-958"><span class="linenos"> 958</span></a>    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-959"><a href="#FisherMatrix-959"><span class="linenos"> 959</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-960"><a href="#FisherMatrix-960"><span class="linenos"> 960</span></a><span class="sd">        Returns the parameter names of the Fisher object.</span>
</span><span id="FisherMatrix-961"><a href="#FisherMatrix-961"><span class="linenos"> 961</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-962"><a href="#FisherMatrix-962"><span class="linenos"> 962</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span>
</span><span id="FisherMatrix-963"><a href="#FisherMatrix-963"><span class="linenos"> 963</span></a>
</span><span id="FisherMatrix-964"><a href="#FisherMatrix-964"><span class="linenos"> 964</span></a>    <span class="nd">@names</span><span class="o">.</span><span class="n">setter</span>
</span><span id="FisherMatrix-965"><a href="#FisherMatrix-965"><span class="linenos"> 965</span></a>    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span>
</span><span id="FisherMatrix-966"><a href="#FisherMatrix-966"><span class="linenos"> 966</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-967"><a href="#FisherMatrix-967"><span class="linenos"> 967</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="FisherMatrix-968"><a href="#FisherMatrix-968"><span class="linenos"> 968</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-969"><a href="#FisherMatrix-969"><span class="linenos"> 969</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-970"><a href="#FisherMatrix-970"><span class="linenos"> 970</span></a><span class="sd">        The bulk setter for the names.</span>
</span><span id="FisherMatrix-971"><a href="#FisherMatrix-971"><span class="linenos"> 971</span></a><span class="sd">        The length of the names must be the same as the one of the original</span>
</span><span id="FisherMatrix-972"><a href="#FisherMatrix-972"><span class="linenos"> 972</span></a><span class="sd">        object.</span>
</span><span id="FisherMatrix-973"><a href="#FisherMatrix-973"><span class="linenos"> 973</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-974"><a href="#FisherMatrix-974"><span class="linenos"> 974</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-975"><a href="#FisherMatrix-975"><span class="linenos"> 975</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="FisherMatrix-976"><a href="#FisherMatrix-976"><span class="linenos"> 976</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix-977"><a href="#FisherMatrix-977"><span class="linenos"> 977</span></a>
</span><span id="FisherMatrix-978"><a href="#FisherMatrix-978"><span class="linenos"> 978</span></a>    <span class="nd">@property</span>
</span><span id="FisherMatrix-979"><a href="#FisherMatrix-979"><span class="linenos"> 979</span></a>    <span class="k">def</span> <span class="nf">latex_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-980"><a href="#FisherMatrix-980"><span class="linenos"> 980</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-981"><a href="#FisherMatrix-981"><span class="linenos"> 981</span></a><span class="sd">        Returns the LaTeX names of the parameters of the Fisher object.</span>
</span><span id="FisherMatrix-982"><a href="#FisherMatrix-982"><span class="linenos"> 982</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-983"><a href="#FisherMatrix-983"><span class="linenos"> 983</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span>
</span><span id="FisherMatrix-984"><a href="#FisherMatrix-984"><span class="linenos"> 984</span></a>
</span><span id="FisherMatrix-985"><a href="#FisherMatrix-985"><span class="linenos"> 985</span></a>    <span class="nd">@latex_names</span><span class="o">.</span><span class="n">setter</span>
</span><span id="FisherMatrix-986"><a href="#FisherMatrix-986"><span class="linenos"> 986</span></a>    <span class="k">def</span> <span class="nf">latex_names</span><span class="p">(</span>
</span><span id="FisherMatrix-987"><a href="#FisherMatrix-987"><span class="linenos"> 987</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-988"><a href="#FisherMatrix-988"><span class="linenos"> 988</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="FisherMatrix-989"><a href="#FisherMatrix-989"><span class="linenos"> 989</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-990"><a href="#FisherMatrix-990"><span class="linenos"> 990</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-991"><a href="#FisherMatrix-991"><span class="linenos"> 991</span></a><span class="sd">        The bulk setter for the LaTeX names.</span>
</span><span id="FisherMatrix-992"><a href="#FisherMatrix-992"><span class="linenos"> 992</span></a><span class="sd">        The length of the names must be the same as the one of the original</span>
</span><span id="FisherMatrix-993"><a href="#FisherMatrix-993"><span class="linenos"> 993</span></a><span class="sd">        object.</span>
</span><span id="FisherMatrix-994"><a href="#FisherMatrix-994"><span class="linenos"> 994</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-995"><a href="#FisherMatrix-995"><span class="linenos"> 995</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix-996"><a href="#FisherMatrix-996"><span class="linenos"> 996</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="FisherMatrix-997"><a href="#FisherMatrix-997"><span class="linenos"> 997</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix-998"><a href="#FisherMatrix-998"><span class="linenos"> 998</span></a>
</span><span id="FisherMatrix-999"><a href="#FisherMatrix-999"><span class="linenos"> 999</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span>
</span><span id="FisherMatrix-1000"><a href="#FisherMatrix-1000"><span class="linenos">1000</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1001"><a href="#FisherMatrix-1001"><span class="linenos">1001</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherMatrix-1002"><a href="#FisherMatrix-1002"><span class="linenos">1002</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1003"><a href="#FisherMatrix-1003"><span class="linenos">1003</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1004"><a href="#FisherMatrix-1004"><span class="linenos">1004</span></a><span class="sd">        Returns the result of adding two Fisher objects.</span>
</span><span id="FisherMatrix-1005"><a href="#FisherMatrix-1005"><span class="linenos">1005</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1006"><a href="#FisherMatrix-1006"><span class="linenos">1006</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="FisherMatrix-1007"><a href="#FisherMatrix-1007"><span class="linenos">1007</span></a>            <span class="c1"># make sure they have the right parameters</span>
</span><span id="FisherMatrix-1008"><a href="#FisherMatrix-1008"><span class="linenos">1008</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-1009"><a href="#FisherMatrix-1009"><span class="linenos">1009</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1010"><a href="#FisherMatrix-1010"><span class="linenos">1010</span></a>
</span><span id="FisherMatrix-1011"><a href="#FisherMatrix-1011"><span class="linenos">1011</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1012"><a href="#FisherMatrix-1012"><span class="linenos">1012</span></a>
</span><span id="FisherMatrix-1013"><a href="#FisherMatrix-1013"><span class="linenos">1013</span></a>            <span class="c1"># make sure the fiducials match</span>
</span><span id="FisherMatrix-1014"><a href="#FisherMatrix-1014"><span class="linenos">1014</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1015"><a href="#FisherMatrix-1015"><span class="linenos">1015</span></a>
</span><span id="FisherMatrix-1016"><a href="#FisherMatrix-1016"><span class="linenos">1016</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">):</span>
</span><span id="FisherMatrix-1017"><a href="#FisherMatrix-1017"><span class="linenos">1017</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span>
</span><span id="FisherMatrix-1018"><a href="#FisherMatrix-1018"><span class="linenos">1018</span></a>                    <span class="s2">&quot;fiducial value&quot;</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span>
</span><span id="FisherMatrix-1019"><a href="#FisherMatrix-1019"><span class="linenos">1019</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1020"><a href="#FisherMatrix-1020"><span class="linenos">1020</span></a>
</span><span id="FisherMatrix-1021"><a href="#FisherMatrix-1021"><span class="linenos">1021</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1022"><a href="#FisherMatrix-1022"><span class="linenos">1022</span></a>
</span><span id="FisherMatrix-1023"><a href="#FisherMatrix-1023"><span class="linenos">1023</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1024"><a href="#FisherMatrix-1024"><span class="linenos">1024</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">other</span>
</span><span id="FisherMatrix-1025"><a href="#FisherMatrix-1025"><span class="linenos">1025</span></a>
</span><span id="FisherMatrix-1026"><a href="#FisherMatrix-1026"><span class="linenos">1026</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1027"><a href="#FisherMatrix-1027"><span class="linenos">1027</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1028"><a href="#FisherMatrix-1028"><span class="linenos">1028</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1029"><a href="#FisherMatrix-1029"><span class="linenos">1029</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1030"><a href="#FisherMatrix-1030"><span class="linenos">1030</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1031"><a href="#FisherMatrix-1031"><span class="linenos">1031</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1032"><a href="#FisherMatrix-1032"><span class="linenos">1032</span></a>
</span><span id="FisherMatrix-1033"><a href="#FisherMatrix-1033"><span class="linenos">1033</span></a>    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span>
</span><span id="FisherMatrix-1034"><a href="#FisherMatrix-1034"><span class="linenos">1034</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1035"><a href="#FisherMatrix-1035"><span class="linenos">1035</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherMatrix-1036"><a href="#FisherMatrix-1036"><span class="linenos">1036</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1037"><a href="#FisherMatrix-1037"><span class="linenos">1037</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1038"><a href="#FisherMatrix-1038"><span class="linenos">1038</span></a><span class="sd">        Addition when the Fisher object is the right operand.</span>
</span><span id="FisherMatrix-1039"><a href="#FisherMatrix-1039"><span class="linenos">1039</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1040"><a href="#FisherMatrix-1040"><span class="linenos">1040</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="FisherMatrix-1041"><a href="#FisherMatrix-1041"><span class="linenos">1041</span></a>
</span><span id="FisherMatrix-1042"><a href="#FisherMatrix-1042"><span class="linenos">1042</span></a>    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1043"><a href="#FisherMatrix-1043"><span class="linenos">1043</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1044"><a href="#FisherMatrix-1044"><span class="linenos">1044</span></a><span class="sd">        Returns the negation of the Fisher object.</span>
</span><span id="FisherMatrix-1045"><a href="#FisherMatrix-1045"><span class="linenos">1045</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1046"><a href="#FisherMatrix-1046"><span class="linenos">1046</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1047"><a href="#FisherMatrix-1047"><span class="linenos">1047</span></a>            <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1048"><a href="#FisherMatrix-1048"><span class="linenos">1048</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1049"><a href="#FisherMatrix-1049"><span class="linenos">1049</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1050"><a href="#FisherMatrix-1050"><span class="linenos">1050</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1051"><a href="#FisherMatrix-1051"><span class="linenos">1051</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1052"><a href="#FisherMatrix-1052"><span class="linenos">1052</span></a>
</span><span id="FisherMatrix-1053"><a href="#FisherMatrix-1053"><span class="linenos">1053</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span>
</span><span id="FisherMatrix-1054"><a href="#FisherMatrix-1054"><span class="linenos">1054</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1055"><a href="#FisherMatrix-1055"><span class="linenos">1055</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherMatrix-1056"><a href="#FisherMatrix-1056"><span class="linenos">1056</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1057"><a href="#FisherMatrix-1057"><span class="linenos">1057</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1058"><a href="#FisherMatrix-1058"><span class="linenos">1058</span></a><span class="sd">        Returns the result of subtracting two Fisher objects.</span>
</span><span id="FisherMatrix-1059"><a href="#FisherMatrix-1059"><span class="linenos">1059</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1060"><a href="#FisherMatrix-1060"><span class="linenos">1060</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>
</span><span id="FisherMatrix-1061"><a href="#FisherMatrix-1061"><span class="linenos">1061</span></a>
</span><span id="FisherMatrix-1062"><a href="#FisherMatrix-1062"><span class="linenos">1062</span></a>    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span>
</span><span id="FisherMatrix-1063"><a href="#FisherMatrix-1063"><span class="linenos">1063</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1064"><a href="#FisherMatrix-1064"><span class="linenos">1064</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherMatrix-1065"><a href="#FisherMatrix-1065"><span class="linenos">1065</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1066"><a href="#FisherMatrix-1066"><span class="linenos">1066</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1067"><a href="#FisherMatrix-1067"><span class="linenos">1067</span></a><span class="sd">        Subtraction when the Fisher object is the right operand.</span>
</span><span id="FisherMatrix-1068"><a href="#FisherMatrix-1068"><span class="linenos">1068</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1069"><a href="#FisherMatrix-1069"><span class="linenos">1069</span></a>        <span class="c1"># this will never be called if we subtract two FisherMatrix instances,</span>
</span><span id="FisherMatrix-1070"><a href="#FisherMatrix-1070"><span class="linenos">1070</span></a>        <span class="c1"># so we just need to handle floats</span>
</span><span id="FisherMatrix-1071"><a href="#FisherMatrix-1071"><span class="linenos">1071</span></a>        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>
</span><span id="FisherMatrix-1072"><a href="#FisherMatrix-1072"><span class="linenos">1072</span></a>
</span><span id="FisherMatrix-1073"><a href="#FisherMatrix-1073"><span class="linenos">1073</span></a>    <span class="k">def</span> <span class="nf">__array_ufunc__</span><span class="p">(</span>
</span><span id="FisherMatrix-1074"><a href="#FisherMatrix-1074"><span class="linenos">1074</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1075"><a href="#FisherMatrix-1075"><span class="linenos">1075</span></a>        <span class="n">ufunc</span><span class="p">,</span>
</span><span id="FisherMatrix-1076"><a href="#FisherMatrix-1076"><span class="linenos">1076</span></a>        <span class="n">method</span><span class="p">,</span>
</span><span id="FisherMatrix-1077"><a href="#FisherMatrix-1077"><span class="linenos">1077</span></a>        <span class="o">*</span><span class="n">inputs</span><span class="p">,</span>
</span><span id="FisherMatrix-1078"><a href="#FisherMatrix-1078"><span class="linenos">1078</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix-1079"><a href="#FisherMatrix-1079"><span class="linenos">1079</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-1080"><a href="#FisherMatrix-1080"><span class="linenos">1080</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1081"><a href="#FisherMatrix-1081"><span class="linenos">1081</span></a><span class="sd">        Handles numpy&#39;s universal functions.</span>
</span><span id="FisherMatrix-1082"><a href="#FisherMatrix-1082"><span class="linenos">1082</span></a><span class="sd">        For a complete list and explanation, see:</span>
</span><span id="FisherMatrix-1083"><a href="#FisherMatrix-1083"><span class="linenos">1083</span></a><span class="sd">        https://numpy.org/doc/stable/reference/ufuncs.html</span>
</span><span id="FisherMatrix-1084"><a href="#FisherMatrix-1084"><span class="linenos">1084</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1085"><a href="#FisherMatrix-1085"><span class="linenos">1085</span></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;__call__&quot;</span><span class="p">:</span>
</span><span id="FisherMatrix-1086"><a href="#FisherMatrix-1086"><span class="linenos">1086</span></a>            <span class="n">scalars</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FisherMatrix-1087"><a href="#FisherMatrix-1087"><span class="linenos">1087</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
</span><span id="FisherMatrix-1088"><a href="#FisherMatrix-1088"><span class="linenos">1088</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="FisherMatrix-1089"><a href="#FisherMatrix-1089"><span class="linenos">1089</span></a>                    <span class="n">scalars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="FisherMatrix-1090"><a href="#FisherMatrix-1090"><span class="linenos">1090</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="FisherMatrix-1091"><a href="#FisherMatrix-1091"><span class="linenos">1091</span></a>                    <span class="n">scalars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="FisherMatrix-1092"><a href="#FisherMatrix-1092"><span class="linenos">1092</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1093"><a href="#FisherMatrix-1093"><span class="linenos">1093</span></a>                    <span class="k">return</span> <span class="bp">NotImplemented</span>
</span><span id="FisherMatrix-1094"><a href="#FisherMatrix-1094"><span class="linenos">1094</span></a>
</span><span id="FisherMatrix-1095"><a href="#FisherMatrix-1095"><span class="linenos">1095</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">names</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">inputs</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)]</span>
</span><span id="FisherMatrix-1096"><a href="#FisherMatrix-1096"><span class="linenos">1096</span></a>
</span><span id="FisherMatrix-1097"><a href="#FisherMatrix-1097"><span class="linenos">1097</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]):</span>
</span><span id="FisherMatrix-1098"><a href="#FisherMatrix-1098"><span class="linenos">1098</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mismatching names&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix-1099"><a href="#FisherMatrix-1099"><span class="linenos">1099</span></a>
</span><span id="FisherMatrix-1100"><a href="#FisherMatrix-1100"><span class="linenos">1100</span></a>            <span class="c1"># make sure the names have the same _ordering_</span>
</span><span id="FisherMatrix-1101"><a href="#FisherMatrix-1101"><span class="linenos">1101</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
</span><span id="FisherMatrix-1102"><a href="#FisherMatrix-1102"><span class="linenos">1102</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="FisherMatrix-1103"><a href="#FisherMatrix-1103"><span class="linenos">1103</span></a>                    <span class="n">scalars</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">_</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span>
</span><span id="FisherMatrix-1104"><a href="#FisherMatrix-1104"><span class="linenos">1104</span></a>                        <span class="n">key</span><span class="o">=</span><span class="n">get_index_of_other_array</span><span class="p">(</span>
</span><span id="FisherMatrix-1105"><a href="#FisherMatrix-1105"><span class="linenos">1105</span></a>                            <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="FisherMatrix-1106"><a href="#FisherMatrix-1106"><span class="linenos">1106</span></a>                            <span class="n">_</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1107"><a href="#FisherMatrix-1107"><span class="linenos">1107</span></a>                        <span class="p">)</span>
</span><span id="FisherMatrix-1108"><a href="#FisherMatrix-1108"><span class="linenos">1108</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">values</span>
</span><span id="FisherMatrix-1109"><a href="#FisherMatrix-1109"><span class="linenos">1109</span></a>
</span><span id="FisherMatrix-1110"><a href="#FisherMatrix-1110"><span class="linenos">1110</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1111"><a href="#FisherMatrix-1111"><span class="linenos">1111</span></a>                <span class="n">ufunc</span><span class="p">(</span><span class="o">*</span><span class="n">scalars</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="FisherMatrix-1112"><a href="#FisherMatrix-1112"><span class="linenos">1112</span></a>                <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1113"><a href="#FisherMatrix-1113"><span class="linenos">1113</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1114"><a href="#FisherMatrix-1114"><span class="linenos">1114</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1115"><a href="#FisherMatrix-1115"><span class="linenos">1115</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix-1116"><a href="#FisherMatrix-1116"><span class="linenos">1116</span></a>
</span><span id="FisherMatrix-1117"><a href="#FisherMatrix-1117"><span class="linenos">1117</span></a>        <span class="k">return</span> <span class="bp">NotImplemented</span>
</span><span id="FisherMatrix-1118"><a href="#FisherMatrix-1118"><span class="linenos">1118</span></a>
</span><span id="FisherMatrix-1119"><a href="#FisherMatrix-1119"><span class="linenos">1119</span></a>    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span>
</span><span id="FisherMatrix-1120"><a href="#FisherMatrix-1120"><span class="linenos">1120</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1121"><a href="#FisherMatrix-1121"><span class="linenos">1121</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="FisherMatrix-1122"><a href="#FisherMatrix-1122"><span class="linenos">1122</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1123"><a href="#FisherMatrix-1123"><span class="linenos">1123</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1124"><a href="#FisherMatrix-1124"><span class="linenos">1124</span></a><span class="sd">        Raises the Fisher object to some power.</span>
</span><span id="FisherMatrix-1125"><a href="#FisherMatrix-1125"><span class="linenos">1125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1126"><a href="#FisherMatrix-1126"><span class="linenos">1126</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1127"><a href="#FisherMatrix-1127"><span class="linenos">1127</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span>
</span><span id="FisherMatrix-1128"><a href="#FisherMatrix-1128"><span class="linenos">1128</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1129"><a href="#FisherMatrix-1129"><span class="linenos">1129</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1130"><a href="#FisherMatrix-1130"><span class="linenos">1130</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1131"><a href="#FisherMatrix-1131"><span class="linenos">1131</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1132"><a href="#FisherMatrix-1132"><span class="linenos">1132</span></a>
</span><span id="FisherMatrix-1133"><a href="#FisherMatrix-1133"><span class="linenos">1133</span></a>    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span>
</span><span id="FisherMatrix-1134"><a href="#FisherMatrix-1134"><span class="linenos">1134</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1135"><a href="#FisherMatrix-1135"><span class="linenos">1135</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherMatrix-1136"><a href="#FisherMatrix-1136"><span class="linenos">1136</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-1137"><a href="#FisherMatrix-1137"><span class="linenos">1137</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1138"><a href="#FisherMatrix-1138"><span class="linenos">1138</span></a><span class="sd">        Matrix multiplies two Fisher objects.</span>
</span><span id="FisherMatrix-1139"><a href="#FisherMatrix-1139"><span class="linenos">1139</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1140"><a href="#FisherMatrix-1140"><span class="linenos">1140</span></a>        <span class="c1"># make sure they have the right parameters</span>
</span><span id="FisherMatrix-1141"><a href="#FisherMatrix-1141"><span class="linenos">1141</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-1142"><a href="#FisherMatrix-1142"><span class="linenos">1142</span></a>            <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1143"><a href="#FisherMatrix-1143"><span class="linenos">1143</span></a>
</span><span id="FisherMatrix-1144"><a href="#FisherMatrix-1144"><span class="linenos">1144</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1145"><a href="#FisherMatrix-1145"><span class="linenos">1145</span></a>
</span><span id="FisherMatrix-1146"><a href="#FisherMatrix-1146"><span class="linenos">1146</span></a>        <span class="c1"># make sure the fiducials match</span>
</span><span id="FisherMatrix-1147"><a href="#FisherMatrix-1147"><span class="linenos">1147</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1148"><a href="#FisherMatrix-1148"><span class="linenos">1148</span></a>
</span><span id="FisherMatrix-1149"><a href="#FisherMatrix-1149"><span class="linenos">1149</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">):</span>
</span><span id="FisherMatrix-1150"><a href="#FisherMatrix-1150"><span class="linenos">1150</span></a>            <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;fiducial value&quot;</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix-1151"><a href="#FisherMatrix-1151"><span class="linenos">1151</span></a>
</span><span id="FisherMatrix-1152"><a href="#FisherMatrix-1152"><span class="linenos">1152</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">@</span> <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1153"><a href="#FisherMatrix-1153"><span class="linenos">1153</span></a>
</span><span id="FisherMatrix-1154"><a href="#FisherMatrix-1154"><span class="linenos">1154</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1155"><a href="#FisherMatrix-1155"><span class="linenos">1155</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1156"><a href="#FisherMatrix-1156"><span class="linenos">1156</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1157"><a href="#FisherMatrix-1157"><span class="linenos">1157</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1158"><a href="#FisherMatrix-1158"><span class="linenos">1158</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1159"><a href="#FisherMatrix-1159"><span class="linenos">1159</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1160"><a href="#FisherMatrix-1160"><span class="linenos">1160</span></a>
</span><span id="FisherMatrix-1161"><a href="#FisherMatrix-1161"><span class="linenos">1161</span></a>    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span>
</span><span id="FisherMatrix-1162"><a href="#FisherMatrix-1162"><span class="linenos">1162</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1163"><a href="#FisherMatrix-1163"><span class="linenos">1163</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FisherMatrix</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="FisherMatrix-1164"><a href="#FisherMatrix-1164"><span class="linenos">1164</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1165"><a href="#FisherMatrix-1165"><span class="linenos">1165</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1166"><a href="#FisherMatrix-1166"><span class="linenos">1166</span></a><span class="sd">        Returns the result of dividing a Fisher object by a number, or another</span>
</span><span id="FisherMatrix-1167"><a href="#FisherMatrix-1167"><span class="linenos">1167</span></a><span class="sd">        Fisher object (element-wise).</span>
</span><span id="FisherMatrix-1168"><a href="#FisherMatrix-1168"><span class="linenos">1168</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1169"><a href="#FisherMatrix-1169"><span class="linenos">1169</span></a>        <span class="c1"># we can only divide two objects if they have the same dimensions and sizes</span>
</span><span id="FisherMatrix-1170"><a href="#FisherMatrix-1170"><span class="linenos">1170</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="FisherMatrix-1171"><a href="#FisherMatrix-1171"><span class="linenos">1171</span></a>            <span class="c1"># maybe it&#39;s a FisherMatrix</span>
</span><span id="FisherMatrix-1172"><a href="#FisherMatrix-1172"><span class="linenos">1172</span></a>            <span class="c1"># make sure they have the right parameters</span>
</span><span id="FisherMatrix-1173"><a href="#FisherMatrix-1173"><span class="linenos">1173</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-1174"><a href="#FisherMatrix-1174"><span class="linenos">1174</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1175"><a href="#FisherMatrix-1175"><span class="linenos">1175</span></a>
</span><span id="FisherMatrix-1176"><a href="#FisherMatrix-1176"><span class="linenos">1176</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1177"><a href="#FisherMatrix-1177"><span class="linenos">1177</span></a>
</span><span id="FisherMatrix-1178"><a href="#FisherMatrix-1178"><span class="linenos">1178</span></a>            <span class="c1"># make sure the fiducials match</span>
</span><span id="FisherMatrix-1179"><a href="#FisherMatrix-1179"><span class="linenos">1179</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1180"><a href="#FisherMatrix-1180"><span class="linenos">1180</span></a>
</span><span id="FisherMatrix-1181"><a href="#FisherMatrix-1181"><span class="linenos">1181</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">):</span>
</span><span id="FisherMatrix-1182"><a href="#FisherMatrix-1182"><span class="linenos">1182</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span>
</span><span id="FisherMatrix-1183"><a href="#FisherMatrix-1183"><span class="linenos">1183</span></a>                    <span class="s2">&quot;fiducial value&quot;</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span>
</span><span id="FisherMatrix-1184"><a href="#FisherMatrix-1184"><span class="linenos">1184</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1185"><a href="#FisherMatrix-1185"><span class="linenos">1185</span></a>
</span><span id="FisherMatrix-1186"><a href="#FisherMatrix-1186"><span class="linenos">1186</span></a>            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="FisherMatrix-1187"><a href="#FisherMatrix-1187"><span class="linenos">1187</span></a>                <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1188"><a href="#FisherMatrix-1188"><span class="linenos">1188</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1189"><a href="#FisherMatrix-1189"><span class="linenos">1189</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">other</span>
</span><span id="FisherMatrix-1190"><a href="#FisherMatrix-1190"><span class="linenos">1190</span></a>
</span><span id="FisherMatrix-1191"><a href="#FisherMatrix-1191"><span class="linenos">1191</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1192"><a href="#FisherMatrix-1192"><span class="linenos">1192</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1193"><a href="#FisherMatrix-1193"><span class="linenos">1193</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1194"><a href="#FisherMatrix-1194"><span class="linenos">1194</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1195"><a href="#FisherMatrix-1195"><span class="linenos">1195</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1196"><a href="#FisherMatrix-1196"><span class="linenos">1196</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1197"><a href="#FisherMatrix-1197"><span class="linenos">1197</span></a>
</span><span id="FisherMatrix-1198"><a href="#FisherMatrix-1198"><span class="linenos">1198</span></a>    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span>
</span><span id="FisherMatrix-1199"><a href="#FisherMatrix-1199"><span class="linenos">1199</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1200"><a href="#FisherMatrix-1200"><span class="linenos">1200</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FisherMatrix</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="FisherMatrix-1201"><a href="#FisherMatrix-1201"><span class="linenos">1201</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1202"><a href="#FisherMatrix-1202"><span class="linenos">1202</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1203"><a href="#FisherMatrix-1203"><span class="linenos">1203</span></a><span class="sd">        Returns the result of multiplying a Fisher object by a number, or</span>
</span><span id="FisherMatrix-1204"><a href="#FisherMatrix-1204"><span class="linenos">1204</span></a><span class="sd">        another Fisher object (element-wise).</span>
</span><span id="FisherMatrix-1205"><a href="#FisherMatrix-1205"><span class="linenos">1205</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1206"><a href="#FisherMatrix-1206"><span class="linenos">1206</span></a>        <span class="c1"># we can only multiply two objects if they have the same dimensions and sizes</span>
</span><span id="FisherMatrix-1207"><a href="#FisherMatrix-1207"><span class="linenos">1207</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
</span><span id="FisherMatrix-1208"><a href="#FisherMatrix-1208"><span class="linenos">1208</span></a>            <span class="c1"># maybe it&#39;s a FisherMatrix</span>
</span><span id="FisherMatrix-1209"><a href="#FisherMatrix-1209"><span class="linenos">1209</span></a>            <span class="c1"># make sure they have the right parameters</span>
</span><span id="FisherMatrix-1210"><a href="#FisherMatrix-1210"><span class="linenos">1210</span></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix-1211"><a href="#FisherMatrix-1211"><span class="linenos">1211</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1212"><a href="#FisherMatrix-1212"><span class="linenos">1212</span></a>
</span><span id="FisherMatrix-1213"><a href="#FisherMatrix-1213"><span class="linenos">1213</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1214"><a href="#FisherMatrix-1214"><span class="linenos">1214</span></a>
</span><span id="FisherMatrix-1215"><a href="#FisherMatrix-1215"><span class="linenos">1215</span></a>            <span class="c1"># make sure the fiducials match</span>
</span><span id="FisherMatrix-1216"><a href="#FisherMatrix-1216"><span class="linenos">1216</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix-1217"><a href="#FisherMatrix-1217"><span class="linenos">1217</span></a>
</span><span id="FisherMatrix-1218"><a href="#FisherMatrix-1218"><span class="linenos">1218</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">):</span>
</span><span id="FisherMatrix-1219"><a href="#FisherMatrix-1219"><span class="linenos">1219</span></a>                <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span>
</span><span id="FisherMatrix-1220"><a href="#FisherMatrix-1220"><span class="linenos">1220</span></a>                    <span class="s2">&quot;fiducial value&quot;</span><span class="p">,</span> <span class="n">fiducials</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span>
</span><span id="FisherMatrix-1221"><a href="#FisherMatrix-1221"><span class="linenos">1221</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix-1222"><a href="#FisherMatrix-1222"><span class="linenos">1222</span></a>
</span><span id="FisherMatrix-1223"><a href="#FisherMatrix-1223"><span class="linenos">1223</span></a>            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
</span><span id="FisherMatrix-1224"><a href="#FisherMatrix-1224"><span class="linenos">1224</span></a>                <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">reindex_array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix-1225"><a href="#FisherMatrix-1225"><span class="linenos">1225</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1226"><a href="#FisherMatrix-1226"><span class="linenos">1226</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">other</span>
</span><span id="FisherMatrix-1227"><a href="#FisherMatrix-1227"><span class="linenos">1227</span></a>
</span><span id="FisherMatrix-1228"><a href="#FisherMatrix-1228"><span class="linenos">1228</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1229"><a href="#FisherMatrix-1229"><span class="linenos">1229</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1230"><a href="#FisherMatrix-1230"><span class="linenos">1230</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1231"><a href="#FisherMatrix-1231"><span class="linenos">1231</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1232"><a href="#FisherMatrix-1232"><span class="linenos">1232</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1233"><a href="#FisherMatrix-1233"><span class="linenos">1233</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1234"><a href="#FisherMatrix-1234"><span class="linenos">1234</span></a>
</span><span id="FisherMatrix-1235"><a href="#FisherMatrix-1235"><span class="linenos">1235</span></a>    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span>
</span><span id="FisherMatrix-1236"><a href="#FisherMatrix-1236"><span class="linenos">1236</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1237"><a href="#FisherMatrix-1237"><span class="linenos">1237</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FisherMatrix</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
</span><span id="FisherMatrix-1238"><a href="#FisherMatrix-1238"><span class="linenos">1238</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1239"><a href="#FisherMatrix-1239"><span class="linenos">1239</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1240"><a href="#FisherMatrix-1240"><span class="linenos">1240</span></a><span class="sd">        Returns the result of multiplying a number by a Fisher object, or</span>
</span><span id="FisherMatrix-1241"><a href="#FisherMatrix-1241"><span class="linenos">1241</span></a><span class="sd">        another Fisher object (element-wise).</span>
</span><span id="FisherMatrix-1242"><a href="#FisherMatrix-1242"><span class="linenos">1242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1243"><a href="#FisherMatrix-1243"><span class="linenos">1243</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="FisherMatrix-1244"><a href="#FisherMatrix-1244"><span class="linenos">1244</span></a>
</span><span id="FisherMatrix-1245"><a href="#FisherMatrix-1245"><span class="linenos">1245</span></a>    <span class="k">def</span> <span class="nf">reparametrize</span><span class="p">(</span>
</span><span id="FisherMatrix-1246"><a href="#FisherMatrix-1246"><span class="linenos">1246</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1247"><a href="#FisherMatrix-1247"><span class="linenos">1247</span></a>        <span class="n">jacobian</span><span class="p">,</span>
</span><span id="FisherMatrix-1248"><a href="#FisherMatrix-1248"><span class="linenos">1248</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-1249"><a href="#FisherMatrix-1249"><span class="linenos">1249</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-1250"><a href="#FisherMatrix-1250"><span class="linenos">1250</span></a>        <span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix-1251"><a href="#FisherMatrix-1251"><span class="linenos">1251</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1252"><a href="#FisherMatrix-1252"><span class="linenos">1252</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1253"><a href="#FisherMatrix-1253"><span class="linenos">1253</span></a><span class="sd">        Returns a new Fisher object with parameters `names`, which are</span>
</span><span id="FisherMatrix-1254"><a href="#FisherMatrix-1254"><span class="linenos">1254</span></a><span class="sd">        related to the old ones via the transformation `jacobian`.</span>
</span><span id="FisherMatrix-1255"><a href="#FisherMatrix-1255"><span class="linenos">1255</span></a><span class="sd">        See the [Wikipedia</span>
</span><span id="FisherMatrix-1256"><a href="#FisherMatrix-1256"><span class="linenos">1256</span></a><span class="sd">        article](https://en.wikipedia.org/w/index.php?title=Fisher_information&amp;oldid=1063384000#Reparametrization)</span>
</span><span id="FisherMatrix-1257"><a href="#FisherMatrix-1257"><span class="linenos">1257</span></a><span class="sd">        for more information.</span>
</span><span id="FisherMatrix-1258"><a href="#FisherMatrix-1258"><span class="linenos">1258</span></a>
</span><span id="FisherMatrix-1259"><a href="#FisherMatrix-1259"><span class="linenos">1259</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1260"><a href="#FisherMatrix-1260"><span class="linenos">1260</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1261"><a href="#FisherMatrix-1261"><span class="linenos">1261</span></a><span class="sd">        transformation : array-like</span>
</span><span id="FisherMatrix-1262"><a href="#FisherMatrix-1262"><span class="linenos">1262</span></a><span class="sd">            the Jacobian of the transformation</span>
</span><span id="FisherMatrix-1263"><a href="#FisherMatrix-1263"><span class="linenos">1263</span></a>
</span><span id="FisherMatrix-1264"><a href="#FisherMatrix-1264"><span class="linenos">1264</span></a><span class="sd">        names : array-like = None</span>
</span><span id="FisherMatrix-1265"><a href="#FisherMatrix-1265"><span class="linenos">1265</span></a><span class="sd">            list of new names for the Fisher object. If None, uses the old</span>
</span><span id="FisherMatrix-1266"><a href="#FisherMatrix-1266"><span class="linenos">1266</span></a><span class="sd">            names.</span>
</span><span id="FisherMatrix-1267"><a href="#FisherMatrix-1267"><span class="linenos">1267</span></a>
</span><span id="FisherMatrix-1268"><a href="#FisherMatrix-1268"><span class="linenos">1268</span></a><span class="sd">        latex_names: array-like = None</span>
</span><span id="FisherMatrix-1269"><a href="#FisherMatrix-1269"><span class="linenos">1269</span></a><span class="sd">            list of new LaTeX names for the Fisher object. If None, and</span>
</span><span id="FisherMatrix-1270"><a href="#FisherMatrix-1270"><span class="linenos">1270</span></a><span class="sd">            `names` is set, uses those instead, otherwise uses the old LaTeX names.</span>
</span><span id="FisherMatrix-1271"><a href="#FisherMatrix-1271"><span class="linenos">1271</span></a>
</span><span id="FisherMatrix-1272"><a href="#FisherMatrix-1272"><span class="linenos">1272</span></a><span class="sd">        fiducials : array-like = None</span>
</span><span id="FisherMatrix-1273"><a href="#FisherMatrix-1273"><span class="linenos">1273</span></a><span class="sd">            the new values of the fiducials. If not set, defaults to old values.</span>
</span><span id="FisherMatrix-1274"><a href="#FisherMatrix-1274"><span class="linenos">1274</span></a>
</span><span id="FisherMatrix-1275"><a href="#FisherMatrix-1275"><span class="linenos">1275</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1276"><a href="#FisherMatrix-1276"><span class="linenos">1276</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1277"><a href="#FisherMatrix-1277"><span class="linenos">1277</span></a><span class="sd">        Instance of `FisherMatrix`.</span>
</span><span id="FisherMatrix-1278"><a href="#FisherMatrix-1278"><span class="linenos">1278</span></a>
</span><span id="FisherMatrix-1279"><a href="#FisherMatrix-1279"><span class="linenos">1279</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1280"><a href="#FisherMatrix-1280"><span class="linenos">1280</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1281"><a href="#FisherMatrix-1281"><span class="linenos">1281</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]))</span>
</span><span id="FisherMatrix-1282"><a href="#FisherMatrix-1282"><span class="linenos">1282</span></a><span class="sd">        &gt;&gt;&gt; jac = [[1, 4], [3, 2]]</span>
</span><span id="FisherMatrix-1283"><a href="#FisherMatrix-1283"><span class="linenos">1283</span></a><span class="sd">        &gt;&gt;&gt; fm.reparametrize(jac, names=[&#39;a&#39;, &#39;b&#39;])</span>
</span><span id="FisherMatrix-1284"><a href="#FisherMatrix-1284"><span class="linenos">1284</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1285"><a href="#FisherMatrix-1285"><span class="linenos">1285</span></a><span class="sd">            array([[19., 16.],</span>
</span><span id="FisherMatrix-1286"><a href="#FisherMatrix-1286"><span class="linenos">1286</span></a><span class="sd">               [16., 24.]]),</span>
</span><span id="FisherMatrix-1287"><a href="#FisherMatrix-1287"><span class="linenos">1287</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1288"><a href="#FisherMatrix-1288"><span class="linenos">1288</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1289"><a href="#FisherMatrix-1289"><span class="linenos">1289</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-1290"><a href="#FisherMatrix-1290"><span class="linenos">1290</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1291"><a href="#FisherMatrix-1291"><span class="linenos">1291</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">@</span> <span class="n">jacobian</span>
</span><span id="FisherMatrix-1292"><a href="#FisherMatrix-1292"><span class="linenos">1292</span></a>
</span><span id="FisherMatrix-1293"><a href="#FisherMatrix-1293"><span class="linenos">1293</span></a>        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-1294"><a href="#FisherMatrix-1294"><span class="linenos">1294</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix-1295"><a href="#FisherMatrix-1295"><span class="linenos">1295</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1296"><a href="#FisherMatrix-1296"><span class="linenos">1296</span></a>            <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-1297"><a href="#FisherMatrix-1297"><span class="linenos">1297</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">latex_names</span><span class="p">))</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix-1298"><a href="#FisherMatrix-1298"><span class="linenos">1298</span></a>                    <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix-1299"><a href="#FisherMatrix-1299"><span class="linenos">1299</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1300"><a href="#FisherMatrix-1300"><span class="linenos">1300</span></a>                <span class="n">latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1301"><a href="#FisherMatrix-1301"><span class="linenos">1301</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1302"><a href="#FisherMatrix-1302"><span class="linenos">1302</span></a>            <span class="c1"># we don&#39;t transform the names</span>
</span><span id="FisherMatrix-1303"><a href="#FisherMatrix-1303"><span class="linenos">1303</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1304"><a href="#FisherMatrix-1304"><span class="linenos">1304</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix-1305"><a href="#FisherMatrix-1305"><span class="linenos">1305</span></a>
</span><span id="FisherMatrix-1306"><a href="#FisherMatrix-1306"><span class="linenos">1306</span></a>        <span class="k">if</span> <span class="n">fiducials</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-1307"><a href="#FisherMatrix-1307"><span class="linenos">1307</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fiducials</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix-1308"><a href="#FisherMatrix-1308"><span class="linenos">1308</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix-1309"><a href="#FisherMatrix-1309"><span class="linenos">1309</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix-1310"><a href="#FisherMatrix-1310"><span class="linenos">1310</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix-1311"><a href="#FisherMatrix-1311"><span class="linenos">1311</span></a>
</span><span id="FisherMatrix-1312"><a href="#FisherMatrix-1312"><span class="linenos">1312</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1313"><a href="#FisherMatrix-1313"><span class="linenos">1313</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1314"><a href="#FisherMatrix-1314"><span class="linenos">1314</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1315"><a href="#FisherMatrix-1315"><span class="linenos">1315</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1316"><a href="#FisherMatrix-1316"><span class="linenos">1316</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1317"><a href="#FisherMatrix-1317"><span class="linenos">1317</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1318"><a href="#FisherMatrix-1318"><span class="linenos">1318</span></a>
</span><span id="FisherMatrix-1319"><a href="#FisherMatrix-1319"><span class="linenos">1319</span></a>    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span>
</span><span id="FisherMatrix-1320"><a href="#FisherMatrix-1320"><span class="linenos">1320</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FisherMatrix-1321"><a href="#FisherMatrix-1321"><span class="linenos">1321</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="FisherMatrix-1322"><a href="#FisherMatrix-1322"><span class="linenos">1322</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1323"><a href="#FisherMatrix-1323"><span class="linenos">1323</span></a><span class="sd">        Saves the Fisher object to a file (UTF-8 encoded).</span>
</span><span id="FisherMatrix-1324"><a href="#FisherMatrix-1324"><span class="linenos">1324</span></a><span class="sd">        The format used is a simple JSON file, containing at least the values of the</span>
</span><span id="FisherMatrix-1325"><a href="#FisherMatrix-1325"><span class="linenos">1325</span></a><span class="sd">        Fisher object, the names of the parameters, the LaTeX names, and the</span>
</span><span id="FisherMatrix-1326"><a href="#FisherMatrix-1326"><span class="linenos">1326</span></a><span class="sd">        fiducial values.</span>
</span><span id="FisherMatrix-1327"><a href="#FisherMatrix-1327"><span class="linenos">1327</span></a>
</span><span id="FisherMatrix-1328"><a href="#FisherMatrix-1328"><span class="linenos">1328</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1329"><a href="#FisherMatrix-1329"><span class="linenos">1329</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1330"><a href="#FisherMatrix-1330"><span class="linenos">1330</span></a><span class="sd">        path : str</span>
</span><span id="FisherMatrix-1331"><a href="#FisherMatrix-1331"><span class="linenos">1331</span></a><span class="sd">            the path to save the data to.</span>
</span><span id="FisherMatrix-1332"><a href="#FisherMatrix-1332"><span class="linenos">1332</span></a>
</span><span id="FisherMatrix-1333"><a href="#FisherMatrix-1333"><span class="linenos">1333</span></a><span class="sd">        metadata : Optional[Mapping[str, Any]] = None</span>
</span><span id="FisherMatrix-1334"><a href="#FisherMatrix-1334"><span class="linenos">1334</span></a><span class="sd">            any metadata that should be associated to the object saved, in the</span>
</span><span id="FisherMatrix-1335"><a href="#FisherMatrix-1335"><span class="linenos">1335</span></a><span class="sd">            form of a dictionary-like object</span>
</span><span id="FisherMatrix-1336"><a href="#FisherMatrix-1336"><span class="linenos">1336</span></a>
</span><span id="FisherMatrix-1337"><a href="#FisherMatrix-1337"><span class="linenos">1337</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1338"><a href="#FisherMatrix-1338"><span class="linenos">1338</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1339"><a href="#FisherMatrix-1339"><span class="linenos">1339</span></a><span class="sd">        The dictionary that was saved.</span>
</span><span id="FisherMatrix-1340"><a href="#FisherMatrix-1340"><span class="linenos">1340</span></a>
</span><span id="FisherMatrix-1341"><a href="#FisherMatrix-1341"><span class="linenos">1341</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1342"><a href="#FisherMatrix-1342"><span class="linenos">1342</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1343"><a href="#FisherMatrix-1343"><span class="linenos">1343</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix-1344"><a href="#FisherMatrix-1344"><span class="linenos">1344</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], latex_names=[r&#39;$\mathbf{A}$&#39;, r&#39;$\mathbf{B}$&#39;])</span>
</span><span id="FisherMatrix-1345"><a href="#FisherMatrix-1345"><span class="linenos">1345</span></a><span class="sd">        &gt;&gt;&gt; pprint(fm.to_file(&#39;example_matrix.json&#39;), sort_dicts=False) # doctest: +SKIP</span>
</span><span id="FisherMatrix-1346"><a href="#FisherMatrix-1346"><span class="linenos">1346</span></a><span class="sd">        {&#39;values&#39;: [[1.0, 0.0], [0.0, 2.0]],</span>
</span><span id="FisherMatrix-1347"><a href="#FisherMatrix-1347"><span class="linenos">1347</span></a><span class="sd">         &#39;names&#39;: [&#39;a&#39;, &#39;b&#39;],</span>
</span><span id="FisherMatrix-1348"><a href="#FisherMatrix-1348"><span class="linenos">1348</span></a><span class="sd">         &#39;latex_names&#39;: [&#39;$\\mathbf{A}$&#39;, &#39;$\\mathbf{B}$&#39;],</span>
</span><span id="FisherMatrix-1349"><a href="#FisherMatrix-1349"><span class="linenos">1349</span></a><span class="sd">         &#39;fiducials&#39;: [0.0, 0.0]}</span>
</span><span id="FisherMatrix-1350"><a href="#FisherMatrix-1350"><span class="linenos">1350</span></a><span class="sd">        &gt;&gt;&gt; # convenience function for reading it</span>
</span><span id="FisherMatrix-1351"><a href="#FisherMatrix-1351"><span class="linenos">1351</span></a><span class="sd">        &gt;&gt;&gt; fm_read = FisherMatrix.from_file(&#39;example_matrix.json&#39;)</span>
</span><span id="FisherMatrix-1352"><a href="#FisherMatrix-1352"><span class="linenos">1352</span></a><span class="sd">        &gt;&gt;&gt; fm == fm_read # verify it&#39;s the same object</span>
</span><span id="FisherMatrix-1353"><a href="#FisherMatrix-1353"><span class="linenos">1353</span></a><span class="sd">        True</span>
</span><span id="FisherMatrix-1354"><a href="#FisherMatrix-1354"><span class="linenos">1354</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1355"><a href="#FisherMatrix-1355"><span class="linenos">1355</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="FisherMatrix-1356"><a href="#FisherMatrix-1356"><span class="linenos">1356</span></a>            <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix-1357"><a href="#FisherMatrix-1357"><span class="linenos">1357</span></a>            <span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1358"><a href="#FisherMatrix-1358"><span class="linenos">1358</span></a>            <span class="s2">&quot;latex_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1359"><a href="#FisherMatrix-1359"><span class="linenos">1359</span></a>            <span class="s2">&quot;fiducials&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1360"><a href="#FisherMatrix-1360"><span class="linenos">1360</span></a>        <span class="p">}</span>
</span><span id="FisherMatrix-1361"><a href="#FisherMatrix-1361"><span class="linenos">1361</span></a>
</span><span id="FisherMatrix-1362"><a href="#FisherMatrix-1362"><span class="linenos">1362</span></a>        <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix-1363"><a href="#FisherMatrix-1363"><span class="linenos">1363</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="FisherMatrix-1364"><a href="#FisherMatrix-1364"><span class="linenos">1364</span></a>                <span class="o">**</span><span class="n">data</span><span class="p">,</span>
</span><span id="FisherMatrix-1365"><a href="#FisherMatrix-1365"><span class="linenos">1365</span></a>                <span class="o">**</span><span class="p">{</span><span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">},</span>
</span><span id="FisherMatrix-1366"><a href="#FisherMatrix-1366"><span class="linenos">1366</span></a>            <span class="p">}</span>
</span><span id="FisherMatrix-1367"><a href="#FisherMatrix-1367"><span class="linenos">1367</span></a>
</span><span id="FisherMatrix-1368"><a href="#FisherMatrix-1368"><span class="linenos">1368</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
</span><span id="FisherMatrix-1369"><a href="#FisherMatrix-1369"><span class="linenos">1369</span></a>            <span class="n">file_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">FisherEncoder</span><span class="p">))</span>
</span><span id="FisherMatrix-1370"><a href="#FisherMatrix-1370"><span class="linenos">1370</span></a>
</span><span id="FisherMatrix-1371"><a href="#FisherMatrix-1371"><span class="linenos">1371</span></a>        <span class="k">return</span> <span class="n">data</span>
</span><span id="FisherMatrix-1372"><a href="#FisherMatrix-1372"><span class="linenos">1372</span></a>
</span><span id="FisherMatrix-1373"><a href="#FisherMatrix-1373"><span class="linenos">1373</span></a>    <span class="k">def</span> <span class="nf">marginalize_over</span><span class="p">(</span>
</span><span id="FisherMatrix-1374"><a href="#FisherMatrix-1374"><span class="linenos">1374</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix-1375"><a href="#FisherMatrix-1375"><span class="linenos">1375</span></a>        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix-1376"><a href="#FisherMatrix-1376"><span class="linenos">1376</span></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix-1377"><a href="#FisherMatrix-1377"><span class="linenos">1377</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix-1378"><a href="#FisherMatrix-1378"><span class="linenos">1378</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix-1379"><a href="#FisherMatrix-1379"><span class="linenos">1379</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1380"><a href="#FisherMatrix-1380"><span class="linenos">1380</span></a><span class="sd">        Perform marginalization over some parameters.</span>
</span><span id="FisherMatrix-1381"><a href="#FisherMatrix-1381"><span class="linenos">1381</span></a>
</span><span id="FisherMatrix-1382"><a href="#FisherMatrix-1382"><span class="linenos">1382</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1383"><a href="#FisherMatrix-1383"><span class="linenos">1383</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1384"><a href="#FisherMatrix-1384"><span class="linenos">1384</span></a><span class="sd">        names : str</span>
</span><span id="FisherMatrix-1385"><a href="#FisherMatrix-1385"><span class="linenos">1385</span></a><span class="sd">            the names of the parameters to marginalize over</span>
</span><span id="FisherMatrix-1386"><a href="#FisherMatrix-1386"><span class="linenos">1386</span></a>
</span><span id="FisherMatrix-1387"><a href="#FisherMatrix-1387"><span class="linenos">1387</span></a><span class="sd">        invert : bool = False</span>
</span><span id="FisherMatrix-1388"><a href="#FisherMatrix-1388"><span class="linenos">1388</span></a><span class="sd">            whether to marginalize over all the parameters NOT in names (the complement)</span>
</span><span id="FisherMatrix-1389"><a href="#FisherMatrix-1389"><span class="linenos">1389</span></a>
</span><span id="FisherMatrix-1390"><a href="#FisherMatrix-1390"><span class="linenos">1390</span></a><span class="sd">        ignore_errors : bool = False</span>
</span><span id="FisherMatrix-1391"><a href="#FisherMatrix-1391"><span class="linenos">1391</span></a><span class="sd">            should non-existing parameters be ignored</span>
</span><span id="FisherMatrix-1392"><a href="#FisherMatrix-1392"><span class="linenos">1392</span></a>
</span><span id="FisherMatrix-1393"><a href="#FisherMatrix-1393"><span class="linenos">1393</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1394"><a href="#FisherMatrix-1394"><span class="linenos">1394</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1395"><a href="#FisherMatrix-1395"><span class="linenos">1395</span></a><span class="sd">        Instance of `FisherMatrix`.</span>
</span><span id="FisherMatrix-1396"><a href="#FisherMatrix-1396"><span class="linenos">1396</span></a>
</span><span id="FisherMatrix-1397"><a href="#FisherMatrix-1397"><span class="linenos">1397</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix-1398"><a href="#FisherMatrix-1398"><span class="linenos">1398</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix-1399"><a href="#FisherMatrix-1399"><span class="linenos">1399</span></a><span class="sd">        Generate a Fisher object using a random orthogonal matrix:</span>
</span><span id="FisherMatrix-1400"><a href="#FisherMatrix-1400"><span class="linenos">1400</span></a><span class="sd">        &gt;&gt;&gt; from scipy.stats import ortho_group</span>
</span><span id="FisherMatrix-1401"><a href="#FisherMatrix-1401"><span class="linenos">1401</span></a><span class="sd">        &gt;&gt;&gt; rm = ortho_group.rvs(5, random_state=12345)</span>
</span><span id="FisherMatrix-1402"><a href="#FisherMatrix-1402"><span class="linenos">1402</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(rm.T @ np.diag([1, 2, 3, 7, 6]) @ rm)</span>
</span><span id="FisherMatrix-1403"><a href="#FisherMatrix-1403"><span class="linenos">1403</span></a>
</span><span id="FisherMatrix-1404"><a href="#FisherMatrix-1404"><span class="linenos">1404</span></a><span class="sd">        Marginalize over some parameters:</span>
</span><span id="FisherMatrix-1405"><a href="#FisherMatrix-1405"><span class="linenos">1405</span></a><span class="sd">        &gt;&gt;&gt; fm.marginalize_over(&#39;p1&#39;, &#39;p2&#39;)</span>
</span><span id="FisherMatrix-1406"><a href="#FisherMatrix-1406"><span class="linenos">1406</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1407"><a href="#FisherMatrix-1407"><span class="linenos">1407</span></a><span class="sd">            array([[ 1.67715591, -1.01556085,  0.30020773],</span>
</span><span id="FisherMatrix-1408"><a href="#FisherMatrix-1408"><span class="linenos">1408</span></a><span class="sd">               [-1.01556085,  4.92788976,  0.91219831],</span>
</span><span id="FisherMatrix-1409"><a href="#FisherMatrix-1409"><span class="linenos">1409</span></a><span class="sd">               [ 0.30020773,  0.91219831,  3.1796454 ]]),</span>
</span><span id="FisherMatrix-1410"><a href="#FisherMatrix-1410"><span class="linenos">1410</span></a><span class="sd">            names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1411"><a href="#FisherMatrix-1411"><span class="linenos">1411</span></a><span class="sd">            latex_names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1412"><a href="#FisherMatrix-1412"><span class="linenos">1412</span></a><span class="sd">            fiducials=array([0., 0., 0.]))</span>
</span><span id="FisherMatrix-1413"><a href="#FisherMatrix-1413"><span class="linenos">1413</span></a>
</span><span id="FisherMatrix-1414"><a href="#FisherMatrix-1414"><span class="linenos">1414</span></a><span class="sd">        Marginalize over all parameters which are NOT `p1` or `p2`:</span>
</span><span id="FisherMatrix-1415"><a href="#FisherMatrix-1415"><span class="linenos">1415</span></a><span class="sd">        &gt;&gt;&gt; fm.marginalize_over(&#39;p1&#39;, &#39;p2&#39;, invert=True)</span>
</span><span id="FisherMatrix-1416"><a href="#FisherMatrix-1416"><span class="linenos">1416</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix-1417"><a href="#FisherMatrix-1417"><span class="linenos">1417</span></a><span class="sd">            array([[ 5.04480062, -0.04490453],</span>
</span><span id="FisherMatrix-1418"><a href="#FisherMatrix-1418"><span class="linenos">1418</span></a><span class="sd">               [-0.04490453,  1.61599083]]),</span>
</span><span id="FisherMatrix-1419"><a href="#FisherMatrix-1419"><span class="linenos">1419</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1420"><a href="#FisherMatrix-1420"><span class="linenos">1420</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix-1421"><a href="#FisherMatrix-1421"><span class="linenos">1421</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix-1422"><a href="#FisherMatrix-1422"><span class="linenos">1422</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1423"><a href="#FisherMatrix-1423"><span class="linenos">1423</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1424"><a href="#FisherMatrix-1424"><span class="linenos">1424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span>
</span><span id="FisherMatrix-1425"><a href="#FisherMatrix-1425"><span class="linenos">1425</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1426"><a href="#FisherMatrix-1426"><span class="linenos">1426</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1427"><a href="#FisherMatrix-1427"><span class="linenos">1427</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1428"><a href="#FisherMatrix-1428"><span class="linenos">1428</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1429"><a href="#FisherMatrix-1429"><span class="linenos">1429</span></a>        <span class="k">if</span> <span class="n">invert</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix-1430"><a href="#FisherMatrix-1430"><span class="linenos">1430</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">^</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix-1431"><a href="#FisherMatrix-1431"><span class="linenos">1431</span></a>        <span class="n">fisher</span> <span class="o">=</span> <span class="n">inv</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="n">ignore_errors</span><span class="p">)</span>
</span><span id="FisherMatrix-1432"><a href="#FisherMatrix-1432"><span class="linenos">1432</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix-1433"><a href="#FisherMatrix-1433"><span class="linenos">1433</span></a>            <span class="n">fisher</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span>
</span><span id="FisherMatrix-1434"><a href="#FisherMatrix-1434"><span class="linenos">1434</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix-1435"><a href="#FisherMatrix-1435"><span class="linenos">1435</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix-1436"><a href="#FisherMatrix-1436"><span class="linenos">1436</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix-1437"><a href="#FisherMatrix-1437"><span class="linenos">1437</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix-1438"><a href="#FisherMatrix-1438"><span class="linenos">1438</span></a>
</span><span id="FisherMatrix-1439"><a href="#FisherMatrix-1439"><span class="linenos">1439</span></a>    <span class="nd">@classmethod</span>
</span><span id="FisherMatrix-1440"><a href="#FisherMatrix-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
</span><span id="FisherMatrix-1441"><a href="#FisherMatrix-1441"><span class="linenos">1441</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="FisherMatrix-1442"><a href="#FisherMatrix-1442"><span class="linenos">1442</span></a>        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix-1443"><a href="#FisherMatrix-1443"><span class="linenos">1443</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix-1444"><a href="#FisherMatrix-1444"><span class="linenos">1444</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1445"><a href="#FisherMatrix-1445"><span class="linenos">1445</span></a><span class="sd">        Reads a Fisher object from a file.</span>
</span><span id="FisherMatrix-1446"><a href="#FisherMatrix-1446"><span class="linenos">1446</span></a>
</span><span id="FisherMatrix-1447"><a href="#FisherMatrix-1447"><span class="linenos">1447</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix-1448"><a href="#FisherMatrix-1448"><span class="linenos">1448</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix-1449"><a href="#FisherMatrix-1449"><span class="linenos">1449</span></a><span class="sd">        path : str</span>
</span><span id="FisherMatrix-1450"><a href="#FisherMatrix-1450"><span class="linenos">1450</span></a><span class="sd">            the path to the file</span>
</span><span id="FisherMatrix-1451"><a href="#FisherMatrix-1451"><span class="linenos">1451</span></a>
</span><span id="FisherMatrix-1452"><a href="#FisherMatrix-1452"><span class="linenos">1452</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix-1453"><a href="#FisherMatrix-1453"><span class="linenos">1453</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix-1454"><a href="#FisherMatrix-1454"><span class="linenos">1454</span></a><span class="sd">        Instance of `FisherMatrix`</span>
</span><span id="FisherMatrix-1455"><a href="#FisherMatrix-1455"><span class="linenos">1455</span></a>
</span><span id="FisherMatrix-1456"><a href="#FisherMatrix-1456"><span class="linenos">1456</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix-1457"><a href="#FisherMatrix-1457"><span class="linenos">1457</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix-1458"><a href="#FisherMatrix-1458"><span class="linenos">1458</span></a><span class="sd">        Any metadata is ignored when reading the file.</span>
</span><span id="FisherMatrix-1459"><a href="#FisherMatrix-1459"><span class="linenos">1459</span></a><span class="sd">        If you want to read the metadata as well, use something like the following:</span>
</span><span id="FisherMatrix-1460"><a href="#FisherMatrix-1460"><span class="linenos">1460</span></a>
</span><span id="FisherMatrix-1461"><a href="#FisherMatrix-1461"><span class="linenos">1461</span></a><span class="sd">        &gt;&gt;&gt; import json</span>
</span><span id="FisherMatrix-1462"><a href="#FisherMatrix-1462"><span class="linenos">1462</span></a><span class="sd">        &gt;&gt;&gt; with open(&lt;filename&gt;, &#39;r&#39;) as f: # doctest: +SKIP</span>
</span><span id="FisherMatrix-1463"><a href="#FisherMatrix-1463"><span class="linenos">1463</span></a><span class="sd">        ...     data = json.loads(f.read()) # doctest: +SKIP</span>
</span><span id="FisherMatrix-1464"><a href="#FisherMatrix-1464"><span class="linenos">1464</span></a>
</span><span id="FisherMatrix-1465"><a href="#FisherMatrix-1465"><span class="linenos">1465</span></a><span class="sd">        Then `data` will contain a dictionary with all of the data from the</span>
</span><span id="FisherMatrix-1466"><a href="#FisherMatrix-1466"><span class="linenos">1466</span></a><span class="sd">        file, which can be easily parsed.</span>
</span><span id="FisherMatrix-1467"><a href="#FisherMatrix-1467"><span class="linenos">1467</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix-1468"><a href="#FisherMatrix-1468"><span class="linenos">1468</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
</span><span id="FisherMatrix-1469"><a href="#FisherMatrix-1469"><span class="linenos">1469</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file_handle</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="FisherMatrix-1470"><a href="#FisherMatrix-1470"><span class="linenos">1470</span></a>
</span><span id="FisherMatrix-1471"><a href="#FisherMatrix-1471"><span class="linenos">1471</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="FisherMatrix-1472"><a href="#FisherMatrix-1472"><span class="linenos">1472</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix-1473"><a href="#FisherMatrix-1473"><span class="linenos">1473</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix-1474"><a href="#FisherMatrix-1474"><span class="linenos">1474</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;latex_names&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix-1475"><a href="#FisherMatrix-1475"><span class="linenos">1475</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fiducials&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix-1476"><a href="#FisherMatrix-1476"><span class="linenos">1476</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class for handling Fisher objects.</p>

<h2 id="examples">Examples</h2>

<p>Specify a Fisher object with default names and fiducials:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
</code></pre></div>

<p>The object has a friendly representation in the interactive session:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[5., 0.],</span>
<span class="go">       [0., 4.]]),</span>
<span class="go">    names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre></div>

<p>List the names:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;p1&#39;, &#39;p2&#39;], dtype=object)</span>
</code></pre></div>

<p>List the values of the Fisher object:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([[5., 0.],</span>
<span class="go">       [0., 4.]])</span>
</code></pre></div>

<p>List the values of the fiducials:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">fiducials</span>
<span class="go">array([0., 0.])</span>
</code></pre></div>

<p>Names can be changed in bulk (ditto for fiducials and values; dimension
must of course match the original):</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">latex_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{X}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Y}</span><span class="s1">$&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[5., 0.],</span>
<span class="go">       [0., 4.]]),</span>
<span class="go">    names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre></div>

<p>We can get and set individual elements of the matrix using dict-like notation:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="go">5.0</span>
</code></pre></div>

<p>The off-diagonal elements are automatically updated when using the setter:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[ 5., -2.],</span>
<span class="go">       [-2.,  4.]]),</span>
<span class="go">    names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre></div>

<p>We can select submatrices by index:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[2., 0.],</span>
<span class="go">       [0., 3.]]),</span>
<span class="go">    names=array([&#39;y&#39;, &#39;z&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;y&#39;, &#39;z&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre></div>

<p>Fisher object with parameter names:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
<span class="gp">... </span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mathbf</span><span class="si">{X}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mathbf</span><span class="si">{Y}</span><span class="s1">$&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_with_names</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
</code></pre></div>

<p>We can add Fisher objects (ordering of names is taken care of):</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">+</span> <span class="n">fm_with_names</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[6., 0.],</span>
<span class="go">       [0., 6.]]),</span>
<span class="go">    names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre></div>

<p>We can also do element-wise multiplication or division:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">*</span> <span class="n">fm_with_names</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[5., 0.],</span>
<span class="go">       [0., 8.]]),</span>
<span class="go">    names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre></div>

<p>Furthermore, we can do matrix multiplication:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">@</span> <span class="n">fm_with_names</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[5., 0.],</span>
<span class="go">       [0., 8.]]),</span>
<span class="go">    names=array([&#39;x&#39;, &#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre></div>

<p>We can also perform standard matrix operations like the trace, eigenvalues, determinant:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">9.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="go">array([4., 5.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">19.999999999999996</span>
</code></pre></div>

<p>We can also get the inverse (the covariance matrix):</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">array([[0.2 , 0.  ],</span>
<span class="go">       [0.  , 0.25]])</span>
</code></pre></div>

<p>We can drop parameters from the object:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[4.]]),</span>
<span class="go">    names=array([&#39;y&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\mathbf{Y}$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0.]))</span>
</code></pre></div>

<p>We can save it to a file (the returned value is the dictionary that was saved):</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;example_matrix.json&#39;</span><span class="p">),</span> <span class="n">sort_dicts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">{&#39;values&#39;: [[5.0, 0.0], [0.0, 4.0]],</span>
<span class="go"> &#39;names&#39;: [&#39;x&#39;, &#39;y&#39;],</span>
<span class="go"> &#39;latex_names&#39;: [&#39;$\\mathbf{X}$&#39;, &#39;$\\mathbf{Y}$&#39;],</span>
<span class="go"> &#39;fiducials&#39;: [0.0, 0.0]}</span>
</code></pre></div>

<p>Loading is performed by a class method <code><a href="#FisherMatrix.from_file">from_file</a></code>:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm_new</span> <span class="o">=</span> <span class="n"><a href="#FisherMatrix.from_file">FisherMatrix</span><span class="o">.</span><span class="n">from_file</a></span><span class="p">(</span><span class="s1">&#39;example_matrix.json&#39;</span><span class="p">)</span>
</code></pre></div>
</div>


                            <div id="FisherMatrix.__init__" class="classattr">
                                        <input id="FisherMatrix.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">FisherMatrix</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">values</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.__init__-190"><a href="#FisherMatrix.__init__-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FisherMatrix.__init__-191"><a href="#FisherMatrix.__init__-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-192"><a href="#FisherMatrix.__init__-192"><span class="linenos">192</span></a>        <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-193"><a href="#FisherMatrix.__init__-193"><span class="linenos">193</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-194"><a href="#FisherMatrix.__init__-194"><span class="linenos">194</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-195"><a href="#FisherMatrix.__init__-195"><span class="linenos">195</span></a>        <span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-196"><a href="#FisherMatrix.__init__-196"><span class="linenos">196</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix.__init__-197"><a href="#FisherMatrix.__init__-197"><span class="linenos">197</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.__init__-198"><a href="#FisherMatrix.__init__-198"><span class="linenos">198</span></a><span class="sd">        Constructor for Fisher object.</span>
</span><span id="FisherMatrix.__init__-199"><a href="#FisherMatrix.__init__-199"><span class="linenos">199</span></a>
</span><span id="FisherMatrix.__init__-200"><a href="#FisherMatrix.__init__-200"><span class="linenos">200</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.__init__-201"><a href="#FisherMatrix.__init__-201"><span class="linenos">201</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.__init__-202"><a href="#FisherMatrix.__init__-202"><span class="linenos">202</span></a><span class="sd">        values : Collection</span>
</span><span id="FisherMatrix.__init__-203"><a href="#FisherMatrix.__init__-203"><span class="linenos">203</span></a><span class="sd">            The values of the Fisher object.</span>
</span><span id="FisherMatrix.__init__-204"><a href="#FisherMatrix.__init__-204"><span class="linenos">204</span></a>
</span><span id="FisherMatrix.__init__-205"><a href="#FisherMatrix.__init__-205"><span class="linenos">205</span></a><span class="sd">        names : Optional[Collection[str]] = None</span>
</span><span id="FisherMatrix.__init__-206"><a href="#FisherMatrix.__init__-206"><span class="linenos">206</span></a><span class="sd">            The names of the parameters.</span>
</span><span id="FisherMatrix.__init__-207"><a href="#FisherMatrix.__init__-207"><span class="linenos">207</span></a><span class="sd">            If not specified, defaults to `p1, ..., pn`.</span>
</span><span id="FisherMatrix.__init__-208"><a href="#FisherMatrix.__init__-208"><span class="linenos">208</span></a>
</span><span id="FisherMatrix.__init__-209"><a href="#FisherMatrix.__init__-209"><span class="linenos">209</span></a><span class="sd">        latex_names : Optional[Collection[str]] = None</span>
</span><span id="FisherMatrix.__init__-210"><a href="#FisherMatrix.__init__-210"><span class="linenos">210</span></a><span class="sd">            The LaTeX names of the parameters.</span>
</span><span id="FisherMatrix.__init__-211"><a href="#FisherMatrix.__init__-211"><span class="linenos">211</span></a><span class="sd">            If not specified, defaults to `names`.</span>
</span><span id="FisherMatrix.__init__-212"><a href="#FisherMatrix.__init__-212"><span class="linenos">212</span></a>
</span><span id="FisherMatrix.__init__-213"><a href="#FisherMatrix.__init__-213"><span class="linenos">213</span></a><span class="sd">        fiducials : Optional[Collection[float]] = None</span>
</span><span id="FisherMatrix.__init__-214"><a href="#FisherMatrix.__init__-214"><span class="linenos">214</span></a><span class="sd">            The fiducial values of the parameters. If not specified, default to</span>
</span><span id="FisherMatrix.__init__-215"><a href="#FisherMatrix.__init__-215"><span class="linenos">215</span></a><span class="sd">            0 for all parameters.</span>
</span><span id="FisherMatrix.__init__-216"><a href="#FisherMatrix.__init__-216"><span class="linenos">216</span></a>
</span><span id="FisherMatrix.__init__-217"><a href="#FisherMatrix.__init__-217"><span class="linenos">217</span></a><span class="sd">        Raises</span>
</span><span id="FisherMatrix.__init__-218"><a href="#FisherMatrix.__init__-218"><span class="linenos">218</span></a><span class="sd">        ------</span>
</span><span id="FisherMatrix.__init__-219"><a href="#FisherMatrix.__init__-219"><span class="linenos">219</span></a><span class="sd">        * `ValueError` if the input array has the wrong dimensionality (not 2)</span>
</span><span id="FisherMatrix.__init__-220"><a href="#FisherMatrix.__init__-220"><span class="linenos">220</span></a><span class="sd">        * `ValueError` if the object is not square-like</span>
</span><span id="FisherMatrix.__init__-221"><a href="#FisherMatrix.__init__-221"><span class="linenos">221</span></a><span class="sd">        * `MismatchingSizeError` if the sizes of the array of names, values,</span>
</span><span id="FisherMatrix.__init__-222"><a href="#FisherMatrix.__init__-222"><span class="linenos">222</span></a><span class="sd">        LaTeX names and fiducials do not match</span>
</span><span id="FisherMatrix.__init__-223"><a href="#FisherMatrix.__init__-223"><span class="linenos">223</span></a>
</span><span id="FisherMatrix.__init__-224"><a href="#FisherMatrix.__init__-224"><span class="linenos">224</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.__init__-225"><a href="#FisherMatrix.__init__-225"><span class="linenos">225</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.__init__-226"><a href="#FisherMatrix.__init__-226"><span class="linenos">226</span></a><span class="sd">        Specify a Fisher object without names:</span>
</span><span id="FisherMatrix.__init__-227"><a href="#FisherMatrix.__init__-227"><span class="linenos">227</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix.__init__-228"><a href="#FisherMatrix.__init__-228"><span class="linenos">228</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.__init__-229"><a href="#FisherMatrix.__init__-229"><span class="linenos">229</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="FisherMatrix.__init__-230"><a href="#FisherMatrix.__init__-230"><span class="linenos">230</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix.__init__-231"><a href="#FisherMatrix.__init__-231"><span class="linenos">231</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix.__init__-232"><a href="#FisherMatrix.__init__-232"><span class="linenos">232</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.__init__-233"><a href="#FisherMatrix.__init__-233"><span class="linenos">233</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.__init__-234"><a href="#FisherMatrix.__init__-234"><span class="linenos">234</span></a><span class="sd">            fiducials=array([0., 0., 0.]))</span>
</span><span id="FisherMatrix.__init__-235"><a href="#FisherMatrix.__init__-235"><span class="linenos">235</span></a>
</span><span id="FisherMatrix.__init__-236"><a href="#FisherMatrix.__init__-236"><span class="linenos">236</span></a><span class="sd">        Specify a Fisher object with names, LaTeX names, and fiducials:</span>
</span><span id="FisherMatrix.__init__-237"><a href="#FisherMatrix.__init__-237"><span class="linenos">237</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([1, 2]), names=[&#39;alpha&#39;, &#39;beta&#39;],</span>
</span><span id="FisherMatrix.__init__-238"><a href="#FisherMatrix.__init__-238"><span class="linenos">238</span></a><span class="sd">        ... latex_names=[r&#39;$\alpha$&#39;, r&#39;$\beta$&#39;], fiducials=[-3, 2])</span>
</span><span id="FisherMatrix.__init__-239"><a href="#FisherMatrix.__init__-239"><span class="linenos">239</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.__init__-240"><a href="#FisherMatrix.__init__-240"><span class="linenos">240</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix.__init__-241"><a href="#FisherMatrix.__init__-241"><span class="linenos">241</span></a><span class="sd">               [0., 2.]]),</span>
</span><span id="FisherMatrix.__init__-242"><a href="#FisherMatrix.__init__-242"><span class="linenos">242</span></a><span class="sd">            names=array([&#39;alpha&#39;, &#39;beta&#39;], dtype=object),</span>
</span><span id="FisherMatrix.__init__-243"><a href="#FisherMatrix.__init__-243"><span class="linenos">243</span></a><span class="sd">            latex_names=array([&#39;$\\alpha$&#39;, &#39;$\\beta$&#39;], dtype=object),</span>
</span><span id="FisherMatrix.__init__-244"><a href="#FisherMatrix.__init__-244"><span class="linenos">244</span></a><span class="sd">            fiducials=array([-3.,  2.]))</span>
</span><span id="FisherMatrix.__init__-245"><a href="#FisherMatrix.__init__-245"><span class="linenos">245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.__init__-246"><a href="#FisherMatrix.__init__-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-247"><a href="#FisherMatrix.__init__-247"><span class="linenos">247</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2"> is not 2-dimensional&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-248"><a href="#FisherMatrix.__init__-248"><span class="linenos">248</span></a>
</span><span id="FisherMatrix.__init__-249"><a href="#FisherMatrix.__init__-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
</span><span id="FisherMatrix.__init__-250"><a href="#FisherMatrix.__init__-250"><span class="linenos">250</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object </span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s2"> is not square-like&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-251"><a href="#FisherMatrix.__init__-251"><span class="linenos">251</span></a>
</span><span id="FisherMatrix.__init__-252"><a href="#FisherMatrix.__init__-252"><span class="linenos">252</span></a>        <span class="c1"># try to treat it as an array-like object</span>
</span><span id="FisherMatrix.__init__-253"><a href="#FisherMatrix.__init__-253"><span class="linenos">253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-254"><a href="#FisherMatrix.__init__-254"><span class="linenos">254</span></a>
</span><span id="FisherMatrix.__init__-255"><a href="#FisherMatrix.__init__-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FisherMatrix.__init__-256"><a href="#FisherMatrix.__init__-256"><span class="linenos">256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ndim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-257"><a href="#FisherMatrix.__init__-257"><span class="linenos">257</span></a>
</span><span id="FisherMatrix.__init__-258"><a href="#FisherMatrix.__init__-258"><span class="linenos">258</span></a>        <span class="c1"># setting the fiducials</span>
</span><span id="FisherMatrix.__init__-259"><a href="#FisherMatrix.__init__-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="n">fiducials</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-260"><a href="#FisherMatrix.__init__-260"><span class="linenos">260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-261"><a href="#FisherMatrix.__init__-261"><span class="linenos">261</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-262"><a href="#FisherMatrix.__init__-262"><span class="linenos">262</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fiducial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fiducials</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-263"><a href="#FisherMatrix.__init__-263"><span class="linenos">263</span></a>
</span><span id="FisherMatrix.__init__-264"><a href="#FisherMatrix.__init__-264"><span class="linenos">264</span></a>        <span class="c1"># setting the names</span>
</span><span id="FisherMatrix.__init__-265"><a href="#FisherMatrix.__init__-265"><span class="linenos">265</span></a>        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-266"><a href="#FisherMatrix.__init__-266"><span class="linenos">266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">make_default_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-267"><a href="#FisherMatrix.__init__-267"><span class="linenos">267</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-268"><a href="#FisherMatrix.__init__-268"><span class="linenos">268</span></a>            <span class="c1"># check they&#39;re unique</span>
</span><span id="FisherMatrix.__init__-269"><a href="#FisherMatrix.__init__-269"><span class="linenos">269</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix.__init__-270"><a href="#FisherMatrix.__init__-270"><span class="linenos">270</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-271"><a href="#FisherMatrix.__init__-271"><span class="linenos">271</span></a>
</span><span id="FisherMatrix.__init__-272"><a href="#FisherMatrix.__init__-272"><span class="linenos">272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-273"><a href="#FisherMatrix.__init__-273"><span class="linenos">273</span></a>
</span><span id="FisherMatrix.__init__-274"><a href="#FisherMatrix.__init__-274"><span class="linenos">274</span></a>        <span class="c1"># setting the pretty names (LaTeX)</span>
</span><span id="FisherMatrix.__init__-275"><a href="#FisherMatrix.__init__-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-276"><a href="#FisherMatrix.__init__-276"><span class="linenos">276</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-277"><a href="#FisherMatrix.__init__-277"><span class="linenos">277</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.__init__-278"><a href="#FisherMatrix.__init__-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">latex_names</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-279"><a href="#FisherMatrix.__init__-279"><span class="linenos">279</span></a>
</span><span id="FisherMatrix.__init__-280"><a href="#FisherMatrix.__init__-280"><span class="linenos">280</span></a>        <span class="c1"># check sizes of inputs</span>
</span><span id="FisherMatrix.__init__-281"><a href="#FisherMatrix.__init__-281"><span class="linenos">281</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="FisherMatrix.__init__-282"><a href="#FisherMatrix.__init__-282"><span class="linenos">282</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span>
</span><span id="FisherMatrix.__init__-283"><a href="#FisherMatrix.__init__-283"><span class="linenos">283</span></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fiducial</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix.__init__-284"><a href="#FisherMatrix.__init__-284"><span class="linenos">284</span></a>        <span class="p">):</span>
</span><span id="FisherMatrix.__init__-285"><a href="#FisherMatrix.__init__-285"><span class="linenos">285</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span>
</span><span id="FisherMatrix.__init__-286"><a href="#FisherMatrix.__init__-286"><span class="linenos">286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="FisherMatrix.__init__-287"><a href="#FisherMatrix.__init__-287"><span class="linenos">287</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-288"><a href="#FisherMatrix.__init__-288"><span class="linenos">288</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_fiducial</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-289"><a href="#FisherMatrix.__init__-289"><span class="linenos">289</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.__init__-290"><a href="#FisherMatrix.__init__-290"><span class="linenos">290</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Constructor for Fisher object.</p>

<h2 id="parameters">Parameters</h2>

<p>values : Collection
    The values of the Fisher object.</p>

<p>names : Optional[Collection[str]] = None
    The names of the parameters.
    If not specified, defaults to <code>p1, ..., pn</code>.</p>

<p>latex_names : Optional[Collection[str]] = None
    The LaTeX names of the parameters.
    If not specified, defaults to <code><a href="#FisherMatrix.names">names</a></code>.</p>

<p>fiducials : Optional[Collection[float]] = None
    The fiducial values of the parameters. If not specified, default to
    0 for all parameters.</p>

<h2 id="raises">Raises</h2>

<ul>
<li><code>ValueError</code> if the input array has the wrong dimensionality (not 2)</li>
<li><code>ValueError</code> if the object is not square-like</li>
<li><code>MismatchingSizeError</code> if the sizes of the array of names, values,
LaTeX names and fiducials do not match</li>
</ul>

<h2 id="examples">Examples</h2>

<p>Specify a Fisher object without names:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0., 0.],</span>
<span class="go">       [0., 2., 0.],</span>
<span class="go">       [0., 0., 3.]]),</span>
<span class="go">    names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p1&#39;, &#39;p2&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0., 0.]))</span>
</code></pre></div>

<p>Specify a Fisher object with names, LaTeX names, and fiducials:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\beta$&#39;</span><span class="p">],</span> <span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0.],</span>
<span class="go">       [0., 2.]]),</span>
<span class="go">    names=array([&#39;alpha&#39;, &#39;beta&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;$\\alpha$&#39;, &#39;$\\beta$&#39;], dtype=object),</span>
<span class="go">    fiducials=array([-3.,  2.]))</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.rename" class="classattr">
                                        <input id="FisherMatrix.rename-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rename</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">]]</span>,</span><span class="param">	<span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.rename-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.rename"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.rename-292"><a href="#FisherMatrix.rename-292"><span class="linenos">292</span></a>    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span>
</span><span id="FisherMatrix.rename-293"><a href="#FisherMatrix.rename-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-294"><a href="#FisherMatrix.rename-294"><span class="linenos">294</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">]],</span>
</span><span id="FisherMatrix.rename-295"><a href="#FisherMatrix.rename-295"><span class="linenos">295</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-296"><a href="#FisherMatrix.rename-296"><span class="linenos">296</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.rename-297"><a href="#FisherMatrix.rename-297"><span class="linenos">297</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.rename-298"><a href="#FisherMatrix.rename-298"><span class="linenos">298</span></a><span class="sd">        Returns a Fisher object with new names. This is primarily useful for</span>
</span><span id="FisherMatrix.rename-299"><a href="#FisherMatrix.rename-299"><span class="linenos">299</span></a><span class="sd">        renaming individual parameters.</span>
</span><span id="FisherMatrix.rename-300"><a href="#FisherMatrix.rename-300"><span class="linenos">300</span></a>
</span><span id="FisherMatrix.rename-301"><a href="#FisherMatrix.rename-301"><span class="linenos">301</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.rename-302"><a href="#FisherMatrix.rename-302"><span class="linenos">302</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.rename-303"><a href="#FisherMatrix.rename-303"><span class="linenos">303</span></a><span class="sd">        names : Mapping[str, Union[str, abc.Mapping]]</span>
</span><span id="FisherMatrix.rename-304"><a href="#FisherMatrix.rename-304"><span class="linenos">304</span></a><span class="sd">            a mapping (dictionary-like object) between the old names and the</span>
</span><span id="FisherMatrix.rename-305"><a href="#FisherMatrix.rename-305"><span class="linenos">305</span></a><span class="sd">            new ones. The values it maps to can either be a string (the new name), or a dict</span>
</span><span id="FisherMatrix.rename-306"><a href="#FisherMatrix.rename-306"><span class="linenos">306</span></a><span class="sd">            with keys `name`, `latex_name`, and `fiducial` (only `name` is mandatory).</span>
</span><span id="FisherMatrix.rename-307"><a href="#FisherMatrix.rename-307"><span class="linenos">307</span></a>
</span><span id="FisherMatrix.rename-308"><a href="#FisherMatrix.rename-308"><span class="linenos">308</span></a><span class="sd">        ignore_errors : bool = False</span>
</span><span id="FisherMatrix.rename-309"><a href="#FisherMatrix.rename-309"><span class="linenos">309</span></a><span class="sd">            if set to True, will not raise an error if a parameter doesn&#39;t exist</span>
</span><span id="FisherMatrix.rename-310"><a href="#FisherMatrix.rename-310"><span class="linenos">310</span></a>
</span><span id="FisherMatrix.rename-311"><a href="#FisherMatrix.rename-311"><span class="linenos">311</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.rename-312"><a href="#FisherMatrix.rename-312"><span class="linenos">312</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.rename-313"><a href="#FisherMatrix.rename-313"><span class="linenos">313</span></a><span class="sd">        Instance of `FisherMatrix`.</span>
</span><span id="FisherMatrix.rename-314"><a href="#FisherMatrix.rename-314"><span class="linenos">314</span></a>
</span><span id="FisherMatrix.rename-315"><a href="#FisherMatrix.rename-315"><span class="linenos">315</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.rename-316"><a href="#FisherMatrix.rename-316"><span class="linenos">316</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.rename-317"><a href="#FisherMatrix.rename-317"><span class="linenos">317</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix.rename-318"><a href="#FisherMatrix.rename-318"><span class="linenos">318</span></a><span class="sd">        &gt;&gt;&gt; m.rename({&#39;p1&#39; : &#39;a&#39;, &#39;p2&#39; : dict(name=&#39;b&#39;, latex_name=&#39;$b$&#39;, fiducial=2)})</span>
</span><span id="FisherMatrix.rename-319"><a href="#FisherMatrix.rename-319"><span class="linenos">319</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.rename-320"><a href="#FisherMatrix.rename-320"><span class="linenos">320</span></a><span class="sd">            array([[1., 0., 0.],</span>
</span><span id="FisherMatrix.rename-321"><a href="#FisherMatrix.rename-321"><span class="linenos">321</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix.rename-322"><a href="#FisherMatrix.rename-322"><span class="linenos">322</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix.rename-323"><a href="#FisherMatrix.rename-323"><span class="linenos">323</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.rename-324"><a href="#FisherMatrix.rename-324"><span class="linenos">324</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;$b$&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.rename-325"><a href="#FisherMatrix.rename-325"><span class="linenos">325</span></a><span class="sd">            fiducials=array([0., 2., 0.]))</span>
</span><span id="FisherMatrix.rename-326"><a href="#FisherMatrix.rename-326"><span class="linenos">326</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.rename-327"><a href="#FisherMatrix.rename-327"><span class="linenos">327</span></a>        <span class="c1"># check uniqueness and size</span>
</span><span id="FisherMatrix.rename-328"><a href="#FisherMatrix.rename-328"><span class="linenos">328</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix.rename-329"><a href="#FisherMatrix.rename-329"><span class="linenos">329</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-330"><a href="#FisherMatrix.rename-330"><span class="linenos">330</span></a>
</span><span id="FisherMatrix.rename-331"><a href="#FisherMatrix.rename-331"><span class="linenos">331</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_errors</span><span class="p">:</span>
</span><span id="FisherMatrix.rename-332"><a href="#FisherMatrix.rename-332"><span class="linenos">332</span></a>            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.rename-333"><a href="#FisherMatrix.rename-333"><span class="linenos">333</span></a>                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.rename-334"><a href="#FisherMatrix.rename-334"><span class="linenos">334</span></a>                    <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-335"><a href="#FisherMatrix.rename-335"><span class="linenos">335</span></a>
</span><span id="FisherMatrix.rename-336"><a href="#FisherMatrix.rename-336"><span class="linenos">336</span></a>        <span class="n">names_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-337"><a href="#FisherMatrix.rename-337"><span class="linenos">337</span></a>        <span class="n">latex_names_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-338"><a href="#FisherMatrix.rename-338"><span class="linenos">338</span></a>        <span class="n">fiducial_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-339"><a href="#FisherMatrix.rename-339"><span class="linenos">339</span></a>
</span><span id="FisherMatrix.rename-340"><a href="#FisherMatrix.rename-340"><span class="linenos">340</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="FisherMatrix.rename-341"><a href="#FisherMatrix.rename-341"><span class="linenos">341</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">names_new</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-342"><a href="#FisherMatrix.rename-342"><span class="linenos">342</span></a>            <span class="c1"># it&#39;s a mapping</span>
</span><span id="FisherMatrix.rename-343"><a href="#FisherMatrix.rename-343"><span class="linenos">343</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
</span><span id="FisherMatrix.rename-344"><a href="#FisherMatrix.rename-344"><span class="linenos">344</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">_process_fisher_mapping</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="FisherMatrix.rename-345"><a href="#FisherMatrix.rename-345"><span class="linenos">345</span></a>                <span class="n">latex_names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;latex_name&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix.rename-346"><a href="#FisherMatrix.rename-346"><span class="linenos">346</span></a>                <span class="n">fiducial_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;fiducial&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix.rename-347"><a href="#FisherMatrix.rename-347"><span class="linenos">347</span></a>                <span class="n">names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="FisherMatrix.rename-348"><a href="#FisherMatrix.rename-348"><span class="linenos">348</span></a>            <span class="c1"># otherwise, it&#39;s a string</span>
</span><span id="FisherMatrix.rename-349"><a href="#FisherMatrix.rename-349"><span class="linenos">349</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.rename-350"><a href="#FisherMatrix.rename-350"><span class="linenos">350</span></a>                <span class="n">names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix.rename-351"><a href="#FisherMatrix.rename-351"><span class="linenos">351</span></a>                <span class="n">latex_names_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherMatrix.rename-352"><a href="#FisherMatrix.rename-352"><span class="linenos">352</span></a>
</span><span id="FisherMatrix.rename-353"><a href="#FisherMatrix.rename-353"><span class="linenos">353</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.rename-354"><a href="#FisherMatrix.rename-354"><span class="linenos">354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-355"><a href="#FisherMatrix.rename-355"><span class="linenos">355</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names_new</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-356"><a href="#FisherMatrix.rename-356"><span class="linenos">356</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names_new</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-357"><a href="#FisherMatrix.rename-357"><span class="linenos">357</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducial_new</span><span class="p">,</span>
</span><span id="FisherMatrix.rename-358"><a href="#FisherMatrix.rename-358"><span class="linenos">358</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns a Fisher object with new names. This is primarily useful for
renaming individual parameters.</p>

<h2 id="parameters">Parameters</h2>

<p>names : Mapping[str, Union[str, abc.Mapping]]
    a mapping (dictionary-like object) between the old names and the
    new ones. The values it maps to can either be a string (the new name), or a dict
    with keys <code>name</code>, <code>latex_name</code>, and <code>fiducial</code> (only <code>name</code> is mandatory).</p>

<p>ignore_errors : bool = False
    if set to True, will not raise an error if a parameter doesn't exist</p>

<h2 id="returns">Returns</h2>

<p>Instance of <code><a href="#FisherMatrix">FisherMatrix</a></code>.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;p1&#39;</span> <span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;p2&#39;</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">latex_name</span><span class="o">=</span><span class="s1">&#39;$b$&#39;</span><span class="p">,</span> <span class="n">fiducial</span><span class="o">=</span><span class="mi">2</span><span class="p">)})</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0., 0.],</span>
<span class="go">       [0., 2., 0.],</span>
<span class="go">       [0., 0., 3.]]),</span>
<span class="go">    names=array([&#39;a&#39;, &#39;b&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;a&#39;, &#39;$b$&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 2., 0.]))</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.is_valid" class="classattr">
                                        <input id="FisherMatrix.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.is_valid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.is_valid-490"><a href="#FisherMatrix.is_valid-490"><span class="linenos">490</span></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.is_valid-491"><a href="#FisherMatrix.is_valid-491"><span class="linenos">491</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.is_valid-492"><a href="#FisherMatrix.is_valid-492"><span class="linenos">492</span></a><span class="sd">        Checks whether the values make a valid Fisher object.</span>
</span><span id="FisherMatrix.is_valid-493"><a href="#FisherMatrix.is_valid-493"><span class="linenos">493</span></a><span class="sd">        A (square) matrix is a Fisher matrix if it satisifies the following two</span>
</span><span id="FisherMatrix.is_valid-494"><a href="#FisherMatrix.is_valid-494"><span class="linenos">494</span></a><span class="sd">        criteria:</span>
</span><span id="FisherMatrix.is_valid-495"><a href="#FisherMatrix.is_valid-495"><span class="linenos">495</span></a>
</span><span id="FisherMatrix.is_valid-496"><a href="#FisherMatrix.is_valid-496"><span class="linenos">496</span></a><span class="sd">        * it is symmetric</span>
</span><span id="FisherMatrix.is_valid-497"><a href="#FisherMatrix.is_valid-497"><span class="linenos">497</span></a><span class="sd">        * it is positive semi-definite</span>
</span><span id="FisherMatrix.is_valid-498"><a href="#FisherMatrix.is_valid-498"><span class="linenos">498</span></a>
</span><span id="FisherMatrix.is_valid-499"><a href="#FisherMatrix.is_valid-499"><span class="linenos">499</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.is_valid-500"><a href="#FisherMatrix.is_valid-500"><span class="linenos">500</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.is_valid-501"><a href="#FisherMatrix.is_valid-501"><span class="linenos">501</span></a><span class="sd">        `True` or `False`</span>
</span><span id="FisherMatrix.is_valid-502"><a href="#FisherMatrix.is_valid-502"><span class="linenos">502</span></a>
</span><span id="FisherMatrix.is_valid-503"><a href="#FisherMatrix.is_valid-503"><span class="linenos">503</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.is_valid-504"><a href="#FisherMatrix.is_valid-504"><span class="linenos">504</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.is_valid-505"><a href="#FisherMatrix.is_valid-505"><span class="linenos">505</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix.is_valid-506"><a href="#FisherMatrix.is_valid-506"><span class="linenos">506</span></a><span class="sd">        &gt;&gt;&gt; m.is_valid()</span>
</span><span id="FisherMatrix.is_valid-507"><a href="#FisherMatrix.is_valid-507"><span class="linenos">507</span></a><span class="sd">        True</span>
</span><span id="FisherMatrix.is_valid-508"><a href="#FisherMatrix.is_valid-508"><span class="linenos">508</span></a><span class="sd">        &gt;&gt;&gt; FisherMatrix(np.diag([-1, 3])).is_valid()</span>
</span><span id="FisherMatrix.is_valid-509"><a href="#FisherMatrix.is_valid-509"><span class="linenos">509</span></a><span class="sd">        False</span>
</span><span id="FisherMatrix.is_valid-510"><a href="#FisherMatrix.is_valid-510"><span class="linenos">510</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.is_valid-511"><a href="#FisherMatrix.is_valid-511"><span class="linenos">511</span></a>        <span class="k">return</span> <span class="n">is_symmetric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_positive_semidefinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Checks whether the values make a valid Fisher object.
A (square) matrix is a Fisher matrix if it satisifies the following two
criteria:</p>

<ul>
<li>it is symmetric</li>
<li>it is positive semi-definite</li>
</ul>

<h2 id="returns">Returns</h2>

<p><code>True</code> or <code>False</code></p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="go">False</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.sort" class="classattr">
                                        <input id="FisherMatrix.sort-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sort</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.sort-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.sort"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.sort-513"><a href="#FisherMatrix.sort-513"><span class="linenos">513</span></a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span>
</span><span id="FisherMatrix.sort-514"><a href="#FisherMatrix.sort-514"><span class="linenos">514</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-515"><a href="#FisherMatrix.sort-515"><span class="linenos">515</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-516"><a href="#FisherMatrix.sort-516"><span class="linenos">516</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.sort-517"><a href="#FisherMatrix.sort-517"><span class="linenos">517</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.sort-518"><a href="#FisherMatrix.sort-518"><span class="linenos">518</span></a><span class="sd">        Sorts the Fisher object by name according to some criterion.</span>
</span><span id="FisherMatrix.sort-519"><a href="#FisherMatrix.sort-519"><span class="linenos">519</span></a>
</span><span id="FisherMatrix.sort-520"><a href="#FisherMatrix.sort-520"><span class="linenos">520</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.sort-521"><a href="#FisherMatrix.sort-521"><span class="linenos">521</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.sort-522"><a href="#FisherMatrix.sort-522"><span class="linenos">522</span></a><span class="sd">        **kwargs</span>
</span><span id="FisherMatrix.sort-523"><a href="#FisherMatrix.sort-523"><span class="linenos">523</span></a><span class="sd">            all of the other keyword arguments for the Python builtin `sorted`.</span>
</span><span id="FisherMatrix.sort-524"><a href="#FisherMatrix.sort-524"><span class="linenos">524</span></a><span class="sd">            If none are specified, will sort according to the names of the parameters.</span>
</span><span id="FisherMatrix.sort-525"><a href="#FisherMatrix.sort-525"><span class="linenos">525</span></a><span class="sd">            In the special case that the value of the keyword `key` is set to</span>
</span><span id="FisherMatrix.sort-526"><a href="#FisherMatrix.sort-526"><span class="linenos">526</span></a><span class="sd">            either `&#39;fiducials&#39;` or `&#39;latex_names&#39;`, it will sort according to those.</span>
</span><span id="FisherMatrix.sort-527"><a href="#FisherMatrix.sort-527"><span class="linenos">527</span></a><span class="sd">            In the second special case that the value of the keyword `key` is</span>
</span><span id="FisherMatrix.sort-528"><a href="#FisherMatrix.sort-528"><span class="linenos">528</span></a><span class="sd">            set to an array of integers of equal size as the Fisher object, sorts them</span>
</span><span id="FisherMatrix.sort-529"><a href="#FisherMatrix.sort-529"><span class="linenos">529</span></a><span class="sd">            according to those instead.</span>
</span><span id="FisherMatrix.sort-530"><a href="#FisherMatrix.sort-530"><span class="linenos">530</span></a><span class="sd">            In the third (and final) special case that the value of the keyword</span>
</span><span id="FisherMatrix.sort-531"><a href="#FisherMatrix.sort-531"><span class="linenos">531</span></a><span class="sd">            `key` is set to an array strings matching those of parameter names</span>
</span><span id="FisherMatrix.sort-532"><a href="#FisherMatrix.sort-532"><span class="linenos">532</span></a><span class="sd">            of the FisherMatrix, the items are sorted according to those</span>
</span><span id="FisherMatrix.sort-533"><a href="#FisherMatrix.sort-533"><span class="linenos">533</span></a><span class="sd">            values.</span>
</span><span id="FisherMatrix.sort-534"><a href="#FisherMatrix.sort-534"><span class="linenos">534</span></a>
</span><span id="FisherMatrix.sort-535"><a href="#FisherMatrix.sort-535"><span class="linenos">535</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.sort-536"><a href="#FisherMatrix.sort-536"><span class="linenos">536</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.sort-537"><a href="#FisherMatrix.sort-537"><span class="linenos">537</span></a><span class="sd">        Instance of `FisherMatrix`.</span>
</span><span id="FisherMatrix.sort-538"><a href="#FisherMatrix.sort-538"><span class="linenos">538</span></a>
</span><span id="FisherMatrix.sort-539"><a href="#FisherMatrix.sort-539"><span class="linenos">539</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.sort-540"><a href="#FisherMatrix.sort-540"><span class="linenos">540</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.sort-541"><a href="#FisherMatrix.sort-541"><span class="linenos">541</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([3, 1, 2]), names=list(&#39;sdf&#39;),</span>
</span><span id="FisherMatrix.sort-542"><a href="#FisherMatrix.sort-542"><span class="linenos">542</span></a><span class="sd">        ... latex_names=[&#39;hjkl&#39;, &#39;qwe&#39;, &#39;ll&#39;], fiducials=[8, 7, 3])</span>
</span><span id="FisherMatrix.sort-543"><a href="#FisherMatrix.sort-543"><span class="linenos">543</span></a><span class="sd">        &gt;&gt;&gt; m.sort(key=&#39;fiducials&#39;)</span>
</span><span id="FisherMatrix.sort-544"><a href="#FisherMatrix.sort-544"><span class="linenos">544</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.sort-545"><a href="#FisherMatrix.sort-545"><span class="linenos">545</span></a><span class="sd">            array([[2., 0., 0.],</span>
</span><span id="FisherMatrix.sort-546"><a href="#FisherMatrix.sort-546"><span class="linenos">546</span></a><span class="sd">               [0., 1., 0.],</span>
</span><span id="FisherMatrix.sort-547"><a href="#FisherMatrix.sort-547"><span class="linenos">547</span></a><span class="sd">               [0., 0., 3.]]),</span>
</span><span id="FisherMatrix.sort-548"><a href="#FisherMatrix.sort-548"><span class="linenos">548</span></a><span class="sd">            names=array([&#39;f&#39;, &#39;d&#39;, &#39;s&#39;], dtype=object),</span>
</span><span id="FisherMatrix.sort-549"><a href="#FisherMatrix.sort-549"><span class="linenos">549</span></a><span class="sd">            latex_names=array([&#39;ll&#39;, &#39;qwe&#39;, &#39;hjkl&#39;], dtype=object),</span>
</span><span id="FisherMatrix.sort-550"><a href="#FisherMatrix.sort-550"><span class="linenos">550</span></a><span class="sd">            fiducials=array([3., 7., 8.]))</span>
</span><span id="FisherMatrix.sort-551"><a href="#FisherMatrix.sort-551"><span class="linenos">551</span></a><span class="sd">        &gt;&gt;&gt; m.sort(key=&#39;latex_names&#39;)</span>
</span><span id="FisherMatrix.sort-552"><a href="#FisherMatrix.sort-552"><span class="linenos">552</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.sort-553"><a href="#FisherMatrix.sort-553"><span class="linenos">553</span></a><span class="sd">            array([[3., 0., 0.],</span>
</span><span id="FisherMatrix.sort-554"><a href="#FisherMatrix.sort-554"><span class="linenos">554</span></a><span class="sd">               [0., 2., 0.],</span>
</span><span id="FisherMatrix.sort-555"><a href="#FisherMatrix.sort-555"><span class="linenos">555</span></a><span class="sd">               [0., 0., 1.]]),</span>
</span><span id="FisherMatrix.sort-556"><a href="#FisherMatrix.sort-556"><span class="linenos">556</span></a><span class="sd">            names=array([&#39;s&#39;, &#39;f&#39;, &#39;d&#39;], dtype=object),</span>
</span><span id="FisherMatrix.sort-557"><a href="#FisherMatrix.sort-557"><span class="linenos">557</span></a><span class="sd">            latex_names=array([&#39;hjkl&#39;, &#39;ll&#39;, &#39;qwe&#39;], dtype=object),</span>
</span><span id="FisherMatrix.sort-558"><a href="#FisherMatrix.sort-558"><span class="linenos">558</span></a><span class="sd">            fiducials=array([8., 3., 7.]))</span>
</span><span id="FisherMatrix.sort-559"><a href="#FisherMatrix.sort-559"><span class="linenos">559</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.sort-560"><a href="#FisherMatrix.sort-560"><span class="linenos">560</span></a>        <span class="n">allowed_keys</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;fiducials&quot;</span><span class="p">,</span> <span class="s2">&quot;latex_names&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-561"><a href="#FisherMatrix.sort-561"><span class="linenos">561</span></a>        <span class="c1"># an integer index</span>
</span><span id="FisherMatrix.sort-562"><a href="#FisherMatrix.sort-562"><span class="linenos">562</span></a>        <span class="k">if</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="s2">&quot;__index__&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]):</span>
</span><span id="FisherMatrix.sort-563"><a href="#FisherMatrix.sort-563"><span class="linenos">563</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-564"><a href="#FisherMatrix.sort-564"><span class="linenos">564</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix.sort-565"><a href="#FisherMatrix.sort-565"><span class="linenos">565</span></a>        <span class="c1"># either &#39;fiducials&#39; or &#39;latex_names&#39;</span>
</span><span id="FisherMatrix.sort-566"><a href="#FisherMatrix.sort-566"><span class="linenos">566</span></a>        <span class="k">elif</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">allowed_keys</span><span class="p">:</span>
</span><span id="FisherMatrix.sort-567"><a href="#FisherMatrix.sort-567"><span class="linenos">567</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]))</span>
</span><span id="FisherMatrix.sort-568"><a href="#FisherMatrix.sort-568"><span class="linenos">568</span></a>            <span class="k">if</span> <span class="s2">&quot;reversed&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix.sort-569"><a href="#FisherMatrix.sort-569"><span class="linenos">569</span></a>                <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-570"><a href="#FisherMatrix.sort-570"><span class="linenos">570</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix.sort-571"><a href="#FisherMatrix.sort-571"><span class="linenos">571</span></a>        <span class="c1"># the names themselves, in any order</span>
</span><span id="FisherMatrix.sort-572"><a href="#FisherMatrix.sort-572"><span class="linenos">572</span></a>        <span class="k">elif</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix.sort-573"><a href="#FisherMatrix.sort-573"><span class="linenos">573</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">])</span>
</span><span id="FisherMatrix.sort-574"><a href="#FisherMatrix.sort-574"><span class="linenos">574</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix.sort-575"><a href="#FisherMatrix.sort-575"><span class="linenos">575</span></a>        <span class="c1"># something that can be passed to `sorted`</span>
</span><span id="FisherMatrix.sort-576"><a href="#FisherMatrix.sort-576"><span class="linenos">576</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.sort-577"><a href="#FisherMatrix.sort-577"><span class="linenos">577</span></a>            <span class="k">if</span> <span class="s2">&quot;key&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]):</span>
</span><span id="FisherMatrix.sort-578"><a href="#FisherMatrix.sort-578"><span class="linenos">578</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`key=</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">` is not callable&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-579"><a href="#FisherMatrix.sort-579"><span class="linenos">579</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-580"><a href="#FisherMatrix.sort-580"><span class="linenos">580</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">get_index_of_other_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-581"><a href="#FisherMatrix.sort-581"><span class="linenos">581</span></a>
</span><span id="FisherMatrix.sort-582"><a href="#FisherMatrix.sort-582"><span class="linenos">582</span></a>        <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix.sort-583"><a href="#FisherMatrix.sort-583"><span class="linenos">583</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherMatrix.sort-584"><a href="#FisherMatrix.sort-584"><span class="linenos">584</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">reindex_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix.sort-585"><a href="#FisherMatrix.sort-585"><span class="linenos">585</span></a>
</span><span id="FisherMatrix.sort-586"><a href="#FisherMatrix.sort-586"><span class="linenos">586</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.sort-587"><a href="#FisherMatrix.sort-587"><span class="linenos">587</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-588"><a href="#FisherMatrix.sort-588"><span class="linenos">588</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-589"><a href="#FisherMatrix.sort-589"><span class="linenos">589</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-590"><a href="#FisherMatrix.sort-590"><span class="linenos">590</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.sort-591"><a href="#FisherMatrix.sort-591"><span class="linenos">591</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sorts the Fisher object by name according to some criterion.</p>

<h2 id="parameters">Parameters</h2>

<p>**kwargs
    all of the other keyword arguments for the Python builtin <code>sorted</code>.
    If none are specified, will sort according to the names of the parameters.
    In the special case that the value of the keyword <code>key</code> is set to
    either <code>'fiducials'</code> or <code>'latex_names'</code>, it will sort according to those.
    In the second special case that the value of the keyword <code>key</code> is
    set to an array of integers of equal size as the Fisher object, sorts them
    according to those instead.
    In the third (and final) special case that the value of the keyword
    <code>key</code> is set to an array strings matching those of parameter names
    of the FisherMatrix, the items are sorted according to those
    values.</p>

<h2 id="returns">Returns</h2>

<p>Instance of <code><a href="#FisherMatrix">FisherMatrix</a></code>.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;sdf&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hjkl&#39;</span><span class="p">,</span> <span class="s1">&#39;qwe&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">],</span> <span class="n">fiducials</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;fiducials&#39;</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[2., 0., 0.],</span>
<span class="go">       [0., 1., 0.],</span>
<span class="go">       [0., 0., 3.]]),</span>
<span class="go">    names=array([&#39;f&#39;, &#39;d&#39;, &#39;s&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;ll&#39;, &#39;qwe&#39;, &#39;hjkl&#39;], dtype=object),</span>
<span class="go">    fiducials=array([3., 7., 8.]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;latex_names&#39;</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[3., 0., 0.],</span>
<span class="go">       [0., 2., 0.],</span>
<span class="go">       [0., 0., 1.]]),</span>
<span class="go">    names=array([&#39;s&#39;, &#39;f&#39;, &#39;d&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;hjkl&#39;, &#39;ll&#39;, &#39;qwe&#39;], dtype=object),</span>
<span class="go">    fiducials=array([8., 3., 7.]))</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.ndim" class="classattr">
                                <div class="attr variable">
            <span class="name">ndim</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.ndim"></a>
    
            <div class="docstring"><p>Returns the number of dimensions of the Fisher object (for now always 2).</p>
</div>


                            </div>
                            <div id="FisherMatrix.values" class="classattr">
                                <div class="attr variable">
            <span class="name">values</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.values"></a>
    
            <div class="docstring"><p>Returns the values in the Fisher object as a numpy array.</p>
</div>


                            </div>
                            <div id="FisherMatrix.is_diagonal" class="classattr">
                                        <input id="FisherMatrix.is_diagonal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_diagonal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.is_diagonal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.is_diagonal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.is_diagonal-661"><a href="#FisherMatrix.is_diagonal-661"><span class="linenos">661</span></a>    <span class="k">def</span> <span class="nf">is_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.is_diagonal-662"><a href="#FisherMatrix.is_diagonal-662"><span class="linenos">662</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.is_diagonal-663"><a href="#FisherMatrix.is_diagonal-663"><span class="linenos">663</span></a><span class="sd">        Checks whether the Fisher matrix is diagonal.</span>
</span><span id="FisherMatrix.is_diagonal-664"><a href="#FisherMatrix.is_diagonal-664"><span class="linenos">664</span></a>
</span><span id="FisherMatrix.is_diagonal-665"><a href="#FisherMatrix.is_diagonal-665"><span class="linenos">665</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.is_diagonal-666"><a href="#FisherMatrix.is_diagonal-666"><span class="linenos">666</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.is_diagonal-667"><a href="#FisherMatrix.is_diagonal-667"><span class="linenos">667</span></a><span class="sd">        `True` or `False`</span>
</span><span id="FisherMatrix.is_diagonal-668"><a href="#FisherMatrix.is_diagonal-668"><span class="linenos">668</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.is_diagonal-669"><a href="#FisherMatrix.is_diagonal-669"><span class="linenos">669</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>Checks whether the Fisher matrix is diagonal.</p>

<h2 id="returns">Returns</h2>

<p><code>True</code> or <code>False</code></p>
</div>


                            </div>
                            <div id="FisherMatrix.diagonal" class="classattr">
                                        <input id="FisherMatrix.diagonal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">diagonal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.diagonal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.diagonal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.diagonal-671"><a href="#FisherMatrix.diagonal-671"><span class="linenos">671</span></a>    <span class="k">def</span> <span class="nf">diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="FisherMatrix.diagonal-672"><a href="#FisherMatrix.diagonal-672"><span class="linenos">672</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.diagonal-673"><a href="#FisherMatrix.diagonal-673"><span class="linenos">673</span></a><span class="sd">        Returns the diagonal elements of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix.diagonal-674"><a href="#FisherMatrix.diagonal-674"><span class="linenos">674</span></a>
</span><span id="FisherMatrix.diagonal-675"><a href="#FisherMatrix.diagonal-675"><span class="linenos">675</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.diagonal-676"><a href="#FisherMatrix.diagonal-676"><span class="linenos">676</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.diagonal-677"><a href="#FisherMatrix.diagonal-677"><span class="linenos">677</span></a><span class="sd">        array-like of floats</span>
</span><span id="FisherMatrix.diagonal-678"><a href="#FisherMatrix.diagonal-678"><span class="linenos">678</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.diagonal-679"><a href="#FisherMatrix.diagonal-679"><span class="linenos">679</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the diagonal elements of the Fisher object as a numpy array.</p>

<h2 id="returns">Returns</h2>

<p>array-like of floats</p>
</div>


                            </div>
                            <div id="FisherMatrix.drop" class="classattr">
                                        <input id="FisherMatrix.drop-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">drop</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.drop-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.drop"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.drop-681"><a href="#FisherMatrix.drop-681"><span class="linenos">681</span></a>    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span>
</span><span id="FisherMatrix.drop-682"><a href="#FisherMatrix.drop-682"><span class="linenos">682</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-683"><a href="#FisherMatrix.drop-683"><span class="linenos">683</span></a>        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-684"><a href="#FisherMatrix.drop-684"><span class="linenos">684</span></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-685"><a href="#FisherMatrix.drop-685"><span class="linenos">685</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-686"><a href="#FisherMatrix.drop-686"><span class="linenos">686</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.drop-687"><a href="#FisherMatrix.drop-687"><span class="linenos">687</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.drop-688"><a href="#FisherMatrix.drop-688"><span class="linenos">688</span></a><span class="sd">        Removes parameters from the Fisher object.</span>
</span><span id="FisherMatrix.drop-689"><a href="#FisherMatrix.drop-689"><span class="linenos">689</span></a>
</span><span id="FisherMatrix.drop-690"><a href="#FisherMatrix.drop-690"><span class="linenos">690</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.drop-691"><a href="#FisherMatrix.drop-691"><span class="linenos">691</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.drop-692"><a href="#FisherMatrix.drop-692"><span class="linenos">692</span></a><span class="sd">        names : string-like</span>
</span><span id="FisherMatrix.drop-693"><a href="#FisherMatrix.drop-693"><span class="linenos">693</span></a><span class="sd">            the names of the parameters to drop.</span>
</span><span id="FisherMatrix.drop-694"><a href="#FisherMatrix.drop-694"><span class="linenos">694</span></a><span class="sd">            If passing a list or a tuple, make sure to unpack it using the</span>
</span><span id="FisherMatrix.drop-695"><a href="#FisherMatrix.drop-695"><span class="linenos">695</span></a><span class="sd">            asterisk (*).</span>
</span><span id="FisherMatrix.drop-696"><a href="#FisherMatrix.drop-696"><span class="linenos">696</span></a>
</span><span id="FisherMatrix.drop-697"><a href="#FisherMatrix.drop-697"><span class="linenos">697</span></a><span class="sd">        invert : bool = False</span>
</span><span id="FisherMatrix.drop-698"><a href="#FisherMatrix.drop-698"><span class="linenos">698</span></a><span class="sd">            whether to drop all the parameters NOT in names (the complement)</span>
</span><span id="FisherMatrix.drop-699"><a href="#FisherMatrix.drop-699"><span class="linenos">699</span></a>
</span><span id="FisherMatrix.drop-700"><a href="#FisherMatrix.drop-700"><span class="linenos">700</span></a><span class="sd">        ignore_errors : bool = False</span>
</span><span id="FisherMatrix.drop-701"><a href="#FisherMatrix.drop-701"><span class="linenos">701</span></a><span class="sd">            should non-existing parameters be ignored</span>
</span><span id="FisherMatrix.drop-702"><a href="#FisherMatrix.drop-702"><span class="linenos">702</span></a>
</span><span id="FisherMatrix.drop-703"><a href="#FisherMatrix.drop-703"><span class="linenos">703</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.drop-704"><a href="#FisherMatrix.drop-704"><span class="linenos">704</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.drop-705"><a href="#FisherMatrix.drop-705"><span class="linenos">705</span></a><span class="sd">        Instance of `FisherMatrix`</span>
</span><span id="FisherMatrix.drop-706"><a href="#FisherMatrix.drop-706"><span class="linenos">706</span></a>
</span><span id="FisherMatrix.drop-707"><a href="#FisherMatrix.drop-707"><span class="linenos">707</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.drop-708"><a href="#FisherMatrix.drop-708"><span class="linenos">708</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.drop-709"><a href="#FisherMatrix.drop-709"><span class="linenos">709</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix.drop-710"><a href="#FisherMatrix.drop-710"><span class="linenos">710</span></a><span class="sd">        &gt;&gt;&gt; m.drop(&#39;p1&#39;, &#39;p3&#39;)</span>
</span><span id="FisherMatrix.drop-711"><a href="#FisherMatrix.drop-711"><span class="linenos">711</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.drop-712"><a href="#FisherMatrix.drop-712"><span class="linenos">712</span></a><span class="sd">            array([[2.]]),</span>
</span><span id="FisherMatrix.drop-713"><a href="#FisherMatrix.drop-713"><span class="linenos">713</span></a><span class="sd">            names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-714"><a href="#FisherMatrix.drop-714"><span class="linenos">714</span></a><span class="sd">            latex_names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-715"><a href="#FisherMatrix.drop-715"><span class="linenos">715</span></a><span class="sd">            fiducials=array([0.]))</span>
</span><span id="FisherMatrix.drop-716"><a href="#FisherMatrix.drop-716"><span class="linenos">716</span></a><span class="sd">        &gt;&gt;&gt; m.drop(*[&#39;p1&#39;, &#39;p3&#39;]) # same thing, but note the asterisk (*)</span>
</span><span id="FisherMatrix.drop-717"><a href="#FisherMatrix.drop-717"><span class="linenos">717</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.drop-718"><a href="#FisherMatrix.drop-718"><span class="linenos">718</span></a><span class="sd">            array([[2.]]),</span>
</span><span id="FisherMatrix.drop-719"><a href="#FisherMatrix.drop-719"><span class="linenos">719</span></a><span class="sd">            names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-720"><a href="#FisherMatrix.drop-720"><span class="linenos">720</span></a><span class="sd">            latex_names=array([&#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-721"><a href="#FisherMatrix.drop-721"><span class="linenos">721</span></a><span class="sd">            fiducials=array([0.]))</span>
</span><span id="FisherMatrix.drop-722"><a href="#FisherMatrix.drop-722"><span class="linenos">722</span></a><span class="sd">        &gt;&gt;&gt; # drop everything that&#39;s NOT `p1` or `p3`</span>
</span><span id="FisherMatrix.drop-723"><a href="#FisherMatrix.drop-723"><span class="linenos">723</span></a><span class="sd">        &gt;&gt;&gt; m.drop(&#39;p1&#39;, &#39;p3&#39;, invert=True)</span>
</span><span id="FisherMatrix.drop-724"><a href="#FisherMatrix.drop-724"><span class="linenos">724</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.drop-725"><a href="#FisherMatrix.drop-725"><span class="linenos">725</span></a><span class="sd">            array([[1., 0.],</span>
</span><span id="FisherMatrix.drop-726"><a href="#FisherMatrix.drop-726"><span class="linenos">726</span></a><span class="sd">               [0., 3.]]),</span>
</span><span id="FisherMatrix.drop-727"><a href="#FisherMatrix.drop-727"><span class="linenos">727</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-728"><a href="#FisherMatrix.drop-728"><span class="linenos">728</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
</span><span id="FisherMatrix.drop-729"><a href="#FisherMatrix.drop-729"><span class="linenos">729</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix.drop-730"><a href="#FisherMatrix.drop-730"><span class="linenos">730</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.drop-731"><a href="#FisherMatrix.drop-731"><span class="linenos">731</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)):</span>
</span><span id="FisherMatrix.drop-732"><a href="#FisherMatrix.drop-732"><span class="linenos">732</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix.drop-733"><a href="#FisherMatrix.drop-733"><span class="linenos">733</span></a>                <span class="sa">f</span><span class="s2">&quot;The names (</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">) are not a strict subset &quot;</span>
</span><span id="FisherMatrix.drop-734"><a href="#FisherMatrix.drop-734"><span class="linenos">734</span></a>                <span class="sa">f</span><span class="s2">&quot;of the parameter names in the Fisher object (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="si">}</span><span class="s2">); &quot;</span>
</span><span id="FisherMatrix.drop-735"><a href="#FisherMatrix.drop-735"><span class="linenos">735</span></a>                <span class="s2">&quot;you can pass `ignore_errors=True` to ignore this error&quot;</span>
</span><span id="FisherMatrix.drop-736"><a href="#FisherMatrix.drop-736"><span class="linenos">736</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix.drop-737"><a href="#FisherMatrix.drop-737"><span class="linenos">737</span></a>
</span><span id="FisherMatrix.drop-738"><a href="#FisherMatrix.drop-738"><span class="linenos">738</span></a>        <span class="k">if</span> <span class="n">ignore_errors</span><span class="p">:</span>
</span><span id="FisherMatrix.drop-739"><a href="#FisherMatrix.drop-739"><span class="linenos">739</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">])</span>
</span><span id="FisherMatrix.drop-740"><a href="#FisherMatrix.drop-740"><span class="linenos">740</span></a>
</span><span id="FisherMatrix.drop-741"><a href="#FisherMatrix.drop-741"><span class="linenos">741</span></a>        <span class="k">if</span> <span class="n">invert</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix.drop-742"><a href="#FisherMatrix.drop-742"><span class="linenos">742</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">^</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.drop-743"><a href="#FisherMatrix.drop-743"><span class="linenos">743</span></a>
</span><span id="FisherMatrix.drop-744"><a href="#FisherMatrix.drop-744"><span class="linenos">744</span></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="FisherMatrix.drop-745"><a href="#FisherMatrix.drop-745"><span class="linenos">745</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to remove all parameters&quot;</span><span class="p">)</span>
</span><span id="FisherMatrix.drop-746"><a href="#FisherMatrix.drop-746"><span class="linenos">746</span></a>
</span><span id="FisherMatrix.drop-747"><a href="#FisherMatrix.drop-747"><span class="linenos">747</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
</span><span id="FisherMatrix.drop-748"><a href="#FisherMatrix.drop-748"><span class="linenos">748</span></a>
</span><span id="FisherMatrix.drop-749"><a href="#FisherMatrix.drop-749"><span class="linenos">749</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
</span><span id="FisherMatrix.drop-750"><a href="#FisherMatrix.drop-750"><span class="linenos">750</span></a>        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
</span><span id="FisherMatrix.drop-751"><a href="#FisherMatrix.drop-751"><span class="linenos">751</span></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
</span><span id="FisherMatrix.drop-752"><a href="#FisherMatrix.drop-752"><span class="linenos">752</span></a>                <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-753"><a href="#FisherMatrix.drop-753"><span class="linenos">753</span></a>                <span class="n">index</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-754"><a href="#FisherMatrix.drop-754"><span class="linenos">754</span></a>                <span class="n">axis</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-755"><a href="#FisherMatrix.drop-755"><span class="linenos">755</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix.drop-756"><a href="#FisherMatrix.drop-756"><span class="linenos">756</span></a>
</span><span id="FisherMatrix.drop-757"><a href="#FisherMatrix.drop-757"><span class="linenos">757</span></a>        <span class="n">fiducials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix.drop-758"><a href="#FisherMatrix.drop-758"><span class="linenos">758</span></a>        <span class="n">latex_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix.drop-759"><a href="#FisherMatrix.drop-759"><span class="linenos">759</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="FisherMatrix.drop-760"><a href="#FisherMatrix.drop-760"><span class="linenos">760</span></a>
</span><span id="FisherMatrix.drop-761"><a href="#FisherMatrix.drop-761"><span class="linenos">761</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.drop-762"><a href="#FisherMatrix.drop-762"><span class="linenos">762</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-763"><a href="#FisherMatrix.drop-763"><span class="linenos">763</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-764"><a href="#FisherMatrix.drop-764"><span class="linenos">764</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-765"><a href="#FisherMatrix.drop-765"><span class="linenos">765</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.drop-766"><a href="#FisherMatrix.drop-766"><span class="linenos">766</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Removes parameters from the Fisher object.</p>

<h2 id="parameters">Parameters</h2>

<p>names : string-like
    the names of the parameters to drop.
    If passing a list or a tuple, make sure to unpack it using the
    asterisk (*).</p>

<p>invert : bool = False
    whether to drop all the parameters NOT in names (the complement)</p>

<p>ignore_errors : bool = False
    should non-existing parameters be ignored</p>

<h2 id="returns">Returns</h2>

<p>Instance of <code><a href="#FisherMatrix">FisherMatrix</a></code></p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p3&#39;</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[2.]]),</span>
<span class="go">    names=array([&#39;p2&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p2&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0.]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="c1"># same thing, but note the asterisk (*)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[2.]]),</span>
<span class="go">    names=array([&#39;p2&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p2&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0.]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># drop everything that&#39;s NOT `p1` or `p3`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p3&#39;</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[1., 0.],</span>
<span class="go">       [0., 3.]]),</span>
<span class="go">    names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p1&#39;, &#39;p3&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.trace" class="classattr">
                                        <input id="FisherMatrix.trace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trace</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.trace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.trace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.trace-768"><a href="#FisherMatrix.trace-768"><span class="linenos">768</span></a>    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span>
</span><span id="FisherMatrix.trace-769"><a href="#FisherMatrix.trace-769"><span class="linenos">769</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.trace-770"><a href="#FisherMatrix.trace-770"><span class="linenos">770</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherMatrix.trace-771"><a href="#FisherMatrix.trace-771"><span class="linenos">771</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix.trace-772"><a href="#FisherMatrix.trace-772"><span class="linenos">772</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.trace-773"><a href="#FisherMatrix.trace-773"><span class="linenos">773</span></a><span class="sd">        Returns the trace of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix.trace-774"><a href="#FisherMatrix.trace-774"><span class="linenos">774</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.trace-775"><a href="#FisherMatrix.trace-775"><span class="linenos">775</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the trace of the Fisher object as a numpy array.</p>
</div>


                            </div>
                            <div id="FisherMatrix.eigenvalues" class="classattr">
                                        <input id="FisherMatrix.eigenvalues-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">eigenvalues</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.eigenvalues-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.eigenvalues"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.eigenvalues-777"><a href="#FisherMatrix.eigenvalues-777"><span class="linenos">777</span></a>    <span class="k">def</span> <span class="nf">eigenvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.eigenvalues-778"><a href="#FisherMatrix.eigenvalues-778"><span class="linenos">778</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.eigenvalues-779"><a href="#FisherMatrix.eigenvalues-779"><span class="linenos">779</span></a><span class="sd">        Returns the eigenvalues of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix.eigenvalues-780"><a href="#FisherMatrix.eigenvalues-780"><span class="linenos">780</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.eigenvalues-781"><a href="#FisherMatrix.eigenvalues-781"><span class="linenos">781</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the eigenvalues of the Fisher object as a numpy array.</p>
</div>


                            </div>
                            <div id="FisherMatrix.eigenvectors" class="classattr">
                                        <input id="FisherMatrix.eigenvectors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">eigenvectors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.eigenvectors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.eigenvectors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.eigenvectors-783"><a href="#FisherMatrix.eigenvectors-783"><span class="linenos">783</span></a>    <span class="k">def</span> <span class="nf">eigenvectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.eigenvectors-784"><a href="#FisherMatrix.eigenvectors-784"><span class="linenos">784</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.eigenvectors-785"><a href="#FisherMatrix.eigenvectors-785"><span class="linenos">785</span></a><span class="sd">        Returns the right eigenvectors of the Fisher object as a numpy array.</span>
</span><span id="FisherMatrix.eigenvectors-786"><a href="#FisherMatrix.eigenvectors-786"><span class="linenos">786</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.eigenvectors-787"><a href="#FisherMatrix.eigenvectors-787"><span class="linenos">787</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Returns the right eigenvectors of the Fisher object as a numpy array.</p>
</div>


                            </div>
                            <div id="FisherMatrix.condition_number" class="classattr">
                                        <input id="FisherMatrix.condition_number-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">condition_number</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.condition_number-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.condition_number"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.condition_number-789"><a href="#FisherMatrix.condition_number-789"><span class="linenos">789</span></a>    <span class="k">def</span> <span class="nf">condition_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.condition_number-790"><a href="#FisherMatrix.condition_number-790"><span class="linenos">790</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.condition_number-791"><a href="#FisherMatrix.condition_number-791"><span class="linenos">791</span></a><span class="sd">        Returns the condition number of the matrix with respect to the $L^2$ norm.</span>
</span><span id="FisherMatrix.condition_number-792"><a href="#FisherMatrix.condition_number-792"><span class="linenos">792</span></a>
</span><span id="FisherMatrix.condition_number-793"><a href="#FisherMatrix.condition_number-793"><span class="linenos">793</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.condition_number-794"><a href="#FisherMatrix.condition_number-794"><span class="linenos">794</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.condition_number-795"><a href="#FisherMatrix.condition_number-795"><span class="linenos">795</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="FisherMatrix.condition_number-796"><a href="#FisherMatrix.condition_number-796"><span class="linenos">796</span></a><span class="sd">        &gt;&gt;&gt; fm.condition_number()</span>
</span><span id="FisherMatrix.condition_number-797"><a href="#FisherMatrix.condition_number-797"><span class="linenos">797</span></a><span class="sd">        3.0</span>
</span><span id="FisherMatrix.condition_number-798"><a href="#FisherMatrix.condition_number-798"><span class="linenos">798</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.condition_number-799"><a href="#FisherMatrix.condition_number-799"><span class="linenos">799</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">())</span>
</span><span id="FisherMatrix.condition_number-800"><a href="#FisherMatrix.condition_number-800"><span class="linenos">800</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the condition number of the matrix with respect to the $L^2$ norm.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">condition_number</span><span class="p">()</span>
<span class="go">3.0</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.inverse" class="classattr">
                                        <input id="FisherMatrix.inverse-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">inverse</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.inverse-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.inverse"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.inverse-802"><a href="#FisherMatrix.inverse-802"><span class="linenos">802</span></a>    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.inverse-803"><a href="#FisherMatrix.inverse-803"><span class="linenos">803</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.inverse-804"><a href="#FisherMatrix.inverse-804"><span class="linenos">804</span></a><span class="sd">        Returns the inverse of the Fisher matrix.</span>
</span><span id="FisherMatrix.inverse-805"><a href="#FisherMatrix.inverse-805"><span class="linenos">805</span></a>
</span><span id="FisherMatrix.inverse-806"><a href="#FisherMatrix.inverse-806"><span class="linenos">806</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.inverse-807"><a href="#FisherMatrix.inverse-807"><span class="linenos">807</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.inverse-808"><a href="#FisherMatrix.inverse-808"><span class="linenos">808</span></a><span class="sd">        array containing the covariance matrix</span>
</span><span id="FisherMatrix.inverse-809"><a href="#FisherMatrix.inverse-809"><span class="linenos">809</span></a>
</span><span id="FisherMatrix.inverse-810"><a href="#FisherMatrix.inverse-810"><span class="linenos">810</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.inverse-811"><a href="#FisherMatrix.inverse-811"><span class="linenos">811</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.inverse-812"><a href="#FisherMatrix.inverse-812"><span class="linenos">812</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2, 5]))</span>
</span><span id="FisherMatrix.inverse-813"><a href="#FisherMatrix.inverse-813"><span class="linenos">813</span></a><span class="sd">        &gt;&gt;&gt; fm.inverse()</span>
</span><span id="FisherMatrix.inverse-814"><a href="#FisherMatrix.inverse-814"><span class="linenos">814</span></a><span class="sd">        array([[1. , 0. , 0. ],</span>
</span><span id="FisherMatrix.inverse-815"><a href="#FisherMatrix.inverse-815"><span class="linenos">815</span></a><span class="sd">               [0. , 0.5, 0. ],</span>
</span><span id="FisherMatrix.inverse-816"><a href="#FisherMatrix.inverse-816"><span class="linenos">816</span></a><span class="sd">               [0. , 0. , 0.2]])</span>
</span><span id="FisherMatrix.inverse-817"><a href="#FisherMatrix.inverse-817"><span class="linenos">817</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.inverse-818"><a href="#FisherMatrix.inverse-818"><span class="linenos">818</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the inverse of the Fisher matrix.</p>

<h2 id="returns">Returns</h2>

<p>array containing the covariance matrix</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">array([[1. , 0. , 0. ],</span>
<span class="go">       [0. , 0.5, 0. ],</span>
<span class="go">       [0. , 0. , 0.2]])</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.determinant" class="classattr">
                                        <input id="FisherMatrix.determinant-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">determinant</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.determinant-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.determinant"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.determinant-820"><a href="#FisherMatrix.determinant-820"><span class="linenos">820</span></a>    <span class="k">def</span> <span class="nf">determinant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherMatrix.determinant-821"><a href="#FisherMatrix.determinant-821"><span class="linenos">821</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.determinant-822"><a href="#FisherMatrix.determinant-822"><span class="linenos">822</span></a><span class="sd">        Returns the determinant of the matrix.</span>
</span><span id="FisherMatrix.determinant-823"><a href="#FisherMatrix.determinant-823"><span class="linenos">823</span></a>
</span><span id="FisherMatrix.determinant-824"><a href="#FisherMatrix.determinant-824"><span class="linenos">824</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.determinant-825"><a href="#FisherMatrix.determinant-825"><span class="linenos">825</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.determinant-826"><a href="#FisherMatrix.determinant-826"><span class="linenos">826</span></a><span class="sd">        float</span>
</span><span id="FisherMatrix.determinant-827"><a href="#FisherMatrix.determinant-827"><span class="linenos">827</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.determinant-828"><a href="#FisherMatrix.determinant-828"><span class="linenos">828</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the determinant of the matrix.</p>

<h2 id="returns">Returns</h2>

<p>float</p>
</div>


                            </div>
                            <div id="FisherMatrix.constraints" class="classattr">
                                        <input id="FisherMatrix.constraints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">constraints</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">marginalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.constraints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.constraints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.constraints-830"><a href="#FisherMatrix.constraints-830"><span class="linenos">830</span></a>    <span class="k">def</span> <span class="nf">constraints</span><span class="p">(</span>
</span><span id="FisherMatrix.constraints-831"><a href="#FisherMatrix.constraints-831"><span class="linenos">831</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-832"><a href="#FisherMatrix.constraints-832"><span class="linenos">832</span></a>        <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-833"><a href="#FisherMatrix.constraints-833"><span class="linenos">833</span></a>        <span class="n">marginalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-834"><a href="#FisherMatrix.constraints-834"><span class="linenos">834</span></a>        <span class="n">sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-835"><a href="#FisherMatrix.constraints-835"><span class="linenos">835</span></a>        <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-836"><a href="#FisherMatrix.constraints-836"><span class="linenos">836</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix.constraints-837"><a href="#FisherMatrix.constraints-837"><span class="linenos">837</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.constraints-838"><a href="#FisherMatrix.constraints-838"><span class="linenos">838</span></a><span class="sd">        Returns the constraints on a parameter as a float, or on all of them</span>
</span><span id="FisherMatrix.constraints-839"><a href="#FisherMatrix.constraints-839"><span class="linenos">839</span></a><span class="sd">        as a numpy array if `name` is not specified.</span>
</span><span id="FisherMatrix.constraints-840"><a href="#FisherMatrix.constraints-840"><span class="linenos">840</span></a>
</span><span id="FisherMatrix.constraints-841"><a href="#FisherMatrix.constraints-841"><span class="linenos">841</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.constraints-842"><a href="#FisherMatrix.constraints-842"><span class="linenos">842</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.constraints-843"><a href="#FisherMatrix.constraints-843"><span class="linenos">843</span></a><span class="sd">        name : Optional[str] = None</span>
</span><span id="FisherMatrix.constraints-844"><a href="#FisherMatrix.constraints-844"><span class="linenos">844</span></a><span class="sd">            the name of the parameter for which we we want the constraints</span>
</span><span id="FisherMatrix.constraints-845"><a href="#FisherMatrix.constraints-845"><span class="linenos">845</span></a>
</span><span id="FisherMatrix.constraints-846"><a href="#FisherMatrix.constraints-846"><span class="linenos">846</span></a><span class="sd">        marginalized : bool = True</span>
</span><span id="FisherMatrix.constraints-847"><a href="#FisherMatrix.constraints-847"><span class="linenos">847</span></a><span class="sd">            whether we want the marginalized or the unmarginalized</span>
</span><span id="FisherMatrix.constraints-848"><a href="#FisherMatrix.constraints-848"><span class="linenos">848</span></a><span class="sd">            constraints.</span>
</span><span id="FisherMatrix.constraints-849"><a href="#FisherMatrix.constraints-849"><span class="linenos">849</span></a>
</span><span id="FisherMatrix.constraints-850"><a href="#FisherMatrix.constraints-850"><span class="linenos">850</span></a><span class="sd">        sigma : Optional[float] = None</span>
</span><span id="FisherMatrix.constraints-851"><a href="#FisherMatrix.constraints-851"><span class="linenos">851</span></a><span class="sd">            how many sigmas away.</span>
</span><span id="FisherMatrix.constraints-852"><a href="#FisherMatrix.constraints-852"><span class="linenos">852</span></a>
</span><span id="FisherMatrix.constraints-853"><a href="#FisherMatrix.constraints-853"><span class="linenos">853</span></a><span class="sd">        p : Optional[float] = None</span>
</span><span id="FisherMatrix.constraints-854"><a href="#FisherMatrix.constraints-854"><span class="linenos">854</span></a><span class="sd">            the confidence interval (p-value).</span>
</span><span id="FisherMatrix.constraints-855"><a href="#FisherMatrix.constraints-855"><span class="linenos">855</span></a><span class="sd">            The relationship between `p` and `sigma` is defined via:</span>
</span><span id="FisherMatrix.constraints-856"><a href="#FisherMatrix.constraints-856"><span class="linenos">856</span></a><span class="sd">            $$</span>
</span><span id="FisherMatrix.constraints-857"><a href="#FisherMatrix.constraints-857"><span class="linenos">857</span></a><span class="sd">                p(\sigma) = \int\limits_{\mu - \sigma}^{\mu + \sigma}</span>
</span><span id="FisherMatrix.constraints-858"><a href="#FisherMatrix.constraints-858"><span class="linenos">858</span></a><span class="sd">                            f(x, \mu, 1)\, \mathrm{d}x</span>
</span><span id="FisherMatrix.constraints-859"><a href="#FisherMatrix.constraints-859"><span class="linenos">859</span></a><span class="sd">                          = \mathrm{Erf}(\sigma / \sqrt{2})</span>
</span><span id="FisherMatrix.constraints-860"><a href="#FisherMatrix.constraints-860"><span class="linenos">860</span></a><span class="sd">            $$</span>
</span><span id="FisherMatrix.constraints-861"><a href="#FisherMatrix.constraints-861"><span class="linenos">861</span></a><span class="sd">            and therefore the inverse is simply:</span>
</span><span id="FisherMatrix.constraints-862"><a href="#FisherMatrix.constraints-862"><span class="linenos">862</span></a><span class="sd">            $$</span>
</span><span id="FisherMatrix.constraints-863"><a href="#FisherMatrix.constraints-863"><span class="linenos">863</span></a><span class="sd">                \sigma(p) = \sqrt{2}\, \mathrm{Erf}^{-1}(p)</span>
</span><span id="FisherMatrix.constraints-864"><a href="#FisherMatrix.constraints-864"><span class="linenos">864</span></a><span class="sd">            $$</span>
</span><span id="FisherMatrix.constraints-865"><a href="#FisherMatrix.constraints-865"><span class="linenos">865</span></a><span class="sd">            The values of `p` corresponding to 1, 2, 3 `sigma` are roughly</span>
</span><span id="FisherMatrix.constraints-866"><a href="#FisherMatrix.constraints-866"><span class="linenos">866</span></a><span class="sd">            0.683, 0.954, and 0.997, respectively.</span>
</span><span id="FisherMatrix.constraints-867"><a href="#FisherMatrix.constraints-867"><span class="linenos">867</span></a>
</span><span id="FisherMatrix.constraints-868"><a href="#FisherMatrix.constraints-868"><span class="linenos">868</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.constraints-869"><a href="#FisherMatrix.constraints-869"><span class="linenos">869</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.constraints-870"><a href="#FisherMatrix.constraints-870"><span class="linenos">870</span></a><span class="sd">        array-like of floats or single float</span>
</span><span id="FisherMatrix.constraints-871"><a href="#FisherMatrix.constraints-871"><span class="linenos">871</span></a>
</span><span id="FisherMatrix.constraints-872"><a href="#FisherMatrix.constraints-872"><span class="linenos">872</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix.constraints-873"><a href="#FisherMatrix.constraints-873"><span class="linenos">873</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix.constraints-874"><a href="#FisherMatrix.constraints-874"><span class="linenos">874</span></a><span class="sd">        The user should specify either `sigma` or `p`, but not both</span>
</span><span id="FisherMatrix.constraints-875"><a href="#FisherMatrix.constraints-875"><span class="linenos">875</span></a><span class="sd">        simultaneously.</span>
</span><span id="FisherMatrix.constraints-876"><a href="#FisherMatrix.constraints-876"><span class="linenos">876</span></a><span class="sd">        If neither are specified, defaults to `sigma=1`.</span>
</span><span id="FisherMatrix.constraints-877"><a href="#FisherMatrix.constraints-877"><span class="linenos">877</span></a>
</span><span id="FisherMatrix.constraints-878"><a href="#FisherMatrix.constraints-878"><span class="linenos">878</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.constraints-879"><a href="#FisherMatrix.constraints-879"><span class="linenos">879</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.constraints-880"><a href="#FisherMatrix.constraints-880"><span class="linenos">880</span></a><span class="sd">        Get (marginalized by default) constraints for all parameters:</span>
</span><span id="FisherMatrix.constraints-881"><a href="#FisherMatrix.constraints-881"><span class="linenos">881</span></a><span class="sd">        &gt;&gt;&gt; m = FisherMatrix([[3, -2], [-2, 5]])</span>
</span><span id="FisherMatrix.constraints-882"><a href="#FisherMatrix.constraints-882"><span class="linenos">882</span></a><span class="sd">        &gt;&gt;&gt; m.constraints()</span>
</span><span id="FisherMatrix.constraints-883"><a href="#FisherMatrix.constraints-883"><span class="linenos">883</span></a><span class="sd">        array([0.67419986, 0.52223297])</span>
</span><span id="FisherMatrix.constraints-884"><a href="#FisherMatrix.constraints-884"><span class="linenos">884</span></a>
</span><span id="FisherMatrix.constraints-885"><a href="#FisherMatrix.constraints-885"><span class="linenos">885</span></a><span class="sd">        Get the unmarginalized constraints instead:</span>
</span><span id="FisherMatrix.constraints-886"><a href="#FisherMatrix.constraints-886"><span class="linenos">886</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(marginalized=False)</span>
</span><span id="FisherMatrix.constraints-887"><a href="#FisherMatrix.constraints-887"><span class="linenos">887</span></a><span class="sd">        array([0.57735027, 0.4472136 ])</span>
</span><span id="FisherMatrix.constraints-888"><a href="#FisherMatrix.constraints-888"><span class="linenos">888</span></a>
</span><span id="FisherMatrix.constraints-889"><a href="#FisherMatrix.constraints-889"><span class="linenos">889</span></a><span class="sd">        Get the unmarginalized constraints for a single parameter:</span>
</span><span id="FisherMatrix.constraints-890"><a href="#FisherMatrix.constraints-890"><span class="linenos">890</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(&#39;p1&#39;, marginalized=False)</span>
</span><span id="FisherMatrix.constraints-891"><a href="#FisherMatrix.constraints-891"><span class="linenos">891</span></a><span class="sd">        array([0.57735027])</span>
</span><span id="FisherMatrix.constraints-892"><a href="#FisherMatrix.constraints-892"><span class="linenos">892</span></a>
</span><span id="FisherMatrix.constraints-893"><a href="#FisherMatrix.constraints-893"><span class="linenos">893</span></a><span class="sd">        Get the marginalized constraints for a single parameter:</span>
</span><span id="FisherMatrix.constraints-894"><a href="#FisherMatrix.constraints-894"><span class="linenos">894</span></a><span class="sd">        &gt;&gt;&gt; m.constraints(&#39;p1&#39;, p=0.682689) # p-value roughly equal to 1 sigma</span>
</span><span id="FisherMatrix.constraints-895"><a href="#FisherMatrix.constraints-895"><span class="linenos">895</span></a><span class="sd">        array([0.67419918])</span>
</span><span id="FisherMatrix.constraints-896"><a href="#FisherMatrix.constraints-896"><span class="linenos">896</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.constraints-897"><a href="#FisherMatrix.constraints-897"><span class="linenos">897</span></a>        <span class="k">if</span> <span class="n">sigma</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-898"><a href="#FisherMatrix.constraints-898"><span class="linenos">898</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix.constraints-899"><a href="#FisherMatrix.constraints-899"><span class="linenos">899</span></a>                <span class="s2">&quot;Cannot specify both `p` and `sigma` simultaneously; &quot;</span>
</span><span id="FisherMatrix.constraints-900"><a href="#FisherMatrix.constraints-900"><span class="linenos">900</span></a>                <span class="s2">&quot;please specify at most one of those&quot;</span>
</span><span id="FisherMatrix.constraints-901"><a href="#FisherMatrix.constraints-901"><span class="linenos">901</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix.constraints-902"><a href="#FisherMatrix.constraints-902"><span class="linenos">902</span></a>
</span><span id="FisherMatrix.constraints-903"><a href="#FisherMatrix.constraints-903"><span class="linenos">903</span></a>        <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-904"><a href="#FisherMatrix.constraints-904"><span class="linenos">904</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-905"><a href="#FisherMatrix.constraints-905"><span class="linenos">905</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix.constraints-906"><a href="#FisherMatrix.constraints-906"><span class="linenos">906</span></a>                    <span class="sa">f</span><span class="s2">&quot;The value of `p` </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2"> is outside of the allowed range (0, 1)&quot;</span>
</span><span id="FisherMatrix.constraints-907"><a href="#FisherMatrix.constraints-907"><span class="linenos">907</span></a>                <span class="p">)</span>
</span><span id="FisherMatrix.constraints-908"><a href="#FisherMatrix.constraints-908"><span class="linenos">908</span></a>            <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">erfinv</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="FisherMatrix.constraints-909"><a href="#FisherMatrix.constraints-909"><span class="linenos">909</span></a>        <span class="k">elif</span> <span class="n">sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-910"><a href="#FisherMatrix.constraints-910"><span class="linenos">910</span></a>            <span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="FisherMatrix.constraints-911"><a href="#FisherMatrix.constraints-911"><span class="linenos">911</span></a>
</span><span id="FisherMatrix.constraints-912"><a href="#FisherMatrix.constraints-912"><span class="linenos">912</span></a>        <span class="k">if</span> <span class="n">sigma</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-913"><a href="#FisherMatrix.constraints-913"><span class="linenos">913</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="FisherMatrix.constraints-914"><a href="#FisherMatrix.constraints-914"><span class="linenos">914</span></a>                <span class="sa">f</span><span class="s2">&quot;The value of `sigma` </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2"> is outside of the allowed range (0, infinify)&quot;</span>
</span><span id="FisherMatrix.constraints-915"><a href="#FisherMatrix.constraints-915"><span class="linenos">915</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix.constraints-916"><a href="#FisherMatrix.constraints-916"><span class="linenos">916</span></a>
</span><span id="FisherMatrix.constraints-917"><a href="#FisherMatrix.constraints-917"><span class="linenos">917</span></a>        <span class="k">if</span> <span class="n">marginalized</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-918"><a href="#FisherMatrix.constraints-918"><span class="linenos">918</span></a>            <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.constraints-919"><a href="#FisherMatrix.constraints-919"><span class="linenos">919</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span>
</span><span id="FisherMatrix.constraints-920"><a href="#FisherMatrix.constraints-920"><span class="linenos">920</span></a>                <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-921"><a href="#FisherMatrix.constraints-921"><span class="linenos">921</span></a>                <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-922"><a href="#FisherMatrix.constraints-922"><span class="linenos">922</span></a>                <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.constraints-923"><a href="#FisherMatrix.constraints-923"><span class="linenos">923</span></a>            <span class="p">)</span>
</span><span id="FisherMatrix.constraints-924"><a href="#FisherMatrix.constraints-924"><span class="linenos">924</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">inv</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">*</span> <span class="n">sigma</span>
</span><span id="FisherMatrix.constraints-925"><a href="#FisherMatrix.constraints-925"><span class="linenos">925</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-926"><a href="#FisherMatrix.constraints-926"><span class="linenos">926</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">*</span> <span class="n">sigma</span>
</span><span id="FisherMatrix.constraints-927"><a href="#FisherMatrix.constraints-927"><span class="linenos">927</span></a>
</span><span id="FisherMatrix.constraints-928"><a href="#FisherMatrix.constraints-928"><span class="linenos">928</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-929"><a href="#FisherMatrix.constraints-929"><span class="linenos">929</span></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherMatrix.constraints-930"><a href="#FisherMatrix.constraints-930"><span class="linenos">930</span></a>                <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)]</span>
</span><span id="FisherMatrix.constraints-931"><a href="#FisherMatrix.constraints-931"><span class="linenos">931</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.constraints-932"><a href="#FisherMatrix.constraints-932"><span class="linenos">932</span></a>
</span><span id="FisherMatrix.constraints-933"><a href="#FisherMatrix.constraints-933"><span class="linenos">933</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Returns the constraints on a parameter as a float, or on all of them
as a numpy array if <code>name</code> is not specified.</p>

<h2 id="parameters">Parameters</h2>

<p>name : Optional[str] = None
    the name of the parameter for which we we want the constraints</p>

<p>marginalized : bool = True
    whether we want the marginalized or the unmarginalized
    constraints.</p>

<p>sigma : Optional[float] = None
    how many sigmas away.</p>

<p>p : Optional[float] = None
    the confidence interval (p-value).
    The relationship between <code>p</code> and <code>sigma</code> is defined via:
    $$
        p(\sigma) = \int\limits_{\mu - \sigma}^{\mu + \sigma}
                    f(x, \mu, 1)\, \mathrm{d}x
                  = \mathrm{Erf}(\sigma / \sqrt{2})
    $$
    and therefore the inverse is simply:
    $$
        \sigma(p) = \sqrt{2}\, \mathrm{Erf}^{-1}(p)
    $$
    The values of <code>p</code> corresponding to 1, 2, 3 <code>sigma</code> are roughly
    0.683, 0.954, and 0.997, respectively.</p>

<h2 id="returns">Returns</h2>

<p>array-like of floats or single float</p>

<h2 id="notes">Notes</h2>

<p>The user should specify either <code>sigma</code> or <code>p</code>, but not both
simultaneously.
If neither are specified, defaults to <code>sigma=1</code>.</p>

<h2 id="examples">Examples</h2>

<p>Get (marginalized by default) constraints for all parameters:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">constraints</span><span class="p">()</span>
<span class="go">array([0.67419986, 0.52223297])</span>
</code></pre></div>

<p>Get the unmarginalized constraints instead:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">marginalized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([0.57735027, 0.4472136 ])</span>
</code></pre></div>

<p>Get the unmarginalized constraints for a single parameter:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([0.57735027])</span>
</code></pre></div>

<p>Get the marginalized constraints for a single parameter:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.682689</span><span class="p">)</span> <span class="c1"># p-value roughly equal to 1 sigma</span>
<span class="go">array([0.67419918])</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.fiducials" class="classattr">
                                <div class="attr variable">
            <span class="name">fiducials</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.fiducials"></a>
    
            <div class="docstring"><p>Returns the fiducial values of the Fisher object as a numpy array.</p>
</div>


                            </div>
                            <div id="FisherMatrix.names" class="classattr">
                                <div class="attr variable">
            <span class="name">names</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.names"></a>
    
            <div class="docstring"><p>Returns the parameter names of the Fisher object.</p>
</div>


                            </div>
                            <div id="FisherMatrix.latex_names" class="classattr">
                                <div class="attr variable">
            <span class="name">latex_names</span>

        
    </div>
    <a class="headerlink" href="#FisherMatrix.latex_names"></a>
    
            <div class="docstring"><p>Returns the LaTeX names of the parameters of the Fisher object.</p>
</div>


                            </div>
                            <div id="FisherMatrix.reparametrize" class="classattr">
                                        <input id="FisherMatrix.reparametrize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reparametrize</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">jacobian</span>,</span><span class="param">	<span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.reparametrize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.reparametrize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.reparametrize-1245"><a href="#FisherMatrix.reparametrize-1245"><span class="linenos">1245</span></a>    <span class="k">def</span> <span class="nf">reparametrize</span><span class="p">(</span>
</span><span id="FisherMatrix.reparametrize-1246"><a href="#FisherMatrix.reparametrize-1246"><span class="linenos">1246</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1247"><a href="#FisherMatrix.reparametrize-1247"><span class="linenos">1247</span></a>        <span class="n">jacobian</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1248"><a href="#FisherMatrix.reparametrize-1248"><span class="linenos">1248</span></a>        <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1249"><a href="#FisherMatrix.reparametrize-1249"><span class="linenos">1249</span></a>        <span class="n">latex_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1250"><a href="#FisherMatrix.reparametrize-1250"><span class="linenos">1250</span></a>        <span class="n">fiducials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1251"><a href="#FisherMatrix.reparametrize-1251"><span class="linenos">1251</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-1252"><a href="#FisherMatrix.reparametrize-1252"><span class="linenos">1252</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.reparametrize-1253"><a href="#FisherMatrix.reparametrize-1253"><span class="linenos">1253</span></a><span class="sd">        Returns a new Fisher object with parameters `names`, which are</span>
</span><span id="FisherMatrix.reparametrize-1254"><a href="#FisherMatrix.reparametrize-1254"><span class="linenos">1254</span></a><span class="sd">        related to the old ones via the transformation `jacobian`.</span>
</span><span id="FisherMatrix.reparametrize-1255"><a href="#FisherMatrix.reparametrize-1255"><span class="linenos">1255</span></a><span class="sd">        See the [Wikipedia</span>
</span><span id="FisherMatrix.reparametrize-1256"><a href="#FisherMatrix.reparametrize-1256"><span class="linenos">1256</span></a><span class="sd">        article](https://en.wikipedia.org/w/index.php?title=Fisher_information&amp;oldid=1063384000#Reparametrization)</span>
</span><span id="FisherMatrix.reparametrize-1257"><a href="#FisherMatrix.reparametrize-1257"><span class="linenos">1257</span></a><span class="sd">        for more information.</span>
</span><span id="FisherMatrix.reparametrize-1258"><a href="#FisherMatrix.reparametrize-1258"><span class="linenos">1258</span></a>
</span><span id="FisherMatrix.reparametrize-1259"><a href="#FisherMatrix.reparametrize-1259"><span class="linenos">1259</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.reparametrize-1260"><a href="#FisherMatrix.reparametrize-1260"><span class="linenos">1260</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.reparametrize-1261"><a href="#FisherMatrix.reparametrize-1261"><span class="linenos">1261</span></a><span class="sd">        transformation : array-like</span>
</span><span id="FisherMatrix.reparametrize-1262"><a href="#FisherMatrix.reparametrize-1262"><span class="linenos">1262</span></a><span class="sd">            the Jacobian of the transformation</span>
</span><span id="FisherMatrix.reparametrize-1263"><a href="#FisherMatrix.reparametrize-1263"><span class="linenos">1263</span></a>
</span><span id="FisherMatrix.reparametrize-1264"><a href="#FisherMatrix.reparametrize-1264"><span class="linenos">1264</span></a><span class="sd">        names : array-like = None</span>
</span><span id="FisherMatrix.reparametrize-1265"><a href="#FisherMatrix.reparametrize-1265"><span class="linenos">1265</span></a><span class="sd">            list of new names for the Fisher object. If None, uses the old</span>
</span><span id="FisherMatrix.reparametrize-1266"><a href="#FisherMatrix.reparametrize-1266"><span class="linenos">1266</span></a><span class="sd">            names.</span>
</span><span id="FisherMatrix.reparametrize-1267"><a href="#FisherMatrix.reparametrize-1267"><span class="linenos">1267</span></a>
</span><span id="FisherMatrix.reparametrize-1268"><a href="#FisherMatrix.reparametrize-1268"><span class="linenos">1268</span></a><span class="sd">        latex_names: array-like = None</span>
</span><span id="FisherMatrix.reparametrize-1269"><a href="#FisherMatrix.reparametrize-1269"><span class="linenos">1269</span></a><span class="sd">            list of new LaTeX names for the Fisher object. If None, and</span>
</span><span id="FisherMatrix.reparametrize-1270"><a href="#FisherMatrix.reparametrize-1270"><span class="linenos">1270</span></a><span class="sd">            `names` is set, uses those instead, otherwise uses the old LaTeX names.</span>
</span><span id="FisherMatrix.reparametrize-1271"><a href="#FisherMatrix.reparametrize-1271"><span class="linenos">1271</span></a>
</span><span id="FisherMatrix.reparametrize-1272"><a href="#FisherMatrix.reparametrize-1272"><span class="linenos">1272</span></a><span class="sd">        fiducials : array-like = None</span>
</span><span id="FisherMatrix.reparametrize-1273"><a href="#FisherMatrix.reparametrize-1273"><span class="linenos">1273</span></a><span class="sd">            the new values of the fiducials. If not set, defaults to old values.</span>
</span><span id="FisherMatrix.reparametrize-1274"><a href="#FisherMatrix.reparametrize-1274"><span class="linenos">1274</span></a>
</span><span id="FisherMatrix.reparametrize-1275"><a href="#FisherMatrix.reparametrize-1275"><span class="linenos">1275</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.reparametrize-1276"><a href="#FisherMatrix.reparametrize-1276"><span class="linenos">1276</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.reparametrize-1277"><a href="#FisherMatrix.reparametrize-1277"><span class="linenos">1277</span></a><span class="sd">        Instance of `FisherMatrix`.</span>
</span><span id="FisherMatrix.reparametrize-1278"><a href="#FisherMatrix.reparametrize-1278"><span class="linenos">1278</span></a>
</span><span id="FisherMatrix.reparametrize-1279"><a href="#FisherMatrix.reparametrize-1279"><span class="linenos">1279</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.reparametrize-1280"><a href="#FisherMatrix.reparametrize-1280"><span class="linenos">1280</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.reparametrize-1281"><a href="#FisherMatrix.reparametrize-1281"><span class="linenos">1281</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]))</span>
</span><span id="FisherMatrix.reparametrize-1282"><a href="#FisherMatrix.reparametrize-1282"><span class="linenos">1282</span></a><span class="sd">        &gt;&gt;&gt; jac = [[1, 4], [3, 2]]</span>
</span><span id="FisherMatrix.reparametrize-1283"><a href="#FisherMatrix.reparametrize-1283"><span class="linenos">1283</span></a><span class="sd">        &gt;&gt;&gt; fm.reparametrize(jac, names=[&#39;a&#39;, &#39;b&#39;])</span>
</span><span id="FisherMatrix.reparametrize-1284"><a href="#FisherMatrix.reparametrize-1284"><span class="linenos">1284</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.reparametrize-1285"><a href="#FisherMatrix.reparametrize-1285"><span class="linenos">1285</span></a><span class="sd">            array([[19., 16.],</span>
</span><span id="FisherMatrix.reparametrize-1286"><a href="#FisherMatrix.reparametrize-1286"><span class="linenos">1286</span></a><span class="sd">               [16., 24.]]),</span>
</span><span id="FisherMatrix.reparametrize-1287"><a href="#FisherMatrix.reparametrize-1287"><span class="linenos">1287</span></a><span class="sd">            names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix.reparametrize-1288"><a href="#FisherMatrix.reparametrize-1288"><span class="linenos">1288</span></a><span class="sd">            latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
</span><span id="FisherMatrix.reparametrize-1289"><a href="#FisherMatrix.reparametrize-1289"><span class="linenos">1289</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix.reparametrize-1290"><a href="#FisherMatrix.reparametrize-1290"><span class="linenos">1290</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.reparametrize-1291"><a href="#FisherMatrix.reparametrize-1291"><span class="linenos">1291</span></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">@</span> <span class="n">jacobian</span>
</span><span id="FisherMatrix.reparametrize-1292"><a href="#FisherMatrix.reparametrize-1292"><span class="linenos">1292</span></a>
</span><span id="FisherMatrix.reparametrize-1293"><a href="#FisherMatrix.reparametrize-1293"><span class="linenos">1293</span></a>        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-1294"><a href="#FisherMatrix.reparametrize-1294"><span class="linenos">1294</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix.reparametrize-1295"><a href="#FisherMatrix.reparametrize-1295"><span class="linenos">1295</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-1296"><a href="#FisherMatrix.reparametrize-1296"><span class="linenos">1296</span></a>            <span class="k">if</span> <span class="n">latex_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-1297"><a href="#FisherMatrix.reparametrize-1297"><span class="linenos">1297</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">latex_names</span><span class="p">))</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix.reparametrize-1298"><a href="#FisherMatrix.reparametrize-1298"><span class="linenos">1298</span></a>                    <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-1299"><a href="#FisherMatrix.reparametrize-1299"><span class="linenos">1299</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-1300"><a href="#FisherMatrix.reparametrize-1300"><span class="linenos">1300</span></a>                <span class="n">latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-1301"><a href="#FisherMatrix.reparametrize-1301"><span class="linenos">1301</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-1302"><a href="#FisherMatrix.reparametrize-1302"><span class="linenos">1302</span></a>            <span class="c1"># we don&#39;t transform the names</span>
</span><span id="FisherMatrix.reparametrize-1303"><a href="#FisherMatrix.reparametrize-1303"><span class="linenos">1303</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-1304"><a href="#FisherMatrix.reparametrize-1304"><span class="linenos">1304</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-1305"><a href="#FisherMatrix.reparametrize-1305"><span class="linenos">1305</span></a>
</span><span id="FisherMatrix.reparametrize-1306"><a href="#FisherMatrix.reparametrize-1306"><span class="linenos">1306</span></a>        <span class="k">if</span> <span class="n">fiducials</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-1307"><a href="#FisherMatrix.reparametrize-1307"><span class="linenos">1307</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fiducials</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="FisherMatrix.reparametrize-1308"><a href="#FisherMatrix.reparametrize-1308"><span class="linenos">1308</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-1309"><a href="#FisherMatrix.reparametrize-1309"><span class="linenos">1309</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherMatrix.reparametrize-1310"><a href="#FisherMatrix.reparametrize-1310"><span class="linenos">1310</span></a>            <span class="n">fiducials</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">)</span>
</span><span id="FisherMatrix.reparametrize-1311"><a href="#FisherMatrix.reparametrize-1311"><span class="linenos">1311</span></a>
</span><span id="FisherMatrix.reparametrize-1312"><a href="#FisherMatrix.reparametrize-1312"><span class="linenos">1312</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.reparametrize-1313"><a href="#FisherMatrix.reparametrize-1313"><span class="linenos">1313</span></a>            <span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1314"><a href="#FisherMatrix.reparametrize-1314"><span class="linenos">1314</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1315"><a href="#FisherMatrix.reparametrize-1315"><span class="linenos">1315</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1316"><a href="#FisherMatrix.reparametrize-1316"><span class="linenos">1316</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.reparametrize-1317"><a href="#FisherMatrix.reparametrize-1317"><span class="linenos">1317</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns a new Fisher object with parameters <code><a href="#FisherMatrix.names">names</a></code>, which are
related to the old ones via the transformation <code>jacobian</code>.
See the <a href="https://en.wikipedia.org/w/index.php?title=Fisher_information&amp;oldid=1063384000#Reparametrization">Wikipedia
article</a>
for more information.</p>

<h2 id="parameters">Parameters</h2>

<p>transformation : array-like
    the Jacobian of the transformation</p>

<p>names : array-like = None
    list of new names for the Fisher object. If None, uses the old
    names.</p>

<p>latex_names: array-like = None
    list of new LaTeX names for the Fisher object. If None, and
    <code><a href="#FisherMatrix.names">names</a></code> is set, uses those instead, otherwise uses the old LaTeX names.</p>

<p>fiducials : array-like = None
    the new values of the fiducials. If not set, defaults to old values.</p>

<h2 id="returns">Returns</h2>

<p>Instance of <code><a href="#FisherMatrix">FisherMatrix</a></code>.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jac</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">reparametrize</span><span class="p">(</span><span class="n">jac</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[19., 16.],</span>
<span class="go">       [16., 24.]]),</span>
<span class="go">    names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;a&#39;, &#39;b&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.to_file" class="classattr">
                                        <input id="FisherMatrix.to_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_file</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.to_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.to_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.to_file-1319"><a href="#FisherMatrix.to_file-1319"><span class="linenos">1319</span></a>    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span>
</span><span id="FisherMatrix.to_file-1320"><a href="#FisherMatrix.to_file-1320"><span class="linenos">1320</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FisherMatrix.to_file-1321"><a href="#FisherMatrix.to_file-1321"><span class="linenos">1321</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="FisherMatrix.to_file-1322"><a href="#FisherMatrix.to_file-1322"><span class="linenos">1322</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.to_file-1323"><a href="#FisherMatrix.to_file-1323"><span class="linenos">1323</span></a><span class="sd">        Saves the Fisher object to a file (UTF-8 encoded).</span>
</span><span id="FisherMatrix.to_file-1324"><a href="#FisherMatrix.to_file-1324"><span class="linenos">1324</span></a><span class="sd">        The format used is a simple JSON file, containing at least the values of the</span>
</span><span id="FisherMatrix.to_file-1325"><a href="#FisherMatrix.to_file-1325"><span class="linenos">1325</span></a><span class="sd">        Fisher object, the names of the parameters, the LaTeX names, and the</span>
</span><span id="FisherMatrix.to_file-1326"><a href="#FisherMatrix.to_file-1326"><span class="linenos">1326</span></a><span class="sd">        fiducial values.</span>
</span><span id="FisherMatrix.to_file-1327"><a href="#FisherMatrix.to_file-1327"><span class="linenos">1327</span></a>
</span><span id="FisherMatrix.to_file-1328"><a href="#FisherMatrix.to_file-1328"><span class="linenos">1328</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.to_file-1329"><a href="#FisherMatrix.to_file-1329"><span class="linenos">1329</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.to_file-1330"><a href="#FisherMatrix.to_file-1330"><span class="linenos">1330</span></a><span class="sd">        path : str</span>
</span><span id="FisherMatrix.to_file-1331"><a href="#FisherMatrix.to_file-1331"><span class="linenos">1331</span></a><span class="sd">            the path to save the data to.</span>
</span><span id="FisherMatrix.to_file-1332"><a href="#FisherMatrix.to_file-1332"><span class="linenos">1332</span></a>
</span><span id="FisherMatrix.to_file-1333"><a href="#FisherMatrix.to_file-1333"><span class="linenos">1333</span></a><span class="sd">        metadata : Optional[Mapping[str, Any]] = None</span>
</span><span id="FisherMatrix.to_file-1334"><a href="#FisherMatrix.to_file-1334"><span class="linenos">1334</span></a><span class="sd">            any metadata that should be associated to the object saved, in the</span>
</span><span id="FisherMatrix.to_file-1335"><a href="#FisherMatrix.to_file-1335"><span class="linenos">1335</span></a><span class="sd">            form of a dictionary-like object</span>
</span><span id="FisherMatrix.to_file-1336"><a href="#FisherMatrix.to_file-1336"><span class="linenos">1336</span></a>
</span><span id="FisherMatrix.to_file-1337"><a href="#FisherMatrix.to_file-1337"><span class="linenos">1337</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.to_file-1338"><a href="#FisherMatrix.to_file-1338"><span class="linenos">1338</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.to_file-1339"><a href="#FisherMatrix.to_file-1339"><span class="linenos">1339</span></a><span class="sd">        The dictionary that was saved.</span>
</span><span id="FisherMatrix.to_file-1340"><a href="#FisherMatrix.to_file-1340"><span class="linenos">1340</span></a>
</span><span id="FisherMatrix.to_file-1341"><a href="#FisherMatrix.to_file-1341"><span class="linenos">1341</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.to_file-1342"><a href="#FisherMatrix.to_file-1342"><span class="linenos">1342</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.to_file-1343"><a href="#FisherMatrix.to_file-1343"><span class="linenos">1343</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(np.diag([1, 2]),</span>
</span><span id="FisherMatrix.to_file-1344"><a href="#FisherMatrix.to_file-1344"><span class="linenos">1344</span></a><span class="sd">        ... names=[&#39;a&#39;, &#39;b&#39;], latex_names=[r&#39;$\mathbf{A}$&#39;, r&#39;$\mathbf{B}$&#39;])</span>
</span><span id="FisherMatrix.to_file-1345"><a href="#FisherMatrix.to_file-1345"><span class="linenos">1345</span></a><span class="sd">        &gt;&gt;&gt; pprint(fm.to_file(&#39;example_matrix.json&#39;), sort_dicts=False) # doctest: +SKIP</span>
</span><span id="FisherMatrix.to_file-1346"><a href="#FisherMatrix.to_file-1346"><span class="linenos">1346</span></a><span class="sd">        {&#39;values&#39;: [[1.0, 0.0], [0.0, 2.0]],</span>
</span><span id="FisherMatrix.to_file-1347"><a href="#FisherMatrix.to_file-1347"><span class="linenos">1347</span></a><span class="sd">         &#39;names&#39;: [&#39;a&#39;, &#39;b&#39;],</span>
</span><span id="FisherMatrix.to_file-1348"><a href="#FisherMatrix.to_file-1348"><span class="linenos">1348</span></a><span class="sd">         &#39;latex_names&#39;: [&#39;$\\mathbf{A}$&#39;, &#39;$\\mathbf{B}$&#39;],</span>
</span><span id="FisherMatrix.to_file-1349"><a href="#FisherMatrix.to_file-1349"><span class="linenos">1349</span></a><span class="sd">         &#39;fiducials&#39;: [0.0, 0.0]}</span>
</span><span id="FisherMatrix.to_file-1350"><a href="#FisherMatrix.to_file-1350"><span class="linenos">1350</span></a><span class="sd">        &gt;&gt;&gt; # convenience function for reading it</span>
</span><span id="FisherMatrix.to_file-1351"><a href="#FisherMatrix.to_file-1351"><span class="linenos">1351</span></a><span class="sd">        &gt;&gt;&gt; fm_read = FisherMatrix.from_file(&#39;example_matrix.json&#39;)</span>
</span><span id="FisherMatrix.to_file-1352"><a href="#FisherMatrix.to_file-1352"><span class="linenos">1352</span></a><span class="sd">        &gt;&gt;&gt; fm == fm_read # verify it&#39;s the same object</span>
</span><span id="FisherMatrix.to_file-1353"><a href="#FisherMatrix.to_file-1353"><span class="linenos">1353</span></a><span class="sd">        True</span>
</span><span id="FisherMatrix.to_file-1354"><a href="#FisherMatrix.to_file-1354"><span class="linenos">1354</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.to_file-1355"><a href="#FisherMatrix.to_file-1355"><span class="linenos">1355</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="FisherMatrix.to_file-1356"><a href="#FisherMatrix.to_file-1356"><span class="linenos">1356</span></a>            <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="FisherMatrix.to_file-1357"><a href="#FisherMatrix.to_file-1357"><span class="linenos">1357</span></a>            <span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.to_file-1358"><a href="#FisherMatrix.to_file-1358"><span class="linenos">1358</span></a>            <span class="s2">&quot;latex_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.to_file-1359"><a href="#FisherMatrix.to_file-1359"><span class="linenos">1359</span></a>            <span class="s2">&quot;fiducials&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.to_file-1360"><a href="#FisherMatrix.to_file-1360"><span class="linenos">1360</span></a>        <span class="p">}</span>
</span><span id="FisherMatrix.to_file-1361"><a href="#FisherMatrix.to_file-1361"><span class="linenos">1361</span></a>
</span><span id="FisherMatrix.to_file-1362"><a href="#FisherMatrix.to_file-1362"><span class="linenos">1362</span></a>        <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherMatrix.to_file-1363"><a href="#FisherMatrix.to_file-1363"><span class="linenos">1363</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="FisherMatrix.to_file-1364"><a href="#FisherMatrix.to_file-1364"><span class="linenos">1364</span></a>                <span class="o">**</span><span class="n">data</span><span class="p">,</span>
</span><span id="FisherMatrix.to_file-1365"><a href="#FisherMatrix.to_file-1365"><span class="linenos">1365</span></a>                <span class="o">**</span><span class="p">{</span><span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">},</span>
</span><span id="FisherMatrix.to_file-1366"><a href="#FisherMatrix.to_file-1366"><span class="linenos">1366</span></a>            <span class="p">}</span>
</span><span id="FisherMatrix.to_file-1367"><a href="#FisherMatrix.to_file-1367"><span class="linenos">1367</span></a>
</span><span id="FisherMatrix.to_file-1368"><a href="#FisherMatrix.to_file-1368"><span class="linenos">1368</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
</span><span id="FisherMatrix.to_file-1369"><a href="#FisherMatrix.to_file-1369"><span class="linenos">1369</span></a>            <span class="n">file_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">FisherEncoder</span><span class="p">))</span>
</span><span id="FisherMatrix.to_file-1370"><a href="#FisherMatrix.to_file-1370"><span class="linenos">1370</span></a>
</span><span id="FisherMatrix.to_file-1371"><a href="#FisherMatrix.to_file-1371"><span class="linenos">1371</span></a>        <span class="k">return</span> <span class="n">data</span>
</span></pre></div>


            <div class="docstring"><p>Saves the Fisher object to a file (UTF-8 encoded).
The format used is a simple JSON file, containing at least the values of the
Fisher object, the names of the parameters, the LaTeX names, and the
fiducial values.</p>

<h2 id="parameters">Parameters</h2>

<p>path : str
    the path to save the data to.</p>

<p>metadata : Optional[Mapping[str, Any]] = None
    any metadata that should be associated to the object saved, in the
    form of a dictionary-like object</p>

<h2 id="returns">Returns</h2>

<p>The dictionary that was saved.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<span class="gp">... </span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{A}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{B}</span><span class="s1">$&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;example_matrix.json&#39;</span><span class="p">),</span> <span class="n">sort_dicts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">{&#39;values&#39;: [[1.0, 0.0], [0.0, 2.0]],</span>
<span class="go"> &#39;names&#39;: [&#39;a&#39;, &#39;b&#39;],</span>
<span class="go"> &#39;latex_names&#39;: [&#39;$\\mathbf{A}$&#39;, &#39;$\\mathbf{B}$&#39;],</span>
<span class="go"> &#39;fiducials&#39;: [0.0, 0.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># convenience function for reading it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_read</span> <span class="o">=</span> <span class="n"><a href="#FisherMatrix.from_file">FisherMatrix</span><span class="o">.</span><span class="n">from_file</a></span><span class="p">(</span><span class="s1">&#39;example_matrix.json&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">==</span> <span class="n">fm_read</span> <span class="c1"># verify it&#39;s the same object</span>
<span class="go">True</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.marginalize_over" class="classattr">
                                        <input id="FisherMatrix.marginalize_over-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">marginalize_over</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>:</span></span>

                <label class="view-source-button" for="FisherMatrix.marginalize_over-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.marginalize_over"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.marginalize_over-1373"><a href="#FisherMatrix.marginalize_over-1373"><span class="linenos">1373</span></a>    <span class="k">def</span> <span class="nf">marginalize_over</span><span class="p">(</span>
</span><span id="FisherMatrix.marginalize_over-1374"><a href="#FisherMatrix.marginalize_over-1374"><span class="linenos">1374</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-1375"><a href="#FisherMatrix.marginalize_over-1375"><span class="linenos">1375</span></a>        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-1376"><a href="#FisherMatrix.marginalize_over-1376"><span class="linenos">1376</span></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-1377"><a href="#FisherMatrix.marginalize_over-1377"><span class="linenos">1377</span></a>        <span class="n">ignore_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-1378"><a href="#FisherMatrix.marginalize_over-1378"><span class="linenos">1378</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FisherMatrix</span><span class="p">:</span>
</span><span id="FisherMatrix.marginalize_over-1379"><a href="#FisherMatrix.marginalize_over-1379"><span class="linenos">1379</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.marginalize_over-1380"><a href="#FisherMatrix.marginalize_over-1380"><span class="linenos">1380</span></a><span class="sd">        Perform marginalization over some parameters.</span>
</span><span id="FisherMatrix.marginalize_over-1381"><a href="#FisherMatrix.marginalize_over-1381"><span class="linenos">1381</span></a>
</span><span id="FisherMatrix.marginalize_over-1382"><a href="#FisherMatrix.marginalize_over-1382"><span class="linenos">1382</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.marginalize_over-1383"><a href="#FisherMatrix.marginalize_over-1383"><span class="linenos">1383</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.marginalize_over-1384"><a href="#FisherMatrix.marginalize_over-1384"><span class="linenos">1384</span></a><span class="sd">        names : str</span>
</span><span id="FisherMatrix.marginalize_over-1385"><a href="#FisherMatrix.marginalize_over-1385"><span class="linenos">1385</span></a><span class="sd">            the names of the parameters to marginalize over</span>
</span><span id="FisherMatrix.marginalize_over-1386"><a href="#FisherMatrix.marginalize_over-1386"><span class="linenos">1386</span></a>
</span><span id="FisherMatrix.marginalize_over-1387"><a href="#FisherMatrix.marginalize_over-1387"><span class="linenos">1387</span></a><span class="sd">        invert : bool = False</span>
</span><span id="FisherMatrix.marginalize_over-1388"><a href="#FisherMatrix.marginalize_over-1388"><span class="linenos">1388</span></a><span class="sd">            whether to marginalize over all the parameters NOT in names (the complement)</span>
</span><span id="FisherMatrix.marginalize_over-1389"><a href="#FisherMatrix.marginalize_over-1389"><span class="linenos">1389</span></a>
</span><span id="FisherMatrix.marginalize_over-1390"><a href="#FisherMatrix.marginalize_over-1390"><span class="linenos">1390</span></a><span class="sd">        ignore_errors : bool = False</span>
</span><span id="FisherMatrix.marginalize_over-1391"><a href="#FisherMatrix.marginalize_over-1391"><span class="linenos">1391</span></a><span class="sd">            should non-existing parameters be ignored</span>
</span><span id="FisherMatrix.marginalize_over-1392"><a href="#FisherMatrix.marginalize_over-1392"><span class="linenos">1392</span></a>
</span><span id="FisherMatrix.marginalize_over-1393"><a href="#FisherMatrix.marginalize_over-1393"><span class="linenos">1393</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.marginalize_over-1394"><a href="#FisherMatrix.marginalize_over-1394"><span class="linenos">1394</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.marginalize_over-1395"><a href="#FisherMatrix.marginalize_over-1395"><span class="linenos">1395</span></a><span class="sd">        Instance of `FisherMatrix`.</span>
</span><span id="FisherMatrix.marginalize_over-1396"><a href="#FisherMatrix.marginalize_over-1396"><span class="linenos">1396</span></a>
</span><span id="FisherMatrix.marginalize_over-1397"><a href="#FisherMatrix.marginalize_over-1397"><span class="linenos">1397</span></a><span class="sd">        Examples</span>
</span><span id="FisherMatrix.marginalize_over-1398"><a href="#FisherMatrix.marginalize_over-1398"><span class="linenos">1398</span></a><span class="sd">        --------</span>
</span><span id="FisherMatrix.marginalize_over-1399"><a href="#FisherMatrix.marginalize_over-1399"><span class="linenos">1399</span></a><span class="sd">        Generate a Fisher object using a random orthogonal matrix:</span>
</span><span id="FisherMatrix.marginalize_over-1400"><a href="#FisherMatrix.marginalize_over-1400"><span class="linenos">1400</span></a><span class="sd">        &gt;&gt;&gt; from scipy.stats import ortho_group</span>
</span><span id="FisherMatrix.marginalize_over-1401"><a href="#FisherMatrix.marginalize_over-1401"><span class="linenos">1401</span></a><span class="sd">        &gt;&gt;&gt; rm = ortho_group.rvs(5, random_state=12345)</span>
</span><span id="FisherMatrix.marginalize_over-1402"><a href="#FisherMatrix.marginalize_over-1402"><span class="linenos">1402</span></a><span class="sd">        &gt;&gt;&gt; fm = FisherMatrix(rm.T @ np.diag([1, 2, 3, 7, 6]) @ rm)</span>
</span><span id="FisherMatrix.marginalize_over-1403"><a href="#FisherMatrix.marginalize_over-1403"><span class="linenos">1403</span></a>
</span><span id="FisherMatrix.marginalize_over-1404"><a href="#FisherMatrix.marginalize_over-1404"><span class="linenos">1404</span></a><span class="sd">        Marginalize over some parameters:</span>
</span><span id="FisherMatrix.marginalize_over-1405"><a href="#FisherMatrix.marginalize_over-1405"><span class="linenos">1405</span></a><span class="sd">        &gt;&gt;&gt; fm.marginalize_over(&#39;p1&#39;, &#39;p2&#39;)</span>
</span><span id="FisherMatrix.marginalize_over-1406"><a href="#FisherMatrix.marginalize_over-1406"><span class="linenos">1406</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.marginalize_over-1407"><a href="#FisherMatrix.marginalize_over-1407"><span class="linenos">1407</span></a><span class="sd">            array([[ 1.67715591, -1.01556085,  0.30020773],</span>
</span><span id="FisherMatrix.marginalize_over-1408"><a href="#FisherMatrix.marginalize_over-1408"><span class="linenos">1408</span></a><span class="sd">               [-1.01556085,  4.92788976,  0.91219831],</span>
</span><span id="FisherMatrix.marginalize_over-1409"><a href="#FisherMatrix.marginalize_over-1409"><span class="linenos">1409</span></a><span class="sd">               [ 0.30020773,  0.91219831,  3.1796454 ]]),</span>
</span><span id="FisherMatrix.marginalize_over-1410"><a href="#FisherMatrix.marginalize_over-1410"><span class="linenos">1410</span></a><span class="sd">            names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
</span><span id="FisherMatrix.marginalize_over-1411"><a href="#FisherMatrix.marginalize_over-1411"><span class="linenos">1411</span></a><span class="sd">            latex_names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
</span><span id="FisherMatrix.marginalize_over-1412"><a href="#FisherMatrix.marginalize_over-1412"><span class="linenos">1412</span></a><span class="sd">            fiducials=array([0., 0., 0.]))</span>
</span><span id="FisherMatrix.marginalize_over-1413"><a href="#FisherMatrix.marginalize_over-1413"><span class="linenos">1413</span></a>
</span><span id="FisherMatrix.marginalize_over-1414"><a href="#FisherMatrix.marginalize_over-1414"><span class="linenos">1414</span></a><span class="sd">        Marginalize over all parameters which are NOT `p1` or `p2`:</span>
</span><span id="FisherMatrix.marginalize_over-1415"><a href="#FisherMatrix.marginalize_over-1415"><span class="linenos">1415</span></a><span class="sd">        &gt;&gt;&gt; fm.marginalize_over(&#39;p1&#39;, &#39;p2&#39;, invert=True)</span>
</span><span id="FisherMatrix.marginalize_over-1416"><a href="#FisherMatrix.marginalize_over-1416"><span class="linenos">1416</span></a><span class="sd">        FisherMatrix(</span>
</span><span id="FisherMatrix.marginalize_over-1417"><a href="#FisherMatrix.marginalize_over-1417"><span class="linenos">1417</span></a><span class="sd">            array([[ 5.04480062, -0.04490453],</span>
</span><span id="FisherMatrix.marginalize_over-1418"><a href="#FisherMatrix.marginalize_over-1418"><span class="linenos">1418</span></a><span class="sd">               [-0.04490453,  1.61599083]]),</span>
</span><span id="FisherMatrix.marginalize_over-1419"><a href="#FisherMatrix.marginalize_over-1419"><span class="linenos">1419</span></a><span class="sd">            names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.marginalize_over-1420"><a href="#FisherMatrix.marginalize_over-1420"><span class="linenos">1420</span></a><span class="sd">            latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
</span><span id="FisherMatrix.marginalize_over-1421"><a href="#FisherMatrix.marginalize_over-1421"><span class="linenos">1421</span></a><span class="sd">            fiducials=array([0., 0.]))</span>
</span><span id="FisherMatrix.marginalize_over-1422"><a href="#FisherMatrix.marginalize_over-1422"><span class="linenos">1422</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.marginalize_over-1423"><a href="#FisherMatrix.marginalize_over-1423"><span class="linenos">1423</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.marginalize_over-1424"><a href="#FisherMatrix.marginalize_over-1424"><span class="linenos">1424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span>
</span><span id="FisherMatrix.marginalize_over-1425"><a href="#FisherMatrix.marginalize_over-1425"><span class="linenos">1425</span></a>            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-1426"><a href="#FisherMatrix.marginalize_over-1426"><span class="linenos">1426</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-1427"><a href="#FisherMatrix.marginalize_over-1427"><span class="linenos">1427</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-1428"><a href="#FisherMatrix.marginalize_over-1428"><span class="linenos">1428</span></a>        <span class="p">)</span>
</span><span id="FisherMatrix.marginalize_over-1429"><a href="#FisherMatrix.marginalize_over-1429"><span class="linenos">1429</span></a>        <span class="k">if</span> <span class="n">invert</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherMatrix.marginalize_over-1430"><a href="#FisherMatrix.marginalize_over-1430"><span class="linenos">1430</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">^</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherMatrix.marginalize_over-1431"><a href="#FisherMatrix.marginalize_over-1431"><span class="linenos">1431</span></a>        <span class="n">fisher</span> <span class="o">=</span> <span class="n">inv</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="n">ignore_errors</span><span class="p">)</span>
</span><span id="FisherMatrix.marginalize_over-1432"><a href="#FisherMatrix.marginalize_over-1432"><span class="linenos">1432</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="FisherMatrix.marginalize_over-1433"><a href="#FisherMatrix.marginalize_over-1433"><span class="linenos">1433</span></a>            <span class="n">fisher</span><span class="o">.</span><span class="n">inverse</span><span class="p">(),</span>
</span><span id="FisherMatrix.marginalize_over-1434"><a href="#FisherMatrix.marginalize_over-1434"><span class="linenos">1434</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-1435"><a href="#FisherMatrix.marginalize_over-1435"><span class="linenos">1435</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">latex_names</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-1436"><a href="#FisherMatrix.marginalize_over-1436"><span class="linenos">1436</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fisher</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="FisherMatrix.marginalize_over-1437"><a href="#FisherMatrix.marginalize_over-1437"><span class="linenos">1437</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Perform marginalization over some parameters.</p>

<h2 id="parameters">Parameters</h2>

<p>names : str
    the names of the parameters to marginalize over</p>

<p>invert : bool = False
    whether to marginalize over all the parameters NOT in names (the complement)</p>

<p>ignore_errors : bool = False
    should non-existing parameters be ignored</p>

<h2 id="returns">Returns</h2>

<p>Instance of <code><a href="#FisherMatrix">FisherMatrix</a></code>.</p>

<h2 id="examples">Examples</h2>

<p>Generate a Fisher object using a random orthogonal matrix:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ortho_group</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rm</span> <span class="o">=</span> <span class="n">ortho_group</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">rm</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span> <span class="o">@</span> <span class="n">rm</span><span class="p">)</span>
</code></pre></div>

<p>Marginalize over some parameters:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">marginalize_over</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p2&#39;</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[ 1.67715591, -1.01556085,  0.30020773],</span>
<span class="go">       [-1.01556085,  4.92788976,  0.91219831],</span>
<span class="go">       [ 0.30020773,  0.91219831,  3.1796454 ]]),</span>
<span class="go">    names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p3&#39;, &#39;p4&#39;, &#39;p5&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0., 0.]))</span>
</code></pre></div>

<p>Marginalize over all parameters which are NOT <code>p1</code> or <code>p2</code>:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">marginalize_over</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;p2&#39;</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">FisherMatrix(</span>
<span class="go">    array([[ 5.04480062, -0.04490453],</span>
<span class="go">       [-0.04490453,  1.61599083]]),</span>
<span class="go">    names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
<span class="go">    latex_names=array([&#39;p1&#39;, &#39;p2&#39;], dtype=object),</span>
<span class="go">    fiducials=array([0., 0.]))</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherMatrix.from_file" class="classattr">
                                        <input id="FisherMatrix.from_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">path</span><span class="p">:</span> <span class="nb">str</span></span>)</span>

                <label class="view-source-button" for="FisherMatrix.from_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherMatrix.from_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherMatrix.from_file-1439"><a href="#FisherMatrix.from_file-1439"><span class="linenos">1439</span></a>    <span class="nd">@classmethod</span>
</span><span id="FisherMatrix.from_file-1440"><a href="#FisherMatrix.from_file-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
</span><span id="FisherMatrix.from_file-1441"><a href="#FisherMatrix.from_file-1441"><span class="linenos">1441</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="FisherMatrix.from_file-1442"><a href="#FisherMatrix.from_file-1442"><span class="linenos">1442</span></a>        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherMatrix.from_file-1443"><a href="#FisherMatrix.from_file-1443"><span class="linenos">1443</span></a>    <span class="p">):</span>
</span><span id="FisherMatrix.from_file-1444"><a href="#FisherMatrix.from_file-1444"><span class="linenos">1444</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherMatrix.from_file-1445"><a href="#FisherMatrix.from_file-1445"><span class="linenos">1445</span></a><span class="sd">        Reads a Fisher object from a file.</span>
</span><span id="FisherMatrix.from_file-1446"><a href="#FisherMatrix.from_file-1446"><span class="linenos">1446</span></a>
</span><span id="FisherMatrix.from_file-1447"><a href="#FisherMatrix.from_file-1447"><span class="linenos">1447</span></a><span class="sd">        Parameters</span>
</span><span id="FisherMatrix.from_file-1448"><a href="#FisherMatrix.from_file-1448"><span class="linenos">1448</span></a><span class="sd">        ----------</span>
</span><span id="FisherMatrix.from_file-1449"><a href="#FisherMatrix.from_file-1449"><span class="linenos">1449</span></a><span class="sd">        path : str</span>
</span><span id="FisherMatrix.from_file-1450"><a href="#FisherMatrix.from_file-1450"><span class="linenos">1450</span></a><span class="sd">            the path to the file</span>
</span><span id="FisherMatrix.from_file-1451"><a href="#FisherMatrix.from_file-1451"><span class="linenos">1451</span></a>
</span><span id="FisherMatrix.from_file-1452"><a href="#FisherMatrix.from_file-1452"><span class="linenos">1452</span></a><span class="sd">        Returns</span>
</span><span id="FisherMatrix.from_file-1453"><a href="#FisherMatrix.from_file-1453"><span class="linenos">1453</span></a><span class="sd">        -------</span>
</span><span id="FisherMatrix.from_file-1454"><a href="#FisherMatrix.from_file-1454"><span class="linenos">1454</span></a><span class="sd">        Instance of `FisherMatrix`</span>
</span><span id="FisherMatrix.from_file-1455"><a href="#FisherMatrix.from_file-1455"><span class="linenos">1455</span></a>
</span><span id="FisherMatrix.from_file-1456"><a href="#FisherMatrix.from_file-1456"><span class="linenos">1456</span></a><span class="sd">        Notes</span>
</span><span id="FisherMatrix.from_file-1457"><a href="#FisherMatrix.from_file-1457"><span class="linenos">1457</span></a><span class="sd">        -----</span>
</span><span id="FisherMatrix.from_file-1458"><a href="#FisherMatrix.from_file-1458"><span class="linenos">1458</span></a><span class="sd">        Any metadata is ignored when reading the file.</span>
</span><span id="FisherMatrix.from_file-1459"><a href="#FisherMatrix.from_file-1459"><span class="linenos">1459</span></a><span class="sd">        If you want to read the metadata as well, use something like the following:</span>
</span><span id="FisherMatrix.from_file-1460"><a href="#FisherMatrix.from_file-1460"><span class="linenos">1460</span></a>
</span><span id="FisherMatrix.from_file-1461"><a href="#FisherMatrix.from_file-1461"><span class="linenos">1461</span></a><span class="sd">        &gt;&gt;&gt; import json</span>
</span><span id="FisherMatrix.from_file-1462"><a href="#FisherMatrix.from_file-1462"><span class="linenos">1462</span></a><span class="sd">        &gt;&gt;&gt; with open(&lt;filename&gt;, &#39;r&#39;) as f: # doctest: +SKIP</span>
</span><span id="FisherMatrix.from_file-1463"><a href="#FisherMatrix.from_file-1463"><span class="linenos">1463</span></a><span class="sd">        ...     data = json.loads(f.read()) # doctest: +SKIP</span>
</span><span id="FisherMatrix.from_file-1464"><a href="#FisherMatrix.from_file-1464"><span class="linenos">1464</span></a>
</span><span id="FisherMatrix.from_file-1465"><a href="#FisherMatrix.from_file-1465"><span class="linenos">1465</span></a><span class="sd">        Then `data` will contain a dictionary with all of the data from the</span>
</span><span id="FisherMatrix.from_file-1466"><a href="#FisherMatrix.from_file-1466"><span class="linenos">1466</span></a><span class="sd">        file, which can be easily parsed.</span>
</span><span id="FisherMatrix.from_file-1467"><a href="#FisherMatrix.from_file-1467"><span class="linenos">1467</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherMatrix.from_file-1468"><a href="#FisherMatrix.from_file-1468"><span class="linenos">1468</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
</span><span id="FisherMatrix.from_file-1469"><a href="#FisherMatrix.from_file-1469"><span class="linenos">1469</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file_handle</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="FisherMatrix.from_file-1470"><a href="#FisherMatrix.from_file-1470"><span class="linenos">1470</span></a>
</span><span id="FisherMatrix.from_file-1471"><a href="#FisherMatrix.from_file-1471"><span class="linenos">1471</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="FisherMatrix.from_file-1472"><a href="#FisherMatrix.from_file-1472"><span class="linenos">1472</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix.from_file-1473"><a href="#FisherMatrix.from_file-1473"><span class="linenos">1473</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;names&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix.from_file-1474"><a href="#FisherMatrix.from_file-1474"><span class="linenos">1474</span></a>            <span class="n">latex_names</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;latex_names&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix.from_file-1475"><a href="#FisherMatrix.from_file-1475"><span class="linenos">1475</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fiducials&quot;</span><span class="p">],</span>
</span><span id="FisherMatrix.from_file-1476"><a href="#FisherMatrix.from_file-1476"><span class="linenos">1476</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Reads a Fisher object from a file.</p>

<h2 id="parameters">Parameters</h2>

<p>path : str
    the path to the file</p>

<h2 id="returns">Returns</h2>

<p>Instance of <code><a href="#FisherMatrix">FisherMatrix</a></code></p>

<h2 id="notes">Notes</h2>

<p>Any metadata is ignored when reading the file.
If you want to read the metadata as well, use something like the following:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="c1"># doctest: +SKIP</span>
<span class="gp">... </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span> <span class="c1"># doctest: +SKIP</span>
</code></pre></div>

<p>Then <code>data</code> will contain a dictionary with all of the data from the
file, which can be easily parsed.</p>
</div>


                            </div>
                </section>
                <section id="FisherFigure1D">
                            <input id="FisherFigure1D-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FisherFigure1D</span><wbr>(<span class="base">fitk.fisher_plotter.FisherBaseFigure</span>):

                <label class="view-source-button" for="FisherFigure1D-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherFigure1D"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherFigure1D-174"><a href="#FisherFigure1D-174"><span class="linenos">174</span></a><span class="k">class</span> <span class="nc">FisherFigure1D</span><span class="p">(</span><span class="n">FisherBaseFigure</span><span class="p">):</span>
</span><span id="FisherFigure1D-175"><a href="#FisherFigure1D-175"><span class="linenos">175</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherFigure1D-176"><a href="#FisherFigure1D-176"><span class="linenos">176</span></a><span class="sd">    Container for easy access to elements in the 1D plot.</span>
</span><span id="FisherFigure1D-177"><a href="#FisherFigure1D-177"><span class="linenos">177</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FisherFigure1D-178"><a href="#FisherFigure1D-178"><span class="linenos">178</span></a>
</span><span id="FisherFigure1D-179"><a href="#FisherFigure1D-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span>
</span><span id="FisherFigure1D-180"><a href="#FisherFigure1D-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherFigure1D-181"><a href="#FisherFigure1D-181"><span class="linenos">181</span></a>        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FisherFigure1D-182"><a href="#FisherFigure1D-182"><span class="linenos">182</span></a>    <span class="p">):</span>
</span><span id="FisherFigure1D-183"><a href="#FisherFigure1D-183"><span class="linenos">183</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherFigure1D-184"><a href="#FisherFigure1D-184"><span class="linenos">184</span></a><span class="sd">        Returns the axis associated to the name `key`.</span>
</span><span id="FisherFigure1D-185"><a href="#FisherFigure1D-185"><span class="linenos">185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherFigure1D-186"><a href="#FisherFigure1D-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherFigure1D-187"><a href="#FisherFigure1D-187"><span class="linenos">187</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherFigure1D-188"><a href="#FisherFigure1D-188"><span class="linenos">188</span></a>
</span><span id="FisherFigure1D-189"><a href="#FisherFigure1D-189"><span class="linenos">189</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">key</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Container for easy access to elements in the 1D plot.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>fitk.fisher_plotter.FisherBaseFigure</dt>
                                <dd id="FisherFigure1D.__init__" class="function">FisherBaseFigure</dd>
                <dd id="FisherFigure1D.figure" class="variable">figure</dd>
                <dd id="FisherFigure1D.axes" class="variable">axes</dd>
                <dd id="FisherFigure1D.names" class="variable">names</dd>
                <dd id="FisherFigure1D.savefig" class="function">savefig</dd>
                <dd id="FisherFigure1D.set_label_params" class="function">set_label_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="FisherFigure2D">
                            <input id="FisherFigure2D-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FisherFigure2D</span><wbr>(<span class="base">fitk.fisher_plotter.FisherBaseFigure</span>):

                <label class="view-source-button" for="FisherFigure2D-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherFigure2D"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherFigure2D-192"><a href="#FisherFigure2D-192"><span class="linenos">192</span></a><span class="k">class</span> <span class="nc">FisherFigure2D</span><span class="p">(</span><span class="n">FisherBaseFigure</span><span class="p">):</span>
</span><span id="FisherFigure2D-193"><a href="#FisherFigure2D-193"><span class="linenos">193</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherFigure2D-194"><a href="#FisherFigure2D-194"><span class="linenos">194</span></a><span class="sd">    Container for easy access to elements in the 2D plot.</span>
</span><span id="FisherFigure2D-195"><a href="#FisherFigure2D-195"><span class="linenos">195</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FisherFigure2D-196"><a href="#FisherFigure2D-196"><span class="linenos">196</span></a>
</span><span id="FisherFigure2D-197"><a href="#FisherFigure2D-197"><span class="linenos">197</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span>
</span><span id="FisherFigure2D-198"><a href="#FisherFigure2D-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherFigure2D-199"><a href="#FisherFigure2D-199"><span class="linenos">199</span></a>        <span class="n">key</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
</span><span id="FisherFigure2D-200"><a href="#FisherFigure2D-200"><span class="linenos">200</span></a>    <span class="p">):</span>
</span><span id="FisherFigure2D-201"><a href="#FisherFigure2D-201"><span class="linenos">201</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="FisherFigure2D-202"><a href="#FisherFigure2D-202"><span class="linenos">202</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="FisherFigure2D-203"><a href="#FisherFigure2D-203"><span class="linenos">203</span></a>                <span class="sa">f</span><span class="s2">&quot;Incompatible type for element access: expected `tuple`, got `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">`&quot;</span>
</span><span id="FisherFigure2D-204"><a href="#FisherFigure2D-204"><span class="linenos">204</span></a>            <span class="p">)</span>
</span><span id="FisherFigure2D-205"><a href="#FisherFigure2D-205"><span class="linenos">205</span></a>
</span><span id="FisherFigure2D-206"><a href="#FisherFigure2D-206"><span class="linenos">206</span></a>        <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="FisherFigure2D-207"><a href="#FisherFigure2D-207"><span class="linenos">207</span></a>
</span><span id="FisherFigure2D-208"><a href="#FisherFigure2D-208"><span class="linenos">208</span></a>        <span class="k">if</span> <span class="n">name1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherFigure2D-209"><a href="#FisherFigure2D-209"><span class="linenos">209</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherFigure2D-210"><a href="#FisherFigure2D-210"><span class="linenos">210</span></a>        <span class="k">if</span> <span class="n">name2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
</span><span id="FisherFigure2D-211"><a href="#FisherFigure2D-211"><span class="linenos">211</span></a>            <span class="k">raise</span> <span class="n">ParameterNotFoundError</span><span class="p">(</span><span class="n">name2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="FisherFigure2D-212"><a href="#FisherFigure2D-212"><span class="linenos">212</span></a>
</span><span id="FisherFigure2D-213"><a href="#FisherFigure2D-213"><span class="linenos">213</span></a>        <span class="n">index1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name1</span><span class="p">)</span>
</span><span id="FisherFigure2D-214"><a href="#FisherFigure2D-214"><span class="linenos">214</span></a>        <span class="n">index2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name2</span><span class="p">)</span>
</span><span id="FisherFigure2D-215"><a href="#FisherFigure2D-215"><span class="linenos">215</span></a>
</span><span id="FisherFigure2D-216"><a href="#FisherFigure2D-216"><span class="linenos">216</span></a>        <span class="k">if</span> <span class="n">index1</span> <span class="o">&lt;</span> <span class="n">index2</span><span class="p">:</span>
</span><span id="FisherFigure2D-217"><a href="#FisherFigure2D-217"><span class="linenos">217</span></a>            <span class="n">index1</span><span class="p">,</span> <span class="n">index2</span> <span class="o">=</span> <span class="n">index2</span><span class="p">,</span> <span class="n">index1</span>
</span><span id="FisherFigure2D-218"><a href="#FisherFigure2D-218"><span class="linenos">218</span></a>
</span><span id="FisherFigure2D-219"><a href="#FisherFigure2D-219"><span class="linenos">219</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Container for easy access to elements in the 2D plot.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>fitk.fisher_plotter.FisherBaseFigure</dt>
                                <dd id="FisherFigure2D.__init__" class="function">FisherBaseFigure</dd>
                <dd id="FisherFigure2D.figure" class="variable">figure</dd>
                <dd id="FisherFigure2D.axes" class="variable">axes</dd>
                <dd id="FisherFigure2D.names" class="variable">names</dd>
                <dd id="FisherFigure2D.savefig" class="function">savefig</dd>
                <dd id="FisherFigure2D.set_label_params" class="function">set_label_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="FisherPlotter">
                            <input id="FisherPlotter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FisherPlotter</span>:

                <label class="view-source-button" for="FisherPlotter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherPlotter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherPlotter-222"><a href="#FisherPlotter-222"><span class="linenos">222</span></a><span class="k">class</span> <span class="nc">FisherPlotter</span><span class="p">:</span>
</span><span id="FisherPlotter-223"><a href="#FisherPlotter-223"><span class="linenos">223</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherPlotter-224"><a href="#FisherPlotter-224"><span class="linenos">224</span></a><span class="sd">    Class for plotting FisherMatrix objects.</span>
</span><span id="FisherPlotter-225"><a href="#FisherPlotter-225"><span class="linenos">225</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FisherPlotter-226"><a href="#FisherPlotter-226"><span class="linenos">226</span></a>
</span><span id="FisherPlotter-227"><a href="#FisherPlotter-227"><span class="linenos">227</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FisherPlotter-228"><a href="#FisherPlotter-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherPlotter-229"><a href="#FisherPlotter-229"><span class="linenos">229</span></a>        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherPlotter-230"><a href="#FisherPlotter-230"><span class="linenos">230</span></a>        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter-231"><a href="#FisherPlotter-231"><span class="linenos">231</span></a>        <span class="n">ylabel1d</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$p (\theta)$&quot;</span><span class="p">,</span>
</span><span id="FisherPlotter-232"><a href="#FisherPlotter-232"><span class="linenos">232</span></a>    <span class="p">):</span>
</span><span id="FisherPlotter-233"><a href="#FisherPlotter-233"><span class="linenos">233</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherPlotter-234"><a href="#FisherPlotter-234"><span class="linenos">234</span></a><span class="sd">        Constructor.</span>
</span><span id="FisherPlotter-235"><a href="#FisherPlotter-235"><span class="linenos">235</span></a>
</span><span id="FisherPlotter-236"><a href="#FisherPlotter-236"><span class="linenos">236</span></a><span class="sd">        Parameters</span>
</span><span id="FisherPlotter-237"><a href="#FisherPlotter-237"><span class="linenos">237</span></a><span class="sd">        ----------</span>
</span><span id="FisherPlotter-238"><a href="#FisherPlotter-238"><span class="linenos">238</span></a><span class="sd">        args : FisherMatrix</span>
</span><span id="FisherPlotter-239"><a href="#FisherPlotter-239"><span class="linenos">239</span></a><span class="sd">            `FisherMatrix` objects which we want to plot.</span>
</span><span id="FisherPlotter-240"><a href="#FisherPlotter-240"><span class="linenos">240</span></a><span class="sd">            Can have different fiducial values.</span>
</span><span id="FisherPlotter-241"><a href="#FisherPlotter-241"><span class="linenos">241</span></a><span class="sd">            The order of plotting of the parameters and the LaTeX labels to use</span>
</span><span id="FisherPlotter-242"><a href="#FisherPlotter-242"><span class="linenos">242</span></a><span class="sd">            are determined by the first argument.</span>
</span><span id="FisherPlotter-243"><a href="#FisherPlotter-243"><span class="linenos">243</span></a>
</span><span id="FisherPlotter-244"><a href="#FisherPlotter-244"><span class="linenos">244</span></a><span class="sd">        labels : Optional[Collection[str]] = None</span>
</span><span id="FisherPlotter-245"><a href="#FisherPlotter-245"><span class="linenos">245</span></a><span class="sd">            the list of labels to put in the legend of the plots.</span>
</span><span id="FisherPlotter-246"><a href="#FisherPlotter-246"><span class="linenos">246</span></a><span class="sd">            If not set, defaults to `0, ..., len(args) - 1`</span>
</span><span id="FisherPlotter-247"><a href="#FisherPlotter-247"><span class="linenos">247</span></a>
</span><span id="FisherPlotter-248"><a href="#FisherPlotter-248"><span class="linenos">248</span></a><span class="sd">        Raises</span>
</span><span id="FisherPlotter-249"><a href="#FisherPlotter-249"><span class="linenos">249</span></a><span class="sd">        ------</span>
</span><span id="FisherPlotter-250"><a href="#FisherPlotter-250"><span class="linenos">250</span></a><span class="sd">        * `MismatchingSizeError` if the sizes of the inputs are not equal</span>
</span><span id="FisherPlotter-251"><a href="#FisherPlotter-251"><span class="linenos">251</span></a><span class="sd">        * `ValueError` if the names of the inputs do not match</span>
</span><span id="FisherPlotter-252"><a href="#FisherPlotter-252"><span class="linenos">252</span></a>
</span><span id="FisherPlotter-253"><a href="#FisherPlotter-253"><span class="linenos">253</span></a><span class="sd">        Examples</span>
</span><span id="FisherPlotter-254"><a href="#FisherPlotter-254"><span class="linenos">254</span></a><span class="sd">        --------</span>
</span><span id="FisherPlotter-255"><a href="#FisherPlotter-255"><span class="linenos">255</span></a><span class="sd">        Create a Fisher plotter with two objects:</span>
</span><span id="FisherPlotter-256"><a href="#FisherPlotter-256"><span class="linenos">256</span></a><span class="sd">        &gt;&gt;&gt; fm1 = FisherMatrix(np.diag([1, 2, 3]), names=list(&#39;abc&#39;))</span>
</span><span id="FisherPlotter-257"><a href="#FisherPlotter-257"><span class="linenos">257</span></a><span class="sd">        &gt;&gt;&gt; fm2 = FisherMatrix(np.diag([4, 5, 6]), names=list(&#39;abc&#39;))</span>
</span><span id="FisherPlotter-258"><a href="#FisherPlotter-258"><span class="linenos">258</span></a><span class="sd">        &gt;&gt;&gt; fp = FisherPlotter(fm1, fm2, labels=[&#39;first&#39;, &#39;second&#39;])</span>
</span><span id="FisherPlotter-259"><a href="#FisherPlotter-259"><span class="linenos">259</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherPlotter-260"><a href="#FisherPlotter-260"><span class="linenos">260</span></a>        <span class="c1"># make sure all of the Fisher objects have the same sizes</span>
</span><span id="FisherPlotter-261"><a href="#FisherPlotter-261"><span class="linenos">261</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">):</span>
</span><span id="FisherPlotter-262"><a href="#FisherPlotter-262"><span class="linenos">262</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="FisherPlotter-263"><a href="#FisherPlotter-263"><span class="linenos">263</span></a>
</span><span id="FisherPlotter-264"><a href="#FisherPlotter-264"><span class="linenos">264</span></a>        <span class="c1"># check names</span>
</span><span id="FisherPlotter-265"><a href="#FisherPlotter-265"><span class="linenos">265</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">):</span>
</span><span id="FisherPlotter-266"><a href="#FisherPlotter-266"><span class="linenos">266</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The names of the inputs do not match&quot;</span><span class="p">)</span>
</span><span id="FisherPlotter-267"><a href="#FisherPlotter-267"><span class="linenos">267</span></a>
</span><span id="FisherPlotter-268"><a href="#FisherPlotter-268"><span class="linenos">268</span></a>        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherPlotter-269"><a href="#FisherPlotter-269"><span class="linenos">269</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span id="FisherPlotter-270"><a href="#FisherPlotter-270"><span class="linenos">270</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</span><span id="FisherPlotter-271"><a href="#FisherPlotter-271"><span class="linenos">271</span></a>        <span class="c1"># default labels are 0, ..., n - 1</span>
</span><span id="FisherPlotter-272"><a href="#FisherPlotter-272"><span class="linenos">272</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherPlotter-273"><a href="#FisherPlotter-273"><span class="linenos">273</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">))))</span>
</span><span id="FisherPlotter-274"><a href="#FisherPlotter-274"><span class="linenos">274</span></a>
</span><span id="FisherPlotter-275"><a href="#FisherPlotter-275"><span class="linenos">275</span></a>        <span class="c1"># in case the names are shuffled, we sort them according to the FIRST</span>
</span><span id="FisherPlotter-276"><a href="#FisherPlotter-276"><span class="linenos">276</span></a>        <span class="c1"># input</span>
</span><span id="FisherPlotter-277"><a href="#FisherPlotter-277"><span class="linenos">277</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="FisherPlotter-278"><a href="#FisherPlotter-278"><span class="linenos">278</span></a>            <span class="p">[</span><span class="n">get_index_of_other_array</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">arg</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>
</span><span id="FisherPlotter-279"><a href="#FisherPlotter-279"><span class="linenos">279</span></a>            <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">,</span>
</span><span id="FisherPlotter-280"><a href="#FisherPlotter-280"><span class="linenos">280</span></a>        <span class="p">)</span>
</span><span id="FisherPlotter-281"><a href="#FisherPlotter-281"><span class="linenos">281</span></a>
</span><span id="FisherPlotter-282"><a href="#FisherPlotter-282"><span class="linenos">282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">args</span><span class="p">)]</span>
</span><span id="FisherPlotter-283"><a href="#FisherPlotter-283"><span class="linenos">283</span></a>
</span><span id="FisherPlotter-284"><a href="#FisherPlotter-284"><span class="linenos">284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherPlotter-285"><a href="#FisherPlotter-285"><span class="linenos">285</span></a>
</span><span id="FisherPlotter-286"><a href="#FisherPlotter-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ylabel1d</span> <span class="o">=</span> <span class="n">ylabel1d</span>
</span><span id="FisherPlotter-287"><a href="#FisherPlotter-287"><span class="linenos">287</span></a>
</span><span id="FisherPlotter-288"><a href="#FisherPlotter-288"><span class="linenos">288</span></a>    <span class="nd">@property</span>
</span><span id="FisherPlotter-289"><a href="#FisherPlotter-289"><span class="linenos">289</span></a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherPlotter-290"><a href="#FisherPlotter-290"><span class="linenos">290</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherPlotter-291"><a href="#FisherPlotter-291"><span class="linenos">291</span></a><span class="sd">        Returns the input array of Fisher objects.</span>
</span><span id="FisherPlotter-292"><a href="#FisherPlotter-292"><span class="linenos">292</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherPlotter-293"><a href="#FisherPlotter-293"><span class="linenos">293</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
</span><span id="FisherPlotter-294"><a href="#FisherPlotter-294"><span class="linenos">294</span></a>
</span><span id="FisherPlotter-295"><a href="#FisherPlotter-295"><span class="linenos">295</span></a>    <span class="nd">@property</span>
</span><span id="FisherPlotter-296"><a href="#FisherPlotter-296"><span class="linenos">296</span></a>    <span class="k">def</span> <span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherPlotter-297"><a href="#FisherPlotter-297"><span class="linenos">297</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherPlotter-298"><a href="#FisherPlotter-298"><span class="linenos">298</span></a><span class="sd">        Returns the labels of the Fisher objects.</span>
</span><span id="FisherPlotter-299"><a href="#FisherPlotter-299"><span class="linenos">299</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherPlotter-300"><a href="#FisherPlotter-300"><span class="linenos">300</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span>
</span><span id="FisherPlotter-301"><a href="#FisherPlotter-301"><span class="linenos">301</span></a>
</span><span id="FisherPlotter-302"><a href="#FisherPlotter-302"><span class="linenos">302</span></a>    <span class="nd">@property</span>
</span><span id="FisherPlotter-303"><a href="#FisherPlotter-303"><span class="linenos">303</span></a>    <span class="k">def</span> <span class="nf">ylabel1d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FisherPlotter-304"><a href="#FisherPlotter-304"><span class="linenos">304</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherPlotter-305"><a href="#FisherPlotter-305"><span class="linenos">305</span></a><span class="sd">        Returns the y-label used for labelling the 1D curves.</span>
</span><span id="FisherPlotter-306"><a href="#FisherPlotter-306"><span class="linenos">306</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherPlotter-307"><a href="#FisherPlotter-307"><span class="linenos">307</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ylabel1d</span>
</span><span id="FisherPlotter-308"><a href="#FisherPlotter-308"><span class="linenos">308</span></a>
</span><span id="FisherPlotter-309"><a href="#FisherPlotter-309"><span class="linenos">309</span></a>    <span class="nd">@ylabel1d</span><span class="o">.</span><span class="n">setter</span>
</span><span id="FisherPlotter-310"><a href="#FisherPlotter-310"><span class="linenos">310</span></a>    <span class="k">def</span> <span class="nf">ylabel1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="FisherPlotter-311"><a href="#FisherPlotter-311"><span class="linenos">311</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FisherPlotter-312"><a href="#FisherPlotter-312"><span class="linenos">312</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected `str` for `ylabel1d`, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FisherPlotter-313"><a href="#FisherPlotter-313"><span class="linenos">313</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ylabel1d</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="FisherPlotter-314"><a href="#FisherPlotter-314"><span class="linenos">314</span></a>
</span><span id="FisherPlotter-315"><a href="#FisherPlotter-315"><span class="linenos">315</span></a>    <span class="k">def</span> <span class="nf">plot_1d</span><span class="p">(</span>
</span><span id="FisherPlotter-316"><a href="#FisherPlotter-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherPlotter-317"><a href="#FisherPlotter-317"><span class="linenos">317</span></a>        <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="FisherPlotter-318"><a href="#FisherPlotter-318"><span class="linenos">318</span></a>        <span class="n">max_cols</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter-319"><a href="#FisherPlotter-319"><span class="linenos">319</span></a>        <span class="n">mpl_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter-320"><a href="#FisherPlotter-320"><span class="linenos">320</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherPlotter-321"><a href="#FisherPlotter-321"><span class="linenos">321</span></a>    <span class="p">):</span>
</span><span id="FisherPlotter-322"><a href="#FisherPlotter-322"><span class="linenos">322</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherPlotter-323"><a href="#FisherPlotter-323"><span class="linenos">323</span></a><span class="sd">        Makes a 1D plot (Gaussians) of the Fisher objects</span>
</span><span id="FisherPlotter-324"><a href="#FisherPlotter-324"><span class="linenos">324</span></a>
</span><span id="FisherPlotter-325"><a href="#FisherPlotter-325"><span class="linenos">325</span></a><span class="sd">        Parameters</span>
</span><span id="FisherPlotter-326"><a href="#FisherPlotter-326"><span class="linenos">326</span></a><span class="sd">        ----------</span>
</span><span id="FisherPlotter-327"><a href="#FisherPlotter-327"><span class="linenos">327</span></a><span class="sd">        max_cols : Optional[int] = None</span>
</span><span id="FisherPlotter-328"><a href="#FisherPlotter-328"><span class="linenos">328</span></a><span class="sd">            the maximum number of columns to force the plot into.</span>
</span><span id="FisherPlotter-329"><a href="#FisherPlotter-329"><span class="linenos">329</span></a><span class="sd">            By default, the parameters are always plotted horizontally; if you</span>
</span><span id="FisherPlotter-330"><a href="#FisherPlotter-330"><span class="linenos">330</span></a><span class="sd">            need to spread it over `max_cols`, pass a non-negative integer</span>
</span><span id="FisherPlotter-331"><a href="#FisherPlotter-331"><span class="linenos">331</span></a><span class="sd">            here.</span>
</span><span id="FisherPlotter-332"><a href="#FisherPlotter-332"><span class="linenos">332</span></a>
</span><span id="FisherPlotter-333"><a href="#FisherPlotter-333"><span class="linenos">333</span></a><span class="sd">        mpl_options : Optional[dict] = None</span>
</span><span id="FisherPlotter-334"><a href="#FisherPlotter-334"><span class="linenos">334</span></a><span class="sd">            any parameters meant for `matplotlib.rcParams`. By default, only</span>
</span><span id="FisherPlotter-335"><a href="#FisherPlotter-335"><span class="linenos">335</span></a><span class="sd">            sets default font to cm serif.</span>
</span><span id="FisherPlotter-336"><a href="#FisherPlotter-336"><span class="linenos">336</span></a><span class="sd">            See [Matplotlib documentation](https://matplotlib.org/stable/tutorials/introductory/customizing.html)</span>
</span><span id="FisherPlotter-337"><a href="#FisherPlotter-337"><span class="linenos">337</span></a><span class="sd">            for more information.</span>
</span><span id="FisherPlotter-338"><a href="#FisherPlotter-338"><span class="linenos">338</span></a>
</span><span id="FisherPlotter-339"><a href="#FisherPlotter-339"><span class="linenos">339</span></a><span class="sd">        Returns</span>
</span><span id="FisherPlotter-340"><a href="#FisherPlotter-340"><span class="linenos">340</span></a><span class="sd">        -------</span>
</span><span id="FisherPlotter-341"><a href="#FisherPlotter-341"><span class="linenos">341</span></a><span class="sd">        An instance of `FisherFigure1D`.</span>
</span><span id="FisherPlotter-342"><a href="#FisherPlotter-342"><span class="linenos">342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherPlotter-343"><a href="#FisherPlotter-343"><span class="linenos">343</span></a>        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="FisherPlotter-344"><a href="#FisherPlotter-344"><span class="linenos">344</span></a>
</span><span id="FisherPlotter-345"><a href="#FisherPlotter-345"><span class="linenos">345</span></a>        <span class="k">if</span> <span class="n">max_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">max_cols</span> <span class="o">&lt;=</span> <span class="n">size</span><span class="p">:</span>
</span><span id="FisherPlotter-346"><a href="#FisherPlotter-346"><span class="linenos">346</span></a>            <span class="n">full</span> <span class="o">=</span> <span class="n">size</span> <span class="o">%</span> <span class="n">max_cols</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="FisherPlotter-347"><a href="#FisherPlotter-347"><span class="linenos">347</span></a>            <span class="n">layout</span> <span class="o">=</span> <span class="n">size</span> <span class="o">//</span> <span class="n">max_cols</span> <span class="k">if</span> <span class="n">full</span> <span class="k">else</span> <span class="n">size</span> <span class="o">//</span> <span class="n">max_cols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_cols</span>
</span><span id="FisherPlotter-348"><a href="#FisherPlotter-348"><span class="linenos">348</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherPlotter-349"><a href="#FisherPlotter-349"><span class="linenos">349</span></a>            <span class="n">layout</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span>
</span><span id="FisherPlotter-350"><a href="#FisherPlotter-350"><span class="linenos">350</span></a>            <span class="n">full</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="FisherPlotter-351"><a href="#FisherPlotter-351"><span class="linenos">351</span></a>
</span><span id="FisherPlotter-352"><a href="#FisherPlotter-352"><span class="linenos">352</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">mpl_options</span><span class="p">:</span>
</span><span id="FisherPlotter-353"><a href="#FisherPlotter-353"><span class="linenos">353</span></a>            <span class="n">mpl_options</span> <span class="o">=</span> <span class="n">get_default_rcparams</span><span class="p">()</span>
</span><span id="FisherPlotter-354"><a href="#FisherPlotter-354"><span class="linenos">354</span></a>
</span><span id="FisherPlotter-355"><a href="#FisherPlotter-355"><span class="linenos">355</span></a>        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="n">mpl_options</span><span class="p">):</span>
</span><span id="FisherPlotter-356"><a href="#FisherPlotter-356"><span class="linenos">356</span></a>            <span class="c1"># general figure setup</span>
</span><span id="FisherPlotter-357"><a href="#FisherPlotter-357"><span class="linenos">357</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
</span><span id="FisherPlotter-358"><a href="#FisherPlotter-358"><span class="linenos">358</span></a>                <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="FisherPlotter-359"><a href="#FisherPlotter-359"><span class="linenos">359</span></a>                <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">scale</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="FisherPlotter-360"><a href="#FisherPlotter-360"><span class="linenos">360</span></a>            <span class="p">)</span>
</span><span id="FisherPlotter-361"><a href="#FisherPlotter-361"><span class="linenos">361</span></a>            <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span>
</span><span id="FisherPlotter-362"><a href="#FisherPlotter-362"><span class="linenos">362</span></a>                <span class="n">nrows</span><span class="o">=</span><span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="FisherPlotter-363"><a href="#FisherPlotter-363"><span class="linenos">363</span></a>                <span class="n">ncols</span><span class="o">=</span><span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="FisherPlotter-364"><a href="#FisherPlotter-364"><span class="linenos">364</span></a>                <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="FisherPlotter-365"><a href="#FisherPlotter-365"><span class="linenos">365</span></a>                <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="FisherPlotter-366"><a href="#FisherPlotter-366"><span class="linenos">366</span></a>            <span class="p">)</span>
</span><span id="FisherPlotter-367"><a href="#FisherPlotter-367"><span class="linenos">367</span></a>            <span class="n">axes</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="FisherPlotter-368"><a href="#FisherPlotter-368"><span class="linenos">368</span></a>            <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FisherPlotter-369"><a href="#FisherPlotter-369"><span class="linenos">369</span></a>                <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">axes</span><span class="p">])</span>
</span><span id="FisherPlotter-370"><a href="#FisherPlotter-370"><span class="linenos">370</span></a>
</span><span id="FisherPlotter-371"><a href="#FisherPlotter-371"><span class="linenos">371</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherPlotter-372"><a href="#FisherPlotter-372"><span class="linenos">372</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">latex_names</span>
</span><span id="FisherPlotter-373"><a href="#FisherPlotter-373"><span class="linenos">373</span></a>
</span><span id="FisherPlotter-374"><a href="#FisherPlotter-374"><span class="linenos">374</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="n">latex_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">latex_names</span><span class="p">):</span>
</span><span id="FisherPlotter-375"><a href="#FisherPlotter-375"><span class="linenos">375</span></a>                <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherPlotter-376"><a href="#FisherPlotter-376"><span class="linenos">376</span></a>
</span><span id="FisherPlotter-377"><a href="#FisherPlotter-377"><span class="linenos">377</span></a>                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">fm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">get_default_cycler</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
</span><span id="FisherPlotter-378"><a href="#FisherPlotter-378"><span class="linenos">378</span></a>                    <span class="n">plot_curve_1d</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</span><span id="FisherPlotter-379"><a href="#FisherPlotter-379"><span class="linenos">379</span></a>
</span><span id="FisherPlotter-380"><a href="#FisherPlotter-380"><span class="linenos">380</span></a>                    <span class="n">add_shading_1d</span><span class="p">(</span>
</span><span id="FisherPlotter-381"><a href="#FisherPlotter-381"><span class="linenos">381</span></a>                        <span class="n">fm</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)],</span>
</span><span id="FisherPlotter-382"><a href="#FisherPlotter-382"><span class="linenos">382</span></a>                        <span class="n">fm</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="FisherPlotter-383"><a href="#FisherPlotter-383"><span class="linenos">383</span></a>                        <span class="n">ax</span><span class="p">,</span>
</span><span id="FisherPlotter-384"><a href="#FisherPlotter-384"><span class="linenos">384</span></a>                        <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter-385"><a href="#FisherPlotter-385"><span class="linenos">385</span></a>                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
</span><span id="FisherPlotter-386"><a href="#FisherPlotter-386"><span class="linenos">386</span></a>                        <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter-387"><a href="#FisherPlotter-387"><span class="linenos">387</span></a>                    <span class="p">)</span>
</span><span id="FisherPlotter-388"><a href="#FisherPlotter-388"><span class="linenos">388</span></a>
</span><span id="FisherPlotter-389"><a href="#FisherPlotter-389"><span class="linenos">389</span></a>                    <span class="n">add_shading_1d</span><span class="p">(</span>
</span><span id="FisherPlotter-390"><a href="#FisherPlotter-390"><span class="linenos">390</span></a>                        <span class="n">fm</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)],</span>
</span><span id="FisherPlotter-391"><a href="#FisherPlotter-391"><span class="linenos">391</span></a>                        <span class="n">fm</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="FisherPlotter-392"><a href="#FisherPlotter-392"><span class="linenos">392</span></a>                        <span class="n">ax</span><span class="p">,</span>
</span><span id="FisherPlotter-393"><a href="#FisherPlotter-393"><span class="linenos">393</span></a>                        <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="FisherPlotter-394"><a href="#FisherPlotter-394"><span class="linenos">394</span></a>                        <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter-395"><a href="#FisherPlotter-395"><span class="linenos">395</span></a>                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="FisherPlotter-396"><a href="#FisherPlotter-396"><span class="linenos">396</span></a>                        <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter-397"><a href="#FisherPlotter-397"><span class="linenos">397</span></a>                    <span class="p">)</span>
</span><span id="FisherPlotter-398"><a href="#FisherPlotter-398"><span class="linenos">398</span></a>
</span><span id="FisherPlotter-399"><a href="#FisherPlotter-399"><span class="linenos">399</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">latex_name</span><span class="p">)</span>
</span><span id="FisherPlotter-400"><a href="#FisherPlotter-400"><span class="linenos">400</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">relim</span><span class="p">()</span>
</span><span id="FisherPlotter-401"><a href="#FisherPlotter-401"><span class="linenos">401</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">()</span>
</span><span id="FisherPlotter-402"><a href="#FisherPlotter-402"><span class="linenos">402</span></a>
</span><span id="FisherPlotter-403"><a href="#FisherPlotter-403"><span class="linenos">403</span></a>                <span class="c1"># the y axis should start at 0 since we&#39;re plotting a PDF</span>
</span><span id="FisherPlotter-404"><a href="#FisherPlotter-404"><span class="linenos">404</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FisherPlotter-405"><a href="#FisherPlotter-405"><span class="linenos">405</span></a>
</span><span id="FisherPlotter-406"><a href="#FisherPlotter-406"><span class="linenos">406</span></a>                <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FisherPlotter-407"><a href="#FisherPlotter-407"><span class="linenos">407</span></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylabel1d</span><span class="p">)</span>
</span><span id="FisherPlotter-408"><a href="#FisherPlotter-408"><span class="linenos">408</span></a>
</span><span id="FisherPlotter-409"><a href="#FisherPlotter-409"><span class="linenos">409</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</span><span id="FisherPlotter-410"><a href="#FisherPlotter-410"><span class="linenos">410</span></a>
</span><span id="FisherPlotter-411"><a href="#FisherPlotter-411"><span class="linenos">411</span></a>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;legend&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherPlotter-412"><a href="#FisherPlotter-412"><span class="linenos">412</span></a>                <span class="c1"># remove any axes which are not drawn</span>
</span><span id="FisherPlotter-413"><a href="#FisherPlotter-413"><span class="linenos">413</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
</span><span id="FisherPlotter-414"><a href="#FisherPlotter-414"><span class="linenos">414</span></a>                    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
</span><span id="FisherPlotter-415"><a href="#FisherPlotter-415"><span class="linenos">415</span></a>                        <span class="p">(</span><span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FisherPlotter-416"><a href="#FisherPlotter-416"><span class="linenos">416</span></a>                    <span class="p">):</span>
</span><span id="FisherPlotter-417"><a href="#FisherPlotter-417"><span class="linenos">417</span></a>                        <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="FisherPlotter-418"><a href="#FisherPlotter-418"><span class="linenos">418</span></a>
</span><span id="FisherPlotter-419"><a href="#FisherPlotter-419"><span class="linenos">419</span></a>            <span class="c1"># remove any axes which are not drawn</span>
</span><span id="FisherPlotter-420"><a href="#FisherPlotter-420"><span class="linenos">420</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
</span><span id="FisherPlotter-421"><a href="#FisherPlotter-421"><span class="linenos">421</span></a>                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
</span><span id="FisherPlotter-422"><a href="#FisherPlotter-422"><span class="linenos">422</span></a>                    <span class="p">(</span><span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FisherPlotter-423"><a href="#FisherPlotter-423"><span class="linenos">423</span></a>                <span class="p">):</span>
</span><span id="FisherPlotter-424"><a href="#FisherPlotter-424"><span class="linenos">424</span></a>                    <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="FisherPlotter-425"><a href="#FisherPlotter-425"><span class="linenos">425</span></a>
</span><span id="FisherPlotter-426"><a href="#FisherPlotter-426"><span class="linenos">426</span></a>        <span class="k">return</span> <span class="n">FisherFigure1D</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</span><span id="FisherPlotter-427"><a href="#FisherPlotter-427"><span class="linenos">427</span></a>
</span><span id="FisherPlotter-428"><a href="#FisherPlotter-428"><span class="linenos">428</span></a>    <span class="k">def</span> <span class="nf">plot_triangle</span><span class="p">(</span>
</span><span id="FisherPlotter-429"><a href="#FisherPlotter-429"><span class="linenos">429</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherPlotter-430"><a href="#FisherPlotter-430"><span class="linenos">430</span></a>        <span class="n">mpl_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter-431"><a href="#FisherPlotter-431"><span class="linenos">431</span></a>        <span class="n">plot_1d_curves</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FisherPlotter-432"><a href="#FisherPlotter-432"><span class="linenos">432</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherPlotter-433"><a href="#FisherPlotter-433"><span class="linenos">433</span></a>    <span class="p">):</span>
</span><span id="FisherPlotter-434"><a href="#FisherPlotter-434"><span class="linenos">434</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherPlotter-435"><a href="#FisherPlotter-435"><span class="linenos">435</span></a><span class="sd">        Plots the 2D contours (and optionally 1D curves) of the Fisher objects.</span>
</span><span id="FisherPlotter-436"><a href="#FisherPlotter-436"><span class="linenos">436</span></a>
</span><span id="FisherPlotter-437"><a href="#FisherPlotter-437"><span class="linenos">437</span></a><span class="sd">        Parameters</span>
</span><span id="FisherPlotter-438"><a href="#FisherPlotter-438"><span class="linenos">438</span></a><span class="sd">        ----------</span>
</span><span id="FisherPlotter-439"><a href="#FisherPlotter-439"><span class="linenos">439</span></a><span class="sd">        mpl_options : Optional[dict] = None</span>
</span><span id="FisherPlotter-440"><a href="#FisherPlotter-440"><span class="linenos">440</span></a><span class="sd">            any parameters meant for `matplotlib.rcParams`. By default, only</span>
</span><span id="FisherPlotter-441"><a href="#FisherPlotter-441"><span class="linenos">441</span></a><span class="sd">            sets default font to cm serif.</span>
</span><span id="FisherPlotter-442"><a href="#FisherPlotter-442"><span class="linenos">442</span></a><span class="sd">            See [Matplotlib documentation](https://matplotlib.org/stable/tutorials/introductory/customizing.html)</span>
</span><span id="FisherPlotter-443"><a href="#FisherPlotter-443"><span class="linenos">443</span></a><span class="sd">            for more information.</span>
</span><span id="FisherPlotter-444"><a href="#FisherPlotter-444"><span class="linenos">444</span></a><span class="sd">        plot_1d_curves : bool = True</span>
</span><span id="FisherPlotter-445"><a href="#FisherPlotter-445"><span class="linenos">445</span></a><span class="sd">            whether or not the 1D (marginalized) curves should be plotted</span>
</span><span id="FisherPlotter-446"><a href="#FisherPlotter-446"><span class="linenos">446</span></a>
</span><span id="FisherPlotter-447"><a href="#FisherPlotter-447"><span class="linenos">447</span></a><span class="sd">        Returns</span>
</span><span id="FisherPlotter-448"><a href="#FisherPlotter-448"><span class="linenos">448</span></a><span class="sd">        -------</span>
</span><span id="FisherPlotter-449"><a href="#FisherPlotter-449"><span class="linenos">449</span></a><span class="sd">        An instance of `FisherFigure2D`.</span>
</span><span id="FisherPlotter-450"><a href="#FisherPlotter-450"><span class="linenos">450</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherPlotter-451"><a href="#FisherPlotter-451"><span class="linenos">451</span></a>        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="FisherPlotter-452"><a href="#FisherPlotter-452"><span class="linenos">452</span></a>
</span><span id="FisherPlotter-453"><a href="#FisherPlotter-453"><span class="linenos">453</span></a>        <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="FisherPlotter-454"><a href="#FisherPlotter-454"><span class="linenos">454</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to make a 2D plot with &lt; 2 parameters&quot;</span><span class="p">)</span>
</span><span id="FisherPlotter-455"><a href="#FisherPlotter-455"><span class="linenos">455</span></a>
</span><span id="FisherPlotter-456"><a href="#FisherPlotter-456"><span class="linenos">456</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">mpl_options</span><span class="p">:</span>
</span><span id="FisherPlotter-457"><a href="#FisherPlotter-457"><span class="linenos">457</span></a>            <span class="n">mpl_options</span> <span class="o">=</span> <span class="n">get_default_rcparams</span><span class="p">()</span>
</span><span id="FisherPlotter-458"><a href="#FisherPlotter-458"><span class="linenos">458</span></a>
</span><span id="FisherPlotter-459"><a href="#FisherPlotter-459"><span class="linenos">459</span></a>        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="n">mpl_options</span><span class="p">):</span>
</span><span id="FisherPlotter-460"><a href="#FisherPlotter-460"><span class="linenos">460</span></a>            <span class="c1"># general figure setup</span>
</span><span id="FisherPlotter-461"><a href="#FisherPlotter-461"><span class="linenos">461</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">size</span><span class="p">),</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="FisherPlotter-462"><a href="#FisherPlotter-462"><span class="linenos">462</span></a>            <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</span><span id="FisherPlotter-463"><a href="#FisherPlotter-463"><span class="linenos">463</span></a>            <span class="c1"># TODO make it work with a shared xcol</span>
</span><span id="FisherPlotter-464"><a href="#FisherPlotter-464"><span class="linenos">464</span></a>            <span class="n">ax</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sharex</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FisherPlotter-465"><a href="#FisherPlotter-465"><span class="linenos">465</span></a>
</span><span id="FisherPlotter-466"><a href="#FisherPlotter-466"><span class="linenos">466</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherPlotter-467"><a href="#FisherPlotter-467"><span class="linenos">467</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">latex_names</span>
</span><span id="FisherPlotter-468"><a href="#FisherPlotter-468"><span class="linenos">468</span></a>
</span><span id="FisherPlotter-469"><a href="#FisherPlotter-469"><span class="linenos">469</span></a>            <span class="c1"># set automatic limits</span>
</span><span id="FisherPlotter-470"><a href="#FisherPlotter-470"><span class="linenos">470</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="FisherPlotter-471"><a href="#FisherPlotter-471"><span class="linenos">471</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
</span><span id="FisherPlotter-472"><a href="#FisherPlotter-472"><span class="linenos">472</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</span><span id="FisherPlotter-473"><a href="#FisherPlotter-473"><span class="linenos">473</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="FisherPlotter-474"><a href="#FisherPlotter-474"><span class="linenos">474</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FisherPlotter-475"><a href="#FisherPlotter-475"><span class="linenos">475</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</span><span id="FisherPlotter-476"><a href="#FisherPlotter-476"><span class="linenos">476</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="FisherPlotter-477"><a href="#FisherPlotter-477"><span class="linenos">477</span></a>
</span><span id="FisherPlotter-478"><a href="#FisherPlotter-478"><span class="linenos">478</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="FisherPlotter-479"><a href="#FisherPlotter-479"><span class="linenos">479</span></a>                <span class="n">namey</span><span class="p">,</span> <span class="n">latex_namey</span><span class="p">,</span> <span class="n">namex</span><span class="p">,</span> <span class="n">latex_namex</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FisherPlotter-480"><a href="#FisherPlotter-480"><span class="linenos">480</span></a>                    <span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="FisherPlotter-481"><a href="#FisherPlotter-481"><span class="linenos">481</span></a>                    <span class="n">latex_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="FisherPlotter-482"><a href="#FisherPlotter-482"><span class="linenos">482</span></a>                    <span class="n">names</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter-483"><a href="#FisherPlotter-483"><span class="linenos">483</span></a>                    <span class="n">latex_names</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter-484"><a href="#FisherPlotter-484"><span class="linenos">484</span></a>                <span class="p">)</span>
</span><span id="FisherPlotter-485"><a href="#FisherPlotter-485"><span class="linenos">485</span></a>                <span class="c1"># labels for 2D contours (increasing y)</span>
</span><span id="FisherPlotter-486"><a href="#FisherPlotter-486"><span class="linenos">486</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FisherPlotter-487"><a href="#FisherPlotter-487"><span class="linenos">487</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">latex_namey</span><span class="p">)</span>
</span><span id="FisherPlotter-488"><a href="#FisherPlotter-488"><span class="linenos">488</span></a>
</span><span id="FisherPlotter-489"><a href="#FisherPlotter-489"><span class="linenos">489</span></a>                <span class="c1"># labels for 2D contours (increasing x)</span>
</span><span id="FisherPlotter-490"><a href="#FisherPlotter-490"><span class="linenos">490</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FisherPlotter-491"><a href="#FisherPlotter-491"><span class="linenos">491</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">latex_namex</span><span class="p">)</span>
</span><span id="FisherPlotter-492"><a href="#FisherPlotter-492"><span class="linenos">492</span></a>
</span><span id="FisherPlotter-493"><a href="#FisherPlotter-493"><span class="linenos">493</span></a>                <span class="c1"># removing any unnecessary axes from the gridspec</span>
</span><span id="FisherPlotter-494"><a href="#FisherPlotter-494"><span class="linenos">494</span></a>                <span class="c1"># TODO should they be removed, or somehow just made invisible?</span>
</span><span id="FisherPlotter-495"><a href="#FisherPlotter-495"><span class="linenos">495</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
</span><span id="FisherPlotter-496"><a href="#FisherPlotter-496"><span class="linenos">496</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="FisherPlotter-497"><a href="#FisherPlotter-497"><span class="linenos">497</span></a>                    <span class="c1"># ax[i, j].axis(&#39;off&#39;)</span>
</span><span id="FisherPlotter-498"><a href="#FisherPlotter-498"><span class="linenos">498</span></a>                <span class="c1"># plotting the 2D contours</span>
</span><span id="FisherPlotter-499"><a href="#FisherPlotter-499"><span class="linenos">499</span></a>                <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
</span><span id="FisherPlotter-500"><a href="#FisherPlotter-500"><span class="linenos">500</span></a>                    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">fm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">get_default_cycler</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
</span><span id="FisherPlotter-501"><a href="#FisherPlotter-501"><span class="linenos">501</span></a>                        <span class="c1"># plot 1-sigma 2D curves</span>
</span><span id="FisherPlotter-502"><a href="#FisherPlotter-502"><span class="linenos">502</span></a>                        <span class="c1"># NOTE this is the &quot;68% of the probability of a</span>
</span><span id="FisherPlotter-503"><a href="#FisherPlotter-503"><span class="linenos">503</span></a>                        <span class="c1"># single parameter lying within the bounds projected</span>
</span><span id="FisherPlotter-504"><a href="#FisherPlotter-504"><span class="linenos">504</span></a>                        <span class="c1"># onto a parameter axis&quot;</span>
</span><span id="FisherPlotter-505"><a href="#FisherPlotter-505"><span class="linenos">505</span></a>                        <span class="n">plot_curve_2d</span><span class="p">(</span>
</span><span id="FisherPlotter-506"><a href="#FisherPlotter-506"><span class="linenos">506</span></a>                            <span class="n">fm</span><span class="p">,</span>
</span><span id="FisherPlotter-507"><a href="#FisherPlotter-507"><span class="linenos">507</span></a>                            <span class="n">namex</span><span class="p">,</span>
</span><span id="FisherPlotter-508"><a href="#FisherPlotter-508"><span class="linenos">508</span></a>                            <span class="n">namey</span><span class="p">,</span>
</span><span id="FisherPlotter-509"><a href="#FisherPlotter-509"><span class="linenos">509</span></a>                            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter-510"><a href="#FisherPlotter-510"><span class="linenos">510</span></a>                            <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="FisherPlotter-511"><a href="#FisherPlotter-511"><span class="linenos">511</span></a>                            <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter-512"><a href="#FisherPlotter-512"><span class="linenos">512</span></a>                            <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span id="FisherPlotter-513"><a href="#FisherPlotter-513"><span class="linenos">513</span></a>                        <span class="p">)</span>
</span><span id="FisherPlotter-514"><a href="#FisherPlotter-514"><span class="linenos">514</span></a>                        <span class="c1"># same thing, but shaded</span>
</span><span id="FisherPlotter-515"><a href="#FisherPlotter-515"><span class="linenos">515</span></a>                        <span class="n">plot_curve_2d</span><span class="p">(</span>
</span><span id="FisherPlotter-516"><a href="#FisherPlotter-516"><span class="linenos">516</span></a>                            <span class="n">fm</span><span class="p">,</span>
</span><span id="FisherPlotter-517"><a href="#FisherPlotter-517"><span class="linenos">517</span></a>                            <span class="n">namex</span><span class="p">,</span>
</span><span id="FisherPlotter-518"><a href="#FisherPlotter-518"><span class="linenos">518</span></a>                            <span class="n">namey</span><span class="p">,</span>
</span><span id="FisherPlotter-519"><a href="#FisherPlotter-519"><span class="linenos">519</span></a>                            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter-520"><a href="#FisherPlotter-520"><span class="linenos">520</span></a>                            <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="FisherPlotter-521"><a href="#FisherPlotter-521"><span class="linenos">521</span></a>                            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="FisherPlotter-522"><a href="#FisherPlotter-522"><span class="linenos">522</span></a>                            <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter-523"><a href="#FisherPlotter-523"><span class="linenos">523</span></a>                            <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter-524"><a href="#FisherPlotter-524"><span class="linenos">524</span></a>                            <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span id="FisherPlotter-525"><a href="#FisherPlotter-525"><span class="linenos">525</span></a>                        <span class="p">)</span>
</span><span id="FisherPlotter-526"><a href="#FisherPlotter-526"><span class="linenos">526</span></a>
</span><span id="FisherPlotter-527"><a href="#FisherPlotter-527"><span class="linenos">527</span></a>                        <span class="c1"># the 2-sigma</span>
</span><span id="FisherPlotter-528"><a href="#FisherPlotter-528"><span class="linenos">528</span></a>                        <span class="n">plot_curve_2d</span><span class="p">(</span>
</span><span id="FisherPlotter-529"><a href="#FisherPlotter-529"><span class="linenos">529</span></a>                            <span class="n">fm</span><span class="p">,</span>
</span><span id="FisherPlotter-530"><a href="#FisherPlotter-530"><span class="linenos">530</span></a>                            <span class="n">namex</span><span class="p">,</span>
</span><span id="FisherPlotter-531"><a href="#FisherPlotter-531"><span class="linenos">531</span></a>                            <span class="n">namey</span><span class="p">,</span>
</span><span id="FisherPlotter-532"><a href="#FisherPlotter-532"><span class="linenos">532</span></a>                            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter-533"><a href="#FisherPlotter-533"><span class="linenos">533</span></a>                            <span class="n">scaling_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="FisherPlotter-534"><a href="#FisherPlotter-534"><span class="linenos">534</span></a>                            <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="FisherPlotter-535"><a href="#FisherPlotter-535"><span class="linenos">535</span></a>                            <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter-536"><a href="#FisherPlotter-536"><span class="linenos">536</span></a>                            <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span id="FisherPlotter-537"><a href="#FisherPlotter-537"><span class="linenos">537</span></a>                        <span class="p">)</span>
</span><span id="FisherPlotter-538"><a href="#FisherPlotter-538"><span class="linenos">538</span></a>                        <span class="c1"># same thing, but shaded</span>
</span><span id="FisherPlotter-539"><a href="#FisherPlotter-539"><span class="linenos">539</span></a>                        <span class="n">plot_curve_2d</span><span class="p">(</span>
</span><span id="FisherPlotter-540"><a href="#FisherPlotter-540"><span class="linenos">540</span></a>                            <span class="n">fm</span><span class="p">,</span>
</span><span id="FisherPlotter-541"><a href="#FisherPlotter-541"><span class="linenos">541</span></a>                            <span class="n">namex</span><span class="p">,</span>
</span><span id="FisherPlotter-542"><a href="#FisherPlotter-542"><span class="linenos">542</span></a>                            <span class="n">namey</span><span class="p">,</span>
</span><span id="FisherPlotter-543"><a href="#FisherPlotter-543"><span class="linenos">543</span></a>                            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter-544"><a href="#FisherPlotter-544"><span class="linenos">544</span></a>                            <span class="n">scaling_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="FisherPlotter-545"><a href="#FisherPlotter-545"><span class="linenos">545</span></a>                            <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="FisherPlotter-546"><a href="#FisherPlotter-546"><span class="linenos">546</span></a>                            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="FisherPlotter-547"><a href="#FisherPlotter-547"><span class="linenos">547</span></a>                            <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter-548"><a href="#FisherPlotter-548"><span class="linenos">548</span></a>                            <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter-549"><a href="#FisherPlotter-549"><span class="linenos">549</span></a>                            <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span id="FisherPlotter-550"><a href="#FisherPlotter-550"><span class="linenos">550</span></a>                        <span class="p">)</span>
</span><span id="FisherPlotter-551"><a href="#FisherPlotter-551"><span class="linenos">551</span></a>
</span><span id="FisherPlotter-552"><a href="#FisherPlotter-552"><span class="linenos">552</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FisherPlotter-553"><a href="#FisherPlotter-553"><span class="linenos">553</span></a>                    <span class="c1"># plotting the 1D Gaussians</span>
</span><span id="FisherPlotter-554"><a href="#FisherPlotter-554"><span class="linenos">554</span></a>                    <span class="k">if</span> <span class="n">plot_1d_curves</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherPlotter-555"><a href="#FisherPlotter-555"><span class="linenos">555</span></a>                        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">fm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">get_default_cycler</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
</span><span id="FisherPlotter-556"><a href="#FisherPlotter-556"><span class="linenos">556</span></a>                            <span class="n">plot_curve_1d</span><span class="p">(</span>
</span><span id="FisherPlotter-557"><a href="#FisherPlotter-557"><span class="linenos">557</span></a>                                <span class="n">fm</span><span class="p">,</span>
</span><span id="FisherPlotter-558"><a href="#FisherPlotter-558"><span class="linenos">558</span></a>                                <span class="n">namex</span><span class="p">,</span>
</span><span id="FisherPlotter-559"><a href="#FisherPlotter-559"><span class="linenos">559</span></a>                                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
</span><span id="FisherPlotter-560"><a href="#FisherPlotter-560"><span class="linenos">560</span></a>                                <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter-561"><a href="#FisherPlotter-561"><span class="linenos">561</span></a>                            <span class="p">)</span>
</span><span id="FisherPlotter-562"><a href="#FisherPlotter-562"><span class="linenos">562</span></a>
</span><span id="FisherPlotter-563"><a href="#FisherPlotter-563"><span class="linenos">563</span></a>                            <span class="c1"># 1 and 2 sigma shading</span>
</span><span id="FisherPlotter-564"><a href="#FisherPlotter-564"><span class="linenos">564</span></a>                            <span class="n">add_shading_1d</span><span class="p">(</span>
</span><span id="FisherPlotter-565"><a href="#FisherPlotter-565"><span class="linenos">565</span></a>                                <span class="n">fiducial</span><span class="o">=</span><span class="n">fm</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">namex</span><span class="p">)],</span>
</span><span id="FisherPlotter-566"><a href="#FisherPlotter-566"><span class="linenos">566</span></a>                                <span class="n">sigma</span><span class="o">=</span><span class="n">fm</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">namex</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="FisherPlotter-567"><a href="#FisherPlotter-567"><span class="linenos">567</span></a>                                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
</span><span id="FisherPlotter-568"><a href="#FisherPlotter-568"><span class="linenos">568</span></a>                                <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="FisherPlotter-569"><a href="#FisherPlotter-569"><span class="linenos">569</span></a>                                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="FisherPlotter-570"><a href="#FisherPlotter-570"><span class="linenos">570</span></a>                                <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter-571"><a href="#FisherPlotter-571"><span class="linenos">571</span></a>                                <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter-572"><a href="#FisherPlotter-572"><span class="linenos">572</span></a>                            <span class="p">)</span>
</span><span id="FisherPlotter-573"><a href="#FisherPlotter-573"><span class="linenos">573</span></a>                            <span class="n">add_shading_1d</span><span class="p">(</span>
</span><span id="FisherPlotter-574"><a href="#FisherPlotter-574"><span class="linenos">574</span></a>                                <span class="n">fiducial</span><span class="o">=</span><span class="n">fm</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">namex</span><span class="p">)],</span>
</span><span id="FisherPlotter-575"><a href="#FisherPlotter-575"><span class="linenos">575</span></a>                                <span class="n">sigma</span><span class="o">=</span><span class="n">fm</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">namex</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="FisherPlotter-576"><a href="#FisherPlotter-576"><span class="linenos">576</span></a>                                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
</span><span id="FisherPlotter-577"><a href="#FisherPlotter-577"><span class="linenos">577</span></a>                                <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="FisherPlotter-578"><a href="#FisherPlotter-578"><span class="linenos">578</span></a>                                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="FisherPlotter-579"><a href="#FisherPlotter-579"><span class="linenos">579</span></a>                                <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter-580"><a href="#FisherPlotter-580"><span class="linenos">580</span></a>                                <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter-581"><a href="#FisherPlotter-581"><span class="linenos">581</span></a>                            <span class="p">)</span>
</span><span id="FisherPlotter-582"><a href="#FisherPlotter-582"><span class="linenos">582</span></a>
</span><span id="FisherPlotter-583"><a href="#FisherPlotter-583"><span class="linenos">583</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="FisherPlotter-584"><a href="#FisherPlotter-584"><span class="linenos">584</span></a>                        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="FisherPlotter-585"><a href="#FisherPlotter-585"><span class="linenos">585</span></a>
</span><span id="FisherPlotter-586"><a href="#FisherPlotter-586"><span class="linenos">586</span></a>            <span class="c1"># set automatic limits</span>
</span><span id="FisherPlotter-587"><a href="#FisherPlotter-587"><span class="linenos">587</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="FisherPlotter-588"><a href="#FisherPlotter-588"><span class="linenos">588</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="FisherPlotter-589"><a href="#FisherPlotter-589"><span class="linenos">589</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">relim</span><span class="p">()</span>
</span><span id="FisherPlotter-590"><a href="#FisherPlotter-590"><span class="linenos">590</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">()</span>
</span><span id="FisherPlotter-591"><a href="#FisherPlotter-591"><span class="linenos">591</span></a>                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
</span><span id="FisherPlotter-592"><a href="#FisherPlotter-592"><span class="linenos">592</span></a>                        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FisherPlotter-593"><a href="#FisherPlotter-593"><span class="linenos">593</span></a>                        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</span><span id="FisherPlotter-594"><a href="#FisherPlotter-594"><span class="linenos">594</span></a>                        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="FisherPlotter-595"><a href="#FisherPlotter-595"><span class="linenos">595</span></a>                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="FisherPlotter-596"><a href="#FisherPlotter-596"><span class="linenos">596</span></a>                    <span class="k">pass</span>
</span><span id="FisherPlotter-597"><a href="#FisherPlotter-597"><span class="linenos">597</span></a>
</span><span id="FisherPlotter-598"><a href="#FisherPlotter-598"><span class="linenos">598</span></a>        <span class="k">return</span> <span class="n">FisherFigure2D</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class for plotting FisherMatrix objects.</p>
</div>


                            <div id="FisherPlotter.__init__" class="classattr">
                                        <input id="FisherPlotter.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">FisherPlotter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>,</span><span class="param">	<span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ylabel1d</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;$p (</span><span class="se">\\</span><span class="s1">theta)$&#39;</span></span>)</span>

                <label class="view-source-button" for="FisherPlotter.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherPlotter.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherPlotter.__init__-227"><a href="#FisherPlotter.__init__-227"><span class="linenos">227</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FisherPlotter.__init__-228"><a href="#FisherPlotter.__init__-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherPlotter.__init__-229"><a href="#FisherPlotter.__init__-229"><span class="linenos">229</span></a>        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="FisherPlotter.__init__-230"><a href="#FisherPlotter.__init__-230"><span class="linenos">230</span></a>        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter.__init__-231"><a href="#FisherPlotter.__init__-231"><span class="linenos">231</span></a>        <span class="n">ylabel1d</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$p (\theta)$&quot;</span><span class="p">,</span>
</span><span id="FisherPlotter.__init__-232"><a href="#FisherPlotter.__init__-232"><span class="linenos">232</span></a>    <span class="p">):</span>
</span><span id="FisherPlotter.__init__-233"><a href="#FisherPlotter.__init__-233"><span class="linenos">233</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherPlotter.__init__-234"><a href="#FisherPlotter.__init__-234"><span class="linenos">234</span></a><span class="sd">        Constructor.</span>
</span><span id="FisherPlotter.__init__-235"><a href="#FisherPlotter.__init__-235"><span class="linenos">235</span></a>
</span><span id="FisherPlotter.__init__-236"><a href="#FisherPlotter.__init__-236"><span class="linenos">236</span></a><span class="sd">        Parameters</span>
</span><span id="FisherPlotter.__init__-237"><a href="#FisherPlotter.__init__-237"><span class="linenos">237</span></a><span class="sd">        ----------</span>
</span><span id="FisherPlotter.__init__-238"><a href="#FisherPlotter.__init__-238"><span class="linenos">238</span></a><span class="sd">        args : FisherMatrix</span>
</span><span id="FisherPlotter.__init__-239"><a href="#FisherPlotter.__init__-239"><span class="linenos">239</span></a><span class="sd">            `FisherMatrix` objects which we want to plot.</span>
</span><span id="FisherPlotter.__init__-240"><a href="#FisherPlotter.__init__-240"><span class="linenos">240</span></a><span class="sd">            Can have different fiducial values.</span>
</span><span id="FisherPlotter.__init__-241"><a href="#FisherPlotter.__init__-241"><span class="linenos">241</span></a><span class="sd">            The order of plotting of the parameters and the LaTeX labels to use</span>
</span><span id="FisherPlotter.__init__-242"><a href="#FisherPlotter.__init__-242"><span class="linenos">242</span></a><span class="sd">            are determined by the first argument.</span>
</span><span id="FisherPlotter.__init__-243"><a href="#FisherPlotter.__init__-243"><span class="linenos">243</span></a>
</span><span id="FisherPlotter.__init__-244"><a href="#FisherPlotter.__init__-244"><span class="linenos">244</span></a><span class="sd">        labels : Optional[Collection[str]] = None</span>
</span><span id="FisherPlotter.__init__-245"><a href="#FisherPlotter.__init__-245"><span class="linenos">245</span></a><span class="sd">            the list of labels to put in the legend of the plots.</span>
</span><span id="FisherPlotter.__init__-246"><a href="#FisherPlotter.__init__-246"><span class="linenos">246</span></a><span class="sd">            If not set, defaults to `0, ..., len(args) - 1`</span>
</span><span id="FisherPlotter.__init__-247"><a href="#FisherPlotter.__init__-247"><span class="linenos">247</span></a>
</span><span id="FisherPlotter.__init__-248"><a href="#FisherPlotter.__init__-248"><span class="linenos">248</span></a><span class="sd">        Raises</span>
</span><span id="FisherPlotter.__init__-249"><a href="#FisherPlotter.__init__-249"><span class="linenos">249</span></a><span class="sd">        ------</span>
</span><span id="FisherPlotter.__init__-250"><a href="#FisherPlotter.__init__-250"><span class="linenos">250</span></a><span class="sd">        * `MismatchingSizeError` if the sizes of the inputs are not equal</span>
</span><span id="FisherPlotter.__init__-251"><a href="#FisherPlotter.__init__-251"><span class="linenos">251</span></a><span class="sd">        * `ValueError` if the names of the inputs do not match</span>
</span><span id="FisherPlotter.__init__-252"><a href="#FisherPlotter.__init__-252"><span class="linenos">252</span></a>
</span><span id="FisherPlotter.__init__-253"><a href="#FisherPlotter.__init__-253"><span class="linenos">253</span></a><span class="sd">        Examples</span>
</span><span id="FisherPlotter.__init__-254"><a href="#FisherPlotter.__init__-254"><span class="linenos">254</span></a><span class="sd">        --------</span>
</span><span id="FisherPlotter.__init__-255"><a href="#FisherPlotter.__init__-255"><span class="linenos">255</span></a><span class="sd">        Create a Fisher plotter with two objects:</span>
</span><span id="FisherPlotter.__init__-256"><a href="#FisherPlotter.__init__-256"><span class="linenos">256</span></a><span class="sd">        &gt;&gt;&gt; fm1 = FisherMatrix(np.diag([1, 2, 3]), names=list(&#39;abc&#39;))</span>
</span><span id="FisherPlotter.__init__-257"><a href="#FisherPlotter.__init__-257"><span class="linenos">257</span></a><span class="sd">        &gt;&gt;&gt; fm2 = FisherMatrix(np.diag([4, 5, 6]), names=list(&#39;abc&#39;))</span>
</span><span id="FisherPlotter.__init__-258"><a href="#FisherPlotter.__init__-258"><span class="linenos">258</span></a><span class="sd">        &gt;&gt;&gt; fp = FisherPlotter(fm1, fm2, labels=[&#39;first&#39;, &#39;second&#39;])</span>
</span><span id="FisherPlotter.__init__-259"><a href="#FisherPlotter.__init__-259"><span class="linenos">259</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherPlotter.__init__-260"><a href="#FisherPlotter.__init__-260"><span class="linenos">260</span></a>        <span class="c1"># make sure all of the Fisher objects have the same sizes</span>
</span><span id="FisherPlotter.__init__-261"><a href="#FisherPlotter.__init__-261"><span class="linenos">261</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">):</span>
</span><span id="FisherPlotter.__init__-262"><a href="#FisherPlotter.__init__-262"><span class="linenos">262</span></a>            <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="FisherPlotter.__init__-263"><a href="#FisherPlotter.__init__-263"><span class="linenos">263</span></a>
</span><span id="FisherPlotter.__init__-264"><a href="#FisherPlotter.__init__-264"><span class="linenos">264</span></a>        <span class="c1"># check names</span>
</span><span id="FisherPlotter.__init__-265"><a href="#FisherPlotter.__init__-265"><span class="linenos">265</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">):</span>
</span><span id="FisherPlotter.__init__-266"><a href="#FisherPlotter.__init__-266"><span class="linenos">266</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The names of the inputs do not match&quot;</span><span class="p">)</span>
</span><span id="FisherPlotter.__init__-267"><a href="#FisherPlotter.__init__-267"><span class="linenos">267</span></a>
</span><span id="FisherPlotter.__init__-268"><a href="#FisherPlotter.__init__-268"><span class="linenos">268</span></a>        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FisherPlotter.__init__-269"><a href="#FisherPlotter.__init__-269"><span class="linenos">269</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span id="FisherPlotter.__init__-270"><a href="#FisherPlotter.__init__-270"><span class="linenos">270</span></a>                <span class="k">raise</span> <span class="n">MismatchingSizeError</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</span><span id="FisherPlotter.__init__-271"><a href="#FisherPlotter.__init__-271"><span class="linenos">271</span></a>        <span class="c1"># default labels are 0, ..., n - 1</span>
</span><span id="FisherPlotter.__init__-272"><a href="#FisherPlotter.__init__-272"><span class="linenos">272</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherPlotter.__init__-273"><a href="#FisherPlotter.__init__-273"><span class="linenos">273</span></a>            <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">))))</span>
</span><span id="FisherPlotter.__init__-274"><a href="#FisherPlotter.__init__-274"><span class="linenos">274</span></a>
</span><span id="FisherPlotter.__init__-275"><a href="#FisherPlotter.__init__-275"><span class="linenos">275</span></a>        <span class="c1"># in case the names are shuffled, we sort them according to the FIRST</span>
</span><span id="FisherPlotter.__init__-276"><a href="#FisherPlotter.__init__-276"><span class="linenos">276</span></a>        <span class="c1"># input</span>
</span><span id="FisherPlotter.__init__-277"><a href="#FisherPlotter.__init__-277"><span class="linenos">277</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="FisherPlotter.__init__-278"><a href="#FisherPlotter.__init__-278"><span class="linenos">278</span></a>            <span class="p">[</span><span class="n">get_index_of_other_array</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">arg</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">],</span>
</span><span id="FisherPlotter.__init__-279"><a href="#FisherPlotter.__init__-279"><span class="linenos">279</span></a>            <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">,</span>
</span><span id="FisherPlotter.__init__-280"><a href="#FisherPlotter.__init__-280"><span class="linenos">280</span></a>        <span class="p">)</span>
</span><span id="FisherPlotter.__init__-281"><a href="#FisherPlotter.__init__-281"><span class="linenos">281</span></a>
</span><span id="FisherPlotter.__init__-282"><a href="#FisherPlotter.__init__-282"><span class="linenos">282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">args</span><span class="p">)]</span>
</span><span id="FisherPlotter.__init__-283"><a href="#FisherPlotter.__init__-283"><span class="linenos">283</span></a>
</span><span id="FisherPlotter.__init__-284"><a href="#FisherPlotter.__init__-284"><span class="linenos">284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="FisherPlotter.__init__-285"><a href="#FisherPlotter.__init__-285"><span class="linenos">285</span></a>
</span><span id="FisherPlotter.__init__-286"><a href="#FisherPlotter.__init__-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ylabel1d</span> <span class="o">=</span> <span class="n">ylabel1d</span>
</span></pre></div>


            <div class="docstring"><p>Constructor.</p>

<h2 id="parameters">Parameters</h2>

<p>args : FisherMatrix
    <code><a href="#FisherMatrix">FisherMatrix</a></code> objects which we want to plot.
    Can have different fiducial values.
    The order of plotting of the parameters and the LaTeX labels to use
    are determined by the first argument.</p>

<p>labels : Optional[Collection[str]] = None
    the list of labels to put in the legend of the plots.
    If not set, defaults to <code>0, ..., len(args) - 1</code></p>

<h2 id="raises">Raises</h2>

<ul>
<li><code>MismatchingSizeError</code> if the sizes of the inputs are not equal</li>
<li><code>ValueError</code> if the names of the inputs do not match</li>
</ul>

<h2 id="examples">Examples</h2>

<p>Create a Fisher plotter with two objects:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fm1</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm2</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span> <span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="n">FisherPlotter</span><span class="p">(</span><span class="n">fm1</span><span class="p">,</span> <span class="n">fm2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">])</span>
</code></pre></div>
</div>


                            </div>
                            <div id="FisherPlotter.values" class="classattr">
                                <div class="attr variable">
            <span class="name">values</span>

        
    </div>
    <a class="headerlink" href="#FisherPlotter.values"></a>
    
            <div class="docstring"><p>Returns the input array of Fisher objects.</p>
</div>


                            </div>
                            <div id="FisherPlotter.labels" class="classattr">
                                <div class="attr variable">
            <span class="name">labels</span>

        
    </div>
    <a class="headerlink" href="#FisherPlotter.labels"></a>
    
            <div class="docstring"><p>Returns the labels of the Fisher objects.</p>
</div>


                            </div>
                            <div id="FisherPlotter.ylabel1d" class="classattr">
                                <div class="attr variable">
            <span class="name">ylabel1d</span>

        
    </div>
    <a class="headerlink" href="#FisherPlotter.ylabel1d"></a>
    
            <div class="docstring"><p>Returns the y-label used for labelling the 1D curves.</p>
</div>


                            </div>
                            <div id="FisherPlotter.plot_1d" class="classattr">
                                        <input id="FisherPlotter.plot_1d-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_1d</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>,</span><span class="param">	<span class="n">max_cols</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mpl_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="FisherPlotter.plot_1d-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherPlotter.plot_1d"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherPlotter.plot_1d-315"><a href="#FisherPlotter.plot_1d-315"><span class="linenos">315</span></a>    <span class="k">def</span> <span class="nf">plot_1d</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_1d-316"><a href="#FisherPlotter.plot_1d-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-317"><a href="#FisherPlotter.plot_1d-317"><span class="linenos">317</span></a>        <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-318"><a href="#FisherPlotter.plot_1d-318"><span class="linenos">318</span></a>        <span class="n">max_cols</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-319"><a href="#FisherPlotter.plot_1d-319"><span class="linenos">319</span></a>        <span class="n">mpl_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-320"><a href="#FisherPlotter.plot_1d-320"><span class="linenos">320</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-321"><a href="#FisherPlotter.plot_1d-321"><span class="linenos">321</span></a>    <span class="p">):</span>
</span><span id="FisherPlotter.plot_1d-322"><a href="#FisherPlotter.plot_1d-322"><span class="linenos">322</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherPlotter.plot_1d-323"><a href="#FisherPlotter.plot_1d-323"><span class="linenos">323</span></a><span class="sd">        Makes a 1D plot (Gaussians) of the Fisher objects</span>
</span><span id="FisherPlotter.plot_1d-324"><a href="#FisherPlotter.plot_1d-324"><span class="linenos">324</span></a>
</span><span id="FisherPlotter.plot_1d-325"><a href="#FisherPlotter.plot_1d-325"><span class="linenos">325</span></a><span class="sd">        Parameters</span>
</span><span id="FisherPlotter.plot_1d-326"><a href="#FisherPlotter.plot_1d-326"><span class="linenos">326</span></a><span class="sd">        ----------</span>
</span><span id="FisherPlotter.plot_1d-327"><a href="#FisherPlotter.plot_1d-327"><span class="linenos">327</span></a><span class="sd">        max_cols : Optional[int] = None</span>
</span><span id="FisherPlotter.plot_1d-328"><a href="#FisherPlotter.plot_1d-328"><span class="linenos">328</span></a><span class="sd">            the maximum number of columns to force the plot into.</span>
</span><span id="FisherPlotter.plot_1d-329"><a href="#FisherPlotter.plot_1d-329"><span class="linenos">329</span></a><span class="sd">            By default, the parameters are always plotted horizontally; if you</span>
</span><span id="FisherPlotter.plot_1d-330"><a href="#FisherPlotter.plot_1d-330"><span class="linenos">330</span></a><span class="sd">            need to spread it over `max_cols`, pass a non-negative integer</span>
</span><span id="FisherPlotter.plot_1d-331"><a href="#FisherPlotter.plot_1d-331"><span class="linenos">331</span></a><span class="sd">            here.</span>
</span><span id="FisherPlotter.plot_1d-332"><a href="#FisherPlotter.plot_1d-332"><span class="linenos">332</span></a>
</span><span id="FisherPlotter.plot_1d-333"><a href="#FisherPlotter.plot_1d-333"><span class="linenos">333</span></a><span class="sd">        mpl_options : Optional[dict] = None</span>
</span><span id="FisherPlotter.plot_1d-334"><a href="#FisherPlotter.plot_1d-334"><span class="linenos">334</span></a><span class="sd">            any parameters meant for `matplotlib.rcParams`. By default, only</span>
</span><span id="FisherPlotter.plot_1d-335"><a href="#FisherPlotter.plot_1d-335"><span class="linenos">335</span></a><span class="sd">            sets default font to cm serif.</span>
</span><span id="FisherPlotter.plot_1d-336"><a href="#FisherPlotter.plot_1d-336"><span class="linenos">336</span></a><span class="sd">            See [Matplotlib documentation](https://matplotlib.org/stable/tutorials/introductory/customizing.html)</span>
</span><span id="FisherPlotter.plot_1d-337"><a href="#FisherPlotter.plot_1d-337"><span class="linenos">337</span></a><span class="sd">            for more information.</span>
</span><span id="FisherPlotter.plot_1d-338"><a href="#FisherPlotter.plot_1d-338"><span class="linenos">338</span></a>
</span><span id="FisherPlotter.plot_1d-339"><a href="#FisherPlotter.plot_1d-339"><span class="linenos">339</span></a><span class="sd">        Returns</span>
</span><span id="FisherPlotter.plot_1d-340"><a href="#FisherPlotter.plot_1d-340"><span class="linenos">340</span></a><span class="sd">        -------</span>
</span><span id="FisherPlotter.plot_1d-341"><a href="#FisherPlotter.plot_1d-341"><span class="linenos">341</span></a><span class="sd">        An instance of `FisherFigure1D`.</span>
</span><span id="FisherPlotter.plot_1d-342"><a href="#FisherPlotter.plot_1d-342"><span class="linenos">342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherPlotter.plot_1d-343"><a href="#FisherPlotter.plot_1d-343"><span class="linenos">343</span></a>        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="FisherPlotter.plot_1d-344"><a href="#FisherPlotter.plot_1d-344"><span class="linenos">344</span></a>
</span><span id="FisherPlotter.plot_1d-345"><a href="#FisherPlotter.plot_1d-345"><span class="linenos">345</span></a>        <span class="k">if</span> <span class="n">max_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">max_cols</span> <span class="o">&lt;=</span> <span class="n">size</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_1d-346"><a href="#FisherPlotter.plot_1d-346"><span class="linenos">346</span></a>            <span class="n">full</span> <span class="o">=</span> <span class="n">size</span> <span class="o">%</span> <span class="n">max_cols</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="FisherPlotter.plot_1d-347"><a href="#FisherPlotter.plot_1d-347"><span class="linenos">347</span></a>            <span class="n">layout</span> <span class="o">=</span> <span class="n">size</span> <span class="o">//</span> <span class="n">max_cols</span> <span class="k">if</span> <span class="n">full</span> <span class="k">else</span> <span class="n">size</span> <span class="o">//</span> <span class="n">max_cols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_cols</span>
</span><span id="FisherPlotter.plot_1d-348"><a href="#FisherPlotter.plot_1d-348"><span class="linenos">348</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_1d-349"><a href="#FisherPlotter.plot_1d-349"><span class="linenos">349</span></a>            <span class="n">layout</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span>
</span><span id="FisherPlotter.plot_1d-350"><a href="#FisherPlotter.plot_1d-350"><span class="linenos">350</span></a>            <span class="n">full</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="FisherPlotter.plot_1d-351"><a href="#FisherPlotter.plot_1d-351"><span class="linenos">351</span></a>
</span><span id="FisherPlotter.plot_1d-352"><a href="#FisherPlotter.plot_1d-352"><span class="linenos">352</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">mpl_options</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_1d-353"><a href="#FisherPlotter.plot_1d-353"><span class="linenos">353</span></a>            <span class="n">mpl_options</span> <span class="o">=</span> <span class="n">get_default_rcparams</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_1d-354"><a href="#FisherPlotter.plot_1d-354"><span class="linenos">354</span></a>
</span><span id="FisherPlotter.plot_1d-355"><a href="#FisherPlotter.plot_1d-355"><span class="linenos">355</span></a>        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="n">mpl_options</span><span class="p">):</span>
</span><span id="FisherPlotter.plot_1d-356"><a href="#FisherPlotter.plot_1d-356"><span class="linenos">356</span></a>            <span class="c1"># general figure setup</span>
</span><span id="FisherPlotter.plot_1d-357"><a href="#FisherPlotter.plot_1d-357"><span class="linenos">357</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_1d-358"><a href="#FisherPlotter.plot_1d-358"><span class="linenos">358</span></a>                <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-359"><a href="#FisherPlotter.plot_1d-359"><span class="linenos">359</span></a>                <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">scale</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="FisherPlotter.plot_1d-360"><a href="#FisherPlotter.plot_1d-360"><span class="linenos">360</span></a>            <span class="p">)</span>
</span><span id="FisherPlotter.plot_1d-361"><a href="#FisherPlotter.plot_1d-361"><span class="linenos">361</span></a>            <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_1d-362"><a href="#FisherPlotter.plot_1d-362"><span class="linenos">362</span></a>                <span class="n">nrows</span><span class="o">=</span><span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_1d-363"><a href="#FisherPlotter.plot_1d-363"><span class="linenos">363</span></a>                <span class="n">ncols</span><span class="o">=</span><span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_1d-364"><a href="#FisherPlotter.plot_1d-364"><span class="linenos">364</span></a>                <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-365"><a href="#FisherPlotter.plot_1d-365"><span class="linenos">365</span></a>                <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-366"><a href="#FisherPlotter.plot_1d-366"><span class="linenos">366</span></a>            <span class="p">)</span>
</span><span id="FisherPlotter.plot_1d-367"><a href="#FisherPlotter.plot_1d-367"><span class="linenos">367</span></a>            <span class="n">axes</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_1d-368"><a href="#FisherPlotter.plot_1d-368"><span class="linenos">368</span></a>            <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_1d-369"><a href="#FisherPlotter.plot_1d-369"><span class="linenos">369</span></a>                <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">axes</span><span class="p">])</span>
</span><span id="FisherPlotter.plot_1d-370"><a href="#FisherPlotter.plot_1d-370"><span class="linenos">370</span></a>
</span><span id="FisherPlotter.plot_1d-371"><a href="#FisherPlotter.plot_1d-371"><span class="linenos">371</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherPlotter.plot_1d-372"><a href="#FisherPlotter.plot_1d-372"><span class="linenos">372</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">latex_names</span>
</span><span id="FisherPlotter.plot_1d-373"><a href="#FisherPlotter.plot_1d-373"><span class="linenos">373</span></a>
</span><span id="FisherPlotter.plot_1d-374"><a href="#FisherPlotter.plot_1d-374"><span class="linenos">374</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="n">latex_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">latex_names</span><span class="p">):</span>
</span><span id="FisherPlotter.plot_1d-375"><a href="#FisherPlotter.plot_1d-375"><span class="linenos">375</span></a>                <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="FisherPlotter.plot_1d-376"><a href="#FisherPlotter.plot_1d-376"><span class="linenos">376</span></a>
</span><span id="FisherPlotter.plot_1d-377"><a href="#FisherPlotter.plot_1d-377"><span class="linenos">377</span></a>                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">fm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">get_default_cycler</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
</span><span id="FisherPlotter.plot_1d-378"><a href="#FisherPlotter.plot_1d-378"><span class="linenos">378</span></a>                    <span class="n">plot_curve_1d</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</span><span id="FisherPlotter.plot_1d-379"><a href="#FisherPlotter.plot_1d-379"><span class="linenos">379</span></a>
</span><span id="FisherPlotter.plot_1d-380"><a href="#FisherPlotter.plot_1d-380"><span class="linenos">380</span></a>                    <span class="n">add_shading_1d</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_1d-381"><a href="#FisherPlotter.plot_1d-381"><span class="linenos">381</span></a>                        <span class="n">fm</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)],</span>
</span><span id="FisherPlotter.plot_1d-382"><a href="#FisherPlotter.plot_1d-382"><span class="linenos">382</span></a>                        <span class="n">fm</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="FisherPlotter.plot_1d-383"><a href="#FisherPlotter.plot_1d-383"><span class="linenos">383</span></a>                        <span class="n">ax</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-384"><a href="#FisherPlotter.plot_1d-384"><span class="linenos">384</span></a>                        <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_1d-385"><a href="#FisherPlotter.plot_1d-385"><span class="linenos">385</span></a>                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-386"><a href="#FisherPlotter.plot_1d-386"><span class="linenos">386</span></a>                        <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-387"><a href="#FisherPlotter.plot_1d-387"><span class="linenos">387</span></a>                    <span class="p">)</span>
</span><span id="FisherPlotter.plot_1d-388"><a href="#FisherPlotter.plot_1d-388"><span class="linenos">388</span></a>
</span><span id="FisherPlotter.plot_1d-389"><a href="#FisherPlotter.plot_1d-389"><span class="linenos">389</span></a>                    <span class="n">add_shading_1d</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_1d-390"><a href="#FisherPlotter.plot_1d-390"><span class="linenos">390</span></a>                        <span class="n">fm</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)],</span>
</span><span id="FisherPlotter.plot_1d-391"><a href="#FisherPlotter.plot_1d-391"><span class="linenos">391</span></a>                        <span class="n">fm</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="FisherPlotter.plot_1d-392"><a href="#FisherPlotter.plot_1d-392"><span class="linenos">392</span></a>                        <span class="n">ax</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-393"><a href="#FisherPlotter.plot_1d-393"><span class="linenos">393</span></a>                        <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-394"><a href="#FisherPlotter.plot_1d-394"><span class="linenos">394</span></a>                        <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_1d-395"><a href="#FisherPlotter.plot_1d-395"><span class="linenos">395</span></a>                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-396"><a href="#FisherPlotter.plot_1d-396"><span class="linenos">396</span></a>                        <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_1d-397"><a href="#FisherPlotter.plot_1d-397"><span class="linenos">397</span></a>                    <span class="p">)</span>
</span><span id="FisherPlotter.plot_1d-398"><a href="#FisherPlotter.plot_1d-398"><span class="linenos">398</span></a>
</span><span id="FisherPlotter.plot_1d-399"><a href="#FisherPlotter.plot_1d-399"><span class="linenos">399</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">latex_name</span><span class="p">)</span>
</span><span id="FisherPlotter.plot_1d-400"><a href="#FisherPlotter.plot_1d-400"><span class="linenos">400</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">relim</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_1d-401"><a href="#FisherPlotter.plot_1d-401"><span class="linenos">401</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_1d-402"><a href="#FisherPlotter.plot_1d-402"><span class="linenos">402</span></a>
</span><span id="FisherPlotter.plot_1d-403"><a href="#FisherPlotter.plot_1d-403"><span class="linenos">403</span></a>                <span class="c1"># the y axis should start at 0 since we&#39;re plotting a PDF</span>
</span><span id="FisherPlotter.plot_1d-404"><a href="#FisherPlotter.plot_1d-404"><span class="linenos">404</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FisherPlotter.plot_1d-405"><a href="#FisherPlotter.plot_1d-405"><span class="linenos">405</span></a>
</span><span id="FisherPlotter.plot_1d-406"><a href="#FisherPlotter.plot_1d-406"><span class="linenos">406</span></a>                <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_1d-407"><a href="#FisherPlotter.plot_1d-407"><span class="linenos">407</span></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylabel1d</span><span class="p">)</span>
</span><span id="FisherPlotter.plot_1d-408"><a href="#FisherPlotter.plot_1d-408"><span class="linenos">408</span></a>
</span><span id="FisherPlotter.plot_1d-409"><a href="#FisherPlotter.plot_1d-409"><span class="linenos">409</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</span><span id="FisherPlotter.plot_1d-410"><a href="#FisherPlotter.plot_1d-410"><span class="linenos">410</span></a>
</span><span id="FisherPlotter.plot_1d-411"><a href="#FisherPlotter.plot_1d-411"><span class="linenos">411</span></a>            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;legend&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_1d-412"><a href="#FisherPlotter.plot_1d-412"><span class="linenos">412</span></a>                <span class="c1"># remove any axes which are not drawn</span>
</span><span id="FisherPlotter.plot_1d-413"><a href="#FisherPlotter.plot_1d-413"><span class="linenos">413</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_1d-414"><a href="#FisherPlotter.plot_1d-414"><span class="linenos">414</span></a>                    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_1d-415"><a href="#FisherPlotter.plot_1d-415"><span class="linenos">415</span></a>                        <span class="p">(</span><span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FisherPlotter.plot_1d-416"><a href="#FisherPlotter.plot_1d-416"><span class="linenos">416</span></a>                    <span class="p">):</span>
</span><span id="FisherPlotter.plot_1d-417"><a href="#FisherPlotter.plot_1d-417"><span class="linenos">417</span></a>                        <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_1d-418"><a href="#FisherPlotter.plot_1d-418"><span class="linenos">418</span></a>
</span><span id="FisherPlotter.plot_1d-419"><a href="#FisherPlotter.plot_1d-419"><span class="linenos">419</span></a>            <span class="c1"># remove any axes which are not drawn</span>
</span><span id="FisherPlotter.plot_1d-420"><a href="#FisherPlotter.plot_1d-420"><span class="linenos">420</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_1d-421"><a href="#FisherPlotter.plot_1d-421"><span class="linenos">421</span></a>                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_1d-422"><a href="#FisherPlotter.plot_1d-422"><span class="linenos">422</span></a>                    <span class="p">(</span><span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">layout</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">layout</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FisherPlotter.plot_1d-423"><a href="#FisherPlotter.plot_1d-423"><span class="linenos">423</span></a>                <span class="p">):</span>
</span><span id="FisherPlotter.plot_1d-424"><a href="#FisherPlotter.plot_1d-424"><span class="linenos">424</span></a>                    <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_1d-425"><a href="#FisherPlotter.plot_1d-425"><span class="linenos">425</span></a>
</span><span id="FisherPlotter.plot_1d-426"><a href="#FisherPlotter.plot_1d-426"><span class="linenos">426</span></a>        <span class="k">return</span> <span class="n">FisherFigure1D</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Makes a 1D plot (Gaussians) of the Fisher objects</p>

<h2 id="parameters">Parameters</h2>

<p>max_cols : Optional[int] = None
    the maximum number of columns to force the plot into.
    By default, the parameters are always plotted horizontally; if you
    need to spread it over <code>max_cols</code>, pass a non-negative integer
    here.</p>

<p>mpl_options : Optional[dict] = None
    any parameters meant for <code>matplotlib.rcParams</code>. By default, only
    sets default font to cm serif.
    See <a href="https://matplotlib.org/stable/tutorials/introductory/customizing.html">Matplotlib documentation</a>
    for more information.</p>

<h2 id="returns">Returns</h2>

<p>An instance of <code><a href="#FisherFigure1D">FisherFigure1D</a></code>.</p>
</div>


                            </div>
                            <div id="FisherPlotter.plot_triangle" class="classattr">
                                        <input id="FisherPlotter.plot_triangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_triangle</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">mpl_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">plot_1d_curves</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="FisherPlotter.plot_triangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FisherPlotter.plot_triangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FisherPlotter.plot_triangle-428"><a href="#FisherPlotter.plot_triangle-428"><span class="linenos">428</span></a>    <span class="k">def</span> <span class="nf">plot_triangle</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_triangle-429"><a href="#FisherPlotter.plot_triangle-429"><span class="linenos">429</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-430"><a href="#FisherPlotter.plot_triangle-430"><span class="linenos">430</span></a>        <span class="n">mpl_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-431"><a href="#FisherPlotter.plot_triangle-431"><span class="linenos">431</span></a>        <span class="n">plot_1d_curves</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-432"><a href="#FisherPlotter.plot_triangle-432"><span class="linenos">432</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-433"><a href="#FisherPlotter.plot_triangle-433"><span class="linenos">433</span></a>    <span class="p">):</span>
</span><span id="FisherPlotter.plot_triangle-434"><a href="#FisherPlotter.plot_triangle-434"><span class="linenos">434</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="FisherPlotter.plot_triangle-435"><a href="#FisherPlotter.plot_triangle-435"><span class="linenos">435</span></a><span class="sd">        Plots the 2D contours (and optionally 1D curves) of the Fisher objects.</span>
</span><span id="FisherPlotter.plot_triangle-436"><a href="#FisherPlotter.plot_triangle-436"><span class="linenos">436</span></a>
</span><span id="FisherPlotter.plot_triangle-437"><a href="#FisherPlotter.plot_triangle-437"><span class="linenos">437</span></a><span class="sd">        Parameters</span>
</span><span id="FisherPlotter.plot_triangle-438"><a href="#FisherPlotter.plot_triangle-438"><span class="linenos">438</span></a><span class="sd">        ----------</span>
</span><span id="FisherPlotter.plot_triangle-439"><a href="#FisherPlotter.plot_triangle-439"><span class="linenos">439</span></a><span class="sd">        mpl_options : Optional[dict] = None</span>
</span><span id="FisherPlotter.plot_triangle-440"><a href="#FisherPlotter.plot_triangle-440"><span class="linenos">440</span></a><span class="sd">            any parameters meant for `matplotlib.rcParams`. By default, only</span>
</span><span id="FisherPlotter.plot_triangle-441"><a href="#FisherPlotter.plot_triangle-441"><span class="linenos">441</span></a><span class="sd">            sets default font to cm serif.</span>
</span><span id="FisherPlotter.plot_triangle-442"><a href="#FisherPlotter.plot_triangle-442"><span class="linenos">442</span></a><span class="sd">            See [Matplotlib documentation](https://matplotlib.org/stable/tutorials/introductory/customizing.html)</span>
</span><span id="FisherPlotter.plot_triangle-443"><a href="#FisherPlotter.plot_triangle-443"><span class="linenos">443</span></a><span class="sd">            for more information.</span>
</span><span id="FisherPlotter.plot_triangle-444"><a href="#FisherPlotter.plot_triangle-444"><span class="linenos">444</span></a><span class="sd">        plot_1d_curves : bool = True</span>
</span><span id="FisherPlotter.plot_triangle-445"><a href="#FisherPlotter.plot_triangle-445"><span class="linenos">445</span></a><span class="sd">            whether or not the 1D (marginalized) curves should be plotted</span>
</span><span id="FisherPlotter.plot_triangle-446"><a href="#FisherPlotter.plot_triangle-446"><span class="linenos">446</span></a>
</span><span id="FisherPlotter.plot_triangle-447"><a href="#FisherPlotter.plot_triangle-447"><span class="linenos">447</span></a><span class="sd">        Returns</span>
</span><span id="FisherPlotter.plot_triangle-448"><a href="#FisherPlotter.plot_triangle-448"><span class="linenos">448</span></a><span class="sd">        -------</span>
</span><span id="FisherPlotter.plot_triangle-449"><a href="#FisherPlotter.plot_triangle-449"><span class="linenos">449</span></a><span class="sd">        An instance of `FisherFigure2D`.</span>
</span><span id="FisherPlotter.plot_triangle-450"><a href="#FisherPlotter.plot_triangle-450"><span class="linenos">450</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FisherPlotter.plot_triangle-451"><a href="#FisherPlotter.plot_triangle-451"><span class="linenos">451</span></a>        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="FisherPlotter.plot_triangle-452"><a href="#FisherPlotter.plot_triangle-452"><span class="linenos">452</span></a>
</span><span id="FisherPlotter.plot_triangle-453"><a href="#FisherPlotter.plot_triangle-453"><span class="linenos">453</span></a>        <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-454"><a href="#FisherPlotter.plot_triangle-454"><span class="linenos">454</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to make a 2D plot with &lt; 2 parameters&quot;</span><span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-455"><a href="#FisherPlotter.plot_triangle-455"><span class="linenos">455</span></a>
</span><span id="FisherPlotter.plot_triangle-456"><a href="#FisherPlotter.plot_triangle-456"><span class="linenos">456</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">mpl_options</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-457"><a href="#FisherPlotter.plot_triangle-457"><span class="linenos">457</span></a>            <span class="n">mpl_options</span> <span class="o">=</span> <span class="n">get_default_rcparams</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_triangle-458"><a href="#FisherPlotter.plot_triangle-458"><span class="linenos">458</span></a>
</span><span id="FisherPlotter.plot_triangle-459"><a href="#FisherPlotter.plot_triangle-459"><span class="linenos">459</span></a>        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="n">mpl_options</span><span class="p">):</span>
</span><span id="FisherPlotter.plot_triangle-460"><a href="#FisherPlotter.plot_triangle-460"><span class="linenos">460</span></a>            <span class="c1"># general figure setup</span>
</span><span id="FisherPlotter.plot_triangle-461"><a href="#FisherPlotter.plot_triangle-461"><span class="linenos">461</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">size</span><span class="p">),</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-462"><a href="#FisherPlotter.plot_triangle-462"><span class="linenos">462</span></a>            <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-463"><a href="#FisherPlotter.plot_triangle-463"><span class="linenos">463</span></a>            <span class="c1"># TODO make it work with a shared xcol</span>
</span><span id="FisherPlotter.plot_triangle-464"><a href="#FisherPlotter.plot_triangle-464"><span class="linenos">464</span></a>            <span class="n">ax</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sharex</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-465"><a href="#FisherPlotter.plot_triangle-465"><span class="linenos">465</span></a>
</span><span id="FisherPlotter.plot_triangle-466"><a href="#FisherPlotter.plot_triangle-466"><span class="linenos">466</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
</span><span id="FisherPlotter.plot_triangle-467"><a href="#FisherPlotter.plot_triangle-467"><span class="linenos">467</span></a>            <span class="n">latex_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">latex_names</span>
</span><span id="FisherPlotter.plot_triangle-468"><a href="#FisherPlotter.plot_triangle-468"><span class="linenos">468</span></a>
</span><span id="FisherPlotter.plot_triangle-469"><a href="#FisherPlotter.plot_triangle-469"><span class="linenos">469</span></a>            <span class="c1"># set automatic limits</span>
</span><span id="FisherPlotter.plot_triangle-470"><a href="#FisherPlotter.plot_triangle-470"><span class="linenos">470</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="FisherPlotter.plot_triangle-471"><a href="#FisherPlotter.plot_triangle-471"><span class="linenos">471</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-472"><a href="#FisherPlotter.plot_triangle-472"><span class="linenos">472</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</span><span id="FisherPlotter.plot_triangle-473"><a href="#FisherPlotter.plot_triangle-473"><span class="linenos">473</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="FisherPlotter.plot_triangle-474"><a href="#FisherPlotter.plot_triangle-474"><span class="linenos">474</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-475"><a href="#FisherPlotter.plot_triangle-475"><span class="linenos">475</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</span><span id="FisherPlotter.plot_triangle-476"><a href="#FisherPlotter.plot_triangle-476"><span class="linenos">476</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="FisherPlotter.plot_triangle-477"><a href="#FisherPlotter.plot_triangle-477"><span class="linenos">477</span></a>
</span><span id="FisherPlotter.plot_triangle-478"><a href="#FisherPlotter.plot_triangle-478"><span class="linenos">478</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="FisherPlotter.plot_triangle-479"><a href="#FisherPlotter.plot_triangle-479"><span class="linenos">479</span></a>                <span class="n">namey</span><span class="p">,</span> <span class="n">latex_namey</span><span class="p">,</span> <span class="n">namex</span><span class="p">,</span> <span class="n">latex_namex</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FisherPlotter.plot_triangle-480"><a href="#FisherPlotter.plot_triangle-480"><span class="linenos">480</span></a>                    <span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-481"><a href="#FisherPlotter.plot_triangle-481"><span class="linenos">481</span></a>                    <span class="n">latex_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-482"><a href="#FisherPlotter.plot_triangle-482"><span class="linenos">482</span></a>                    <span class="n">names</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-483"><a href="#FisherPlotter.plot_triangle-483"><span class="linenos">483</span></a>                    <span class="n">latex_names</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-484"><a href="#FisherPlotter.plot_triangle-484"><span class="linenos">484</span></a>                <span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-485"><a href="#FisherPlotter.plot_triangle-485"><span class="linenos">485</span></a>                <span class="c1"># labels for 2D contours (increasing y)</span>
</span><span id="FisherPlotter.plot_triangle-486"><a href="#FisherPlotter.plot_triangle-486"><span class="linenos">486</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-487"><a href="#FisherPlotter.plot_triangle-487"><span class="linenos">487</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">latex_namey</span><span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-488"><a href="#FisherPlotter.plot_triangle-488"><span class="linenos">488</span></a>
</span><span id="FisherPlotter.plot_triangle-489"><a href="#FisherPlotter.plot_triangle-489"><span class="linenos">489</span></a>                <span class="c1"># labels for 2D contours (increasing x)</span>
</span><span id="FisherPlotter.plot_triangle-490"><a href="#FisherPlotter.plot_triangle-490"><span class="linenos">490</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-491"><a href="#FisherPlotter.plot_triangle-491"><span class="linenos">491</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">latex_namex</span><span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-492"><a href="#FisherPlotter.plot_triangle-492"><span class="linenos">492</span></a>
</span><span id="FisherPlotter.plot_triangle-493"><a href="#FisherPlotter.plot_triangle-493"><span class="linenos">493</span></a>                <span class="c1"># removing any unnecessary axes from the gridspec</span>
</span><span id="FisherPlotter.plot_triangle-494"><a href="#FisherPlotter.plot_triangle-494"><span class="linenos">494</span></a>                <span class="c1"># TODO should they be removed, or somehow just made invisible?</span>
</span><span id="FisherPlotter.plot_triangle-495"><a href="#FisherPlotter.plot_triangle-495"><span class="linenos">495</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-496"><a href="#FisherPlotter.plot_triangle-496"><span class="linenos">496</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_triangle-497"><a href="#FisherPlotter.plot_triangle-497"><span class="linenos">497</span></a>                    <span class="c1"># ax[i, j].axis(&#39;off&#39;)</span>
</span><span id="FisherPlotter.plot_triangle-498"><a href="#FisherPlotter.plot_triangle-498"><span class="linenos">498</span></a>                <span class="c1"># plotting the 2D contours</span>
</span><span id="FisherPlotter.plot_triangle-499"><a href="#FisherPlotter.plot_triangle-499"><span class="linenos">499</span></a>                <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-500"><a href="#FisherPlotter.plot_triangle-500"><span class="linenos">500</span></a>                    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">fm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">get_default_cycler</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
</span><span id="FisherPlotter.plot_triangle-501"><a href="#FisherPlotter.plot_triangle-501"><span class="linenos">501</span></a>                        <span class="c1"># plot 1-sigma 2D curves</span>
</span><span id="FisherPlotter.plot_triangle-502"><a href="#FisherPlotter.plot_triangle-502"><span class="linenos">502</span></a>                        <span class="c1"># NOTE this is the &quot;68% of the probability of a</span>
</span><span id="FisherPlotter.plot_triangle-503"><a href="#FisherPlotter.plot_triangle-503"><span class="linenos">503</span></a>                        <span class="c1"># single parameter lying within the bounds projected</span>
</span><span id="FisherPlotter.plot_triangle-504"><a href="#FisherPlotter.plot_triangle-504"><span class="linenos">504</span></a>                        <span class="c1"># onto a parameter axis&quot;</span>
</span><span id="FisherPlotter.plot_triangle-505"><a href="#FisherPlotter.plot_triangle-505"><span class="linenos">505</span></a>                        <span class="n">plot_curve_2d</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_triangle-506"><a href="#FisherPlotter.plot_triangle-506"><span class="linenos">506</span></a>                            <span class="n">fm</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-507"><a href="#FisherPlotter.plot_triangle-507"><span class="linenos">507</span></a>                            <span class="n">namex</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-508"><a href="#FisherPlotter.plot_triangle-508"><span class="linenos">508</span></a>                            <span class="n">namey</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-509"><a href="#FisherPlotter.plot_triangle-509"><span class="linenos">509</span></a>                            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-510"><a href="#FisherPlotter.plot_triangle-510"><span class="linenos">510</span></a>                            <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-511"><a href="#FisherPlotter.plot_triangle-511"><span class="linenos">511</span></a>                            <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-512"><a href="#FisherPlotter.plot_triangle-512"><span class="linenos">512</span></a>                            <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-513"><a href="#FisherPlotter.plot_triangle-513"><span class="linenos">513</span></a>                        <span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-514"><a href="#FisherPlotter.plot_triangle-514"><span class="linenos">514</span></a>                        <span class="c1"># same thing, but shaded</span>
</span><span id="FisherPlotter.plot_triangle-515"><a href="#FisherPlotter.plot_triangle-515"><span class="linenos">515</span></a>                        <span class="n">plot_curve_2d</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_triangle-516"><a href="#FisherPlotter.plot_triangle-516"><span class="linenos">516</span></a>                            <span class="n">fm</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-517"><a href="#FisherPlotter.plot_triangle-517"><span class="linenos">517</span></a>                            <span class="n">namex</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-518"><a href="#FisherPlotter.plot_triangle-518"><span class="linenos">518</span></a>                            <span class="n">namey</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-519"><a href="#FisherPlotter.plot_triangle-519"><span class="linenos">519</span></a>                            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-520"><a href="#FisherPlotter.plot_triangle-520"><span class="linenos">520</span></a>                            <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-521"><a href="#FisherPlotter.plot_triangle-521"><span class="linenos">521</span></a>                            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-522"><a href="#FisherPlotter.plot_triangle-522"><span class="linenos">522</span></a>                            <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-523"><a href="#FisherPlotter.plot_triangle-523"><span class="linenos">523</span></a>                            <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-524"><a href="#FisherPlotter.plot_triangle-524"><span class="linenos">524</span></a>                            <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-525"><a href="#FisherPlotter.plot_triangle-525"><span class="linenos">525</span></a>                        <span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-526"><a href="#FisherPlotter.plot_triangle-526"><span class="linenos">526</span></a>
</span><span id="FisherPlotter.plot_triangle-527"><a href="#FisherPlotter.plot_triangle-527"><span class="linenos">527</span></a>                        <span class="c1"># the 2-sigma</span>
</span><span id="FisherPlotter.plot_triangle-528"><a href="#FisherPlotter.plot_triangle-528"><span class="linenos">528</span></a>                        <span class="n">plot_curve_2d</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_triangle-529"><a href="#FisherPlotter.plot_triangle-529"><span class="linenos">529</span></a>                            <span class="n">fm</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-530"><a href="#FisherPlotter.plot_triangle-530"><span class="linenos">530</span></a>                            <span class="n">namex</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-531"><a href="#FisherPlotter.plot_triangle-531"><span class="linenos">531</span></a>                            <span class="n">namey</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-532"><a href="#FisherPlotter.plot_triangle-532"><span class="linenos">532</span></a>                            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-533"><a href="#FisherPlotter.plot_triangle-533"><span class="linenos">533</span></a>                            <span class="n">scaling_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-534"><a href="#FisherPlotter.plot_triangle-534"><span class="linenos">534</span></a>                            <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-535"><a href="#FisherPlotter.plot_triangle-535"><span class="linenos">535</span></a>                            <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-536"><a href="#FisherPlotter.plot_triangle-536"><span class="linenos">536</span></a>                            <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-537"><a href="#FisherPlotter.plot_triangle-537"><span class="linenos">537</span></a>                        <span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-538"><a href="#FisherPlotter.plot_triangle-538"><span class="linenos">538</span></a>                        <span class="c1"># same thing, but shaded</span>
</span><span id="FisherPlotter.plot_triangle-539"><a href="#FisherPlotter.plot_triangle-539"><span class="linenos">539</span></a>                        <span class="n">plot_curve_2d</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_triangle-540"><a href="#FisherPlotter.plot_triangle-540"><span class="linenos">540</span></a>                            <span class="n">fm</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-541"><a href="#FisherPlotter.plot_triangle-541"><span class="linenos">541</span></a>                            <span class="n">namex</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-542"><a href="#FisherPlotter.plot_triangle-542"><span class="linenos">542</span></a>                            <span class="n">namey</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-543"><a href="#FisherPlotter.plot_triangle-543"><span class="linenos">543</span></a>                            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-544"><a href="#FisherPlotter.plot_triangle-544"><span class="linenos">544</span></a>                            <span class="n">scaling_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-545"><a href="#FisherPlotter.plot_triangle-545"><span class="linenos">545</span></a>                            <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-546"><a href="#FisherPlotter.plot_triangle-546"><span class="linenos">546</span></a>                            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-547"><a href="#FisherPlotter.plot_triangle-547"><span class="linenos">547</span></a>                            <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-548"><a href="#FisherPlotter.plot_triangle-548"><span class="linenos">548</span></a>                            <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-549"><a href="#FisherPlotter.plot_triangle-549"><span class="linenos">549</span></a>                            <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-550"><a href="#FisherPlotter.plot_triangle-550"><span class="linenos">550</span></a>                        <span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-551"><a href="#FisherPlotter.plot_triangle-551"><span class="linenos">551</span></a>
</span><span id="FisherPlotter.plot_triangle-552"><a href="#FisherPlotter.plot_triangle-552"><span class="linenos">552</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-553"><a href="#FisherPlotter.plot_triangle-553"><span class="linenos">553</span></a>                    <span class="c1"># plotting the 1D Gaussians</span>
</span><span id="FisherPlotter.plot_triangle-554"><a href="#FisherPlotter.plot_triangle-554"><span class="linenos">554</span></a>                    <span class="k">if</span> <span class="n">plot_1d_curves</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-555"><a href="#FisherPlotter.plot_triangle-555"><span class="linenos">555</span></a>                        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">fm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">get_default_cycler</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
</span><span id="FisherPlotter.plot_triangle-556"><a href="#FisherPlotter.plot_triangle-556"><span class="linenos">556</span></a>                            <span class="n">plot_curve_1d</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_triangle-557"><a href="#FisherPlotter.plot_triangle-557"><span class="linenos">557</span></a>                                <span class="n">fm</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-558"><a href="#FisherPlotter.plot_triangle-558"><span class="linenos">558</span></a>                                <span class="n">namex</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-559"><a href="#FisherPlotter.plot_triangle-559"><span class="linenos">559</span></a>                                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-560"><a href="#FisherPlotter.plot_triangle-560"><span class="linenos">560</span></a>                                <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-561"><a href="#FisherPlotter.plot_triangle-561"><span class="linenos">561</span></a>                            <span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-562"><a href="#FisherPlotter.plot_triangle-562"><span class="linenos">562</span></a>
</span><span id="FisherPlotter.plot_triangle-563"><a href="#FisherPlotter.plot_triangle-563"><span class="linenos">563</span></a>                            <span class="c1"># 1 and 2 sigma shading</span>
</span><span id="FisherPlotter.plot_triangle-564"><a href="#FisherPlotter.plot_triangle-564"><span class="linenos">564</span></a>                            <span class="n">add_shading_1d</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_triangle-565"><a href="#FisherPlotter.plot_triangle-565"><span class="linenos">565</span></a>                                <span class="n">fiducial</span><span class="o">=</span><span class="n">fm</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">namex</span><span class="p">)],</span>
</span><span id="FisherPlotter.plot_triangle-566"><a href="#FisherPlotter.plot_triangle-566"><span class="linenos">566</span></a>                                <span class="n">sigma</span><span class="o">=</span><span class="n">fm</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">namex</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="FisherPlotter.plot_triangle-567"><a href="#FisherPlotter.plot_triangle-567"><span class="linenos">567</span></a>                                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-568"><a href="#FisherPlotter.plot_triangle-568"><span class="linenos">568</span></a>                                <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-569"><a href="#FisherPlotter.plot_triangle-569"><span class="linenos">569</span></a>                                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-570"><a href="#FisherPlotter.plot_triangle-570"><span class="linenos">570</span></a>                                <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-571"><a href="#FisherPlotter.plot_triangle-571"><span class="linenos">571</span></a>                                <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-572"><a href="#FisherPlotter.plot_triangle-572"><span class="linenos">572</span></a>                            <span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-573"><a href="#FisherPlotter.plot_triangle-573"><span class="linenos">573</span></a>                            <span class="n">add_shading_1d</span><span class="p">(</span>
</span><span id="FisherPlotter.plot_triangle-574"><a href="#FisherPlotter.plot_triangle-574"><span class="linenos">574</span></a>                                <span class="n">fiducial</span><span class="o">=</span><span class="n">fm</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">namex</span><span class="p">)],</span>
</span><span id="FisherPlotter.plot_triangle-575"><a href="#FisherPlotter.plot_triangle-575"><span class="linenos">575</span></a>                                <span class="n">sigma</span><span class="o">=</span><span class="n">fm</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">namex</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="FisherPlotter.plot_triangle-576"><a href="#FisherPlotter.plot_triangle-576"><span class="linenos">576</span></a>                                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-577"><a href="#FisherPlotter.plot_triangle-577"><span class="linenos">577</span></a>                                <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-578"><a href="#FisherPlotter.plot_triangle-578"><span class="linenos">578</span></a>                                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-579"><a href="#FisherPlotter.plot_triangle-579"><span class="linenos">579</span></a>                                <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
</span><span id="FisherPlotter.plot_triangle-580"><a href="#FisherPlotter.plot_triangle-580"><span class="linenos">580</span></a>                                <span class="n">ec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="FisherPlotter.plot_triangle-581"><a href="#FisherPlotter.plot_triangle-581"><span class="linenos">581</span></a>                            <span class="p">)</span>
</span><span id="FisherPlotter.plot_triangle-582"><a href="#FisherPlotter.plot_triangle-582"><span class="linenos">582</span></a>
</span><span id="FisherPlotter.plot_triangle-583"><a href="#FisherPlotter.plot_triangle-583"><span class="linenos">583</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-584"><a href="#FisherPlotter.plot_triangle-584"><span class="linenos">584</span></a>                        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_triangle-585"><a href="#FisherPlotter.plot_triangle-585"><span class="linenos">585</span></a>
</span><span id="FisherPlotter.plot_triangle-586"><a href="#FisherPlotter.plot_triangle-586"><span class="linenos">586</span></a>            <span class="c1"># set automatic limits</span>
</span><span id="FisherPlotter.plot_triangle-587"><a href="#FisherPlotter.plot_triangle-587"><span class="linenos">587</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="FisherPlotter.plot_triangle-588"><a href="#FisherPlotter.plot_triangle-588"><span class="linenos">588</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-589"><a href="#FisherPlotter.plot_triangle-589"><span class="linenos">589</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">relim</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_triangle-590"><a href="#FisherPlotter.plot_triangle-590"><span class="linenos">590</span></a>                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">()</span>
</span><span id="FisherPlotter.plot_triangle-591"><a href="#FisherPlotter.plot_triangle-591"><span class="linenos">591</span></a>                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-592"><a href="#FisherPlotter.plot_triangle-592"><span class="linenos">592</span></a>                        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FisherPlotter.plot_triangle-593"><a href="#FisherPlotter.plot_triangle-593"><span class="linenos">593</span></a>                        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</span><span id="FisherPlotter.plot_triangle-594"><a href="#FisherPlotter.plot_triangle-594"><span class="linenos">594</span></a>                        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="FisherPlotter.plot_triangle-595"><a href="#FisherPlotter.plot_triangle-595"><span class="linenos">595</span></a>                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="FisherPlotter.plot_triangle-596"><a href="#FisherPlotter.plot_triangle-596"><span class="linenos">596</span></a>                    <span class="k">pass</span>
</span><span id="FisherPlotter.plot_triangle-597"><a href="#FisherPlotter.plot_triangle-597"><span class="linenos">597</span></a>
</span><span id="FisherPlotter.plot_triangle-598"><a href="#FisherPlotter.plot_triangle-598"><span class="linenos">598</span></a>        <span class="k">return</span> <span class="n">FisherFigure2D</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots the 2D contours (and optionally 1D curves) of the Fisher objects.</p>

<h2 id="parameters">Parameters</h2>

<p>mpl_options : Optional[dict] = None
    any parameters meant for <code>matplotlib.rcParams</code>. By default, only
    sets default font to cm serif.
    See <a href="https://matplotlib.org/stable/tutorials/introductory/customizing.html">Matplotlib documentation</a>
    for more information.
plot_1d_curves : bool = True
    whether or not the 1D (marginalized) curves should be plotted</p>

<h2 id="returns">Returns</h2>

<p>An instance of <code><a href="#FisherFigure2D">FisherFigure2D</a></code>.</p>
</div>


                            </div>
                </section>
                <section id="bayes_factor">
                            <input id="bayes_factor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bayes_factor</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">fisher_base</span><span class="p">:</span> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>,</span><span class="param">	<span class="n">fisher_extended</span><span class="p">:</span> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>,</span><span class="param">	<span class="n">priors</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">offsets</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="bayes_factor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#bayes_factor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="bayes_factor-20"><a href="#bayes_factor-20"><span class="linenos"> 20</span></a><span class="k">def</span> <span class="nf">bayes_factor</span><span class="p">(</span>
</span><span id="bayes_factor-21"><a href="#bayes_factor-21"><span class="linenos"> 21</span></a>    <span class="n">fisher_base</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="bayes_factor-22"><a href="#bayes_factor-22"><span class="linenos"> 22</span></a>    <span class="n">fisher_extended</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="bayes_factor-23"><a href="#bayes_factor-23"><span class="linenos"> 23</span></a>    <span class="n">priors</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
</span><span id="bayes_factor-24"><a href="#bayes_factor-24"><span class="linenos"> 24</span></a>    <span class="n">offsets</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
</span><span id="bayes_factor-25"><a href="#bayes_factor-25"><span class="linenos"> 25</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="bayes_factor-26"><a href="#bayes_factor-26"><span class="linenos"> 26</span></a>    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="bayes_factor-27"><a href="#bayes_factor-27"><span class="linenos"> 27</span></a><span class="sd">    Returns the expected Bayes factor for a nested model (base model $M_B$ and</span>
</span><span id="bayes_factor-28"><a href="#bayes_factor-28"><span class="linenos"> 28</span></a><span class="sd">    extended model $M_E$), defined as:</span>
</span><span id="bayes_factor-29"><a href="#bayes_factor-29"><span class="linenos"> 29</span></a><span class="sd">    $$</span>
</span><span id="bayes_factor-30"><a href="#bayes_factor-30"><span class="linenos"> 30</span></a><span class="sd">        \left\langle B \right\rangle \equiv (2 \pi)^{-p / 2} \frac{\sqrt{\mathrm{det} \mathsf{F}_E}}{\sqrt{\mathrm{det} \mathsf{F}_B}}</span>
</span><span id="bayes_factor-31"><a href="#bayes_factor-31"><span class="linenos"> 31</span></a><span class="sd">        \exp{\left[-\frac{1}{2} \delta \theta_\alpha \mathsf{F}_E \delta \theta_\beta\right]}</span>
</span><span id="bayes_factor-32"><a href="#bayes_factor-32"><span class="linenos"> 32</span></a><span class="sd">        \prod\limits_{q = 1}^{p} \Delta \theta_{n + q}</span>
</span><span id="bayes_factor-33"><a href="#bayes_factor-33"><span class="linenos"> 33</span></a><span class="sd">    $$</span>
</span><span id="bayes_factor-34"><a href="#bayes_factor-34"><span class="linenos"> 34</span></a><span class="sd">    where $\mathsf{F}_B$ is the Fisher matrix of the base model (size $n \times</span>
</span><span id="bayes_factor-35"><a href="#bayes_factor-35"><span class="linenos"> 35</span></a><span class="sd">    n$), $\mathsf{F}_E$ is the Fisher matrix of the extended model (size $n&#39;</span>
</span><span id="bayes_factor-36"><a href="#bayes_factor-36"><span class="linenos"> 36</span></a><span class="sd">    \times n&#39;$, with $n&#39; = n + p$), $\delta \theta_\alpha$ is the offset array</span>
</span><span id="bayes_factor-37"><a href="#bayes_factor-37"><span class="linenos"> 37</span></a><span class="sd">    (size $n&#39;$), and $\Delta \theta_\alpha$ is the array of priors on the extra</span>
</span><span id="bayes_factor-38"><a href="#bayes_factor-38"><span class="linenos"> 38</span></a><span class="sd">    parameters in the extended model (size $p$).</span>
</span><span id="bayes_factor-39"><a href="#bayes_factor-39"><span class="linenos"> 39</span></a>
</span><span id="bayes_factor-40"><a href="#bayes_factor-40"><span class="linenos"> 40</span></a><span class="sd">    Parameters</span>
</span><span id="bayes_factor-41"><a href="#bayes_factor-41"><span class="linenos"> 41</span></a><span class="sd">    ----------</span>
</span><span id="bayes_factor-42"><a href="#bayes_factor-42"><span class="linenos"> 42</span></a><span class="sd">    fisher_base : FisherMatrix</span>
</span><span id="bayes_factor-43"><a href="#bayes_factor-43"><span class="linenos"> 43</span></a><span class="sd">        the Fisher matrix of the base (simpler) model</span>
</span><span id="bayes_factor-44"><a href="#bayes_factor-44"><span class="linenos"> 44</span></a>
</span><span id="bayes_factor-45"><a href="#bayes_factor-45"><span class="linenos"> 45</span></a><span class="sd">    fisher_extended : FisherMatrix</span>
</span><span id="bayes_factor-46"><a href="#bayes_factor-46"><span class="linenos"> 46</span></a><span class="sd">        the Fisher matrix of the extended (more complex) model</span>
</span><span id="bayes_factor-47"><a href="#bayes_factor-47"><span class="linenos"> 47</span></a>
</span><span id="bayes_factor-48"><a href="#bayes_factor-48"><span class="linenos"> 48</span></a><span class="sd">    priors : Collection[float]</span>
</span><span id="bayes_factor-49"><a href="#bayes_factor-49"><span class="linenos"> 49</span></a><span class="sd">        the priors for all of the parameters in the extended model</span>
</span><span id="bayes_factor-50"><a href="#bayes_factor-50"><span class="linenos"> 50</span></a>
</span><span id="bayes_factor-51"><a href="#bayes_factor-51"><span class="linenos"> 51</span></a><span class="sd">    offsets : Collection[float]</span>
</span><span id="bayes_factor-52"><a href="#bayes_factor-52"><span class="linenos"> 52</span></a><span class="sd">        the offsets induced in the base model by the extended model</span>
</span><span id="bayes_factor-53"><a href="#bayes_factor-53"><span class="linenos"> 53</span></a>
</span><span id="bayes_factor-54"><a href="#bayes_factor-54"><span class="linenos"> 54</span></a><span class="sd">    Returns</span>
</span><span id="bayes_factor-55"><a href="#bayes_factor-55"><span class="linenos"> 55</span></a><span class="sd">    -------</span>
</span><span id="bayes_factor-56"><a href="#bayes_factor-56"><span class="linenos"> 56</span></a><span class="sd">    float</span>
</span><span id="bayes_factor-57"><a href="#bayes_factor-57"><span class="linenos"> 57</span></a>
</span><span id="bayes_factor-58"><a href="#bayes_factor-58"><span class="linenos"> 58</span></a><span class="sd">    Raises</span>
</span><span id="bayes_factor-59"><a href="#bayes_factor-59"><span class="linenos"> 59</span></a><span class="sd">    ------</span>
</span><span id="bayes_factor-60"><a href="#bayes_factor-60"><span class="linenos"> 60</span></a><span class="sd">    `ValueError` is raised in one of the following situations:</span>
</span><span id="bayes_factor-61"><a href="#bayes_factor-61"><span class="linenos"> 61</span></a>
</span><span id="bayes_factor-62"><a href="#bayes_factor-62"><span class="linenos"> 62</span></a><span class="sd">    * `fisher_extended` does not have at least the same parameter names as `fisher_base`</span>
</span><span id="bayes_factor-63"><a href="#bayes_factor-63"><span class="linenos"> 63</span></a><span class="sd">    * the size of `priors` is not equal to the difference between the sizes of</span>
</span><span id="bayes_factor-64"><a href="#bayes_factor-64"><span class="linenos"> 64</span></a><span class="sd">    `fisher_extended` and `fisher_base`</span>
</span><span id="bayes_factor-65"><a href="#bayes_factor-65"><span class="linenos"> 65</span></a><span class="sd">    * the size of `offsets` is not equal to the size of `fisher_extended`</span>
</span><span id="bayes_factor-66"><a href="#bayes_factor-66"><span class="linenos"> 66</span></a>
</span><span id="bayes_factor-67"><a href="#bayes_factor-67"><span class="linenos"> 67</span></a><span class="sd">    Notes</span>
</span><span id="bayes_factor-68"><a href="#bayes_factor-68"><span class="linenos"> 68</span></a><span class="sd">    -----</span>
</span><span id="bayes_factor-69"><a href="#bayes_factor-69"><span class="linenos"> 69</span></a><span class="sd">    For more details, see</span>
</span><span id="bayes_factor-70"><a href="#bayes_factor-70"><span class="linenos"> 70</span></a><span class="sd">    [arXiv:astro-ph/0703191](https://arxiv.org/abs/astro-ph/0703191), eq. (14).</span>
</span><span id="bayes_factor-71"><a href="#bayes_factor-71"><span class="linenos"> 71</span></a>
</span><span id="bayes_factor-72"><a href="#bayes_factor-72"><span class="linenos"> 72</span></a><span class="sd">    Internally, the method first computes the logarithm of the Bayes factor to prevent</span>
</span><span id="bayes_factor-73"><a href="#bayes_factor-73"><span class="linenos"> 73</span></a><span class="sd">    numerical over- and underflow, and returns the exponential of that result.</span>
</span><span id="bayes_factor-74"><a href="#bayes_factor-74"><span class="linenos"> 74</span></a>
</span><span id="bayes_factor-75"><a href="#bayes_factor-75"><span class="linenos"> 75</span></a><span class="sd">    Furthermore, a warning is printed if the value of any of the offsets is</span>
</span><span id="bayes_factor-76"><a href="#bayes_factor-76"><span class="linenos"> 76</span></a><span class="sd">    larger than the $1\sigma$ marginalized constraints.</span>
</span><span id="bayes_factor-77"><a href="#bayes_factor-77"><span class="linenos"> 77</span></a>
</span><span id="bayes_factor-78"><a href="#bayes_factor-78"><span class="linenos"> 78</span></a><span class="sd">    Examples</span>
</span><span id="bayes_factor-79"><a href="#bayes_factor-79"><span class="linenos"> 79</span></a><span class="sd">    --------</span>
</span><span id="bayes_factor-80"><a href="#bayes_factor-80"><span class="linenos"> 80</span></a><span class="sd">    &gt;&gt;&gt; fisher_base = FisherMatrix(np.diag([1, 2, 3]))</span>
</span><span id="bayes_factor-81"><a href="#bayes_factor-81"><span class="linenos"> 81</span></a><span class="sd">    &gt;&gt;&gt; fisher_extended = FisherMatrix(np.diag([1, 2, 3, 4, 5]))</span>
</span><span id="bayes_factor-82"><a href="#bayes_factor-82"><span class="linenos"> 82</span></a><span class="sd">    &gt;&gt;&gt; bayes_factor(fisher_base, fisher_extended,</span>
</span><span id="bayes_factor-83"><a href="#bayes_factor-83"><span class="linenos"> 83</span></a><span class="sd">    ... priors=[1, 1], offsets=[0, 0, 0, 0, 0])</span>
</span><span id="bayes_factor-84"><a href="#bayes_factor-84"><span class="linenos"> 84</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="bayes_factor-85"><a href="#bayes_factor-85"><span class="linenos"> 85</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">fisher_base</span><span class="o">.</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">fisher_extended</span><span class="o">.</span><span class="n">names</span><span class="p">)):</span>
</span><span id="bayes_factor-86"><a href="#bayes_factor-86"><span class="linenos"> 86</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="bayes_factor-87"><a href="#bayes_factor-87"><span class="linenos"> 87</span></a>            <span class="s2">&quot;The extended Fisher matrix must contain at least &quot;</span>
</span><span id="bayes_factor-88"><a href="#bayes_factor-88"><span class="linenos"> 88</span></a>            <span class="s2">&quot;the parameters of the base Fisher matrix&quot;</span>
</span><span id="bayes_factor-89"><a href="#bayes_factor-89"><span class="linenos"> 89</span></a>        <span class="p">)</span>
</span><span id="bayes_factor-90"><a href="#bayes_factor-90"><span class="linenos"> 90</span></a>
</span><span id="bayes_factor-91"><a href="#bayes_factor-91"><span class="linenos"> 91</span></a>    <span class="c1"># check dimensions</span>
</span><span id="bayes_factor-92"><a href="#bayes_factor-92"><span class="linenos"> 92</span></a>    <span class="n">n_base</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fisher_base</span><span class="p">)</span>
</span><span id="bayes_factor-93"><a href="#bayes_factor-93"><span class="linenos"> 93</span></a>    <span class="n">n_extended</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fisher_extended</span><span class="p">)</span>
</span><span id="bayes_factor-94"><a href="#bayes_factor-94"><span class="linenos"> 94</span></a>    <span class="n">n_extra</span> <span class="o">=</span> <span class="n">n_extended</span> <span class="o">-</span> <span class="n">n_base</span>
</span><span id="bayes_factor-95"><a href="#bayes_factor-95"><span class="linenos"> 95</span></a>
</span><span id="bayes_factor-96"><a href="#bayes_factor-96"><span class="linenos"> 96</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">n_extra</span><span class="p">:</span>
</span><span id="bayes_factor-97"><a href="#bayes_factor-97"><span class="linenos"> 97</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to compute the Bayes factor for a non-nested model&quot;</span><span class="p">)</span>
</span><span id="bayes_factor-98"><a href="#bayes_factor-98"><span class="linenos"> 98</span></a>
</span><span id="bayes_factor-99"><a href="#bayes_factor-99"><span class="linenos"> 99</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">priors</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_extra</span><span class="p">:</span>
</span><span id="bayes_factor-100"><a href="#bayes_factor-100"><span class="linenos">100</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="bayes_factor-101"><a href="#bayes_factor-101"><span class="linenos">101</span></a>            <span class="sa">f</span><span class="s2">&quot;The number of elements in the prior array (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">priors</span><span class="p">)</span><span class="si">}</span><span class="s2">) &quot;</span>
</span><span id="bayes_factor-102"><a href="#bayes_factor-102"><span class="linenos">102</span></a>            <span class="sa">f</span><span class="s2">&quot;does not match the number of extra parameters from the extended model (</span><span class="si">{</span><span class="n">n_extra</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="bayes_factor-103"><a href="#bayes_factor-103"><span class="linenos">103</span></a>        <span class="p">)</span>
</span><span id="bayes_factor-104"><a href="#bayes_factor-104"><span class="linenos">104</span></a>
</span><span id="bayes_factor-105"><a href="#bayes_factor-105"><span class="linenos">105</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_extended</span><span class="p">:</span>
</span><span id="bayes_factor-106"><a href="#bayes_factor-106"><span class="linenos">106</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="bayes_factor-107"><a href="#bayes_factor-107"><span class="linenos">107</span></a>            <span class="sa">f</span><span class="s2">&quot;The number of elements in the offset array (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span><span class="si">}</span><span class="s2">) &quot;</span>
</span><span id="bayes_factor-108"><a href="#bayes_factor-108"><span class="linenos">108</span></a>            <span class="sa">f</span><span class="s2">&quot;does not match the number of parameters in the extended model (</span><span class="si">{</span><span class="n">n_extended</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="bayes_factor-109"><a href="#bayes_factor-109"><span class="linenos">109</span></a>        <span class="p">)</span>
</span><span id="bayes_factor-110"><a href="#bayes_factor-110"><span class="linenos">110</span></a>
</span><span id="bayes_factor-111"><a href="#bayes_factor-111"><span class="linenos">111</span></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span> <span class="o">/</span> <span class="n">fisher_extended</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">marginalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="bayes_factor-112"><a href="#bayes_factor-112"><span class="linenos">112</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="bayes_factor-113"><a href="#bayes_factor-113"><span class="linenos">113</span></a>            <span class="s2">&quot;The Fisher matrix of the extended model has offsets &quot;</span>
</span><span id="bayes_factor-114"><a href="#bayes_factor-114"><span class="linenos">114</span></a>            <span class="s2">&quot;larger than the 1 sigma marginalized error, &quot;</span>
</span><span id="bayes_factor-115"><a href="#bayes_factor-115"><span class="linenos">115</span></a>            <span class="s2">&quot;the obtained result may not be reliable&quot;</span>
</span><span id="bayes_factor-116"><a href="#bayes_factor-116"><span class="linenos">116</span></a>        <span class="p">)</span>
</span><span id="bayes_factor-117"><a href="#bayes_factor-117"><span class="linenos">117</span></a>
</span><span id="bayes_factor-118"><a href="#bayes_factor-118"><span class="linenos">118</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
</span><span id="bayes_factor-119"><a href="#bayes_factor-119"><span class="linenos">119</span></a>        <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">n_extra</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="bayes_factor-120"><a href="#bayes_factor-120"><span class="linenos">120</span></a>        <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="n">fisher_extended</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="bayes_factor-121"><a href="#bayes_factor-121"><span class="linenos">121</span></a>        <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="n">fisher_base</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="bayes_factor-122"><a href="#bayes_factor-122"><span class="linenos">122</span></a>        <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span> <span class="o">@</span> <span class="n">fisher_extended</span><span class="o">.</span><span class="n">values</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="bayes_factor-123"><a href="#bayes_factor-123"><span class="linenos">123</span></a>        <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">priors</span><span class="p">)))</span>
</span><span id="bayes_factor-124"><a href="#bayes_factor-124"><span class="linenos">124</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the expected Bayes factor for a nested model (base model $M_B$ and
extended model $M_E$), defined as:
$$
    \left\langle B \right\rangle \equiv (2 \pi)^{-p / 2} \frac{\sqrt{\mathrm{det} \mathsf{F}_E}}{\sqrt{\mathrm{det} \mathsf{F}_B}}
    \exp{\left[-\frac{1}{2} \delta \theta_\alpha \mathsf{F}_E \delta \theta_\beta\right]}
    \prod\limits_{q = 1}^{p} \Delta \theta_{n + q}
$$
where $\mathsf{F}_B$ is the Fisher matrix of the base model (size $n \times
n$), $\mathsf{F}_E$ is the Fisher matrix of the extended model (size $n'
\times n'$, with $n' = n + p$), $\delta \theta_\alpha$ is the offset array
(size $n'$), and $\Delta \theta_\alpha$ is the array of priors on the extra
parameters in the extended model (size $p$).</p>

<h2 id="parameters">Parameters</h2>

<p>fisher_base : FisherMatrix
    the Fisher matrix of the base (simpler) model</p>

<p>fisher_extended : FisherMatrix
    the Fisher matrix of the extended (more complex) model</p>

<p>priors : Collection[float]
    the priors for all of the parameters in the extended model</p>

<p>offsets : Collection[float]
    the offsets induced in the base model by the extended model</p>

<h2 id="returns">Returns</h2>

<p>float</p>

<h2 id="raises">Raises</h2>

<p><code>ValueError</code> is raised in one of the following situations:</p>

<ul>
<li><code>fisher_extended</code> does not have at least the same parameter names as <code>fisher_base</code></li>
<li>the size of <code>priors</code> is not equal to the difference between the sizes of
<code>fisher_extended</code> and <code>fisher_base</code></li>
<li>the size of <code>offsets</code> is not equal to the size of <code>fisher_extended</code></li>
</ul>

<h2 id="notes">Notes</h2>

<p>For more details, see
<a href="https://arxiv.org/abs/astro-ph/0703191">arXiv:astro-ph/0703191</a>, eq. (14).</p>

<p>Internally, the method first computes the logarithm of the Bayes factor to prevent
numerical over- and underflow, and returns the exponential of that result.</p>

<p>Furthermore, a warning is printed if the value of any of the offsets is
larger than the $1\sigma$ marginalized constraints.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fisher_base</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fisher_extended</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bayes_factor</span><span class="p">(</span><span class="n">fisher_base</span><span class="p">,</span> <span class="n">fisher_extended</span><span class="p">,</span>
<span class="gp">... </span><span class="n">priors</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">offsets</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>
</div>


                </section>
                <section id="kl_divergence">
                            <input id="kl_divergence-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">kl_divergence</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">fisher1</span><span class="p">:</span> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>,</span><span class="param">	<span class="n">fisher2</span><span class="p">:</span> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>,</span><span class="param">	<span class="n">fisher_prior</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">units</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="kl_divergence-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#kl_divergence"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="kl_divergence-127"><a href="#kl_divergence-127"><span class="linenos">127</span></a><span class="k">def</span> <span class="nf">kl_divergence</span><span class="p">(</span>
</span><span id="kl_divergence-128"><a href="#kl_divergence-128"><span class="linenos">128</span></a>    <span class="n">fisher1</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="kl_divergence-129"><a href="#kl_divergence-129"><span class="linenos">129</span></a>    <span class="n">fisher2</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="kl_divergence-130"><a href="#kl_divergence-130"><span class="linenos">130</span></a>    <span class="n">fisher_prior</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FisherMatrix</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="kl_divergence-131"><a href="#kl_divergence-131"><span class="linenos">131</span></a>    <span class="n">units</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
</span><span id="kl_divergence-132"><a href="#kl_divergence-132"><span class="linenos">132</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="kl_divergence-133"><a href="#kl_divergence-133"><span class="linenos">133</span></a>    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="kl_divergence-134"><a href="#kl_divergence-134"><span class="linenos">134</span></a><span class="sd">    Computes the Kullback-Leibler divergence (or relative entropy), $D(P_2 ||</span>
</span><span id="kl_divergence-135"><a href="#kl_divergence-135"><span class="linenos">135</span></a><span class="sd">    P_1)$, its expectation value, $\langle D \rangle$, and the square roots</span>
</span><span id="kl_divergence-136"><a href="#kl_divergence-136"><span class="linenos">136</span></a><span class="sd">    of the variance, $\sqrt{\sigma^2(D)}$, between two Gaussian probability</span>
</span><span id="kl_divergence-137"><a href="#kl_divergence-137"><span class="linenos">137</span></a><span class="sd">    distributions, $P_1$ and $P_2$.</span>
</span><span id="kl_divergence-138"><a href="#kl_divergence-138"><span class="linenos">138</span></a>
</span><span id="kl_divergence-139"><a href="#kl_divergence-139"><span class="linenos">139</span></a><span class="sd">    Parameters</span>
</span><span id="kl_divergence-140"><a href="#kl_divergence-140"><span class="linenos">140</span></a><span class="sd">    ----------</span>
</span><span id="kl_divergence-141"><a href="#kl_divergence-141"><span class="linenos">141</span></a><span class="sd">    fisher1 : FisherMatrix</span>
</span><span id="kl_divergence-142"><a href="#kl_divergence-142"><span class="linenos">142</span></a><span class="sd">        the Fisher matrix of the first distribution</span>
</span><span id="kl_divergence-143"><a href="#kl_divergence-143"><span class="linenos">143</span></a>
</span><span id="kl_divergence-144"><a href="#kl_divergence-144"><span class="linenos">144</span></a><span class="sd">    fisher2 : FisherMatrix</span>
</span><span id="kl_divergence-145"><a href="#kl_divergence-145"><span class="linenos">145</span></a><span class="sd">        the Fisher matrix of the second distribution</span>
</span><span id="kl_divergence-146"><a href="#kl_divergence-146"><span class="linenos">146</span></a>
</span><span id="kl_divergence-147"><a href="#kl_divergence-147"><span class="linenos">147</span></a><span class="sd">    fisher_prior : Optional[FisherMatrix] = None</span>
</span><span id="kl_divergence-148"><a href="#kl_divergence-148"><span class="linenos">148</span></a><span class="sd">        the prior Fisher matrix. If not set, defaults to a zero matrix.</span>
</span><span id="kl_divergence-149"><a href="#kl_divergence-149"><span class="linenos">149</span></a>
</span><span id="kl_divergence-150"><a href="#kl_divergence-150"><span class="linenos">150</span></a><span class="sd">    units : str = &#39;b&#39;</span>
</span><span id="kl_divergence-151"><a href="#kl_divergence-151"><span class="linenos">151</span></a><span class="sd">        the information units in which to output the result (default in bits).</span>
</span><span id="kl_divergence-152"><a href="#kl_divergence-152"><span class="linenos">152</span></a><span class="sd">        Can be either `&#39;b&#39;` (bits) or `&#39;B&#39;` (bytes), with an optional SI (such</span>
</span><span id="kl_divergence-153"><a href="#kl_divergence-153"><span class="linenos">153</span></a><span class="sd">        as `&#39;MB&#39;`) or binary (such as `&#39;MiB&#39;`) prefix. Please consult the table</span>
</span><span id="kl_divergence-154"><a href="#kl_divergence-154"><span class="linenos">154</span></a><span class="sd">        at the [Wikipedia article](https://en.wikipedia.org/wiki/Binary_prefix)</span>
</span><span id="kl_divergence-155"><a href="#kl_divergence-155"><span class="linenos">155</span></a><span class="sd">        for more details.</span>
</span><span id="kl_divergence-156"><a href="#kl_divergence-156"><span class="linenos">156</span></a>
</span><span id="kl_divergence-157"><a href="#kl_divergence-157"><span class="linenos">157</span></a><span class="sd">    Returns</span>
</span><span id="kl_divergence-158"><a href="#kl_divergence-158"><span class="linenos">158</span></a><span class="sd">    -------</span>
</span><span id="kl_divergence-159"><a href="#kl_divergence-159"><span class="linenos">159</span></a><span class="sd">    the result as a tuple of 3 `float`s in the requested information units</span>
</span><span id="kl_divergence-160"><a href="#kl_divergence-160"><span class="linenos">160</span></a>
</span><span id="kl_divergence-161"><a href="#kl_divergence-161"><span class="linenos">161</span></a><span class="sd">    Raises</span>
</span><span id="kl_divergence-162"><a href="#kl_divergence-162"><span class="linenos">162</span></a><span class="sd">    ------</span>
</span><span id="kl_divergence-163"><a href="#kl_divergence-163"><span class="linenos">163</span></a><span class="sd">    * `MismatchingValueError` if the parameter names of the Fisher matrices do</span>
</span><span id="kl_divergence-164"><a href="#kl_divergence-164"><span class="linenos">164</span></a><span class="sd">    not match</span>
</span><span id="kl_divergence-165"><a href="#kl_divergence-165"><span class="linenos">165</span></a><span class="sd">    * `ValueError` if the value of `units` cannot be parsed</span>
</span><span id="kl_divergence-166"><a href="#kl_divergence-166"><span class="linenos">166</span></a>
</span><span id="kl_divergence-167"><a href="#kl_divergence-167"><span class="linenos">167</span></a><span class="sd">    Notes</span>
</span><span id="kl_divergence-168"><a href="#kl_divergence-168"><span class="linenos">168</span></a><span class="sd">    -----</span>
</span><span id="kl_divergence-169"><a href="#kl_divergence-169"><span class="linenos">169</span></a><span class="sd">    For more details, see [arXiv:1402.3593](https://arxiv.org/abs/1402.3593),</span>
</span><span id="kl_divergence-170"><a href="#kl_divergence-170"><span class="linenos">170</span></a><span class="sd">    section 3.</span>
</span><span id="kl_divergence-171"><a href="#kl_divergence-171"><span class="linenos">171</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="kl_divergence-172"><a href="#kl_divergence-172"><span class="linenos">172</span></a>    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">fisher1</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fisher2</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="kl_divergence-173"><a href="#kl_divergence-173"><span class="linenos">173</span></a>        <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span><span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">fisher1</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">fisher2</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
</span><span id="kl_divergence-174"><a href="#kl_divergence-174"><span class="linenos">174</span></a>
</span><span id="kl_divergence-175"><a href="#kl_divergence-175"><span class="linenos">175</span></a>    <span class="n">dimension</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fisher1</span><span class="p">)</span>
</span><span id="kl_divergence-176"><a href="#kl_divergence-176"><span class="linenos">176</span></a>
</span><span id="kl_divergence-177"><a href="#kl_divergence-177"><span class="linenos">177</span></a>    <span class="k">if</span> <span class="n">fisher_prior</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">fisher1</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fisher_prior</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
</span><span id="kl_divergence-178"><a href="#kl_divergence-178"><span class="linenos">178</span></a>        <span class="k">raise</span> <span class="n">MismatchingValuesError</span><span class="p">(</span>
</span><span id="kl_divergence-179"><a href="#kl_divergence-179"><span class="linenos">179</span></a>            <span class="s2">&quot;parameter name&quot;</span><span class="p">,</span> <span class="n">fisher1</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">fisher_prior</span><span class="o">.</span><span class="n">names</span>
</span><span id="kl_divergence-180"><a href="#kl_divergence-180"><span class="linenos">180</span></a>        <span class="p">)</span>
</span><span id="kl_divergence-181"><a href="#kl_divergence-181"><span class="linenos">181</span></a>
</span><span id="kl_divergence-182"><a href="#kl_divergence-182"><span class="linenos">182</span></a>    <span class="k">if</span> <span class="n">fisher_prior</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="kl_divergence-183"><a href="#kl_divergence-183"><span class="linenos">183</span></a>        <span class="n">fisher_prior</span> <span class="o">=</span> <span class="n">FisherMatrix</span><span class="p">(</span>
</span><span id="kl_divergence-184"><a href="#kl_divergence-184"><span class="linenos">184</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dimension</span><span class="p">)),</span>
</span><span id="kl_divergence-185"><a href="#kl_divergence-185"><span class="linenos">185</span></a>            <span class="n">names</span><span class="o">=</span><span class="n">fisher1</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="kl_divergence-186"><a href="#kl_divergence-186"><span class="linenos">186</span></a>            <span class="n">fiducials</span><span class="o">=</span><span class="n">fisher1</span><span class="o">.</span><span class="n">fiducials</span><span class="p">,</span>
</span><span id="kl_divergence-187"><a href="#kl_divergence-187"><span class="linenos">187</span></a>        <span class="p">)</span>
</span><span id="kl_divergence-188"><a href="#kl_divergence-188"><span class="linenos">188</span></a>
</span><span id="kl_divergence-189"><a href="#kl_divergence-189"><span class="linenos">189</span></a>    <span class="n">f1_and_prior</span> <span class="o">=</span> <span class="p">(</span><span class="n">fisher1</span> <span class="o">+</span> <span class="n">fisher_prior</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</span><span id="kl_divergence-190"><a href="#kl_divergence-190"><span class="linenos">190</span></a>    <span class="n">f2_and_prior</span> <span class="o">=</span> <span class="p">(</span><span class="n">fisher2</span> <span class="o">+</span> <span class="n">fisher_prior</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</span><span id="kl_divergence-191"><a href="#kl_divergence-191"><span class="linenos">191</span></a>    <span class="n">f2</span> <span class="o">=</span> <span class="n">fisher2</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</span><span id="kl_divergence-192"><a href="#kl_divergence-192"><span class="linenos">192</span></a>
</span><span id="kl_divergence-193"><a href="#kl_divergence-193"><span class="linenos">193</span></a>    <span class="n">factor</span> <span class="o">=</span> <span class="n">process_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
</span><span id="kl_divergence-194"><a href="#kl_divergence-194"><span class="linenos">194</span></a>
</span><span id="kl_divergence-195"><a href="#kl_divergence-195"><span class="linenos">195</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="kl_divergence-196"><a href="#kl_divergence-196"><span class="linenos">196</span></a>        <span class="p">(</span>
</span><span id="kl_divergence-197"><a href="#kl_divergence-197"><span class="linenos">197</span></a>            <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="n">f1_and_prior</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="kl_divergence-198"><a href="#kl_divergence-198"><span class="linenos">198</span></a>            <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="n">f2_and_prior</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="kl_divergence-199"><a href="#kl_divergence-199"><span class="linenos">199</span></a>            <span class="o">-</span> <span class="n">dimension</span>
</span><span id="kl_divergence-200"><a href="#kl_divergence-200"><span class="linenos">200</span></a>            <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">f2_and_prior</span><span class="p">)</span> <span class="o">@</span> <span class="n">f1_and_prior</span><span class="p">)</span>
</span><span id="kl_divergence-201"><a href="#kl_divergence-201"><span class="linenos">201</span></a>        <span class="p">)</span>
</span><span id="kl_divergence-202"><a href="#kl_divergence-202"><span class="linenos">202</span></a>        <span class="o">/</span> <span class="mi">2</span>
</span><span id="kl_divergence-203"><a href="#kl_divergence-203"><span class="linenos">203</span></a>        <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="kl_divergence-204"><a href="#kl_divergence-204"><span class="linenos">204</span></a>        <span class="o">*</span> <span class="n">factor</span>
</span><span id="kl_divergence-205"><a href="#kl_divergence-205"><span class="linenos">205</span></a>    <span class="p">)</span>
</span><span id="kl_divergence-206"><a href="#kl_divergence-206"><span class="linenos">206</span></a>
</span><span id="kl_divergence-207"><a href="#kl_divergence-207"><span class="linenos">207</span></a>    <span class="n">argument</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="kl_divergence-208"><a href="#kl_divergence-208"><span class="linenos">208</span></a>        <span class="n">f2</span>
</span><span id="kl_divergence-209"><a href="#kl_divergence-209"><span class="linenos">209</span></a>        <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">f2_and_prior</span><span class="p">)</span>
</span><span id="kl_divergence-210"><a href="#kl_divergence-210"><span class="linenos">210</span></a>        <span class="o">@</span> <span class="n">f1_and_prior</span>
</span><span id="kl_divergence-211"><a href="#kl_divergence-211"><span class="linenos">211</span></a>        <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">f2_and_prior</span><span class="p">)</span>
</span><span id="kl_divergence-212"><a href="#kl_divergence-212"><span class="linenos">212</span></a>        <span class="o">@</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">f1_and_prior</span><span class="p">))</span>
</span><span id="kl_divergence-213"><a href="#kl_divergence-213"><span class="linenos">213</span></a>    <span class="p">)</span>
</span><span id="kl_divergence-214"><a href="#kl_divergence-214"><span class="linenos">214</span></a>
</span><span id="kl_divergence-215"><a href="#kl_divergence-215"><span class="linenos">215</span></a>    <span class="n">expectation</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span>
</span><span id="kl_divergence-216"><a href="#kl_divergence-216"><span class="linenos">216</span></a>
</span><span id="kl_divergence-217"><a href="#kl_divergence-217"><span class="linenos">217</span></a>    <span class="n">variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">argument</span> <span class="o">@</span> <span class="n">argument</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">factor</span>
</span><span id="kl_divergence-218"><a href="#kl_divergence-218"><span class="linenos">218</span></a>
</span><span id="kl_divergence-219"><a href="#kl_divergence-219"><span class="linenos">219</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expectation</span><span class="p">,</span> <span class="n">variance</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes the Kullback-Leibler divergence (or relative entropy), $D(P_2 ||
P_1)$, its expectation value, $\langle D \rangle$, and the square roots
of the variance, $\sqrt{\sigma^2(D)}$, between two Gaussian probability
distributions, $P_1$ and $P_2$.</p>

<h2 id="parameters">Parameters</h2>

<p>fisher1 : FisherMatrix
    the Fisher matrix of the first distribution</p>

<p>fisher2 : FisherMatrix
    the Fisher matrix of the second distribution</p>

<p>fisher_prior : Optional[FisherMatrix] = None
    the prior Fisher matrix. If not set, defaults to a zero matrix.</p>

<p>units : str = 'b'
    the information units in which to output the result (default in bits).
    Can be either <code>'b'</code> (bits) or <code>'B'</code> (bytes), with an optional SI (such
    as <code>'MB'</code>) or binary (such as <code>'MiB'</code>) prefix. Please consult the table
    at the <a href="https://en.wikipedia.org/wiki/Binary_prefix">Wikipedia article</a>
    for more details.</p>

<h2 id="returns">Returns</h2>

<p>the result as a tuple of 3 <code>float</code>s in the requested information units</p>

<h2 id="raises">Raises</h2>

<ul>
<li><code>MismatchingValueError</code> if the parameter names of the Fisher matrices do
not match</li>
<li><code>ValueError</code> if the value of <code>units</code> cannot be parsed</li>
</ul>

<h2 id="notes">Notes</h2>

<p>For more details, see <a href="https://arxiv.org/abs/1402.3593">arXiv:1402.3593</a>,
section 3.</p>
</div>


                </section>
                <section id="plot_curve_1d">
                            <input id="plot_curve_1d-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_curve_1d</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">fisher</span><span class="p">:</span> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="plot_curve_1d-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#plot_curve_1d"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="plot_curve_1d-685"><a href="#plot_curve_1d-685"><span class="linenos">685</span></a><span class="k">def</span> <span class="nf">plot_curve_1d</span><span class="p">(</span>
</span><span id="plot_curve_1d-686"><a href="#plot_curve_1d-686"><span class="linenos">686</span></a>    <span class="n">fisher</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="plot_curve_1d-687"><a href="#plot_curve_1d-687"><span class="linenos">687</span></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="plot_curve_1d-688"><a href="#plot_curve_1d-688"><span class="linenos">688</span></a>    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="plot_curve_1d-689"><a href="#plot_curve_1d-689"><span class="linenos">689</span></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="plot_curve_1d-690"><a href="#plot_curve_1d-690"><span class="linenos">690</span></a><span class="p">):</span>
</span><span id="plot_curve_1d-691"><a href="#plot_curve_1d-691"><span class="linenos">691</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="plot_curve_1d-692"><a href="#plot_curve_1d-692"><span class="linenos">692</span></a><span class="sd">    Plots a 1D curve (usually marginalized Gaussian) from a Fisher object.</span>
</span><span id="plot_curve_1d-693"><a href="#plot_curve_1d-693"><span class="linenos">693</span></a>
</span><span id="plot_curve_1d-694"><a href="#plot_curve_1d-694"><span class="linenos">694</span></a><span class="sd">    Parameters</span>
</span><span id="plot_curve_1d-695"><a href="#plot_curve_1d-695"><span class="linenos">695</span></a><span class="sd">    --------</span>
</span><span id="plot_curve_1d-696"><a href="#plot_curve_1d-696"><span class="linenos">696</span></a><span class="sd">    fisher : FisherMatrix</span>
</span><span id="plot_curve_1d-697"><a href="#plot_curve_1d-697"><span class="linenos">697</span></a><span class="sd">        the Fisher matrix which we want to plot</span>
</span><span id="plot_curve_1d-698"><a href="#plot_curve_1d-698"><span class="linenos">698</span></a>
</span><span id="plot_curve_1d-699"><a href="#plot_curve_1d-699"><span class="linenos">699</span></a><span class="sd">    name : str</span>
</span><span id="plot_curve_1d-700"><a href="#plot_curve_1d-700"><span class="linenos">700</span></a><span class="sd">        the name of the parameter which we want to plot</span>
</span><span id="plot_curve_1d-701"><a href="#plot_curve_1d-701"><span class="linenos">701</span></a>
</span><span id="plot_curve_1d-702"><a href="#plot_curve_1d-702"><span class="linenos">702</span></a><span class="sd">    ax : Optional[matplotlib.axes.Axes] = None</span>
</span><span id="plot_curve_1d-703"><a href="#plot_curve_1d-703"><span class="linenos">703</span></a><span class="sd">        the axis on which we want to plot the contour. By default, plots to a</span>
</span><span id="plot_curve_1d-704"><a href="#plot_curve_1d-704"><span class="linenos">704</span></a><span class="sd">        new figure.</span>
</span><span id="plot_curve_1d-705"><a href="#plot_curve_1d-705"><span class="linenos">705</span></a>
</span><span id="plot_curve_1d-706"><a href="#plot_curve_1d-706"><span class="linenos">706</span></a><span class="sd">    Returns</span>
</span><span id="plot_curve_1d-707"><a href="#plot_curve_1d-707"><span class="linenos">707</span></a><span class="sd">    -------</span>
</span><span id="plot_curve_1d-708"><a href="#plot_curve_1d-708"><span class="linenos">708</span></a><span class="sd">    A 2-tuple `(Figure, Axes)`</span>
</span><span id="plot_curve_1d-709"><a href="#plot_curve_1d-709"><span class="linenos">709</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="plot_curve_1d-710"><a href="#plot_curve_1d-710"><span class="linenos">710</span></a>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="plot_curve_1d-711"><a href="#plot_curve_1d-711"><span class="linenos">711</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="plot_curve_1d-712"><a href="#plot_curve_1d-712"><span class="linenos">712</span></a>
</span><span id="plot_curve_1d-713"><a href="#plot_curve_1d-713"><span class="linenos">713</span></a>    <span class="n">fid</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fisher</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name</span><span class="p">)]</span>
</span><span id="plot_curve_1d-714"><a href="#plot_curve_1d-714"><span class="linenos">714</span></a>    <span class="n">sigma</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">constraints</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">marginalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="plot_curve_1d-715"><a href="#plot_curve_1d-715"><span class="linenos">715</span></a>
</span><span id="plot_curve_1d-716"><a href="#plot_curve_1d-716"><span class="linenos">716</span></a>    <span class="n">add_plot_1d</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="plot_curve_1d-717"><a href="#plot_curve_1d-717"><span class="linenos">717</span></a>
</span><span id="plot_curve_1d-718"><a href="#plot_curve_1d-718"><span class="linenos">718</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="n">ax</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots a 1D curve (usually marginalized Gaussian) from a Fisher object.</p>

<h2 id="parameters">Parameters</h2>

<p>fisher : FisherMatrix
    the Fisher matrix which we want to plot</p>

<p>name : str
    the name of the parameter which we want to plot</p>

<p>ax : Optional[matplotlib.axes.Axes] = None
    the axis on which we want to plot the contour. By default, plots to a
    new figure.</p>

<h2 id="returns">Returns</h2>

<p>A 2-tuple <code>(Figure, Axes)</code></p>
</div>


                </section>
                <section id="plot_curve_2d">
                            <input id="plot_curve_2d-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_curve_2d</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">fisher</span><span class="p">:</span> <span class="n"><a href="#FisherMatrix">fitk.FisherMatrix</a></span>,</span><span class="param">	<span class="n">name1</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">name2</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">scaling_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">],</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="plot_curve_2d-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#plot_curve_2d"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="plot_curve_2d-757"><a href="#plot_curve_2d-757"><span class="linenos">757</span></a><span class="k">def</span> <span class="nf">plot_curve_2d</span><span class="p">(</span>
</span><span id="plot_curve_2d-758"><a href="#plot_curve_2d-758"><span class="linenos">758</span></a>    <span class="n">fisher</span><span class="p">:</span> <span class="n">FisherMatrix</span><span class="p">,</span>
</span><span id="plot_curve_2d-759"><a href="#plot_curve_2d-759"><span class="linenos">759</span></a>    <span class="n">name1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="plot_curve_2d-760"><a href="#plot_curve_2d-760"><span class="linenos">760</span></a>    <span class="n">name2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="plot_curve_2d-761"><a href="#plot_curve_2d-761"><span class="linenos">761</span></a>    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="plot_curve_2d-762"><a href="#plot_curve_2d-762"><span class="linenos">762</span></a>    <span class="n">scaling_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="plot_curve_2d-763"><a href="#plot_curve_2d-763"><span class="linenos">763</span></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="plot_curve_2d-764"><a href="#plot_curve_2d-764"><span class="linenos">764</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Figure</span><span class="p">],</span> <span class="n">Axes</span><span class="p">]:</span>
</span><span id="plot_curve_2d-765"><a href="#plot_curve_2d-765"><span class="linenos">765</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="plot_curve_2d-766"><a href="#plot_curve_2d-766"><span class="linenos">766</span></a><span class="sd">    Plots a 2D curve (usually ellipse) from two parameters of a Fisher object.</span>
</span><span id="plot_curve_2d-767"><a href="#plot_curve_2d-767"><span class="linenos">767</span></a>
</span><span id="plot_curve_2d-768"><a href="#plot_curve_2d-768"><span class="linenos">768</span></a><span class="sd">    Parameters</span>
</span><span id="plot_curve_2d-769"><a href="#plot_curve_2d-769"><span class="linenos">769</span></a><span class="sd">    ----------</span>
</span><span id="plot_curve_2d-770"><a href="#plot_curve_2d-770"><span class="linenos">770</span></a><span class="sd">    fisher : FisherMatrix</span>
</span><span id="plot_curve_2d-771"><a href="#plot_curve_2d-771"><span class="linenos">771</span></a><span class="sd">        the Fisher matrix which we want to plot</span>
</span><span id="plot_curve_2d-772"><a href="#plot_curve_2d-772"><span class="linenos">772</span></a>
</span><span id="plot_curve_2d-773"><a href="#plot_curve_2d-773"><span class="linenos">773</span></a><span class="sd">    name1 : str</span>
</span><span id="plot_curve_2d-774"><a href="#plot_curve_2d-774"><span class="linenos">774</span></a><span class="sd">        the name of the first parameter which we want to plot</span>
</span><span id="plot_curve_2d-775"><a href="#plot_curve_2d-775"><span class="linenos">775</span></a>
</span><span id="plot_curve_2d-776"><a href="#plot_curve_2d-776"><span class="linenos">776</span></a><span class="sd">    name2 : str</span>
</span><span id="plot_curve_2d-777"><a href="#plot_curve_2d-777"><span class="linenos">777</span></a><span class="sd">        the name of the second parameter which we want to plot</span>
</span><span id="plot_curve_2d-778"><a href="#plot_curve_2d-778"><span class="linenos">778</span></a>
</span><span id="plot_curve_2d-779"><a href="#plot_curve_2d-779"><span class="linenos">779</span></a><span class="sd">    ax : Optional[matplotlib.axes.Axes] = None</span>
</span><span id="plot_curve_2d-780"><a href="#plot_curve_2d-780"><span class="linenos">780</span></a><span class="sd">        the axis on which we want to plot the contour. By default, plots to a</span>
</span><span id="plot_curve_2d-781"><a href="#plot_curve_2d-781"><span class="linenos">781</span></a><span class="sd">        new figure.</span>
</span><span id="plot_curve_2d-782"><a href="#plot_curve_2d-782"><span class="linenos">782</span></a>
</span><span id="plot_curve_2d-783"><a href="#plot_curve_2d-783"><span class="linenos">783</span></a><span class="sd">    Returns</span>
</span><span id="plot_curve_2d-784"><a href="#plot_curve_2d-784"><span class="linenos">784</span></a><span class="sd">    -------</span>
</span><span id="plot_curve_2d-785"><a href="#plot_curve_2d-785"><span class="linenos">785</span></a><span class="sd">    A 2-tuple `(Figure, Axes)`</span>
</span><span id="plot_curve_2d-786"><a href="#plot_curve_2d-786"><span class="linenos">786</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="plot_curve_2d-787"><a href="#plot_curve_2d-787"><span class="linenos">787</span></a>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="plot_curve_2d-788"><a href="#plot_curve_2d-788"><span class="linenos">788</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="plot_curve_2d-789"><a href="#plot_curve_2d-789"><span class="linenos">789</span></a>
</span><span id="plot_curve_2d-790"><a href="#plot_curve_2d-790"><span class="linenos">790</span></a>    <span class="n">fidx</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fisher</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name1</span><span class="p">)]</span>
</span><span id="plot_curve_2d-791"><a href="#plot_curve_2d-791"><span class="linenos">791</span></a>    <span class="n">fidy</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">fiducials</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fisher</span><span class="o">.</span><span class="n">names</span> <span class="o">==</span> <span class="n">name2</span><span class="p">)]</span>
</span><span id="plot_curve_2d-792"><a href="#plot_curve_2d-792"><span class="linenos">792</span></a>
</span><span id="plot_curve_2d-793"><a href="#plot_curve_2d-793"><span class="linenos">793</span></a>    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">get_ellipse</span><span class="p">(</span><span class="n">fisher</span><span class="p">,</span> <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">)</span>
</span><span id="plot_curve_2d-794"><a href="#plot_curve_2d-794"><span class="linenos">794</span></a>
</span><span id="plot_curve_2d-795"><a href="#plot_curve_2d-795"><span class="linenos">795</span></a>    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
</span><span id="plot_curve_2d-796"><a href="#plot_curve_2d-796"><span class="linenos">796</span></a>        <span class="n">Ellipse</span><span class="p">(</span>
</span><span id="plot_curve_2d-797"><a href="#plot_curve_2d-797"><span class="linenos">797</span></a>            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">fidx</span><span class="p">,</span> <span class="n">fidy</span><span class="p">),</span>
</span><span id="plot_curve_2d-798"><a href="#plot_curve_2d-798"><span class="linenos">798</span></a>            <span class="n">width</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">scaling_factor</span><span class="p">,</span>
</span><span id="plot_curve_2d-799"><a href="#plot_curve_2d-799"><span class="linenos">799</span></a>            <span class="n">height</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">scaling_factor</span><span class="p">,</span>
</span><span id="plot_curve_2d-800"><a href="#plot_curve_2d-800"><span class="linenos">800</span></a>            <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span>
</span><span id="plot_curve_2d-801"><a href="#plot_curve_2d-801"><span class="linenos">801</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="plot_curve_2d-802"><a href="#plot_curve_2d-802"><span class="linenos">802</span></a>        <span class="p">),</span>
</span><span id="plot_curve_2d-803"><a href="#plot_curve_2d-803"><span class="linenos">803</span></a>    <span class="p">)</span>
</span><span id="plot_curve_2d-804"><a href="#plot_curve_2d-804"><span class="linenos">804</span></a>
</span><span id="plot_curve_2d-805"><a href="#plot_curve_2d-805"><span class="linenos">805</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(),</span> <span class="n">ax</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots a 2D curve (usually ellipse) from two parameters of a Fisher object.</p>

<h2 id="parameters">Parameters</h2>

<p>fisher : FisherMatrix
    the Fisher matrix which we want to plot</p>

<p>name1 : str
    the name of the first parameter which we want to plot</p>

<p>name2 : str
    the name of the second parameter which we want to plot</p>

<p>ax : Optional[matplotlib.axes.Axes] = None
    the axis on which we want to plot the contour. By default, plots to a
    new figure.</p>

<h2 id="returns">Returns</h2>

<p>A 2-tuple <code>(Figure, Axes)</code></p>
</div>


                </section>
    </main>
</body>
</html>